<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>

	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<HTA:APPLICATION ID="Form2551Qv2018" APPLICATIONNAME="2551Qv2018" VERSION="1.0" CAPTION="yes" SHOWINTASKBAR="yes" ICON="../img/bir_icon.ico"
	 SINGLEINSTANCE="YES" SYSMENU="NO" NAVIGABLE="YES" CONTEXTMENU="NO" WINDOWSTATE="maximize" SCROLLFLAT="YES">
		<script src='../jq/jquery-1.7.1.min.js'></script>
		<script src='../jq/jquery-ui-1.8.18.custom.min.js'></script>
		<link href="../css/styles.css" rel="stylesheet" type="text/css" />
		<link href="../css/print.css" rel="stylesheet" type="text/css" media="print" />
		<script src='../js/environment.js'></script>
		<script src='../js/string-util.js'></script>
		<script src='../js/aes.js'></script>
		<script src='../js/rijndael.js'></script>
		<script src='../js/lz-string-1.0.2.js'></script>
		<script language="VBScript" src="../js/eBIRTools.vbs"></script>

		<title>BIR Form No. 2551Qv2018</title>
</head>
<style media="print">
	#printer {
		display: inline !important;
	}
</style>

<body>
	<ul id="printMenu" class="topnav printButtonClass">
		<li>
			<a href="#" class='toplevel printButtonClass'>File</a>
			<ul class="subnav printButtonClass">
				<li>
					<a href="#" onclick="window.print();">Print</a>
				</li>
				<li>
					<a href="#" onclick="cancel();">Cancel Print</a>
				</li>
			</ul>
		</li>
	</ul>
	<ul id="formMenu" class="topnav printButtonClass">
		<li>
			<a href="#" class='toplevel printButtonClass'>File</a>
			<ul class="subnav printButtonClass">
				<li>
					<a href="#" onclick="window.location='../BIRForms.hta?xmlReloadProfile=' + createXMLProfileName() + '&formTyp=2551Qv2018'">Main Screen</a>
				</li>
				<li>
					<a href="#" onclick="saveXML(false);">Save</a>
				</li>
				<li>
					<a href="#" onclick="printme();">Print Preview</a>
				</li>
				<li>
					<a href="#" onclick="saveBeforeExit();">Exit</a>
				</li>
			</ul>
		</li>
		<li>
			<a href="#" class='toplevel printButtonClass'>Help</a>
			<style>
				.asubnav {
					text-indent: 20px;
					list-style-type: none
				}
			</style>
			<ul class="subnav printButtonClass">
				<li>
					<ul class="atopnav">
						<!--l3-->
						<li>
							<a href="#" class='atoplevel'>Documentary Stamp</a>
							<ul class="asubnav" style="display:none;">
								<li>
									<a href="#" onclick="goToHelpPage('2000');return false">BIR Form 2000</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('2000v2018');return false">BIR Form 2000v2018</a>
								</li> 
							</ul>
						</li>
					</ul>
					<!--l3-->
					<ul class="atopnav">
						<!--l3-->
						<li>
							<a href="#" class='atoplevel'>Excise</a>
							<ul class="asubnav" style="display:none;">
								<li>
									<a href="#" onclick="goToHelpPage('2200A');return false">BIR Form 2200A</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('2200P');return false">BIR Form 2200P</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('2200T');return false">BIR Form 2200T</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('2200AN');return false">BIR Form 2200AN</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('2200M');return false">BIR Form 2200M</a>
								</li>
							</ul>
						</li>
					</ul>
					<!--l3-->
					<ul class="atopnav">
						<!--l3-->
						<li>
							<a href="#" class='atoplevel'>Income</a>
							<ul class="asubnav" style="display:none;">
								<li>
									<a href="#" onclick="goToHelpPage('1701Q');return false">BIR Form 1701Q</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('1704');return false">BIR Form 1704</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('1702Q');return false">BIR Form 1702Q</a>
								</li>
							</ul>
						</li>
					</ul>
					<!--l3-->
					<ul class="atopnav">
						<!--l3-->
						<li>
							<a href="#" class='atoplevel'>ONETT</a>
							<ul class="asubnav" style="display:none;">
								<li>
									<a href="#" onclick="goToHelpPage('1606');return false">BIR Form 1606</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('1706');return false">BIR Form 1706</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('1707');return false">BIR Form 1707</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('1800');return false">BIR Form 1800</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('1801');return false">BIR Form 1801</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('2000-OT');return false">BIR Form 2000-OT</a>
								</li>
							</ul>
						</li>
					</ul>
					<!--l3-->
					<ul class="atopnav">
						<!--l3-->
						<li>
							<a href="#" class='atoplevel'>Payment</a>
							<ul class="asubnav" style="display:none;">
								<li>
									<a href="#" onclick="goToHelpPage('0605');return false">BIR Form 0605</a>
								</li>
							</ul>
						</li>
					</ul>
					<!--l3-->
					<ul class="atopnav">
						<!--l3-->
						<li>
							<a href="#" class='atoplevel'>Percentage</a>
							<ul class="asubnav" style="display:none;">
								<li>
									<a href="#" onclick="goToHelpPage('2551');return false">BIR Form 2551Q</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('2551Qv2018');return false">BIR Form 2551Qv2018</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('2551M');return false">BIR Form 2551M</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('2552');return false">BIR Form 2552</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('2553');return false">BIR Form 2553</a>
								</li>
							</ul>
						</li>
					</ul>
					<!--l3-->
					<ul class="atopnav">
						<!--l3-->
						<li>
							<a href="#" class='atoplevel'>Value Added Tax</a>
							<ul class="asubnav" style="display:none;">
								<li>
									<a href="#" onclick="goToHelpPage('2550M');return false">BIR Form 2550M</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('2550Q');return false">BIR Form 2550Q</a>
								</li>
							</ul>
						</li>
					</ul>
					<!--l3-->
					<ul class="atopnav">
						<!--l3-->
						<li>
							<a href="#" class='atoplevel'>Withholding</a>
							<ul class="asubnav" style="display:none;">
								<li>
									<a href="#" onclick="goToHelpPage('0619E');return false">BIR Form 0619E</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('0619F');return false">BIR Form 0619F</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('1601C');return false">BIR Form 1601C</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('1601Cv2018');return false">BIR Form 1601Cv2018</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('1601E');return false">BIR Form 1601E</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('1601EQ');return false">BIR Form 1601EQ</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('1601F');return false">BIR Form 1601F</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('1601FQ');return false">BIR Form 1601FQ</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('1602');return false">BIR Form 1602</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('1602Q');return false">BIR Form 1602Qv2018</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('1603');return false">BIR Form 1603</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('1603Q');return false">BIR Form 1603Qv2018</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('1600');return false">BIR Form 1600</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('1600WP');return false">BIR Form 1600WP</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('1604CF');return false">BIR Form 1604CF</a>
								</li>
								<li>
									<a href="#" onclick="goToHelpPage('1604E');return false">BIR Form 1604E</a>
								</li>
							</ul>
						</li>
					</ul>
					<!--l3-->
				</li>
			</ul>
		</li>
	</ul>
	<!--topnav-->
	<div class="printButtonClass" style="position:fixed; top:10px; font-size:11px; z-index:1000000000000000; right:5px; width:auto;">Government Property Not For Sale</div>

	<!--title-->
	<img class="printButtonClass" id="bg" src="../img/bg_n.png" height="100%" align="top" />
	<!--watermark-->

	<div id='loader'>
		<div id='text'>
			<img src="../img/ajax-loader-1.gif" width="440" height="30" alt="loader" />
		</div>
	</div>
	<style>
		#loader,
		#text {
			width: 100%;
			height: 100%;
			top: 0;
			left: 0;
			position: fixed;
			background: #FFF;
			z-index: 5000;
		}

		#text {
			background: none;
			top: 50%;
			left: 50%;
			right: 68%;
			left: 32%;
			width: 440px;
			overflow: hidden;
		}
	</style>
	<style>
		.atcNames {
			font-weight: bold;
		}

		tr.atc td {
			border-bottom: 1px #e1e1e1 solid;
		}

		tr.atc:hover td {
			background: #FFC;
		}

		td.atc {
			padding: 4px;
		}

		#container {
			margin-top: 40px;
		}
	</style>
	<div class='printButtonClass menu'></div>
	<div class='printButtonClass' id='header'>
		<input type='button' class='printButtonClass' value='Main Menu' onclick="window.location = '../BIRForms.hta'; " />
		<input type='button' class='printButtonClass' value='Save' onclick='saveXML(false);' />
		<input type='button' class='printButtonClass' value='Print' onclick='window.print();' />
		<input type='button' class='printButtonClass' value='Exit' onclick='window.close(); self.close();' />
	</div>
	<!-- MODAL - Payment Option  -->
	<div id="paymentOption" class="payment-option">
		<div align="center">
			<img src="../img/bir_broadcast_logo.png" alt="bir logo" class="payment-option-content" />
			<img src="../img/epay_logo.png" alt="bir logo" class="payment-option-content" />
			<br/>
			<br/>
			<span class="payment-option-content">You can now pay electronically through the following channels</span>
			<br/>
			<br/>
			<span class="payment-option-content">
				<a href="https://www.bir.gov.ph/index.php/eservices/epay.html" target="_blank">https://www.bir.gov.ph/index.php/eservices/epay.html</a>
			</span>
			<br/>
			<br/>
		</div>
		<div id="paymentOptionFooter" class="payment-option-footer">
			<input id="paymentOptionCloseBtn" type="button" style="width:120px; height:30px;" value="Close" />
		</div>
	</div>
	<form id="frmMain" name="frmMain">
		<div id="container">
			<div id="wrapper" style="margin: 0 auto; position: relative; width: 800px; ">

				<table border="0" width="800" cellspacing="0" cellpadding="0" align="center" style="background-image: url(../img/frmbg.png); background-repeat: repeat-x;">
					<tr>
						<td>

							<div id="formPaper">
								<!--Page 1-->
								<div id="Page1">
									<table width="741" border="0" cellspacing="0" cellpadding="0">
										<tr>
											<!--Top Header-->
											<td>
												<table width="741" border="0" cellspacing="0" cellpadding="0" style="height: 56px;">
													<tr>
														<td width="25%" valign="bottom" style="padding-left: 2px;">
															<img width="80" height="25" src="../img/bcs_new.png">
														</td>
														<td width="50%" valign="middle" align="center">
															<img width="210" height="50" alt="birlogo" src="../img/header_logo.png">

														</td>
														<td width="25%" valign="middle">


														</td>

													</tr>


												</table>
											</td>
										</tr>
										<tr>
											<td>
												<table width="741" style="height:90px;" border="1" cellspacing="0" cellpadding="0">
													<tbody>
														<tr>
															<td width="150" valign="center" style="text-align:center !important">
																<font face="Arial" size="1">BIR Form No.
																	<br>
																</font>
																<font face="Arial" size="6" style="font-weight:bold;">2551Q

																</font>
																<font face="Arial" size="1">January 2018(ENCS)</font>
																<br>
																<font face="Arial" size="1">
																	<b>Page 1</b>
																</font>
															</td>
															<td width="580" align="center">
																<font size="5" style="font-weight:bold;">Quarterly Percentage Tax Return</font>

																<br>
																<font face="Arial" size="1">
																	<i>Enter all required information in CAPITAL LETTERS using BLACK ink. Mark applicable boxes with an "X". Two
																		copies MUST be filled with the BIR and one held by the Taxpayer.</i>
																</font>
															</td>
															<td valign="top">
																<img width="220" height="75" src="../img/2551Qv2018_BarCode/2551Qv2018_P1.png">

															</td>
														</tr>
													</tbody>

												</table>
											</td>
										</tr>
										<tr>
											<td>
												<table width="741" border="0" cellspacing="0" cellpadding="0" class="tblForm">
													<tr>
														<td width="40%" valign="top" class="tblFormTd">
															<table width="297" border="0" cellspacing="0" cellpadding="0">
																<tr>
																	<td width="23">
																		<font size="2" style="font-weight:bold;">&nbsp;1&nbsp;&nbsp;&nbsp;</font>
																	</td>
																	<td colspan="2">
																		<font size="1">For the</font>
																	</td>
																	<td>
																		<input id="frm2551Qv2018:forThe_1" name="frm2551Qv2018:forThe" value="Y" type="radio" onclick="dateyear()" />
																		<label class="iceSelOneRb-dis-dis" for="frm2551Qv2018:optAmend:_1">Calendar&nbsp;&nbsp;</label>
																		<input id="frm2551Qv2018:forThe_2" name="frm2551Qv2018:forThe" value="N" type="radio" onclick="dateyear()" />
																		<label class="iceSelOneRb-dis-dis" for="frm2551Qv2018:optAmend:_2">Fiscal</label>
																	</td>
																</tr>

																<tr>
																	<td width="13">
																		<font size="2" style="font-weight:bold;">&nbsp;2&nbsp;&nbsp;&nbsp;</font>
																	</td>
																	<td colspan="2" width="59" nowrap>
																		<font size="1">Year Ended(MM/YYYY)</font>
																	</td>
																	<td width="255">
																		<select size="1" name="frm2551Qv2018:rtnMonth" id="frm2551Qv2018:rtnMonth" class="iceSelOneMnu fieldSelect1">
																			<option value="00"></option>
																			<option value="01">01 - January</option>
																			<option value="02">02 - February</option>
																			<option value="03">03 - March</option>
																			<option value="04">04 - April</option>
																			<option value="05">05 - May</option>
																			<option value="06">06 - June</option>
																			<option value="07">07 - July</option>
																			<option value="08">08 - August</option>
																			<option value="09">09 - September</option>
																			<option value="10">10 - October</option>
																			<option value="11">11 - November</option>
																			<option value="12">12 - December</option>
																		</select>
																		&nbsp;&nbsp;
																		<input type="text" value="" size="4" name="frm2551Qv2018:txtYear" maxlength="4" id="frm2551Qv2018:txtYear" onblur="blockletterWithout2Decimal(this);validateYear()"
																		 onkeypress="return wholenumber(this, event)" />
																	</td>
																</tr>


															</table>
														</td>

														<td width="30%" valign="top" class="tblFormTd">
															<table border="0" cellspacing="0" cellpadding="0">
																<tr>
																	<td>
																		<font size="2" style="font-weight:bold;">&nbsp;&nbsp;3&nbsp;&nbsp;</font>
																		<font size="1">Quarter</font>
																	</td>
																	<td>
																		<font size="1">&nbsp;</font>
																	</td>
																</tr>
																<tr>
																	<td colspan="2">
																		<table cellspacing="0" cellpadding="0" border="0" >
																					<tbody>
																						<tr>
																							<td style="padding-left: 5px;">
																								<input type="radio" value="1" name="frm2551Qv2018:qtr" id="frm2551Qv2018:qtr_1" />
																								<label for="frm2551Qv2018:qtr_1" style="font-size:12px;">1st</label>
																								&nbsp;&nbsp;&nbsp;
																							</td>
																							<td>
																								<input type="radio" value="2" name="frm2551Qv2018:qtr" id="frm2551Qv2018:qtr_2" />
																								<label for="frm2551Qv2018:qtr_2" style="font-size:12px;">2nd</label>
																								&nbsp;&nbsp;&nbsp;
																							</td>
																							<td>
																								<input type="radio" value="3" name="frm2551Qv2018:qtr" id="frm2551Qv2018:qtr_3" />
																								<label for="frm2551Qv2018:qtr_3" style="font-size:12px;">3rd</label>
																								&nbsp;&nbsp;&nbsp;
																							</td>
																							<td>
																								<input type="radio" value="4" name="frm2551Qv2018:qtr" id="frm2551Qv2018:qtr_4" />
																								<label for="frm2551Qv2018:qtr_4" style="font-size:12px;">4th</label>
																								&nbsp;&nbsp;&nbsp;&nbsp;
																							</td>
																						</tr>

																					</tbody>
																				</table>
																	</td>
																</tr>
															</table>
														</td>
														<td width="15%" valign="top" class="tblFormTd">
															<table width="110" border="0" cellspacing="0" cellpadding="0">
																<tr>
																	<td width="23">
																		<font size="2" style="font-weight:bold;">&nbsp;&nbsp;4&nbsp;&nbsp;</font>
																	</td>
																	<td width="87">
																		<font size="1">Amended Return?</font>
																	</td>
																</tr>
																<tr>
																	<td>&nbsp;</td>
																	<td>
																	<table cellspacing="0" cellpadding="0" border="0">
																					<tbody>
																						<tr>
																							<td>
																								<input type="radio" value="Y" name="frm2551Qv2018:amendedRtn" id="frm2551Qv2018:amendedRtn_1" onclick="updateAmended();" />
																								<label for="frm2551Qv2018:amendedRtn_1" style="font-size:12px;">Yes</label>
																							</td>
																							<td>
																								<input type="radio" value="N" name="frm2551Qv2018:amendedRtn" id="frm2551Qv2018:amendedRtn_2" onclick="updateAmended();computeTotalTaxCreditForm2551Qv2018();"
																								 checked />
																								<label for="frm2551Qv2018:amendedRtn_2" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:12px;">No</label>&nbsp;&nbsp;&nbsp;
																							</td>

																						</tr>

																					</tbody>
																				</table>
																		
																	</td>
																</tr>
															</table>
														</td>
														<td width="15%" valign="top" class="tblFormTd">
															<table border="0" cellspacing="0" cellpadding="0">
																<tr>
																	<td>
																		<font size="2" style="font-weight:bold;">&nbsp;5&nbsp;&nbsp;</font>
																		<font size="1">No. of Sheet/s </font>
																	</td>

																</tr>
																<tr>

																	<td>
																		&nbsp;
																		<font size="1">Attached</font> &nbsp;&nbsp;
																		<input type="text" value="0" style="text-align: right;" size="4" name="frm2551Qv2018:txtSheets" maxlength="2" id="frm2551Qv2018:txtSheets"
																		 class="iceInpTxt-dis" onkeypress="return wholenumber(this, event)" />
																	</td>
																</tr>
															</table>
														</td>

													</tr>
												</table>
											</td>
										</tr>
										<tr>
											<td>
												<table width="741" border="0" cellspacing="0" cellpadding="0" class="tblForm">
													<tr>
														<td class="tblFormTdPart">
															<table width="" border="0" cellspacing="0" cellpadding="0">
																<tr>
																	<td width="88">&nbsp;&nbsp;&nbsp;
																		<font size="2" style="font-weight:bold;"></font>
																	</td>
																	<td width="565">
																		<div align="center">
																			<font size="2" style="font-weight:bold;letter-spacing: 3px;">Part I - Background Information</font>
																		</div>
																	</td>
																	<td width="88">&nbsp;</td>
																</tr>
															</table>
														</td>
													</tr>
												</table>
											</td>
										</tr>

										<tr>
											<td>
												<table border="0" cellspacing="0" cellpadding="0" class="tblForm">
													<tr>
														<td width="70%" valign="top" class="tblFormTd">
															<table border="0" cellspacing="0" cellpadding="0">
																<tr>
																	<td>
																		<font size="2" style="font-weight:bold">&nbsp;6&nbsp;</font>
																	</td>
																	<td>
																		<font size="1">Taxpayer Indentification Number (TIN)&nbsp;</font>
																		<font size="2" face="Arial">
																			<input type="text" value="" size="4" name="frm2551Qv2018:txtTIN1" maxlength="4" id="frm2551Qv2018:txtTIN1" onkeypress="return wholenumber(this, event)"
																			/>
																			<input type="text" value="" size="4" name="frm2551Qv2018:txtTIN2" maxlength="4" id="frm2551Qv2018:txtTIN2" onkeypress="return wholenumber(this, event)"
																			/>
																			<input type="text" value="" size="4" name="frm2551Qv2018:txtTIN3" maxlength="4" id="frm2551Qv2018:txtTIN3" onkeypress="return wholenumber(this, event)"
																			/>
																			<input type="text" value="" size="4" name="frm2551Qv2018:txtBranchCode" maxlength="4" id="frm2551Qv2018:txtBranchCode" onkeypress="return letternumber(event)"
																			/>
																		</font>
																	</td>
																</tr>
															</table>
														</td>
														<td width="20%" valign="top" class="tblFormTd">
															<table border="0" cellspacing="0" cellpadding="0">
																<tr>
																	<td>
																		<font size="2" style="font-weight:bold">&nbsp;7&nbsp;</font>
																		<font size="1">RDO Code&nbsp;</font>
																	</td>
																	<td width="50%" id="rdoSelect" nowrap>
																	</td>
																</tr>
															</table>
														</td>


													</tr>
												</table>
											</td>
										</tr>
										<tr>
											<td>
												<table width="741" border="0" cellspacing="0" cellpadding="0" class="tblForm">
													<tr>
														<td width="" valign="top" class="tblFormTd">
															<table border="0" cellspacing="0" cellpadding="0">
																<tr>
																	<td width="567">
																		<table width="561" border="0" cellpadding="0" cellspacing="0">
																			<tr>
																				<td width="23">
																					<font size="2" style="font-weight:bold;">&nbsp;8&nbsp;</font>
																				</td>
																				<td width="538">
																					<font size="1">
																						Taxpayer's Name (Last Name, First Name, Middle Name for Individual OR Registered Name for Non-Individual)
																					</font>
																				</td>
																			</tr>
																		</table>
																	</td>
																</tr>
																<tr>
																	<td>
																		<table border="0" cellspacing="0" cellpadding="0">
																			<tr>
																				<td></td>
																				<td>&nbsp;
																					<input type="text" value="" size="120" disabled="true" name="frm2551Qv2018:registeredName" maxlength="50" id="frm2551Qv2018:registeredName" onblur="return capital(this, event)"
																					/>
																				</td>
																			</tr>
																		</table>
																	</td>
																</tr>
															</table>
														</td>

													</tr>
												</table>
											</td>
										</tr>
										<tr>
											<td>
												<table width="741" border="0" cellspacing="0" cellpadding="0" class="tblForm">
													<tr>
														<td width="" valign="top" class="tblFormTd">
															<table border="0" cellspacing="0" cellpadding="0">
																<tr>
																	<td>
																		<table border="0" cellpadding="0" cellspacing="0">
																			<tr>
																				<td width="23">
																					<font size="2" style="font-weight:bold;">&nbsp;9&nbsp;</font>
																				</td>
																				<td>
																					<font size="1">
																						Registered Address (Indicate complete address. If branch, indicate the branch address. If the registered address is different from the current address, go to the RDO to update registered address using BIR Form No. 1905)
																					</font>
																				</td>
																			</tr>
																		</table>
																	</td>
																</tr>
																<tr>
																	<td>
																		<table border="0" cellspacing="0" cellpadding="0">
																			<tr>
																				<td></td>
																				<td>&nbsp;
																					<input type="text" value="" disabled="true" size="110" name="frm2551Qv2018:registeredAddress" maxlength="100" id="frm2551Qv2018:registeredAddress" onblur="return capital(this, event)"
																					/>
																				</td>
																			</tr>
																		</table>
																	</td>
																</tr>
															</table>
														</td>
														<td width="100" valign="top" class="tblFormTd">
															<table border="0" cellspacing="0" cellpadding="0">
																<tr>
																	<td width="135">
																		<table width="129" border="0" cellpadding="0" cellspacing="0">
																			<tr>
																				<td width="23">
																					<font size="2" style="font-weight:bold;">&nbsp;9A</font>
																				</td>
																				<td width="106">
																					<font size="1">Zip Code</font>
																				</td>
																			</tr>
																		</table>
																	</td>
																</tr>
																<tr>
																	<td>
																		<table border="0" cellspacing="0" cellpadding="0">
																			<tr>
																				<td>&nbsp;</td>
																				<td>
																					<input type="text" value="" disabled="true" size="8" name="frm2551Qv2018:zipCode" maxlength="8" id="frm2551Qv2018:zipCode" onkeypress="return wholenumber(this, event)"
																					/>
																				</td>
																			</tr>
																		</table>
																	</td>
																</tr>
															</table>
														</td>
													</tr>
												</table>
											</td>
										</tr>
										<tr>
											<td>
												<table width="741" border="0" cellspacing="0" cellpadding="0" class="tblForm">
													<tr>
														<td width="" valign="top" class="tblFormTd">
															<table border="0" cellspacing="0" cellpadding="0">
																<tr>
																	<td>
																		<table border="0" cellpadding="0" cellspacing="0">
																			<tr>
																				<td width="23">
																					<font size="2" style="font-weight:bold;">&nbsp;10&nbsp;</font>
																				</td>
																				<td>
																					<font size="1">&nbsp;&nbsp;&nbsp;Contact Number (Landline/Cellphone No.)</font>
																				</td>
																			</tr>
																		</table>
																	</td>
																</tr>
																<tr>
																	<td>
																		<table border="0" cellspacing="0" cellpadding="0">
																			<tr>
																				<td></td>
																				<td>&nbsp;
																					<input type="text" value="" disabled="true" size="43" name="frm2551Qv2018:telNo" maxlength="20" id="frm2551Qv2018:telNo" onkeypress="return wholenumber(this, event)"
																					/>
																				</td>
																			</tr>
																		</table>
																	</td>
																</tr>
															</table>
														</td>
														<td width="100" valign="top" class="tblFormTd">
															<table border="0" cellspacing="0" cellpadding="0">
																<tr>
																	<td>
																		<table border="0" cellpadding="0" cellspacing="0">
																			<tr>
																				<td width="23">
																					<font size="2" style="font-weight:bold;">&nbsp;11</font>
																				</td>
																				<td>
																					<font size="1">Email Address</font>
																				</td>
																			</tr>
																		</table>
																	</td>
																</tr>
																<tr>
																	<td>
																		<table border="0" cellspacing="0" cellpadding="0">
																			<tr>
																				<td>&nbsp;</td>
																				<td>
																					<input type="text" value="" disabled="true" size="70" name="txtEmail" maxlength="50" id="txtEmail" onblur="return capital(this, event)"
																					/>
																				</td>
																			</tr>
																		</table>
																	</td>
																</tr>
															</table>
														</td>
													</tr>
												</table>
											</td>

										</tr>

										<tr>
											<td>
												<table width="741" border="0" cellspacing="0" cellpadding="0" class="tblForm">
													<tr>
														<td width="" valign="top" class="tblFormTd">
															<table border="0" cellspacing="0" cellpadding="0">

																<tr>
																	<td width="20">
																		<font size="2" style="font-weight:bold;">&nbsp;12&nbsp;&nbsp;</font>
																	</td>
																	<td width="180">
																		<font size="1">Are you availing of tax relief under Special Law / International Tax Treaty?</font>
																	</td>


																	<td style="padding-left: 20px;">
																		<input type="radio" value="Y" name="frm2551Qv2018:taxTreaty" id="frm2551Qv2018:taxTreaty_1" onclick="chageTreaty()" />
																		<label for="frm2551Qv2018:taxTreaty_1" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:12px;">Yes</label>&nbsp;&nbsp;&nbsp;
																	</td>
																	<td width="100">
																		<input type="radio" value="N" name="frm2551Qv2018:taxTreaty" id="frm2551Qv2018:taxTreaty_2" checked onclick="chageTreaty()" />
																		<label for="frm2551Qv2018:taxTreaty_2" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:12px;">No</label>
																	</td>

																</tr>

															</table>
														</td>
														<td valign="top" class="tblFormTd">
															<table border="0" cellspacing="0" cellpadding="0">
																<tr>
																	<td>
																		<td>
																			<font size="2" style="font-weight:bold;">&nbsp;&nbsp;12A &nbsp;&nbsp;</font>
																		</td>
																		<td>
																			<font size="1" face="Arial, Helvetica, sans-serif">If yes, specify&nbsp;
																				<select class="iceSelOneMnu-dis input-dis" disabled="disabled" id="frm2551Qv2018:txtTaxReliefSpecify" name="frm2551Qv2018:txtTaxReliefSpecify"
																				 size="1">
																					<option selected="selected" value="0"> </option>
																					<option value="1">Special Rate</option>
																					<option value="2">International Tax Treaty</option>
																				</select>
																			</font>
																		</td>
																	</td>
																</tr>

															</table>
														</td>
													</tr>
												</table>
											</td>
										</tr>

										<!--13-->
										<tr>
											<td>
												<table width="741" border="0" cellspacing="0" cellpadding="0" class="tblForm">
													<tr>

														<td width="100%" valign="top" class="tblFormTd">
															<table>
																<tr>
																	<td>
																		<font size="2" style="font-weight:bold;">&nbsp;13&nbsp;</font>
																	</td>
																	<td>

																		<font size="1">&nbsp;Only for individual taxpayers whose sales/receipts are subject to Percentage Tax under section 116
																			of the Tax Code, as amended:</font>
																	</td>
																</tr>
																<tr>
																	<td>&nbsp;</td>
																	<td>
																		<font size="1">What income tax rates are you availing? (choose one)</font>
																	</td>
																</tr>
																<tr>
																	<td>&nbsp;</td>
																	<td>
																		<table>
																			<tr>
																				<td style="width: 180px; padding-right: 30px;">
																					<font size="1">(To be filled out only on the initial quarter of the taxable year)</font>
																				</td>
																				<td>
																					<input type="radio" value="N" name="frm2551Qv2018:taxRate" id="frm2551Qv2018:taxRate1" onclick="taxRateOption()" />

																				</td>
																				<td style="width: 200px; padding-left: 10px;">
																					<label for="frm2551Qv2018:taxRate1" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:12px;">
																						<font size="1">Graduated income tax rate on net taxable income</font>
																						
																					</label>
																				</td>
																				<td>
																					<input type="radio" value="N" name="frm2551Qv2018:taxRate" id="frm2551Qv2018:taxRate2" onclick ="taxRateOption()" />
																					<label for="frm2551Qv2018:taxRate2" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:12px;">
																						<font size="1">8% income tax rate on gross sales/receipts/others</font>
																						
																					</label>
																				</td>
																			</tr>
																		</table>
																	</td>
																</tr>

															</table>

														</td>

													</tr>

												</table>
											</td>

										</tr>
										<!--13 end-->


										<!--Part II-->

										<tr>
											<td>
												<table width="741" border="0" cellspacing="0" cellpadding="0" class="tblForm">
													<tr>
														<td class="tblFormTdPart">
															<table width="" border="0" cellspacing="0" cellpadding="0">
																<tr>
																	<td width="88">&nbsp;&nbsp;&nbsp;
																		<font size="2" style="font-weight:bold;"></font>
																	</td>
																	<td width="565">
																		<div align="center">
																			<font size="2" face="Arial, Helvetica, sans-serif">
																				<b>Part II - Total Tax Payable</b>
																			</font>
																		</div>
																	</td>
																	<td width="88">&nbsp;</td>
																</tr>
															</table>
														</td>
													</tr>
												</table>
											</td>
										</tr>
										<!--New Total Tax Payable-->
										<!--Item 14-->
										<tr>
											<td>
												<table width="741" border="0" cellspacing="0" cellpadding="0" class="tblForm">
													<tr>
														<td width="" valign="top" class="tblFormTd">
															<table border="0" cellspacing="0" cellpadding="0">
																<tr>
																	<td>
																		<table border="0" cellpadding="0" cellspacing="0">
																			<tr>
																				<td width="23">
																					<font size="2" style="font-weight:bold;">&nbsp;14&nbsp;</font>
																				</td>
																				<td>Total Tax Due
																					<a href="" id="frm2200S:btnSchedule1" onclick="processNext();"><font size="1">(From Schedule 1 Item 7)</font></a>
																				</td>
																			</tr>
																		</table>
																	</td>
																</tr>

															</table>
														</td>
														<td width="100" valign="top" class="tblFormTd">
															<table border="0" cellspacing="0" cellpadding="0">
																<tr>
																	<td>
																		<table border="0" cellspacing="0" cellpadding="0">
																			<tr>
																				<td>&nbsp;</td>
																				<td>
																					<input type="text" disabled="true" value="0.00" name="frm2551Qv2018:txt14" maxlength="15" id="frm2551Qv2018:txt14" style="text-align: right;"
																					 onkeypress="return numbersonly(this, event)" onblur="round(this,2)" />

																				</td>
																			</tr>
																		</table>
																	</td>
																</tr>
															</table>
														</td>
													</tr>
												</table>
											</td>
										</tr>
										<!--End of Item 14-->
										<tr>
											<td>
												<table width="741" border="0" cellspacing="0" cellpadding="0" class="tblForm">
													<tr>
														<td width="" valign="top" class="tblFormTd">
															<table>
																<tr>
																	<td>&nbsp;&nbsp;</td>
																	<td>Less: Tax Credit/Payment
																		<font size="1">(attach proof)</font>
																	</td>
																</tr>
															</table>
														</td>
													</tr>

												</table>

											</td>
											<td width="" valign="top" class="tblFormTd">

											</td>
										</tr>

										<!--Item 15-->
										<tr>
											<td>
												<table width="741" border="0" cellspacing="0" cellpadding="0" class="tblForm">
													<tr>
														<td valign="top" class="tblFormTd" style="padding-left: 40px;">
															<table border="0" cellpadding="0" cellspacing="0">
																<tr>
																	<td width="23">
																		<font size="2" style="font-weight:bold;">&nbsp;15&nbsp;</font>
																	</td>
																	<td>Creditable Percentage Tax Withheld per BIR Form No. 2307

																	</td>
																</tr>
															</table>
														</td>

														<td width="100" valign="top" class="tblFormTd">
															<table border="0" cellspacing="0" cellpadding="0">
																<tr>
																	<td>
																		<table border="0" cellspacing="0" cellpadding="0">
																			<tr>
																				<td>&nbsp;</td>
																				<td>
																					<input type="text" value="0.00" name="frm2551Qv2018:txt15" maxlength="15" id="frm2551Qv2018:txt15" style="text-align: right;" onkeypress="return numbersonly(this, event)"
																					 onblur="round(this,2); computeAll();" />
																				</td>
																			</tr>
																		</table>
																	</td>
																</tr>
															</table>
														</td>
													</tr>

												</table>

											</td>
										</tr>
										<!--End of Item 15-->
										<!--Item 16-->
										<tr>
											<td>
												<table width="741" border="0" cellspacing="0" cellpadding="0" class="tblForm">
													<tr>
														<td valign="top" class="tblFormTd" style="padding-left: 40px;">
															<table border="0" cellpadding="0" cellspacing="0">
																<tr>
																	<td width="23">
																		<font size="2" style="font-weight:bold;">&nbsp;16&nbsp;</font>
																	</td>
																	<td>
																		Tax Paid in Return Previously Filed, if this is an Amended Return
																	</td>
																</tr>
															</table>
														</td>
														<td width="100" valign="top" class="tblFormTd">
															<table border="0" cellspacing="0" cellpadding="0">
																<tr>
																	<td>
																		<table border="0" cellspacing="0" cellpadding="0">
																			<tr>
																				<td>&nbsp;</td>
																				<td>
																					<input type="text" value="0.00" name="frm2551Qv2018:txt16" maxlength="15" id="frm2551Qv2018:txt16" style="text-align: right;" onkeypress="return numbersonly(this, event)"
																					 onblur="round(this,2); computeAll()" disabled="true" />
																				</td>
																			</tr>
																		</table>
																	</td>
																</tr>
															</table>
														</td>
													</tr>

												</table>

											</td>
										</tr>
										<!--End of Item 16-->
										<!--Item 17-->
										<tr>
											<td>
												<table width="741" border="0" cellspacing="0" cellpadding="0" class="tblForm">
													<tr>
														<td valign="top" class="tblFormTd" style="padding-left: 40px;">
															<table border="0" cellpadding="0" cellspacing="0">
																<tr>
																	<td width="23">
																		<font size="2" style="font-weight:bold;">&nbsp;17&nbsp;</font>
																	</td>
																	<td>
																		Other Tax Credit/Payment
																		<font size="1">(specify)</font>&nbsp;&nbsp;
																		<input type="text" size="50" value="" name="frm2551Qv2018:txt17Specify" maxlength="50" id="frm2551Qv2018:txt17Specify" />
																	</td>
																</tr>
															</table>
														</td>
														<td width="100" valign="top" class="tblFormTd">
															<table border="0" cellspacing="0" cellpadding="0">
																<tr>
																	<td>
																		<table border="0" cellspacing="0" cellpadding="0">
																			<tr>
																				<td>&nbsp;</td>
																				<td>
																					<input type="text" value="0.00" name="frm2551Qv2018:txt17" maxlength="15" id="frm2551Qv2018:txt17" style="text-align: right;" onkeypress="return numbersonly(this, event)"
																					 onblur="round(this,2); computeAll();" />
																				</td>
																			</tr>
																		</table>
																	</td>
																</tr>
															</table>
														</td>
													</tr>

												</table>

											</td>
										</tr>
										<!--End of Item 17-->
										<!--Item 18-->
										<tr>
											<td>
												<table width="741" border="0" cellspacing="0" cellpadding="0" class="tblForm">
													<tr>
														<td valign="top" class="tblFormTd">
															<table border="0" cellpadding="0" cellspacing="0">
																<tr>
																	<td width="23">
																		<font size="2" style="font-weight:bold;">&nbsp;18&nbsp;</font>
																	</td>
																	<td>
																		Total Tax Credits/Payments
																		<font size="1">(Sum of Items 15 to 17)</font>
																	</td>
																</tr>
															</table>
														</td>
														<td width="100" valign="top" class="tblFormTd">
															<table border="0" cellspacing="0" cellpadding="0">
																<tr>
																	<td>
																		<table border="0" cellspacing="0" cellpadding="0">
																			<tr>
																				<td>&nbsp;</td>
																				<td>
																					<input type="text" disabled="true" value="0.00" name="frm2551Qv2018:txt18" maxlength="15" id="frm2551Qv2018:txt18" style="text-align: right;"
																					 onkeypress="return numbersonly(this, event)" onblur="round(this,2)" />
																				</td>
																			</tr>
																		</table>
																	</td>
																</tr>
															</table>
														</td>
													</tr>

												</table>

											</td>
										</tr>
										<!--End of Item 18-->
										<!--Item 19-->
										<tr>
											<td>
												<table width="741" border="0" cellspacing="0" cellpadding="0" class="tblForm">
													<tr>
														<td valign="top" class="tblFormTd">
															<table border="0" cellpadding="0" cellspacing="0">
																<tr>
																	<td width="23">
																		<font size="2" style="font-weight:bold;">&nbsp;19&nbsp;</font>
																	</td>
																	<td>
																		Tax Still Payable/(Overpayment)
																		<font size="1">(Item 14 less Item 18)</font>
																	</td>
																</tr>
															</table>
														</td>
														<td width="100" valign="top" class="tblFormTd">
															<table border="0" cellspacing="0" cellpadding="0">
																<tr>
																	<td>
																		<table border="0" cellspacing="0" cellpadding="0">
																			<tr>
																				<td>&nbsp;</td>
																				<td>
																					<input type="text" disabled="true" value="0.00" name="frm2551Qv2018:txt19" maxlength="15" id="frm2551Qv2018:txt19" style="text-align: right;"
																					 onkeypress="return numbersonly(this, event)" onblur="round(this,2)" />
																				</td>
																			</tr>
																		</table>
																	</td>
																</tr>
															</table>
														</td>
													</tr>

												</table>

											</td>
										</tr>
										<!--End of Item 19-->

										<tr>
											<td>
												<table width="741" border="0" cellspacing="0" cellpadding="0" class="tblForm">
													<tr>
														<td width="" valign="top" class="tblFormTd">
															<table>
																<tr>
																	<td>&nbsp;&nbsp;</td>
																	<td>
																		Add: Penalties
																	</td>
																</tr>
															</table>
														</td>
													</tr>

												</table>

											</td>
											<td width="" valign="top" class="tblFormTd">

											</td>
										</tr>

										<!--Item 20-->
										<tr>
											<td>
												<table width="741" border="0" cellspacing="0" cellpadding="0" class="tblForm">
													<tr>
														<td valign="top" class="tblFormTd" style="padding-left: 80px;">
															<table border="0" cellpadding="0" cellspacing="0">
																<tr>
																	<td width="23">
																		<font size="2" style="font-weight:bold;">&nbsp;20&nbsp;</font>
																	</td>
																	<td>
																		Surcharge
																	</td>
																</tr>
															</table>
														</td>
														<td width="100" valign="top" class="tblFormTd">
															<table border="0" cellspacing="0" cellpadding="0">
																<tr>
																	<td>
																		<table border="0" cellspacing="0" cellpadding="0">
																			<tr>
																				<td>&nbsp;</td>
																				<td>
																					<input type="text" value="0.00" name="frm2551Qv2018:txt20" maxlength="15" id="frm2551Qv2018:txt20" style="text-align: right;" onkeypress="return numbersonly(this, event)"
																					 onblur="round(this,2); computeAll();" />
																				</td>
																			</tr>
																		</table>
																	</td>
																</tr>
															</table>
														</td>
													</tr>

												</table>

											</td>
										</tr>
										<!--End of Item 20-->

										<!--Item 21-->
										<tr>
											<td>
												<table width="741" border="0" cellspacing="0" cellpadding="0" class="tblForm">
													<tr>
														<td valign="top" class="tblFormTd" style="padding-left: 80px;">
															<table border="0" cellpadding="0" cellspacing="0">
																<tr>
																	<td width="23">
																		<font size="2" style="font-weight:bold;">&nbsp;21&nbsp;</font>
																	</td>
																	<td>
																		Interest
																	</td>
																</tr>
															</table>
														</td>
														<td width="100" valign="top" class="tblFormTd">
															<table border="0" cellspacing="0" cellpadding="0">
																<tr>
																	<td>
																		<table border="0" cellspacing="0" cellpadding="0">
																			<tr>
																				<td>&nbsp;</td>
																				<td>
																					<input type="text" value="0.00" name="frm2551Qv2018:txt21" maxlength="15" id="frm2551Qv2018:txt21" style="text-align: right;" onkeypress="return numbersonly(this, event)"
																					 onblur="round(this,2); computeAll();" />
																				</td>
																			</tr>
																		</table>
																	</td>
																</tr>
															</table>
														</td>
													</tr>

												</table>

											</td>
										</tr>
										<!--End of Item 21-->

										<!--Item 22-->
										<tr>
											<td>
												<table width="741" border="0" cellspacing="0" cellpadding="0" class="tblForm">
													<tr>
														<td valign="top" class="tblFormTd" style="padding-left: 80px;">
															<table border="0" cellpadding="0" cellspacing="0">
																<tr>
																	<td width="23">
																		<font size="2" style="font-weight:bold;">&nbsp;22&nbsp;</font>
																	</td>
																	<td>
																		Compromise
																	</td>
																</tr>
															</table>
														</td>
														<td width="100" valign="top" class="tblFormTd">
															<table border="0" cellspacing="0" cellpadding="0">
																<tr>
																	<td>
																		<table border="0" cellspacing="0" cellpadding="0">
																			<tr>
																				<td>&nbsp;</td>
																				<td>
																					<input type="text" value="0.00" name="frm2551Qv2018:txt22" maxlength="15" id="frm2551Qv2018:txt22" style="text-align: right;" onkeypress="return numbersonly(this, event)"
																					 onblur="round(this,2); computeAll();" />
																				</td>
																			</tr>
																		</table>
																	</td>
																</tr>
															</table>
														</td>
													</tr>

												</table>

											</td>
										</tr>
										<!--End of Item 22-->

										<!--Item 23-->
										<tr>
											<td>
												<table width="741" border="0" cellspacing="0" cellpadding="0" class="tblForm">
													<tr>
														<td valign="top" class="tblFormTd">
															<table border="0" cellpadding="0" cellspacing="0">
																<tr>
																	<td width="23">
																		<font size="2" style="font-weight:bold;">&nbsp;23&nbsp;</font>
																	</td>
																	<td>
																		Total Penalties
																		<font size="1">(Sum of Items 20 to 22)</font>
																	</td>
																</tr>
															</table>
														</td>
														<td width="100" valign="top" class="tblFormTd">
															<table border="0" cellspacing="0" cellpadding="0">
																<tr>
																	<td>
																		<table border="0" cellspacing="0" cellpadding="0">
																			<tr>
																				<td>&nbsp;</td>
																				<td>
																					<input type="text" disabled="true" value="0.00" name="frm2551Qv2018:txt23" maxlength="15" id="frm2551Qv2018:txt23" style="text-align: right;"
																					 onkeypress="return numbersonly(this, event)" onblur="round(this,2)" />
																				</td>
																			</tr>
																		</table>
																	</td>
																</tr>
															</table>
														</td>
													</tr>

												</table>

											</td>
										</tr>
										<!--End of Item 23-->

										<!--Item 24-->
										<tr>
											<td>
												<table width="741" border="0" cellspacing="0" cellpadding="0" class="tblForm">
													<tr>
														<td valign="top" class="tblFormTd">
															<table border="0" cellpadding="0" cellspacing="0">
																<tr>
																	<td width="23">
																		<font size="2" style="font-weight:bold;">&nbsp;24&nbsp;</font>
																	</td>
																	<td>
																		<font size="2" style="font-weight:bold;">TOTAL AMOUNT PAYABLE(Overpayment)</font>
																		<font size="1">(Sum of Items 19 and 23)</font>
																	</td>
																</tr>
															</table>
														</td>
														<td width="100" valign="top" class="tblFormTd">
															<table border="0" cellspacing="0" cellpadding="0">
																<tr>
																	<td>
																		<table border="0" cellspacing="0" cellpadding="0">
																			<tr>
																				<td>&nbsp;</td>
																				<td>
																					<input type="text" value="0.00" name="frm2551Qv2018:txt24" disabled="true" maxlength="18" id="frm2551Qv2018:txt24" style="text-align: right;" onkeypress="return numbersonly(this, event)"
																					 onblur="round(this,2)" onchange="overPaymentOption()" />
																				</td>
																			</tr>
																		</table>
																	</td>
																</tr>
															</table>
														</td>
													</tr>

												</table>

											</td>
										</tr>
										<!--End of Item 24-->

										<tr>
											<td>
												<table width="741" border="0" cellspacing="0" cellpadding="0" class="tblForm">
													<tr>
														<td width="" valign="top" class="tblFormTd">
															<table>
																<tr>
																	<td>&nbsp;&nbsp;</td>
																	<td>
																		If overpayment, mark one box only:
																	</td>
																	<td>
																		<input type="radio" value="N" name="frm2551Qv2018:overPayment" id="frm2551Qv2018:overPayment1" />
																		<label for="frm2551Qv2018:overPayment1" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:12px;">
																			<font size="1">To be refunded</font>
																		</label>
																	</td>
																	<td>
																		<input type="radio" value="N" name="frm2551Qv2018:overPayment" id="frm2551Qv2018:overPayment2" />
																		<label for="frm2551Qv2018:overPayment2" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:12px;">
																			<font size="1">To be issued a Tax Credit Certificate</font>
																		</label>
																	</td>
																</tr>
															</table>
														</td>
													</tr>

												</table>

											</td>
											<td width="" valign="top" class="tblFormTd">

											</td>
										</tr>




										<!--End Total Tax Payable-->

										<!--Jurat-->
										<tr>
											<td>
												<table width="741" style="font-family:arial; font-size:10px; text-align: center; vertical-align: top; table-layout: fixed;"
												 border="1px" cellspacing="0" cellpadding="0">
													<tbody>
														<tr>
															<td style="text-align: justify; " colspan="4">
																<p style="text-indent: 20px; padding: 0px 3px;">I/We declare under the penalties of perjury that this return, and all its attachments, have been made in good faith, verified by me/us, and to the best of my/our knowledge and belief, is true and correct 
																	pursuant to the provisions of the National Internal Revenue Code, as amended, and the regulations issued under authority thereof. Further, I give my consent to the processing of my information as 
																	contemplated under the *Data Privacy Act of 2012(R.A. No. 10173) for legitimate and lawful purposes. (If Authorized Representative, attach authorization letter)
																</p>
															</td>
														</tr>
														<tr>
															<td style="text-align: left; " colspan="2">For Individual:
																<br>
																<br>
																<br>
																<br>
															</td>
															<td style="text-align: left; " colspan="2">For Non-Individual:
																<br>
																<br>
																<br>
																<br>
															</td>
														</tr>
														<tr>
															<td colspan="2">Signature over Printed Name of Taxpayer/Authorized Representative/Tax Agent
																<br>
																<i>(Indicate Title/Designation and TIN)</i>
															</td>
															<td colspan="2">Signature over Printed Name of President/Vice President/
																<br> Authorized Officer or Representative/Tax Agent
																<i>(Indicate Title/Designation and TIN)</i>
															</td>
														</tr>
														<tr>
															<td colspan="2">
																<table border="0" cellspacing="0" cellpadding="0">
																	<tbody>
																		<tr>
																			<td>
																				Tax Agent Accreditation No./
																				<br> Attorney's Roll No.
																				<i>(If applicable)</i>
																			</td>
																			<td>
																				<input disabled="" id="txtTaxAgentNo" type="text" size="25" maxlength="20" value="">
																			</td>
																		</tr>
																	</tbody>
																</table>
															</td>
															<td>
																<table border="0" cellspacing="0" cellpadding="0">
																	<tbody>
																		<tr>
																			<td>
																				Date of Issue
																				<br>
																				<i>(MM/DD/YYYY)</i>
																			</td>
																			<td>
																				<input disabled="" id="txtDateIssue" type="text" size="12" maxlength="10" value="">
																			</td>
																		</tr>
																	</tbody>
																</table>
															</td>
															<td>
																<table border="0" cellspacing="0" cellpadding="0">
																	<tbody>
																		<tr>
																			<td>
																				Date of Expiry
																				<br>
																				<i>(MM/DD/YYYY)</i>
																			</td>
																			<td>
																				<input disabled="" id="txtDateExpiry" type="text" size="12" maxlength="10" value="">
																			</td>
																		</tr>
																	</tbody>
																</table>
															</td>
														</tr>
													</tbody>
												</table>
											</td>
										</tr>
										<!--End of Jurat-->
										<!--Part III Details of payment-->
										<tr>
											<td>
												<table width="800" class="tblForm" border="1" cellspacing="0" cellpadding="0">
													<tbody>
														<tr>
															<td class="tblFormTdPart">
																<table width="799" border="0" cellspacing="0" cellpadding="0">
																	<tbody>
																		<tr>
																			<td width="100%">
																				<div align="center">
																					<font size="2" style="font-weight:bold;">Part III - Details of Payment</font>
																				</div>
																			</td>
																		</tr>
																	</tbody>
																</table>
															</td>
														</tr>
													</tbody>
												</table>
											</td>
										</tr>
										<!--end details pf payment-->

										<!--start of 27, 28, 29, 30-->
										<tr>
											<td>
												<table width="800" class="tblForm" border="0" cellspacing="0" cellpadding="0">
													<tbody>
														<tr>
															<td class="tblFormTd" valign="top">
																<table width="100%" class="tblForm" border="1" cellspacing="0" cellpadding="0">
																	<tbody>
																		<tr>
																			<td width="20%">
																				<div align="center">
																					<font size="1" style="font-weight:bold;">Particulars </font>
																				</div>
																			</td>
																			<td width="15%">
																				<div align="center">
																					<font size="1" style="font-weight:bold;">Drawee Bank/Agency </font>
																				</div>
																			</td>
																			<td width="20%">
																				<div align="center">
																					<font size="1" style="font-weight:bold;">Number </font>
																				</div>
																			</td>
																			<td width="20%">
																				<div align="center">
																					<font size="1" style="font-weight:bold;">Date (MM/DD/YYYY) </font>
																				</div>
																			</td>
																			<td width="25%">
																				<div align="center">
																					<font size="1" style="font-weight:bold;">Amount </font>
																				</div>
																			</td>
																		</tr>
																		<tr>
																			<td>
																				<font size="2" style="font-weight:bold;">&nbsp;25&nbsp;&nbsp;&nbsp;</font>
																				<font size="1">Cash/Bank Debit Memo </font>
																			</td>
																			<td>
																				<input name="frm2551Qv2018:txtAgency25" disabled="" id="frm2551Qv2018:txtAgency25" type="text" size="23" maxlength="50" value="">
																			</td>
																			<td>
																				<input name="frm2551Qv2018:txtNumber25" disabled="" id="frm2551Qv2018:txtNumber25" type="text" size="23" maxlength="50" value="">
																			</td>
																			<td>
																				<input name="frm2551Qv2018:txtDate25" disabled="" id="frm2551Qv2018:txtDate25" type="text" size="23" maxlength="10" value="">
																			</td>
																			<td>
																				<input name="frm2551Qv2018:txtAmount25" disabled="" id="frm2551Qv2018:txtAmount25" style="text-align: right" type="text" size="20"
																				 maxlength="50" value="">
																			</td>
																		</tr>
																		<tr>
																			<td>
																				<font size="2" style="font-weight:bold;">&nbsp;26&nbsp;&nbsp;&nbsp;</font>
																				<font size="1">Check </font>
																			</td>
																			<td>
																				<input name="frm2551Qv2018:txtAgency26" disabled="" id="frm2551Qv2018:txtAgency26" type="text" size="23" maxlength="50" value="">
																			</td>
																			<td>
																				<input name="frm2551Qv2018:txtNumber26" disabled="" id="frm2551Qv2018:txtNumber26" type="text" size="23" maxlength="50" value="">
																			</td>
																			<td>
																				<input name="frm2551Qv2018:txtDate26" disabled="" id="frm2551Qv2018:txtDate26" type="text" size="23" maxlength="10" value="">
																			</td>
																			<td>
																				<input name="frm2551Qv2018:txtAmount26" disabled="" id="frm2551Qv2018:txtAmount26" style="text-align: right" type="text" size="20"
																				 maxlength="50" value="">
																			</td>
																		</tr>
																		<tr>
																			<td>
																				<font size="2" style="font-weight:bold;">&nbsp;27&nbsp;&nbsp;&nbsp;</font>
																				<font size="1">Tax Debit Memo </font>
																			</td>
																			<td>
																				<input name="frm2551Qv2018:txtAgency27" disabled="" id="frm2551Qv2018:txtAgency27" type="text" size="23" maxlength="50" value="">
																			</td>
																			<td>
																				<input name="frm2551Qv2018:txtNumber27" disabled="" id="frm2551Qv2018:txtNumber27" type="text" size="23" maxlength="50" value="">
																			</td>
																			<td>
																				<input name="frm2551Qv2018:txtDate27" disabled="" id="frm2551Qv2018:txtDate27" type="text" size="23" maxlength="10" value="">
																			</td>
																			<td>
																				<input name="frm2551Qv2018:txtAmount27" disabled="" id="frm2551Qv2018:txtAmount27" style="text-align: right" type="text" size="20"
																				 maxlength="50" value="">
																			</td>
																		</tr>
																		<tr>
																			<td colspan="5">
																				<font size="2" style="font-weight:bold;">&nbsp;28&nbsp;&nbsp;&nbsp;</font>
																				<font size="1">Others
																					<i>(specify below)</i>
																				</font>
																			</td>
																		</tr>
																		<tr>
																			<td>
																				<input name="frm2551Qv2018:txtParticular28" disabled="" id="frm2551Qv2018:txtParticular28" type="text" size="20" maxlength="50" value="">
																			</td>
																			<td>
																				<input name="frm2551Qv2018:txtAgency28" disabled="" id="frm2551Qv2018:txtAgency28" type="text" size="23" maxlength="50" value="">
																			</td>
																			<td>
																				<input name="frm2551Qv2018:txtNumber28" disabled="" id="frm2551Qv2018:txtNumber28" type="text" size="23" maxlength="50" value="">
																			</td>
																			<td>
																				<input name="frm2551Qv2018:txtDate28" disabled="" id="frm2551Qv2018:txtDate28" type="text" size="23" maxlength="10" value="">
																			</td>
																			<td>
																				<input name="frm2551Qv2018:txtAmount28" disabled="" id="frm2551Qv2018:txtAmount28" style="text-align: right" type="text" size="20"
																				 maxlength="50" value="">
																			</td>
																		</tr>
																	</tbody>
																</table>
															</td>
														</tr>
													</tbody>
												</table>
											</td>
										</tr>
										<!--end of 25, 26, 27, 28-->

										<!--start of machine validation-->
										<tr>
											<td>
												<table style="font-size:10px; text-align: left; " border="1">
													<tbody>
														<tr>
															<td width="60%" align="center">Machine Validation/Revenue Official Receipt (ROR) Details
																<br>
																<i> (If not filed with an Authorized Agent Bank)</i>
																<br>
																<br>
																<br>
																<br>
																<br>
															</td>
															<td width="40%" align="center">
																<i>Stamp of Receiving Office/AAB and Date of Receipt
																	<br>(RO's Signature/Bank Teller's Initial)</i>
																<br>
																<br>
																<br>
																<br>
																<br>
															</td>
														</tr>
													</tbody>
												</table>
											</td>
										</tr>
										<tr>
											<td>
												<b>&nbsp;*NOTE: </b> Please read the BIR Data Privacy Policy found in the BIR website (www.bir.gov.ph)
											</td>
										</tr>
										
										


										<!--End of Part III Details of Payment-->







									</table>
								</div>
								<!--end of page1-->

								<!--page 2-->
								<div id="Page2" style="display: none;" >
									<table width="800" border="0" cellspacing="0" cellpadding="0">
										<tr>
											<td>
												<table border="1" cellspacing="0" cellpadding="0" style="height:0px;">
													<tr>
														<td width="150" valign="middle" style="text-align: center;">
															<font face="Arial" size="1px">BIR Form No.</font>
															<br/>
															<font size="5px" style="font-weight:bold;">2551Q</font>
															<br/>
															<font face="Arial" size="1px">January 2018 (ENCS)</font>
															<br/>
															<font face="Arial" size="1px" style="font-weight:bold;">Page 2</font>
														</td>
														<td width="580" valign="center" style="text-align: center;">
															<font size="5px" style="font-weight:bold;">
																Quarterly Percentage Tax Return
															</font>
														</td>
														<td valign="top">
																<img width="220" height="75px" src="../img/2551Qv2018_BarCode/2551Qv2018_P2.png"  /> 		
														</td>
													</tr>
												</table>
											</td>
										</tr>
										<tr>
											<td>
												<table width="800" border="1" cellspacing="0" cellpadding="0" class="tblForm">
													<tr>
														<td width="35%">
															<font size="1" face="Arial, Helvetica, sans-serif">TIN</font>
														</td>
														<td width="65%">
															<font size="1" face="Arial, Helvetica, sans-serif">
																Taxpayer's Last Name (if Individual) / Registered Name (if Non-Individual)
															</font>
														</td>
													</tr>
													<tr>
														<td>
															<font size="2" face="Arial">
																<input type="text" value="" size="3" name="frm2551Qv2018:txtPg2TIN1" maxlength="3" id="frm2551Qv2018:txtPg2TIN1" onkeypress="return wholenumber(this, event)"
																 disabled="true" />
																<input type="text" value="" size="3" name="frm2551Qv2018:txtPg2TIN2" maxlength="3" id="frm2551Qv2018:txtPg2TIN2" onkeypress="return wholenumber(this, event)"
																 disabled="true" />
																<input type="text" value="" size="3" name="frm2551Qv2018:txtPg2TIN3" maxlength="3" id="frm2551Qv2018:txtPg2TIN3" onkeypress="return wholenumber(this, event)"
																 disabled="true" />
																<input type="text" value="" size="3" name="frm2551Qv2018:txtPg2BranchCode" maxlength="3" id="frm2551Qv2018:txtPg2BranchCode" onkeypress="return letternumber(event)"
																 disabled="true" />
															</font>
														</td>
														<td>
															<input type="text" value="" size="80" name="frm2551Qv2018:txtPg2TaxpayerName" maxlength="50" id="frm2551Qv2018:txtPg2TaxpayerName"
															 onblur="return capital(this, event)" disabled="true" />
														</td>
													</tr>
												</table>
											</td>
										</tr>
										<tr>
											<td>
												<table width="800" border="1" cellspacing="0" cellpadding="0" class="tblForm">
													<tr>
														<td class="tblFormTdPart">
															<table width="800" border="0" cellspacing="0" cellpadding="0">
																<tr>
																	<td width="100%">
																		<div align="center">
																			<font size="2" style="font-weight:bold;"></font>
																		</div>
																	</td>
																</tr>
															</table>
														</td>
													</tr>
												</table>
											</td>
										</tr>
										<!-- Schedule I -->
										<tr>
											<td>
												<table width="800" border="1" cellspacing="0" cellpadding="0" class="tblForm">
													<tr>
														<td>
															<font size="1" style="font-weight:bold; padding-left: 5px;">Schedule 1 - Computation of Tax</font>
															<font size="1">(Attach additional sheet/s, if necessary)</font>
														</td>
													</tr>
												</table>
											</td>
										</tr>
										<tr>
											<td>
												<table id="tbllistSchedI" class="tblForm" cellspacing="0" cellpadding="0" width="800" border="1">
													<tr>

														<td width="20%" align="center">
															<font size="1" face="Arial, Helvetica, sans-serif">Alphanumeric Tax Code (ATC)</font>
														</td>
														<td width="35%" align="center">
															<font size="1" face="Arial, Helvetica, sans-serif"> Taxable Amount</font>
														</td>
														<td width="10%" align="center">
															<font size="1" face="Arial, Helvetica, sans-serif"> Tax Rate </font>
														</td>
														<td width="35%" align="center">
															<font size="1" face="Arial, Helvetica, sans-serif"> Tax Due</font>
														</td>

													</tr>
													<tbody id="tbodyllistSchedI">
														<tr>
															<td>
																<div style="font-weight:bold; float:left; padding: 5px 10px 0px 10px;">
																	1
																</div>
																<div style="float:left;">
																	<select id="drpATC1" onchange="drpATCChanged(1); computeAll();" style="width: 100px;">
																		<option value="0" selected> - </option>
																	</select>
																</div>
															</td>

															<td>
																<input type="text" style="width: 95%; text-align: right;" id="txtATCAmt1" value="0.00" size="17" maxlength="12" onkeypress="return numbersonly(this, event)"
																 onblur="round(this,2); computeATC(1); computeAll();" disabled="true" /> </td>
															<td>
																<input type="text" style="text-align: right;" id="txtATCRate1" value="0.00" size="2" onblur="round(this,2);getReqWithheldCompute(0)"
																 maxlength="10" onkeypress="return numbersonly(this, event)" style="width: 70%" disabled="true" />% </td>
															<td>
																<input type="text" style="width: 95%; text-align: right;" id="txtATCDue1" value="0.00" size="17" maxlength="25" disabled="true"
																/> </td>
														</tr>
														<tr>
															<td>
																<div style="font-weight:bold; float:left; padding: 5px 10px 0px 10px;">
																	2
																</div>
																<div style="float:left;">
																	<select id="drpATC2" onchange="drpATCChanged(2); computeAll();" style="width: 100px;">
																		<option value="0" selected> - </option>
																	</select>
																</div>
															</td>

															<td>
																<input type="text" style="width: 95%; text-align: right;" id="txtATCAmt2" value="0.00" size="17" maxlength="12" onkeypress="return numbersonly(this, event)"
																 onblur="round(this,2); computeATC(2); computeAll();" disabled="true" /> </td>
															<td>
																<input type="text" style="text-align: right;" id="txtATCRate2" value="0.00" size="2" onblur="round(this,2);getReqWithheldCompute(0)"
																 maxlength="10" onkeypress="return numbersonly(this, event)" style="width: 70%" disabled="true" />% </td>
															<td>
																<input type="text" style="width: 95%; text-align: right;" id="txtATCDue2" value="0.00" size="17" maxlength="25" disabled="true"
																/> </td>
														</tr>
														<tr>
															<td>
																<div style="font-weight:bold; float:left; padding: 5px 10px 0px 10px;">
																	3
																</div>
																<div style="float:left;">
																	<select id="drpATC3" onchange="drpATCChanged(3); computeAll(); computeAll();" style="width: 100px;">
																		<option value="0" selected> - </option>
																	</select>
																</div>
															</td>

															<td>
																<input type="text" style="width: 95%; text-align: right;" id="txtATCAmt3" value="0.00" size="17" maxlength="12" onkeypress="return numbersonly(this, event)"
																 onblur="round(this,2); computeATC(3); computeAll();" disabled="true" /> </td>
															<td>
																<input type="text" style="text-align: right;" id="txtATCRate3" value="0.00" size="2" onblur="round(this,2);getReqWithheldCompute(0)"
																 maxlength="10" onkeypress="return numbersonly(this, event)" style="width: 70%" disabled="true" />% </td>
															<td>
																<input type="text" style="width: 95%; text-align: right;" id="txtATCDue3" value="0.00" size="17" maxlength="25" disabled="true"
																/> </td>
														</tr>
														<tr>
															<td>
																<div style="font-weight:bold; float:left; padding: 5px 10px 0px 10px;">
																	4
																</div>
																<div style="float:left;">
																	<select id="drpATC4" onchange="drpATCChanged(4); computeAll();" style="width: 100px;">
																		<option value="0" selected> - </option>
																	</select>
																</div>
															</td>

															<td>
																<input type="text" style="width: 95%; text-align: right;" id="txtATCAmt4" value="0.00" size="17" maxlength="12" onkeypress="return numbersonly(this, event)"
																 onblur="round(this,2); computeATC(4); computeAll();" disabled="true" /> </td>
															<td>
																<input type="text" style="text-align: right;" id="txtATCRate4" value="0.00" size="2" onblur="round(this,2);getReqWithheldCompute(0)"
																 maxlength="10" onkeypress="return numbersonly(this, event)" style="width: 70%" disabled="true" />% </td>
															<td>
																<input type="text" style="width: 95%; text-align: right;" id="txtATCDue4" value="0.00" size="17" maxlength="25" disabled="true"
																/> </td>
														</tr>
														<tr>
															<td>
																<div style="font-weight:bold; float:left; padding: 5px 10px 0px 10px;">
																	5
																</div>
																<div style="float:left;">
																	<select id="drpATC5" onchange="drpATCChanged(5); computeAll();" style="width: 100px;">
																		<option value="0" selected> - </option>
																	</select>
																</div>
															</td>

															<td>
																<input type="text" style="width: 95%; text-align: right;" id="txtATCAmt5" value="0.00" size="17" maxlength="12" onkeypress="return numbersonly(this, event)"
																 onblur="round(this,2); computeATC(5); computeAll();" disabled="true" /> </td>
															<td>
																<input type="text" style="text-align: right;" id="txtATCRate5" value="0.00" size="2" onblur="round(this,2);getReqWithheldCompute(0)"
																 maxlength="10" onkeypress="return numbersonly(this, event)" style="width: 70%" disabled="true" />% </td>
															<td>
																<input type="text" style="width: 95%; text-align: right;" id="txtATCDue5" value="0.00" size="17" maxlength="25" disabled="true"
																/> </td>
														</tr>
														<tr>
															<td>
																<div style="font-weight:bold; float:left; padding: 5px 10px 0px 10px;">
																	6
																</div>
																<div style="float:left;">
																	<select id="drpATC6" onchange="drpATCChanged(6); computeAll();" style="width: 100px;">
																		<option value="0" selected> - </option>
																	</select>
																</div>
															</td>

															<td>
																<input type="text" style="width: 95%; text-align: right;" id="txtATCAmt6" value="0.00" size="17" maxlength="12" onkeypress="return numbersonly(this, event)"
																 onblur="round(this,2); computeATC(6); computeAll();" disabled="true" /> </td>
															<td>
																<input type="text" style="text-align: right;" id="txtATCRate6" value="0.00" size="2" onblur="round(this,2);getReqWithheldCompute(0)"
																 maxlength="10" onkeypress="return numbersonly(this, event)" style="width: 70%" disabled="true" />% </td>
															<td>
																<input type="text" style="width: 95%; text-align: right;" id="txtATCDue6" value="0.00" size="17" maxlength="25" disabled="true"
																/> </td>
														</tr>

													</tbody>
												</table>
											</td>
										</tr>
										<tr>
											<td>
												<table class="tblForm" width="800" cellspacing="0" cellpadding="0" border="1">
													<tr>
														<td height="30">

															<font size="2" style="font-weight:bold;">&nbsp;7</font>
															<font size="1" style="font-weight:bold;">Total Tax Due</font>

															<font size="1">(Sum of Items 1 to 6)<a href="" id="frm2200S:btnSchedule1" onclick="processPrev();">&nbsp;(To Part II Item 14)</a></font>
															
														</td>
														<td width="35%" align="right" height="30" style="padding-right: 10px;">
															<input type="text" style="text-align: right;" id="txtTotalSched1" maxlength="20" size="17" value="0.00" disabled="true" />
														</td>
													</tr>
												</table>
											</td>
										</tr>


										<!--table 1 alphanumeric tac code (ATC)-->
										<tr>
											<td>
												<table width="800" class="tblForm" border="1" cellspacing="0" cellpadding="0">
													<tr>
														<td class="tblForm" colspan="2" style="padding-left: 5px;">
															<font size="1" style="font-weight:bold;">Table 1 - Alphanumeric Tax Code (ATC)</font>
														</td>
													</tr>
												</table>
												<table border="1" width="800" cellspacing="0" cellpadding="0" class="tblForm">
													<tr>
														<td style="font-size: 1; font-weight:bold; text-align: center;">
															ATC
														</td>
														<td style="font-size: 1; font-weight:bold; text-align: center;">
															Percentage Tax On
														</td>
														<td style="font-size: 1; font-weight:bold; text-align: center;">
															Tax Rate
														</td>
													</tr>
													<tbody id="tblSched3A">
														<tr>
															<td width="50px" align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">PT 010</font>
															</td>
															<td style="padding: 0px 2px;">
																<font size="1" face="Arial, Helvetica, sans-serif">Person exempt from VAT under Sec. 109(BB) (Sec. 116)</font>
															</td>
															<td width="40px" align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">3%</font>
															</td>
														</tr>
														<tr>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">PT 040</font>
															</td>
															<td style="padding: 0px 2px;">
																<font size="1" face="Arial, Helvetica, sans-serif">Domestic carriers and keepers of garages (Sec. 117)</font>
															</td>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">3%</font>
															</td>
														</tr>
														<tr>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">PT 041</font>
															</td>
															<td style="padding: 0px 2px;">
																<font size="1" face="Arial, Helvetica, sans-serif">International Carriers (Sec. 118)</font>
															</td>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">3%</font>
															</td>
														</tr>
														<tr>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">PT 060</font>
															</td>
															<td style="padding: 0px 2px;">
																<font size="1" face="Arial, Helvetica, sans-serif">Franchises on gas and water utilities (Sec. 119)</font>
															</td>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">2%</font>
															</td>
														</tr>
														<tr>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">PT 070</font>
															</td>
															<td style="padding: 0px 2px;">
																<font size="1" face="Arial, Helvetica, sans-serif">Franchises on radio/TV broadcasting companies whose annual gross receipts do not exceed P10 M (Sec. 119)</font>
															</td>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">3%</font>
															</td>
														</tr>
														<tr>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">PT 090</font>
															</td>
															<td style="padding: 0px 2px;">
																<font size="1" face="Arial, Helvetica, sans-serif">Overseas dispatch, message or conversation originating from the Philippines (Sec. 120)</font>
															</td>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">10%</font>
															</td>
														</tr>
														<tr>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">PT 140</font>
															</td>
															<td style="padding: 0px 2px;">
																<font size="1" face="Arial, Helvetica, sans-serif">Cockpits (Sec. 125)</font>
															</td>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">18%</font>
															</td>
														</tr>
														<tr>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">PT 150</font>
															</td>
															<td style="padding: 0px 2px;">
																<font size="1" face="Arial, Helvetica, sans-serif">Tax on amusement places, such as cabarets, night and day clubs, videoke bars, karaoke bars, karaoke television,
																	karaoke boxes, music lounges and other similar establishments (Sec. 125)</font>
															</td>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">18%</font>
															</td>
														</tr>
														<tr>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">PT 160</font>
															</td>
															<td style="padding: 0px 2px;">
																<font size="1" face="Arial, Helvetica, sans-serif">Boxing Exhibition (Sec. 125)</font>
															</td>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">10%</font>
															</td>
														</tr>
														<tr>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">PT 170</font>
															</td>
															<td style="padding: 0px 2px;">
																<font size="1" face="Arial, Helvetica, sans-serif">Professional Basketball Games (Sec. 125)</font>
															</td>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">15%</font>
															</td>
														</tr>
														<tr>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">PT 180</font>
															</td>
															<td style="padding: 0px 2px;">
																<font size="1" face="Arial, Helvetica, sans-serif">Jai-alai and Race Tracks (Sec. 125)</font>
															</td>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">30%</font>
															</td>
														</tr>
													</tbody>
												</table>
												<table width="800" class="tblForm" border="1" cellspacing="0" cellpadding="0">
													<tr>
														<td colspan="3" class="tblForm" style="padding-left: 5px;">
															<font size="1" style="font-weight:bold;">Tax on Banks and Non-Bank Financial Intermediaries Performing Quasi-Banking Functions</font>
															<font size="1">(Sec. 121)</font>
														</td>

													</tr>
													<tbody id="tblSched3B">
														<tr>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif"></font>
															</td>
															<td colspan="2" style="padding: 0px 2px;">
																<font size="1" face="Arial, Helvetica, sans-serif">1) On interest, commisions and discounts from lending activities as well as income from financial leasing,
																	on the basis of remaining maturities of instruments from which such receipts are derived</font>
															</td>

														</tr>
														<tr>
															<td width="50px" align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">PT 105</font>
															</td>
															<td style="padding: 0px 2px;">
																<font size="1" face="Arial, Helvetica, sans-serif">&nbsp;&nbsp;&nbsp;&nbsp; - Maturity period is five (5) years or less</font>
															</td>
															<td width="30px" align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">&nbsp;&nbsp;5%</font>
															</td>
														</tr>
														<tr>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">PT 101</font>
															</td>
															<td style="padding: 0px 2px;">
																<font size="1" face="Arial, Helvetica, sans-serif">&nbsp;&nbsp;&nbsp;&nbsp; - Maturity period is more than five (5) years</font>
															</td>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">1%</font>
															</td>
														</tr>
														<tr>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">PT 102</font>
															</td>
															<td style="padding: 0px 2px;">
																<font size="1" face="Arial, Helvetica, sans-serif"> 2) On dividends and equity shares and net income of subsidiaries</font>
															</td>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">0%</font>
															</td>
														</tr>
														<tr>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">PT 103</font>
															</td>
															<td style="padding: 0px 2px;">
																<font size="1" face="Arial, Helvetica, sans-serif"> 3) On royalties, rentals of property, real or personal, profits from exchange and all other gross income</font>
															</td>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">7%</font>
															</td>
														</tr>
														<tr>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">PT 104</font>
															</td>
															<td style="padding: 0px 2px;">
																<font size="1" face="Arial, Helvetica, sans-serif"> 4) On net trading gains within the taxable year on foreign currency, debt securities, derivatives and other
																	financial instruments
																</font>
															</td>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">7%</font>
															</td>
														</tr>
													</tbody>

												</table>
												<table width="800" class="tblForm" border="1" cellspacing="0" cellpadding="0">
													<tr>
														<td colspan="3" class="tblForm" style="padding-left: 5px;">
															<font size="1" style="font-weight:bold;">Tax on Other Non-Bank Financial Intermediaries not Performing Quasi-Banking Functions</font>
															<font size="1">(Sec. 122)</font>
														</td>
													</tr>
													<tbody id="tblSched3C">
														<tr>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif"></font>
															</td>
															<td colspan="2" style="padding: 0px 2px;">
																<font size="1" face="Arial, Helvetica, sans-serif"> 1) On interest, commissions and discounts from lending activities as well as income from financial leasing,
																	on the basis of remaining maturities of instruments from which such receipts are derived</font>
															</td>
															
														</tr>
														
														<tr>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">&nbsp;PT 113</font>
															</td>
															<td style="padding: 0px 2px;">
																<font size="1" face="Arial, Helvetica, sans-serif">&nbsp;&nbsp;&nbsp;&nbsp; - Maturity period is five (5) years or less</font>
															</td>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">5%</font>
															</td>
														</tr>
														<tr>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">PT 114</font>
															</td>
															<td style="padding: 0px 2px;">
																<font size="1" face="Arial, Helvetica, sans-serif">&nbsp;&nbsp;&nbsp;&nbsp; - Maturity period is more than five (5) years</font>
															</td>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">1%</font>
															</td>
														</tr>
														<tr>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">PT 115</font>
															</td>
															<td style="padding: 0px 2px;">
																<font size="1" face="Arial, Helvetica, sans-serif"> 2) From all other items treated as gross income under the code</font>
															</td>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">5%</font>
															</td>
														</tr>
														<tr>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">PT 120</font>
															</td>
															<td style="padding: 0px 2px;">
																<font size="1" face="Arial, Helvetica, sans-serif">Life Insurance Premiums (Sec. 123)</font>
															</td>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">2%</font>
															</td>
														</tr>
													</tbody>
												</table>
												<table width="800" class="tblForm" border="1" cellspacing="0" cellpadding="0">
													<tr>
														<td colspan="3" class="tblForm" style="padding-left: 5px;">
															<font size="1" style="font-weight:bold;">Agents of Foreign Insurance Companies</font>
															<font size="1">(Sec. 124)</font>
														</td>
													</tr>
													<tbody id="tblSched3D">
														<tr>
															<td width="50px" align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">PT 130</font>
															</td>
															<td style="padding: 0px 2px;">
																<font size="1" face="Arial, Helvetica, sans-serif"> 1) Insurance Agents</font>
															</td>
															<td width="40px" align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">4%</font>
															</td>
														</tr>
														<tr>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">PT 132</font>
															</td>
															<td style="padding: 0px 2px;">
																<font size="1" face="Arial, Helvetica, sans-serif"> 2) Owners of property obtaining insurance directly with foreign insurance companies</font>
															</td>
															<td align="center">
																<font size="1" face="Arial, Helvetica, sans-serif">5%</font>
															</td>
														</tr>
													</tbody>
												</table>
											</td>
										</tr>
									</table>
								</div>
								<!--end of page 2-->

							</div>


					</tr>
					<tr>
						<td>
							<!--footer button-->
							<div>
									<table width="828" border="0" cellspacing="0" cellpadding="0" class="tblForm printButtonClass" >
										<tr>
											<td>
												<div align="center">
													<br />
													<input class="printButtonClass" type="button" value="Prev" style="width: 100px;" name="frm2551Qv2018:btnPrevPage" id="frm2551Qv2018:btnPrevPage"
													 onclick="processPrev();" />
													<input id="frm2551Qv2018:txtCurrentPage" name="frm2551Qv2018:txtCurrentPage" value="1" size="1" type="text" style="text-align:center;"
													 onkeypress="return numbersonly(this, event);" onkeyup="goToPage(this);" />
													<span class=large>/&nbsp;</span>
													<input type="text" id="frm2551Qv2018:txtMaxPage" readonly="true" size="2" value="2" style="text-align:center;" />&nbsp;
													<input class="printButtonClass" type="button" value="Next" style="width: 100px;" name="frm2551Qv2018:btnNextPage" id="frm2551Qv2018:btnNextPage"
													 onclick="processNext();" />
													<br />
													<br />
												</div>
											</td>
										</tr>
										<tr>
											<td>
												<div id="frm2551Qv2018:j_id743" class="icePnlGrp">
													<div align="center">
														<input class="printButtonClass" type="button" value="Validate" style="width: 100px;" name="frm2551Qv2018:cmdValidate" id="frm2551Qv2018:cmdValidate"
														 onclick="validateForm()" />
														<input class="printButtonClass" type="button" value="Edit" style="width: 100px;" name="frm2551Qv2018:cmdEdit" id="frm2551Qv2018:cmdEdit"
														 onclick="editForm()" />
														<!--<input class="printButtonClass" type="button" value="Submit" style="width: 100px;" name="btnUpload" id="btnUpload" />-->
														<input class="printButtonClass" type="hidden" value="Submit" style="width: 100px;" name="btnUpload" id="btnUpload" />
														<input class="printButtonClass" type="button" value="Save" style="width: 100px;" name="btnSave" id="btnSave" onclick="saveXML(false);"
														/>
														<!--<input class="printButtonClass" type="button" value="Print" style="width: 100px;" name="btnPrint" id="btnPrint" onclick="window.print()" />-->
														<input class="printButtonClass" type="button" value="Print" style="width: 100px;" name="btnPrint" id="btnPrint" onclick="printme();"
														/>
														<input class="printButtonClass" type="button" value="Submit / Final Copy" style="width: 200px;" name="frm2551Qv2018:btnFinalCopy"
														 id="frm2551Qv2018:btnFinalCopy" onclick="openAlertEmail();" />
														<!--<div id="msg" class="printButtonClass"></div>-->
														<div id="msg" class="printButtonClass" style="display:none;"></div>
														<br />
														<br />
													</div>
												</div>
											</td>
										</tr>
									</table>
								</div>
								<!--end of footer button-->
						</td>
					</tr>
				</table>

			</div>
		</div>


		<div id="hiddenEnroll" style="display:none;">
			<input id="txtFinalFlag" class="FinalFlag" name="txtFinalFlag" type="text" onblur="" onkeypress="" value="0" maxlength="60"
			/>
			<input id="txtEnroll" name="txtEnroll" type="text" onblur="" onkeypress="" value="N" maxlength="60" />
		</div>
		<div id="ebirConfirmOnline" style="display: none; position: fixed; top:  20%; left: 32%;
        right: auto; overflow-y: auto; overflow-x: hidden; background: #e2e2e2; padding: 20px; border:2px solid blue;">
			<div style="position: relative; width: 100%;">

				<span style="font-weight: bold; font-size: largerBold;">Please Re - enter your eBIRForms Online Username and Password.</span>

			</div>
			<div class="modalInner" style="width: 98%;">
				<table>
					<tr>
						<td>
							Confirm USERNAME:
						</td>
						<td>

							<input type="text" id="ebirOnlineConfirmUsername" maxlength="50" />
						</td>
					</tr>
					<tr>
						<td>
							Confirm PASSWORD:
						</td>
						<td>
							<input type="password" id="ebirOnlineConfirmPassword" maxlength="50" />
						</td>
					</tr>

					<tr>
						<td>
							<input type="button" id="ebirOnlineConfirmSubmit" value="Submit" onclick="sendEmail(this);" />
						</td>
						<td>
							<input type="button" id="ebirOnlineConfirmCancel" value="Cancel" onclick="SetFinalFlagTo0();HideContainer('ebirConfirmOnline'); ShowContainer('container'); "
							/>
						</td>
					</tr>
				</table>
			</div>
		</div>
		<div id="tosa" style="display: none;">
			<h2>Terms of Service Agreement</h2>
			<p class="indentTosa">
				Thank you for visiting the eBIRForms webpage. By accessing and/or using any part of this website and eBIRForms System (including
				the online and offline services), herein collectively called the "Service", you shall be deemed to have accepted to be
				legally bound by these Terms of Service.
			</p>
			<p class="indentTosa">
				Please review the following terms carefully. The terms "Bureau", "we", "us" and "our" refer to the Bureau of Internal Revenue
				or BIR, the legal name of the owner of the website. The term "you" refers to the taxpayer, tax agent, tax software provider
				or any user or viewer of our site. The Bureau reserves the right to modify these terms or provide additional terms from
				time to time. The continued use of the Service following the posting of any changes to the Terms of Service constitutes
				your acceptance of such changes.
			</p>

			<h2>Description of Service</h2>

			<p class="indentTosa">The Service provides you with the facility to file/submit returns and pay taxes due thereon using the eBIRForms System.
				It also receives returns generated by the third party software and filed by the taxpayer or tax agent.</p>
			<p class="indentTosa">The Service provides you with the following services:</p>
			<ul class="indentTosa">
				<li class="indentTosa">downloadable tax preparation software package</li>
				<li class="indentTosa">taxpayer, tax agent and tax software provider enrollment</li>
				<li class="indentTosa">file/submit tax returns, and attachments (upon system’s update)</li>
				<li class="indentTosa">access to payment facility to make payments</li>
				<li class="indentTosa">access to the taxpayer’s record</li>
				<li class="indentTosa">access to tax records of tax agent including client/s who authorized such tax agent for electronic filing and/or payment</li>
				<li class="indentTosa">update user record</li>
				<li class="indentTosa">assign tax agent by taxpayer and correspondingly, tax agent to represent a taxpayer</li>
				<li class="indentTosa">third party data lay-out requirements publication</li>
				<li class="indentTosa">third party software compliance testing</li>
			</ul>


			<h2>General User's Obligations</h2>

			<h4>Filing/Submitting Tax Returns</h4>
			<p class="indentTosa">In filing or submitting tax returns, you may either use the eBIRForms software package or the system’s upload facility
				for the returns generated by an accredited third party software.</p>
			<p class="indentTosa">It is your responsibility to file your return and pay the correct taxes on time, failure to do so may result to the imposition
				of corresponding penalties (e.g., surcharge and interest) and to civil and criminal liability as provided by law and
				regulations.
			</p>

			<h4>Use of eBIRForms Software Package</h4>
			<p class="indentTosa">The eBIRForms software package is for your personal, non-commercial use only. The downloaded software package is used
				for filling up of tax returns, and there is a facility for its electronic submission. It is designed with automatic population
				of selected taxpayer information and automatic mathematical computation of tax due based on encoded taxable amounts.</p>
			<p class="indentTosa">It may be used by accredited tax agents/practitioners enrolled in the system in providing services for their clients who
				have authorized them to file tax returns on said taxpayers’ behalf.</p>
			<p class="indentTosa">The Service ensures the preservation of data transmitted and includes safeguards against efforts to tamper with, manipulate,
				alter, or subvert the data. Tampering or any attempt to tamper the eBIRForms application software package or data will
				be dealt with in accordance with the applicable laws.</p>
			<p class="indentTosa">You are responsible for using the eBIRForms software package only on computers and telephone or other lines that you have
				permission to use, and you are responsible for all related charges, if applicable, such as cable, ISP, and telephone
				charges.
			</p>
			<p class="indentTosa">You are strictly prohibited from modifying, copying, distributing, transmitting, displaying, performing, reproducing,
				publishing, licensing, creating derivative works, transferring or selling any information contained in the package, for
				a fee or otherwise.</p>

			<h4>Updates of eBIRForms software package</h4>
			<p class="indentTosa">You are required to download updated eBIRForms software package when notified of new versions of the said package.</p>

			<h4>Use of third party software for filing</h4>
			<p class="indentTosa">You are only allowed to use the accredited third party software to generate tax returns for filing.</p>

			<h4>Inactive Accounts</h4>
			<p class="indentTosa">To ensure efficiency in the Service, dormant accounts or those with prolonged period of inactivity shall be suspended
				and shall be archived and cleaned-up from the system. The system shall notify you through email in case of any account
				suspension.
			</p>

			<h4>Session Log-out</h4>
			<p class="indentTosa">Your eBIRForms session shall automatically log-out after a predefined duration of no keyboard activity.</p>

			<h2>Taxpayer's Obligations</h2>

			<h4>Enrollment Obligation</h4>
			<p class="indentTosa">In consideration of your use of the Service, you undertake to provide true, accurate, current and complete information
				about yourself or your organization as required by the eBIRForms enrollment process. You shall maintain and update the
				data to keep it true, accurate, current and complete.</p>
			<p class="indentTosa">BIR reserves the right to terminate or suspend your account and to refuse current or future use of the eBIRForms in case
				any information you provided is found to be untrue, inaccurate, obsolete or incomplete.</p>

			<h4>Security Obligation</h4>
			<p class="indentTosa">You undertake to use the Service in a manner that protects your privacy and the data/information you provide.</p>
			<p class="indentTosa">As part of the enrollment process, you will be provided with an account username and password. You agree not to disclose
				your account password to anyone and you are fully responsible for all activities that occur under your account username.</p>
			<p class="indentTosa">You are advised to use a strong password consisting of at least eight (8) characters, with numeric as well as alphabetic
				characters, and with a mix of upper and lower case alphabetic characters and at least one special character (for example,
				!,@,#).
			</p>
			<p class="indentTosa">You agree to log-out or lock your computer if unattended to ensure that unauthorized users do not gain access to your
				account and the data you provided and were provided to you through the Service. You should ensure that you exit from
				your account at the end of every session.</p>
			<p class="indentTosa">To ensure adequate security in the system, note that the maximum limit set for unsuccessful log-on attempts is three (3)
				within a sixty-minute period. In the event of account lock, you should request your Revenue District Office (RDO) in
				writing to unlock your account so you may resume access thereto.</p>
			<p class="indentTosa">You are responsible for the protection of your computer where eBIRForms system is installed against viruses, worms or
				malwares.
			</p>
			<p class="indentTosa">You shall immediately notify the BIR Helpdesk at telephone number (02) 981-7050 or (02) 981-7051 of any unauthorized use
				of your password or account, or any other breach of security.</p>

			<h4>Legal Obligation</h4>
			<p class="indentTosa">The Service provides you various email notifications that may require response or confirmation relative to your use of
				the system. You must promptly respond to or confirm the email notifications when required.</p>
			<p class="indentTosa">In filing tax returns using the eBIRForms software package or third party software generated return, you may only file
				your own or your organization's tax returns. You are not allowed to file tax returns of other persons/parties, unless
				you are a tax agent duly authorized by your client to file such tax returns.</p>

			<h4>Payment Obligation</h4>
			<p class="indentTosa">It is your obligation to ensure that payment shall be received by the BIR and be cleared on the BIR account on or before
				the due dates.</p>


			<h2>Accredited Tax Agent's Obligations</h2>

			<h4>Enrollment Obligation</h4>
			<p class="indentTosa">In consideration of your use of the Service, you undertake to provide true, accurate, current and complete information
				about yourself and the taxpayer you are duly authorized to represent as required by the eBIRForms enrollment process.
				You shall maintain and update the data to keep it true, accurate, current and complete.</p>
			<p class="indentTosa">BIR reserves the right to terminate or suspend your account and to refuse current or future use of the eBIRForms in case
				any information you provided is found to be untrue, inaccurate, obsolete or incomplete.</p>

			<h4>Security Obligation</h4>
			<p class="indentTosa">You undertake to use the Service in a manner that protects your privacy and the privacy of the taxpayer you are duly authorized
				to represent and the data/information you provide.</p>
			<p class="indentTosa">As part of the enrollment process, you will be provided with an account username and password. You agree not to disclose
				your account password to anyone and you are fully responsible for all activities that occur under your account username.</p>
			<p class="indentTosa">You are advised to use a strong password consisting of at least eight (8) characters, with numeric as well as alphabetic
				characters, and with a mix of upper and lower case alphabetic characters and at least one special character (for example,
				!,@,#).
			</p>
			<p class="indentTosa">You are advised to change your password periodically (i.e., monthly or as may be deemed necessary).</p>
			<p class="indentTosa">You agree to log-out or lock your computer if unattended to ensure that unauthorized users do not gain access to your
				account and the data you provided and were provided to you through the Service. You should ensure that you exit from
				your account at the end of every session.</p>
			<p class="indentTosa">To ensure adequate security in the system, note that the maximum limit set for unsuccessful log-on attempts is three (3)
				within a sixty-minute period. In the event of account lock, you should request your RDO in writing to unlock your account
				so you may resume access thereto.</p>
			<p class="indentTosa">You are responsible for the protection of your computer where eBIRForms system is installed against viruses, worms or
				malwares.
			</p>
			<p class="indentTosa">You shall immediately notify the BIR Helpdesk at telephone number (02) 981-7050 or (02) 981-7051 of any unauthorized use
				of your password or account, or any other breach of security.</p>

			<h4>Legal Obligation</h4>
			<p class="indentTosa">To be able use this website to access data or perform activities as agent of another person/taxpayer, you should have
				been duly authorized/appointed/designated as the taxpayer's agent, which authority continues to be effective or must
				not have been revoked.</p>
			<p class="indentTosa">For purposes of using the Service as a tax agent of another person/taxpayer, you should be an accredited tax agent/practitioner
				before the BIR pursuant to Revenue Regulations No. 11-2006, as amended by Revenue Regulations No. 4-2010.</p>
			<p class="indentTosa">You may only act as an agent and represent another person/taxpayer after receiving an email confirmation from the BIR
				allowing you to do so.</p>
			<p class="indentTosa">The Service provides you various email notifications that may require response or confirmation relative to your use of
				the system. You must promptly respond to or confirm the email notifications when required.</p>
			<p class="indentTosa">You shall not upload files other than the tax returns of taxpayers you are duly authorized to represent and the corresponding
				attachments. Any violation of this condition shall constitute a ground for the Bureau to terminate or suspend your account
				and refuse current or future use of the Service.</p>

			<h4>Payment Obligation</h4>
			<p class="indentTosa">It is your obligation to ensure that payment shall be received by the BIR and be cleared on the BIR account on or before
				the due dates.</p>

			<h2>Tax Software Provider's Obligations</h2>

			<h4>Enrollment Obligation</h4>
			<p class="indentTosa">In consideration of your use of the Service, you undertake to provide true, accurate, current and complete information
				about yourself or your organization as required by the eBIRForms enrollment process. You shall maintain and update the
				data to keep it true, accurate, current and complete.</p>
			<p class="indentTosa">BIR reserves the right to terminate or suspend your account and to refuse current or future use of the eBIRForms in case
				any information you provided is found to be untrue, inaccurate, obsolete or incomplete.</p>

			<h4>Security Obligation</h4>
			<p class="indentTosa">You undertake to use the Service in a manner that protects your privacy and the privacy of any other person/taxpayer and
				the data/information you provide.</p>
			<p class="indentTosa">As part of the enrollment process, you will be provided with an account username and password. You agree not to disclose
				your account password to anyone and you are fully responsible for all activities that occur under your account username.</p>
			<p class="indentTosa">You are advised to use a strong password consisting of at least eight (8) characters, with numeric as well as alphabetic
				characters, and with a mix of upper and lower case alphabetic characters and at least one special character (for example,
				!,@,#).
			</p>
			<p class="indentTosa">You are advised to change your password periodically (i.e., monthly or as may be deemed necessary).</p>
			<p class="indentTosa">You agree to log-out or lock your computer if unattended to ensure that unauthorized users do not gain access to your
				account and the data you provided and were provided to you through the Service. You should ensure that you exit from
				your account at the end of every session.</p>
			<p class="indentTosa">To ensure adequate security in the system, note that the maximum limit set for unsuccessful log-on attempts is three (3)
				within a sixty-minute period. In the event of account lock, you should request your RDO in writing to unlock your account
				so you may resume access thereto.</p>
			<p class="indentTosa">You are responsible for the protection of your computer where eBIRForms system is installed against viruses, worms or
				malwares.
			</p>
			<p class="indentTosa">You shall immediately notify the BIR Helpdesk at telephone number (02) 981-7050 or (02) 981-7051 of any unauthorized use
				of your password or account, or any other breach of security.</p>

			<h4>Legal Obligation</h4>
			<p class="indentTosa">The Service provides you various email notifications that may require response or confirmation relative to your use of
				the system. You must promptly respond to or confirm the email notifications when required.</p>
			<p class="indentTosa">You are strictly prohibited from sharing your certification number and access credentials to a third party software provider
				not accredited by the eBIRForms system.</p>
			<p class="indentTosa">You undertake to strictly follow the instructions and guidelines for tax software providers as issued by BIR.</p>
			<p class="indentTosa">You agree to provide software with an electronic export facility that will generate the tax returns.</p>
			<p class="indentTosa">It must be understood that the accreditation issued by the BIR to the tax software provider does not constitute endorsement,
				sponsorship or approval of the software used to generate the tax returns.</p>

			<h2>Disclaimer</h2>
			<p class="indentTosa">The BIR is providing the eBIRForms website as an alternative mode of filing tax returns. The content of the website is
				provided in an "as is basis" and without any express or implied warranties.</p>
			<p class="indentTosa">The BIR does not warrant that the Service will be uninterrupted; be free from inaccuracies, errors, viruses or other harmful
				components; operate in the configuration or with the hardware or software you use.</p>
			<p class="indentTosa">The BIR is not liable or responsible for any damages, expenses, costs or loss of any kind (including, but not limited
				to, any direct, indirect, special, incidental, or consequential damages, financial losses, loss of profits, loss of any
				data or loss of any opportunity) caused as a result (directly or indirectly) of, or in connection with, your use of the
				Service (including the downloads and/or use of the services) or reliance on any information, materials, tools, provided
				in or available from this site.</p>

			<h5>Last update: June 1, 2015 </h5>
			<div class="centerButton">
				<input type=button id="btnAgree" value="Agree" onclick="hideTosa(); disableDropDown('after');" />
			</div>
		</div>
		<div id="ebirEnroll" style="display: none; position: fixed; top:  20%; left: 20%;
        right: auto; overflow-y: auto; overflow-x: hidden; background: #e2e2e2; padding: 20px; border:2px solid blue;">
			<div style="position: relative; width: 100%;">

				<span style="font-weight:bold;">eBIRForms Terms of Service Agreement (TOSA)</span>
				<br>
				<br />
				<span>Thank you for using eBIRForms. By clicking Agree, you confirm that you have read, understood and agreed to the TOSA.</span>
				<br />
				<br/>

				<span>The full eBIRForms TOSA can be accessed
					<a href="#" onclick="openTermsandAgreement();disableDropDown('before');">here</a>.</span>
				<br />
				<span> </span>
				<br />
				<br />

			</div>
			<div class="modalInner" style="width: 98%;">
				<table>
					<tr>
						<td>
							<input type="button" id="ebirEnrollYes" value="  Ok  " onclick="sendEmail(this); HideContainer('ebirEnroll');" />
						</td>
						<td>
							<input type="button" id="ebirEnrollNo" value="Cancel" onclick="SetFinalFlagTo0();HideContainer('ebirEnroll'); ShowContainer('container'); "
							/>
						</td>
						<tr>
				</table>
			</div>
			<div id="isRegister" style="display: none; position: fixed; top:  40%; left: 35%;
        right: auto; overflow-y: auto; overflow-x: hidden; background: #e2e2e2; padding: 20px; border:2px solid blue;">
				<div style="position: relative; width: 100%;">

					<span style="font-weight: bold; font-size: largerBold;">Are you a registered eBIRForms Online User?</span>

				</div>
				<div class="modalInner" style="width: 98%;">
					<table>

						<tr>
							<td>
								<input type="button" id="isregistered" value="YES" onclick="HideContainer('isRegister'); ShowContainer('ebirOnline') " />
							</td>
							<td>
								<input type="button" id="notregistered" value="NO" onclick="HideContainer('isRegister');ShowContainer('ebirEnroll'); " />
							</td>

						</tr>
					</table>
				</div>
			</div>

			<div id="ebirOnline" style="display: none; position: fixed; top:  20%; left: 32%;
        right: auto; overflow-y: auto; overflow-x: hidden; background: #e2e2e2; padding: 20px; border:2px solid blue;">
				<div style="position: relative; width: 100%;">

					<span style="font-weight: bold; font-size: largerBold;">Please enter your eBIRForms Online Username and Password.</span>

				</div>
				<div class="modalInner" style="width: 98%;">
					<table>
						<tr>
							<td>
								USERNAME:
							</td>
							<td>

								<input type="text" id="ebirOnlineUsername" maxlength="50" />
							</td>
						</tr>
						<tr>
							<td>
								PASSWORD:
							</td>
							<td>
								<input type="password" id="ebirOnlinePassword" maxlength="50" />
								<input type="text" id="ebirOnlineSecret" maxlength="50" style="display: none;" />
							</td>
						</tr>

						<tr>
							<td>
								<input type="button" id="ebirOnlineSubmit" value="Submit" onclick="ValidateUserPass();" />
							</td>
							<td>
								<input type="button" id="ebirOnlineCancel" value="Cancel" onclick="SetFinalFlagTo0();HideContainer('ebirOnline'); ShowContainer('container'); "
								/>
							</td>
						</tr>
					</table>
				</div>
			</div>
			<!--
			<div id="hiddenEmail" style="display:none;">
				<input id="txtEmail" class="emailClass" name="txtEmail" type="text" onblur="" onkeypress="" maxlength="60" />
			</div>
		    -->
			<!-- Send Email -->
			<!-- export modal -->
			<div id="modalExport" style="width:50%; display:none; height:43%; position:fixed; top:3%; left:25%; right:auto; overflow-y:auto; overflow-x:hidden; background:#e2e2e2;"
			 align="center">
				<br/>
				<br/>
				<table border="0" width="60%" align="center">
					<tr class="modalHeader">
						<td>Have Disk</td>
					</tr>
				</table>
				<table border="0" cellspacing="3" cellpadding="3" width="60%">
					<tr>
						<td>&nbsp;</td>
					</tr>
					<tr>
						<td>&nbsp;</td>
					</tr>
					<tr>
						<td class="modalColumnHeader">Make sure that a recordable media [diskette/universal serial bus (USB) flash drive, compact disck (cd), digital video
							disc (dvd)] is already inserted.</td>
					</tr>
					<tr>
						<td>&nbsp;</td>
					</tr>
					<tr>
						<td>&nbsp;</td>
					</tr>
					<tr>
						<td class="modalColumnHeader">Drive:
							<select class="driveSelect" id="driveSelectTPExport" name="driveSelectTPExport" size="1" class="modalContent">

							</select>
						</td>
					</tr>
				</table>
				<div align="center">
					<br />
					<br />
					<input type="button" class="printButtonClass" name="btnOk" id="btnOkExport" style="width:120px; height:30px;" value="OK"
					 onclick="exportTPFiles(fileNameToExport); checkFinalCopyBtn('2551Qv2018');" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
					<input type="button" class="printButtonClass" name="btnCancel" id="btnCancelExport" style="width:120px; height:30px;" value="CANCEL"
					 onclick="cancelExportModal(); checkFinalCopyBtn('2551Qv2018');" />
				</div>
				<br />
				<br />
			</div>
	</form>
	<textarea id='responsetext' style="display:none;"></textarea>
	<!-- XML retrieval -->
	<div style="display:none;">
		<xmp id='xmlFormat'>
		</xmp>
		<!--format the doc -->
		<span id='xmlClose'>All Rights Reserved BIR 2012.</span>
	</div>
	<div id="responseBG" style="display:none;">
		<!--loaded files render here-->
	</div>
	<div id="response" style="display:none;">
		<!--loaded files render here-->
	</div>
	<div id="responseATC" style="display:none;">
		<!--loaded ATC files render here-->
	</div>
	<div id="responseRdo" style="display:none;">
		<!--loaded files render here-->
	</div>
</body>

</html>

<script type="text/javascript">
	var isSubmitFinal = false;
	var isSubmit = false;

	var fileName = "";
	var existingXMLFileName = "";
	var gIsReadOnly = false;
	var fileNameToExport = "";

	var atcList = new Array();

	var savedReturn = "";
	var p3Compromise = "";
	var p3Surcharge = "";
	var p3Interest = "";
	var p3IsAmended = "";
	var p3FilingDate = "";
	var p3ReturnPeriod = "";
	var p3ReturnPeriodEnd = "";
	var p3ReturnPeriodEndMonth = "";

	var p3BasicTax = "";
	var p3TotalPenalties = "";
	var p3TotalAmountPayable = "";

	var p3TPTIN1 = "";
	var p3TPTIN2 = "";
	var p3TPTIN3 = "";
	var p3TPTIN = "";
	var p3TPBranchCode = "";
	var p3TPRDOCode = "";
	var p3TPLineBus = "";
	var p3TPName = "";
	var p3TPTelNum = "";
	var p3TPAddress = "";
	var p3TPZip = "";
	var tp_lob = "";
	
	//new fields
	var i1Calendar = "";
	var i1Fiscal = "";
	var i2Year = "";
	var i2Month = "";
	var i3Quarter1 = "";
	var i3Quarter2 = "";
	var i3Quarter3 = "";
	var i3Quarter4 = "";
	var i4AmendedYes = "";
	var i4AmendedNo = "";
	var i5Sheets = "";
	var i6Tin1 = "";
	var i6Tin2 = "";
	var i6Tin3 = "";
	var i6Tin4 = "";
	var i7Rdo = "";
	var i8TaxPayerName = "";
	var i9TaxPayerAddress = "";
	var i9ZipCode = "";
	var i10ContactNum = "";
	var i11Email = "";
	var i12TaxTreatyYes = "";
	var i12TaxTreatyNo = "";
	var i12TaxTreatyDesc = "";
	var i13TaxRateNet = "";
	var i13TaxRateGross = "";
	var i14TaxDue = "";
	var i15CredTax = "";
	var i16TaxReturn = "";
	var i17OtherCredTaxDesc = "";
	var i17OtherCredTax = "";
	var i18TotTaxCred = "";
	var i19TaxOverpayment = "";
	var i20Surcharge = "";
	var i21Interest = "";
	var i22Compromise = "";
	var i23TotPenalties = "";
	var i24TotOverPayment = "";
	var i24ToRefund = "";
	var i24ToTaxCredit = "";
	var sched1Atc1Code = "";
	var sched1Atc2Code = "";
	var sched1atc3Code = "";
	var sched1atc4Code = "";
	var sched1atc5Code = "";
	var sched1atc6Code = "";
	var sched1TaxAmount1 = "";
	var sched1TaxAmount2 = "";
	var sched1TaxAmount3 = "";
	var sched1TaxAmount4 = "";
	var sched1TaxAmount5 = "";
	var sched1TaxAmount6 = "";
	var sched1TaxRate1 = "";
	var sched1TaxRate2 = "";
	var sched1TaxRate3 = "";
	var sched1TaxRate4 = "";
	var sched1TaxRate5 = "";
	var sched1TaxRate6 = "";
	var sched1TaxDue1 = "";
	var sched1TaxDue2 = "";
	var sched1TaxDue3 = "";
	var sched1TaxDue4 = "";
	var sched1TaxDue5 = "";
	var sched1TaxDue6 = "";
	var sched1TotalTaxDue = ""; 

	//custom vars
	var formReturnPeriod = "";
	var formIsAmended = "";


	

	function atcPropertyJS(formType, atcCode, description, rate, category, base, compType, constTaxDue, minimum, maximum) {
		this.formType = formType;
		this.atcCode = atcCode;
		this.description = description;
		this.rate = rate;
		this.category = category;
		this.base = base;
		this.compType = compType;
		this.constTaxDue = constTaxDue;
		this.minimum = minimum;
		this.maximum = maximum;
	}

	/*----------------------------------*/
	var d = document, XMLBGFile = '', data = '', XMLFile = '', XMLATCFile = '', msg = d.getElementById('msg');
	var loader = d.getElementById('loader');
	/*----------------------------------*/

	var str;
	var codeATC;
	var descATC;
	var rateATC;
	var rowFlag;
	var atcFlag = new Array();
	var globalEmail = "";
	str = setInterval("sleeptime()", 300);
	function sleeptime() {
		clearInterval(str);
		loadXMLATC('xml/atcCodes.xml');
		populateATC();
		loadATCtoDropDown();
		init();
		taxRateOption();


		var bgFileName = qs('xmlBGInfoFileName');
		if (bgFileName != null && bgFileName.indexOf('.xml') > -1) {
			loadBGXML(bgFileName);
		}

		fileName = qs('xmlFileName');
		if (fileName != null && fileName.indexOf('.xml') > -1) {
			//Removed as of 06/06/2014 Bug #3812
			//showFillupSched1Alert = false;
			loadXML(fileName);   
			
			//woi
			//for dev purpose
			//var tin = fileName.split("\\")[3].split("-");
			//loadBGXML("E:\\ebirforms\\profile\\"+ tin[0]+".xml");
			var tin = fileName.split("/")[1].split("-"); 
			loadBGXML("profile/"+ tin[0]+".xml");  


			d.getElementById('frm2551Qv2018:forThe_1').disabled = true;
			d.getElementById('frm2551Qv2018:forThe_2').disabled = true;
			d.getElementById('frm2551Qv2018:rtnMonth').disabled = true;
			d.getElementById('frm2551Qv2018:txtYear').disabled = true;
			d.getElementById('frm2551Qv2018:txtCurrentPage').value = "1"; 

			existingXMLFileName = fileName;
			if (gIsReadOnly) {
				window.setTimeout("disableAllElementIDs(); d.getElementById('btnUpload').disabled = false;", 1000);
			}
		} else {
			window.setTimeout("$('#loader').hide('blind');", 100);
		}
		if ($('#printMenu').css('display') != 'none') {
			$('#printMenu').hide('blind');
		}
		document.getElementById('frm2551Qv2018:txtTIN1').disabled = true; document.getElementById('frm2551Qv2018:txtTIN2').disabled = true; document.getElementById('frm2551Qv2018:txtTIN3').disabled = true; document.getElementById('frm2551Qv2018:txtBranchCode').disabled = true;
		window.setTimeout("checkFinalCopyBtn('2551Qv2018')", 2000);
	}

	function rdoPropertyJS(rdoCode, description) {
		this.rdoCode = rdoCode;
		this.description = description;
	}

	var rdoList = new Array();

	//schedule 1 functions
	//by programmerapril

	function loadATCtoDropDown() {

		codeATC.sort();

		for (i = 1; i < codeATC.length; i++) {
			var drpATC01 = document.getElementById("drpATC1");
			var drpATC02 = document.getElementById("drpATC2");
			var drpATC03 = document.getElementById("drpATC3");
			var drpATC04 = document.getElementById("drpATC4");
			var drpATC05 = document.getElementById("drpATC5");
			var drpATC06 = document.getElementById("drpATC6");

			var option1 = document.createElement("option");
			var option2 = document.createElement("option");
			var option3 = document.createElement("option");
			var option4 = document.createElement("option");
			var option5 = document.createElement("option");
			var option6 = document.createElement("option");

			option1.text = insertSpace(codeATC[i], 2); //codeATC[i];
			option1.value = i;
			option2.text = insertSpace(codeATC[i], 2);
			option2.value = i;
			option3.text = insertSpace(codeATC[i], 2);
			option3.value = i;
			option4.text = insertSpace(codeATC[i], 2);
			option4.value = i;
			option5.text = insertSpace(codeATC[i], 2);
			option5.value = i;
			option6.text = insertSpace(codeATC[i], 2);
			option6.value = i;

			drpATC01.add(option1);
			drpATC02.add(option2);
			drpATC03.add(option3);
			drpATC04.add(option4);
			drpATC05.add(option5);
			drpATC06.add(option6);
		}

	}

	function insertSpace(str, indx)
	{
		//index starts at 1
		var strPrefix = str.substring(0, indx);
		//alert(strPrefix + "-" + indx);

		var strCode = str.substring(indx, str.length);
		//alert(strCode + "- " + str.length);
		var retStr = strPrefix + " " + strCode; 

		return retStr;
	}

	function drpATCChanged(rowIndex) {
		var t01 = d.getElementById('drpATC' + rowIndex).value;

		if (d.getElementById('drpATC' + rowIndex).value == 0) {
			//d.getElementById('txtATCAmt' + rowIndex).style.backgroundColor = "#e2e2e2";
			d.getElementById('txtATCAmt' + rowIndex).disabled = true;
			d.getElementById('txtATCAmt' + rowIndex).style.backgroundColor = "";


			d.getElementById('txtATCAmt' + rowIndex).value = "0.00";
			d.getElementById('txtATCRate' + rowIndex).value = "0.00";

		}
		else {
			//d.getElementById('txtATCAmt' + rowIndex).style.backgroundColor = "#ffffff";
			d.getElementById('txtATCAmt' + rowIndex).disabled = false;
			d.getElementById('txtATCRate' + rowIndex).value = rateATC[d.getElementById('drpATC' + rowIndex).value];
		}

		computeATC(rowIndex);
	}

	function computeATC(rowIndex) {
		var taxDue = NumWithComma(d.getElementById('txtATCAmt' + rowIndex).value) * (d.getElementById('txtATCRate' + rowIndex).value / 100);

		d.getElementById('txtATCDue' + rowIndex).value = formatCurrency(taxDue);

		computeTotalSched1();
	}

	function computeTotalSched1() {
		var totalSched1 = formatCurrency(NumWithComma(d.getElementById('txtATCDue1').value) + NumWithComma(d.getElementById('txtATCDue2').value) +
			NumWithComma(d.getElementById('txtATCDue3').value) + NumWithComma(d.getElementById('txtATCDue4').value) +
			NumWithComma(d.getElementById('txtATCDue5').value) + NumWithComma(d.getElementById('txtATCDue6').value));

		d.getElementById('txtTotalSched1').value = totalSched1;
		d.getElementById('frm2551Qv2018:txt14').value = totalSched1;
	}

	//end of schedule 1 function

	//total tax payable functions
	// by programmerapril
	function computeItem18() {
		var item18 = NumWithComma(d.getElementById('frm2551Qv2018:txt15').value) + NumWithComma(d.getElementById('frm2551Qv2018:txt16').value) +
			NumWithComma(d.getElementById('frm2551Qv2018:txt17').value);

		d.getElementById('frm2551Qv2018:txt18').value = formatCurrency(item18);
	}

	function computeItem19() {
		var item19 = NumWithComma(d.getElementById('frm2551Qv2018:txt14').value) - NumWithComma(d.getElementById('frm2551Qv2018:txt18').value);

		d.getElementById('frm2551Qv2018:txt19').value = formatCurrency(item19);
	}

	function computeItem23() {
		var item23 = NumWithComma(d.getElementById('frm2551Qv2018:txt20').value) + NumWithComma(d.getElementById('frm2551Qv2018:txt21').value) +
			NumWithComma(d.getElementById('frm2551Qv2018:txt22').value);

		d.getElementById('frm2551Qv2018:txt23').value = formatCurrency(item23);
	}

	function computeItem24() {
		var item24 = NumWithComma(d.getElementById('frm2551Qv2018:txt19').value) + NumWithComma(d.getElementById('frm2551Qv2018:txt23').value);

		d.getElementById('frm2551Qv2018:txt24').value = formatCurrency(item24);
	}

	function computeAll() {
		computeItem18();
		computeItem19();
		computeItem23();
		computeItem24();

		refundOption();
	}

	function refundOption()
	{
		if (NumWithComma(d.getElementById('frm2551Qv2018:txt24').value) >= 0) {
			d.getElementById('frm2551Qv2018:overPayment1').checked = false;
			d.getElementById('frm2551Qv2018:overPayment2').checked = false;

			d.getElementById('frm2551Qv2018:overPayment1').disabled = true;
			d.getElementById('frm2551Qv2018:overPayment2').disabled = true;
		}
		else{
			d.getElementById('frm2551Qv2018:overPayment1').disabled = false;
			d.getElementById('frm2551Qv2018:overPayment2').disabled = false;
		}
	}

	function taxRateOption()
	{
		if(d.getElementById('frm2551Qv2018:taxRate1').checked == true)
		{
			d.getElementById('frm2551Qv2018:txt15').disabled = false;
			if(d.getElementById('frm2551Qv2018:amendedRtn_1').checked == true)
			{
				d.getElementById('frm2551Qv2018:txt16').disabled = false;
			}

			d.getElementById('frm2551Qv2018:txt17').disabled = false;
			d.getElementById('frm2551Qv2018:txt20').disabled = false;
			d.getElementById('frm2551Qv2018:txt21').disabled = false;
			d.getElementById('frm2551Qv2018:txt22').disabled = false;

			d.getElementById('drpATC1').disabled = false;
			d.getElementById('drpATC2').disabled = false;
			d.getElementById('drpATC3').disabled = false;
			d.getElementById('drpATC4').disabled = false;
			d.getElementById('drpATC5').disabled = false;
			d.getElementById('drpATC6').disabled = false;

		}
		else{
			//8% Tax Rate will zero out all figures for compliance only

			d.getElementById('frm2551Qv2018:txt15').value = "0.00";
			d.getElementById('frm2551Qv2018:txt15').disabled = true;
			d.getElementById('frm2551Qv2018:txt16').value = "0.00";
			d.getElementById('frm2551Qv2018:txt16').disabled = true;
			d.getElementById('frm2551Qv2018:txt17').value = "0.00";
			d.getElementById('frm2551Qv2018:txt17').disabled = true;
			d.getElementById('frm2551Qv2018:txt20').value = "0.00";
			d.getElementById('frm2551Qv2018:txt20').disabled = true;
			d.getElementById('frm2551Qv2018:txt21').value = "0.00";
			d.getElementById('frm2551Qv2018:txt21').disabled = true;
			d.getElementById('frm2551Qv2018:txt22').value = "0.00";
			d.getElementById('frm2551Qv2018:txt22').disabled = true;

			d.getElementById('drpATC1').selectedIndex = 0;
			drpATCChanged(1);
			d.getElementById('drpATC1').disabled = true;
			d.getElementById('drpATC2').selectedIndex = 0;
			drpATCChanged(2);
			d.getElementById('drpATC2').disabled = true;
			d.getElementById('drpATC3').selectedIndex = 0;
			drpATCChanged(3);
			d.getElementById('drpATC3').disabled = true;
			d.getElementById('drpATC4').selectedIndex = 0;
			drpATCChanged(4);
			d.getElementById('drpATC4').disabled = true;
			d.getElementById('drpATC5').selectedIndex = 0;
			drpATCChanged(5);
			d.getElementById('drpATC5').disabled = true;
			d.getElementById('drpATC6').selectedIndex = 0;
			drpATCChanged(6);
			d.getElementById('drpATC6').disabled = true;

			computeAll();
		}
	}

	//end of total tax payable functions
	var currentPage = 1;
	var maxPage = 2;

	function processNext() {
		if (currentPage < maxPage) {
			currentPage++;

			$('#Page' + currentPage).show('blind');
			$('#Page' + (currentPage - 1)).hide('blind');
			document.getElementById('frm2551Qv2018:txtCurrentPage').value = currentPage;
		}
	}

	function processPrev() {
		if (currentPage > 1) {
			currentPage--;
			$('#Page' + currentPage).show('blind');
			$('#Page' + (currentPage + 1)).hide('blind');
			document.getElementById('frm2551Qv2018:txtCurrentPage').value = currentPage;
		}
	}

	function goToPage(pageVal) {
		var newPage = pageVal.value;

		if (newPage <= maxPage && newPage >= 1) {
			$('#Page' + newPage).show('blind');
				$('#Page' + currentPage).hide('blind');
				currentPage = newPage;
		}
		else {
			alert("Invalid page.");
			pageVal.value = currentPage;
		}


	}

	//removed from loading table was hard coded
	//loading of ATC on Table 1
	/*function loadSched3(atcDesc, atcRate, atcCode) {
		//codes here
		
		var duplicateCnt = 0;
		var isATCNotDuplicate = false;
		if (listATC.length > 0) {
			for (var i = 0; i < listATC.length; i++) {
				if (atcCode == listATC[i]){
					duplicateCnt = 1;
				}
			}
		}
		else {
			isATCNotDuplicate = true;
		}

		if (duplicateCnt == 0) {
			isATCNotDuplicate = true;
		}

		if (isATCNotDuplicate) {
			if (atcCode == "PT010" || atcCode == "PT040" || atcCode == "PT041" || atcCode == "PT060" || atcCode == "PT070" || 
			atcCode == "PT090" || atcCode == "PT140" || atcCode == "PT150" || atcCode == "PT160" || atcCode == "PT170" || 
			atcCode == "PT180") {
				$('#tblSched3A').html(d.getElementById('tblSched3A').innerHTML +
    	        "<tr>" + 
				"<td align='center'><font size='1' face='Arial, Helvetica, sans-serif'>" + atcCode + "</font></td>" + 
				"<td><font size='1' face='Arial, Helvetica, sans-serif'>" + atcDesc + "</font></td>" + 
				"<td><font size='1' face='Arial, Helvetica, sans-serif'>" + atcRate + "</font></td>" + 
				"</tr>");
				listATC[dCount] = atcCode;
			}
			else if (atcCode == "PT105" || atcCode == "PT101" || atcCode == "PT102" || atcCode == "PT103" || atcCode == "PT104") {
				$('#tblSched3B').html(d.getElementById('tblSched3B').innerHTML +
				"<tr>" + 
				"<td align='center'><font size='1' face='Arial, Helvetica, sans-serif'>" + atcCode + "</font></td>" + 
				"<td><font size='1' face='Arial, Helvetica, sans-serif'>" + atcDesc + "</font></td>" + 
				"<td><font size='1' face='Arial, Helvetica, sans-serif'>" + atcRate + "</font></td>" + 		
				"</tr>");
				listATC[dCount] = atcCode;
			}
			dCount++;
		}
	}*/


	/*--------------------------------------------------------------*/
	//Added By dgarfin
	function loadXMLATC(fileLocation) {
		//woi
		//for dev purposes
		//fileLocation = "E:\\BIR\\ebirforms\\xml\\atcCodes.xml"
		try {
			//This will load the ATC file with filename 'fileLocation' if it exists
			var fsoXML = new ActiveXObject("Scripting.FileSystemObject");
			XMLATCFile = fsoXML.OpenTextFile(fileLocation, 1);

			if (XMLATCFile.AtEndOfStream)
				data = "";
			else {

				var responseATC = d.getElementById('responseATC'); //render file and write to hidden div
				responseATC.innerHTML = XMLATCFile.ReadAll(); //remove XML tag

			}
			XMLATCFile.Close(); //alert( responseATC.innerHTML ); //Debug			
			loadATC();	/*This will load ATC onto an array*/
		} catch (e) {
			msg.innerHTML = "ATC File not Found.";
		} //this will Alert File not Found if it doesn't exist
	}

	var atcCount = 0;

	var dCount = 0;
	var listATC = new Array();
	function loadATC() {
		/*This will load data onto an array*/
		var response = d.getElementById("responseATC");

		var atcCnt = String(response.innerHTML).split('atcCount=');
		atcCount = atcCnt[1];


		var j = 0;
		//loads atcList from xml
		for (var i = 1; i <= atcCount; i++) {

			var atc = String(response.innerHTML).split('atc' + i + ':');
			var atcStr = atc[1];

			//Ensure that before writing to atcPropertyJS the formType 2551Qv2018 is traceable in atcStr
			if (atcStr.indexOf('2551_') >= 0) {
				var atcValues = atcStr.split('~');

				var formType = "2551Qv2018";
				var atcCode = atcValues[0];
				var description = atcValues[1];
				var rate = atcValues[2];
				var category = atcValues[3];

				var base = '';
				var compType = '';
				var constTaxDue = '';
				var minimum = '';
				var maximum = '';

				//loading of ATC tables dynamically
				//loadSched3(description, rate, atcCode);

				var objATC = new atcPropertyJS(formType, atcCode, description, rate, category, base, compType, constTaxDue, minimum, maximum);
				atcList[j] = objATC;

				j++;
				//alert('2551Qv2018 successfully created array #'+i);

			} else {
				//alert('2551Qv2018 not found in array #'+i);
				continue;
			}
		}
	}

	/*--------------------------------------------------------------*/


	/*--------------------------------------------------------------*/
	function loadXML(loadWhere) {
		//alert("start loadXML: " + loadWhere);
		try {
			//This will load the file with filename loadWhere if it exists
			var fsoXML = new ActiveXObject("Scripting.FileSystemObject");
			XMLFile = fsoXML.OpenTextFile(loadWhere, 1);

			//alert(XMLFile);

			if (XMLFile.AtEndOfStream)
				data = "";
			else {
				var response = d.getElementById('response'); //render file and write to hidden div
				response.innerHTML = XMLFile.ReadAll(); //remove XML tag
			}
			XMLFile.Close(); //alert( response.innerHTML ); //Debug				
			loadData();	/*This will load data onto fields*/
			if (response.innerHTML.indexOf("All Rights Reserved BIR 2012.0") >= 0) {
				gIsReadOnly = true;
			}

			if (gIsReadOnly) {
				d.getElementById('frm2551Qv2018:cmdValidate').disabled = true;
				d.getElementById('btnSave').disabled = true;
			}
			window.setTimeout("$('#loader').hide('blind');", 2000);
		} catch (e) {
			msg.innerHTML = ""; //"Save File not Found.";
		} //this will Alert File not Found if it doesn't exist
	}

	function loadData() {
		/*This will load data onto fields*/
		var response = d.getElementById("response");

		var elem = document.getElementById('frmMain').elements;
		for (var i = 0; i < elem.length; i++) {
			try {
				if (elem[i].type != 'hidden' && elem[i].type != 'undefined') {	//elem[i].type != 'button' &&  			
					if (elem[i].type == 'text' || elem[i].type == 'select-one') {
						var fieldVal = String($("#response").html()).split(elem[i].id + '=');
						if (elem[i].id == 'frm2551Qv2018:registeredName' || elem[i].id == 'frm2551Qv2018:txtLineofBus' || elem[i].id == 'frm2551Qv2018:registeredAddress') {
							elem[i].value = unescape(fieldVal[1]);
						}
						else if (elem[i].className.indexOf("FinalFlag") > -1) {
							elem[i].value = typeof (fieldVal[1]) === "undefined" ? "3" : fieldVal[1];
						}
						else {
							elem[i].value = fieldVal[1]; //all select-one and text values		 		
						}
					}
					if (elem[i].type == 'radio') {
						var rdoVal = String($("#response").html()).split(elem[i].id + '=');
						if (rdoVal[1] == 'true') {
							elem[i].checked = rdoVal[1];
							elem[i].onclick();
						}
					}
					if (elem[i].type == 'checkbox') {
						var chkboxVal = String($("#response").html()).split(elem[i].id + '=');
						if (chkboxVal[1] == 'true') {
							elem[i].checked = chkboxVal[1];
						}
					}

				}
			} catch (e) {
				//alert('exception thrown : e : '+e.description);
			}

		}
		document.getElementById('txtEmail').value = globalEmail;
	}

	function createXMLFileName(subFolder) {
		var xmlFileName = "";
		var titleTin1 = d.getElementById('frm2551Qv2018:txtTIN1');
		var titleTin2 = d.getElementById('frm2551Qv2018:txtTIN2');
		var titleTin3 = d.getElementById('frm2551Qv2018:txtTIN3');
		var titleBranchCode = d.getElementById('frm2551Qv2018:txtBranchCode');
		var titleTPName = d.getElementById('frm2551Qv2018:registeredName');

		var qtr = "";
		if (d.getElementById('frm2551Qv2018:qtr_1').checked == true) {
			qtr = "Q1";
		}
		if (d.getElementById('frm2551Qv2018:qtr_2').checked == true) {
			qtr = "Q2";
		}
		if (d.getElementById('frm2551Qv2018:qtr_3').checked == true) {
			qtr = "Q3";
		}
		if (d.getElementById('frm2551Qv2018:qtr_4').checked == true) {
			qtr = "Q4";
		}
		var returnPeriod = d.getElementById('frm2551Qv2018:rtnMonth').value + d.getElementById('frm2551Qv2018:txtYear').value + qtr;

		if (existingXMLFileName != null && existingXMLFileName.length > 0) {
			xmlFileName = existingXMLFileName;

		} else {

			xmlFileName = subFolder + titleTin1.value + titleTin2.value + titleTin3.value + titleBranchCode.value +
				"-2551Qv2018-" +
				returnPeriod +
				".xml";
		}

		fileName = titleTin1.value + titleTin2.value + titleTin3.value + titleBranchCode.value +
			"-2551Qv2018-" +
			returnPeriod +
			".xml";

		return xmlFileName;
	}

	function saveEncryptedProfile(isFromSubmit) {
		var isSaveSuccessful = saveXML(true);
		//saveXMLProfile(true);	
		var fnNew = "";

		if (isSaveSuccessful) {

			if (existingXMLFileName.indexOf('/') > -1) { //Means existingXMLFileName is the same as the preloaded file yyy
				fnNew = existingXMLFileName.substring(existingXMLFileName.indexOf('/') + 1, existingXMLFileName.length);
			} else {
				if (fileName.indexOf('/') > -1) { //Means fileName is the same as the preloaded file
					fnNew = fileName.substring(fileName.indexOf('/') + 1, fileName.length);
				} else {
					fnNew = fileName;
				}
			}
		} else {
			return;
		}

		if (document.getElementById('txtFinalFlag').value == "3") { fnNew = fnNew.split(".xml")[0] + "#" + globalEmail + "#.xml"; } 
		
		//woi
		//for dev purposes
		//var xmlFileName = "E:\\BIR\\ebirforms\\IAF_RDO_Copy\\" + fnNew;
		var xmlFileName = "IAF_RDO_Copy/" + fnNew; //createXMLFileName("IAF_RDO_Copy/");//

		msg.innerHTML = 'Generating File...';
		var fileSys = new ActiveXObject("Scripting.FileSystemObject");

		var xmlFile = "";
		//dgarfin todo: alert user that it will overwrite existing zzz
		if (doesFileExists(xmlFileName)) {
			//alert("File '"+xmlFileName+"' already exists!\n\nThis will overwrite existing data.");				
		}
		xmlFile = fileSys.CreateTextFile(xmlFileName);
		fileNameToExport = fnNew;
		var allXML = "<?xml version='1.0'?>", tab = d.getElementById('xmlFormat').innerHTML;
		allXML += tab; //adds line break

		/*--------------------- follow this format for parsing --------------------------- */
		var elem = document.getElementById('frmMain').elements;
		for (var i = 0; i < elem.length; i++) {
			if (elem[i].type != 'button' && elem[i].type != 'hidden' && elem[i].type != 'undefined') {
				if (elem[i].type == 'text' || elem[i].type == 'select-one') {
					allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab; //all select-one and text values
				}
				if (elem[i].type == 'radio' || elem[i].type == 'checkbox') {
					allXML += "<div>" + elem[i].id + "=" + elem[i].checked + elem[i].id + "=</div>" + tab; //all radio and checkbox values			
				}

			}
		}
		/*--------------------- follow this format for parsing --------------------------- */

		allXML += tab + d.getElementById('xmlClose').innerHTML + "0";

		//Encryption of data content 'allXML' 
		//allXML = LZString.compress(allXML);
		//var encryptedAllXML = encrypt(allXML);

		xmlFile.write(allXML);
		xmlFile.close();
		// External compression and encryption
		var succ = EncryptFile(xmlFileName);

		msg.innerHTML = '';
		if (typeof (isFromSubmit) === "undefined") {
			if (confirm('File saved and encrypted.\nDo you want to save this in USB flash drive or CD-RW?')) {
				//alert("Make sure you already inserted your USB flash drive or CD-RW before proceeding.");		
				//show modal "Have Disk"...
				showModalExport();
				//window.history.go(0);
			} else { // return; //cancel finalcopy
				//exportTPFileInC();
				//alert("You have not saved the file to either your USB flash drive or CD-RW.\n\n In case you want to submit it via email,\nyou may locate it under : 'C:\\IAF_RDO_Copy'");
				//window.history.go(0);

				//refresh HTA page here. to address: 
				//Issue#380: A return tagged as final copy should not be edited by tp, rdo, rdc. Currently, user can still modify entries.
				//document.location.reload(true);
				disableAllElementIDs();
				d.getElementById('btnUpload').disabled = false;
			}
		}
		else {
			disableAllElementIDs();
			d.getElementById('btnUpload').disabled = false;
		}
		return fileSys.GetAbsolutePathName(xmlFileName);

	}

	function doesFileExists(xmlFile) {
		var fileSysObj = new ActiveXObject("Scripting.FileSystemObject");
		if (fileSysObj.FileExists(xmlFile)) {
			return true;
		} else {
			return false;
		}
	}

	function isItAnAmendedReturn(xmlFile) {
		if (d.getElementById('frm2551Qv2018:amendedRtn_1').checked) {
			return true;
		} else {
			return false;
		}
	}

	function isItAFinalCopy(xmlFile) {
		var fsoXML = new ActiveXObject("Scripting.FileSystemObject");
		fn = fsoXML.OpenTextFile(xmlFile, 1);
		var fnContent = fn.ReadAll();
		fn.Close();

		if (fnContent.indexOf("All Rights Reserved BIR 2012.0") >= 0) {
			return true;
		} else {
			return false;
		}
	}

	function createNewXMLFileName(subFolder, xmlFileName) {
		//Conditions met here: (isFileExists && isFinalCopy && isAmendedReturn) 
		var fso = new ActiveXObject("Scripting.FileSystemObject");
		var fileNm = "";
		var newFileNm = "";

		//Added 10/21/2016
		var subFileName = "";
		var version = 0;

		if (xmlFileName.indexOf('V') == -1) {
			fileNm = xmlFileName.substring(xmlFileName.indexOf('/') + 1, xmlFileName.indexOf('.xml'));
		} else {
			fileNm = xmlFileName.substring(xmlFileName.indexOf('/') + 1, xmlFileName.indexOf('V'));
		}

		var sameFileNameCtr = 0;
		//if (fso.FileExists(xmlFileName)) {
		if (subFolder.length > 0 && fso.FolderExists(subFolder)) {
			var objEnum = new Enumerator(fso.GetFolder(subFolder).Files);
			for (i = 0; !objEnum.atEnd(); objEnum.moveNext()) {
				if (objEnum.item().name.indexOf(fileNm) > -1 && objEnum.item().name.indexOf('V') > -1) {
					//sameFileNameCtr++;

					//as of 10/21/2016
					var isAFinalCopy = isItAFinalCopy(subFolder + objEnum.item().name);
					//if (isAFinalCopy) {
					//no longer counts the file but gets the highest version number and add plus 1
					subFileName = objEnum.item().name.substring(objEnum.item().name.indexOf('V') + 1, objEnum.item().name.indexOf('.xml'));
					version = parseInt(subFileName);
					if (version >= sameFileNameCtr) {
						sameFileNameCtr = version + 1;
					}
					//}
				}
			}

			if (sameFileNameCtr > 0) {
				newFileNm = subFolder + fileNm + "V" + sameFileNameCtr + ".xml";

			} else {
				//unlikely to happend since saveXML() altered filtered out the scenario that will call this function
				//amended default
				newFileNm = subFolder + fileNm + "V1.xml";
			}
			return newFileNm;
		}
		//} else {
		//unlikely to happend since saveXML() altered filtered out the scenario that will call this function
		//}		
	}



	function saveXML(isFinalCopy) {
		var isFileExists = false;
		var isAmendedReturn = false;
		var isAFinalCopy = false;

		if (gIsReadOnly && document.getElementById("txtFinalFlag").value != "2") {
			if (confirm('You will no longer be allowed to modify since this is already the final copy.\nDo you want to save this in USB flash drive or CD-RW instead?')) {
				var xmlFileName = createXMLFileName("IAF_RDO_Copy/");
				msg.innerHTML = 'Generating File...';
				var fileSys = new ActiveXObject("Scripting.FileSystemObject");
				var xmlFile = fileSys.CreateTextFile(xmlFileName); //(saveWhere);
				//
				fileNameToExport = fileName;
				var allXML = "<?xml version='1.0'?>", tab = d.getElementById('xmlFormat').innerHTML;
				allXML += tab; //adds line break

				/*--------------------- follow this format for parsing --------------------------- */
				var elem = document.getElementById('frmMain').elements;
				for (var i = 0; i < elem.length; i++) {
					if (elem[i].type != 'button' && elem[i].type != 'hidden' && elem[i].type != 'undefined') {
						if (elem[i].type == 'text' || elem[i].type == 'select-one') {
							if (elem[i].id == 'frm2551Qv2018:registeredName' || elem[i].id == 'frm2551Qv2018:registeredAddress') {
								allXML += "<div>" + elem[i].id + "=" + escape(elem[i].value) + elem[i].id + "=</div>" + tab;
							}
							else {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab; //all select-one and text values
							}
						}
						if (elem[i].type == 'radio' || elem[i].type == 'checkbox') {
							allXML += "<div>" + elem[i].id + "=" + elem[i].checked + elem[i].id + "=</div>" + tab; //all radio and checkbox values			
						}

					}
				}
				/*--------------------- follow this format for parsing --------------------------- */

				allXML += tab + d.getElementById('xmlClose').innerHTML + "0";

				//Encryption of data content 'allXML' 
				//allXML = LZString.compress(allXML);
				//var encryptedAllXML = encrypt(allXML);

				xmlFile.write(allXML);
				xmlFile.close();
				// External compression and encryption
				var succ = EncryptFile(xmlFileName);

				msg.innerHTML = '';

				showModalExport();

				saveXMLProfile(true);
				// saveXML(true); 
			} else {
				return false;
			}
		} else {
			var valid = initialValidateBeforeSave();

			if (valid == true) {
				
				//woi
				//for dev purposes
				//var xmlFileName = createXMLFileName("E:\\BIR\\ebirforms\\savefile\\");
				var xmlFileName = createXMLFileName("savefile/");
				
				msg.innerHTML = 'Generating File...';
				var fileSys = new ActiveXObject("Scripting.FileSystemObject");
				var xmlFile = "";

				//Added 10/21/2016
				var xmlFileNameValidate = "";
				var isFinalFlag2 = false;
				//---------------------------------------------------------------
				//START:  New logic in handling amended returns			
				isFileExists = doesFileExists(xmlFileName);
				isAmendedReturn = isItAnAmendedReturn();

				//as of 10/21/2016
				//if there is already amended filed and will file a not amended,
				//it will restrict it
				if (isAmendedReturn == false) {

					if (xmlFileName.indexOf('V') == -1) {
						xmlFileNameValidate = xmlFileName.substring(xmlFileName.indexOf('/') + 1, xmlFileName.indexOf('.xml'));
					} else {
						xmlFileNameValidate = xmlFileName.substring(xmlFileName.indexOf('/') + 1, xmlFileName.indexOf('V'));
					}

					var hasVersion = false;
					//woi
					//for dev purposes
					//var objEnum = new Enumerator(fileSys.GetFolder("E:\\BIR\\ebirforms\\savefile\\").Files);
					var objEnum = new Enumerator(fileSys.GetFolder("savefile/").Files);
					
					for (i = 0; !objEnum.atEnd(); objEnum.moveNext()) {
						if (objEnum.item().name.indexOf(xmlFileNameValidate) > -1 && objEnum.item().name.indexOf("V") > -1) {
							hasVersion = true;
						}
					}
					if (hasVersion) {
						alert("If your intention is to make an amended return, kindly tick Amended Return to 'Yes' before hitting 'Save' or 'Final Copy' or 'Submit'.");
						return false;
					}
				}

				if (isFileExists) {
					isAFinalCopy = isItAFinalCopy(xmlFileName); if (document.getElementById('txtFinalFlag').value == '2') {
						isAFinalCopy = false;
						isFinalFlag2 = true;
					}
				}

				//1) check if fileExists, if not regular routine
				if (isFileExists == false) {
					//as of 10/21/2016
					if (isAmendedReturn) {
						//woi
						//for dev purposes
						//var fn = createNewXMLFileName("E:\\BIR\\ebirforms\\savefile\\", xmlFileName);
						var fn = createNewXMLFileName("savefile/", xmlFileName);
						
						xmlFile = fileSys.CreateTextFile(fn);
						xmlFileName = fn;
						existingXMLFileName = fn;
					}
					else
						xmlFile = fileSys.CreateTextFile(xmlFileName); //xmlFileName should be the newly created xml filename here.
				}
				//2) if (fileExists && FinalCopy  && Amended) {versionFile} 
				else if (isFileExists && isAFinalCopy && isAmendedReturn) {
					//as of 10/21/2016
					if (existingXMLFileName != null && existingXMLFileName.length > 0) {
						xmlFile = fileSys.CreateTextFile(xmlFileName); //xmlFileName should be the preloaded xml filename here.
					}
					else {
						//versionFile xxx
						//woi
						//for dev purposes
						//var fn = createNewXMLFileName("E:\\BIR\\ebirforms\\savefile\\", xmlFileName);
						var fn = createNewXMLFileName("savefile/", xmlFileName);
						
						xmlFile = fileSys.CreateTextFile(fn);
						xmlFileName = fn;
						existingXMLFileName = fn;
					}
				}
				//3)if (fileExists && FinalCopy  && Not Amended) {throw error message: "If your intention is to make an amended return, kindly tick Amended Return to 'Yes'".} 
				else if (isFileExists && isAFinalCopy && isAmendedReturn == false && document.getElementById('txtFinalFlag').value != '3') {
					alert("If your intention is to make an amended return, kindly tick Amended Return to 'Yes' before hitting 'Save' or 'Final Copy' or 'Submit'.");
					return false;
				}
				//4) if (fileExists && Not FinalCopy  && Not Amended/Amended) {regular routine} 				
				else if (isFileExists && isAFinalCopy == false) {
					//as of 10/21/2016
					if (existingXMLFileName != null && existingXMLFileName.length > 0) {
						xmlFile = fileSys.CreateTextFile(xmlFileName); //xmlFileName should be the preloaded xml filename here.
					}
					else {
						//as of 10/21/2016
						
						if (isAmendedReturn && isFinalFlag2 == false) {
							//woi
							//for dev purposes
							//var fn = createNewXMLFileName("E:\\BIR\\ebirforms\\savefile\\", xmlFileName);
							var fn = createNewXMLFileName("savefile/", xmlFileName);
							
							xmlFile = fileSys.CreateTextFile(fn);
							xmlFileName = fn;
							existingXMLFileName = fn;
						}
						else
							xmlFile = fileSys.CreateTextFile(xmlFileName); //xmlFileName should be the preloaded xml filename here.
					}
				}
				else {
					xmlFile = fileSys.CreateTextFile(xmlFileName);
				}
				//END:  New logic in handling amended returns						
				//---------------------------------------------------------------

				var allXML = "<?xml version='1.0'?>", tab = d.getElementById('xmlFormat').innerHTML;
				allXML += tab; //adds line break

				/*--------------------- follow this format for parsing --------------------------- */
				var elem = document.getElementById('frmMain').elements;
				//var elemVal = "";
				//woi saving
				//changes
				for (var i = 0; i < elem.length; i++)
				{
					if (elem[i].type != 'button' && elem[i].type != 'hidden' && elem[i].type != 'undefined') {
						if (elem[i].type == 'text' || elem[i].type == 'select-one') {
							if (elem[i].id == 'frm2551Qv2018:registeredName' || elem[i].id == 'frm2551Qv2018:registeredAddress') {
								allXML += "<div>" + elem[i].id + "=" + escape(elem[i].value) + elem[i].id + "=</div>" + tab;
							}
							else {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab; //all select-one and text values
							}
						}
						if (elem[i].type == 'radio' || elem[i].type == 'checkbox') {
							allXML += "<div>" + elem[i].id + "=" + elem[i].checked + elem[i].id + "=</div>" + tab; //all radio and checkbox values			
						}
					}//outer if

				}//end of loop
				
				var retPeriodSubStr = xmlFileName.substring(xmlFileName.lastIndexOf('-') + 1, xmlFileName.indexOf('.xml')); //111111111111-0605-09122011115519.xml (09/12/2011 11:55:19)
				p3ReturnPeriod = retPeriodSubStr.substring(0, 2) + "/" + retPeriodSubStr.substring(2, 6) + "-" + retPeriodSubStr.substring(6, 8);

				var mmYYYofQtr = "";
				if ('Q1' == retPeriodSubStr.substring(6, 8)) {
					mmYYYofQtr = getQuarterMonth(parseInt(retPeriodSubStr.substring(2, 6)), parseInt(retPeriodSubStr.substring(0, 2)), 'Q1'); //"03";
				} else if ('Q2' == retPeriodSubStr.substring(6, 8)) {
					mmYYYofQtr = getQuarterMonth(parseInt(retPeriodSubStr.substring(2, 6)), parseInt(retPeriodSubStr.substring(0, 2)), 'Q2'); //"06";
				} else if ('Q3' == retPeriodSubStr.substring(6, 8)) {
					mmYYYofQtr = getQuarterMonth(parseInt(retPeriodSubStr.substring(2, 6)), parseInt(retPeriodSubStr.substring(0, 2)), 'Q3'); //"09";
				} else if ('Q4' == retPeriodSubStr.substring(6, 8)) {
					mmYYYofQtr = getQuarterMonth(parseInt(retPeriodSubStr.substring(2, 6)), parseInt(retPeriodSubStr.substring(0, 2)), 'Q4'); //"09";
				}

				//woi
				//changes
				p3ReturnPeriodEnd = getLastDateOfMonthAndReturnMMDDYYYY(mmYYYofQtr.substring(3, 7), mmYYYofQtr.substring(0, 2));

				p3TPTIN = p3TPTIN1 + p3TPTIN2 + p3TPTIN3;
				/*--------------------- follow this format for parsing --------------------------- */

				if (isFinalCopy) {
					allXML += tab + d.getElementById('xmlClose').innerHTML + "0";
					gIsReadOnly = true;
				} else {
					allXML += tab + d.getElementById('xmlClose').innerHTML;
				}

				//Phase 3: This 'savefile' will be uploaded to IAF Infra for DI processing
				savedReturn = allXML;

				xmlFile.write(allXML);
				xmlFile.close();
				msg.innerHTML = '';

				if (isFinalCopy == false) {
					alert('BIR Form saved successfully as : ' + xmlFileName);
				}
				saveXMLProfile(false);
				return true;

			}
		}
		return true;
	}

	function saveXMLsubmit(submit) {
		var valid = initialValidateBeforeSave();
		var isBFinalCopy = false;
		if (valid == true) {
			//woi
			//for dev purposes
			//var xmlFileName = createXMLFileName("E:\\BIR\\ebirforms\\savefile\\");
			var xmlFileName = createXMLFileName("savefile/");
			
			msg.innerHTML = 'Generating File...';
			var fileSys = new ActiveXObject("Scripting.FileSystemObject");
			var xmlFile = "";

			//Added 10/21/2016
			var xmlFileNameValidate = "";

			//---------------------------------------------------------------
			//START:  New logic in handling amended returns			
			isFileExists = doesFileExists(xmlFileName);
			isAmendedReturn = isItAnAmendedReturn();

			//as of 10/21/2016
			//if there is already amended filed and will file a not amended,
			//it will restrict it
			if (isAmendedReturn == false) {
				if (xmlFileName.indexOf('V') == -1) {
					xmlFileNameValidate = xmlFileName.substring(xmlFileName.indexOf('/') + 1, xmlFileName.indexOf('.xml'));
				} else {
					xmlFileNameValidate = xmlFileName.substring(xmlFileName.indexOf('/') + 1, xmlFileName.indexOf('V'));
				}

				var hasVersion = false;
				//woi
				//for dev purposes
				//var objEnum = new Enumerator(fileSys.GetFolder("E:\\BIR\\ebirforms\\savefile\\").Files);
				var objEnum = new Enumerator(fileSys.GetFolder("savefile/").Files);
				
				for (i = 0; !objEnum.atEnd(); objEnum.moveNext()) {
					if (objEnum.item().name.indexOf(xmlFileName) > -1 && objEnum.item().name.indexOf("V") > -1) {
						hasVersion = true;
					}
				}
				if (hasVersion) {
					if (!isSubmit)
						alert("If your intention is to make an amended return, kindly tick Amended Return to 'Yes' before hitting 'Save' or 'Final Copy' or 'Submit'.");
					return false;
				}
			}

			if (isFileExists) {
				if (document.getElementById('txtFinalFlag').value == '2') { isAFinalCopy = false; }
			}

			//1) check if fileExists, if not regular routine
			if (isFileExists == false) {

				xmlFile = fileSys.CreateTextFile(xmlFileName); //xmlFileName should be the newly created xml filename here.
			}
			//2) if (fileExists && FinalCopy  && Amended) {versionFile} 
			else if (isFileExists && isBFinalCopy && isAmendedReturn) {
				//versionFile xxx

				//woi
				//for dev purposes
				//var fn = createNewXMLFileName("E:\\BIR\\ebirforms\\savefile\\", xmlFileName);
				var fn = createNewXMLFileName("savefile/", xmlFileName); 
				
				xmlFile = fileSys.CreateTextFile(fn);
				xmlFileName = fn;
				existingXMLFileName = fn;
			}
			//3)if (fileExists && FinalCopy  && Not Amended) {throw error message: "If your intention is to make an amended return, kindly tick Amended Return to 'Yes'".} 
			else if (isFileExists && isBFinalCopy && isAmendedReturn == false && document.getElementById('txtFinalFlag').value != '3') {
				if (!isSubmit) {
					alert("If your intention is to make an amended return, kindly tick Amended Return to 'Yes' before hitting 'Save' or 'Final Copy' or 'Submit'.");
					return false;
				}
				else {
					xmlFile = fileSys.CreateTextFile(xmlFileName);
				}
			}
			//4) if (fileExists && Not FinalCopy  && Not Amended/Amended) {regular routine} 				
			else if (isFileExists && isBFinalCopy == false) {

				xmlFile = fileSys.CreateTextFile(xmlFileName); //xmlFileName should be the preloaded xml filename here.
			}
			else {
				xmlFile = fileSys.CreateTextFile(xmlFileName);
			}
			//END:  New logic in handling amended returns						
			//---------------------------------------------------------------

			var allXML = "<?xml version='1.0'?>", tab = d.getElementById('xmlFormat').innerHTML;
			allXML += tab; //adds line break

			/*--------------------- follow this format for parsing --------------------------- */
			var elem = document.getElementById('frmMain').elements;
			//var elemVal = "";
			for (var i = 0; i < elem.length; i++)
			{
				if (elem[i].type != 'button' && elem[i].type != 'hidden' && elem[i].type != 'undefined') {
					if (elem[i].type == 'text' || elem[i].type == 'select-one') {

						if (elem[i].id == 'frm2551Qv2018:txtYear') {
								allXML += "<div>" + elem[i].id + "=" + escape(elem[i].value) + elem[i].id + "=</div>" + tab;
								i2Year = escape(elem[i].value);
							}
							else if (elem[i].id == 'frm2551Qv2018:rtnMonth') {
								allXML += "<div>" + elem[i].id + "=" + escape(elem[i].value) + elem[i].id + "=</div>" + tab;
								i2Month = escape(elem[i].value);
							}
							else if (elem[i].id == 'frm2551Qv2018:txtSheets') {
								allXML += "<div>" + elem[i].id + "=" + escape(elem[i].value) + elem[i].id + "=</div>" + tab;
								i5Sheets = escape(elem[i].value);
							}
							else if (elem[i].id == 'frm2551Qv2018:txtTIN1') {
								allXML += "<div>" + elem[i].id + "=" + escape(elem[i].value) + elem[i].id + "=</div>" + tab;
								i6Tin1 = escape(elem[i].value);
								p3TPTIN1 = i6Tin1;
							}
							else if (elem[i].id == 'frm2551Qv2018:txtTIN2') {
								allXML += "<div>" + elem[i].id + "=" + escape(elem[i].value) + elem[i].id + "=</div>" + tab;
								i6Tin2 = escape(elem[i].value);
								p3TPTIN2 = i6Tin2; 
							}
							else if (elem[i].id == 'frm2551Qv2018:txtTIN3') {
								allXML += "<div>" + elem[i].id + "=" + escape(elem[i].value) + elem[i].id + "=</div>" + tab;
								i6Tin3 = escape(elem[i].value);
								p3TPTIN3 = i6Tin3;
							}
							else if (elem[i].id == 'frm2551Qv2018:txtBranchCode') {
								allXML += "<div>" + elem[i].id + "=" + escape(elem[i].value) + elem[i].id + "=</div>" + tab;
								i6Tin4 = escape(elem[i].value);
							}
							else if (elem[i].id == 'frm2551Qv2018:txtRDOCode') {
								allXML += "<div>" + elem[i].id + "=" + escape(elem[i].value) + elem[i].id + "=</div>" + tab;
								i7Rdo = escape(elem[i].value);
							}
							if (elem[i].id == 'frm2551Qv2018:registeredName') {
								allXML += "<div>" + elem[i].id + "=" + escape(elem[i].value) + elem[i].id + "=</div>" + tab;
								i8TaxPayerName = escape(elem[i].value);
							}						
							else if (elem[i].id == 'frm2551Qv2018:registeredAddress') {
								allXML += "<div>" + elem[i].id + "=" + escape(elem[i].value) + elem[i].id + "=</div>" + tab;
								i9TaxPayerAddress = escape(elem[i].value);
							}
							if (elem[i].id == 'frm2551Qv2018:zipCode') {
								allXML += "<div>" + elem[i].id + "=" + escape(elem[i].value) + elem[i].id + "=</div>" + tab;
								i9ZipCode = escape(elem[i].value);
							}
							else if (elem[i].id == 'frm2551Qv2018:telNo') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								i10ContactNum = elem[i].value;
							} else if (elem[i].id == 'txtEmail') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								i11Email = elem[i].value;
							} else if (elem[i].id == 'frm2551Qv2018:txtTaxReliefSpecify') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								i12TaxTreatyDesc = elem[i].value;


							//Total Tax Payable Including Schedule1 Fields	
							} else if (elem[i].id == 'frm2551Qv2018:txt14') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								i14TaxDue = elem[i].value;
							} else if (elem[i].id == 'frm2551Qv2018:txt15') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								i15CredTax = elem[i].value;
							} else if (elem[i].id == 'frm2551Qv2018:txt16') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								i16TaxReturn = elem[i].value;
							} else if (elem[i].id == 'frm2551Qv2018:txt17Specify') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								i17OtherCredTaxDesc = elem[i].value;
							} else if (elem[i].id == 'frm2551Qv2018:txt17') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								i17OtherCredTax = elem[i].value;
							} else if (elem[i].id == 'frm2551Qv2018:txt18') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								i18TotTaxCred = elem[i].value;
							} else if (elem[i].id == 'frm2551Qv2018:txt19') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								i19TaxOverpayment = elem[i].value;
							} else if (elem[i].id == 'frm2551Qv2018:txt20') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								i20Surcharge = elem[i].value;
							} else if (elem[i].id == 'frm2551Qv2018:txt21') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								i21Interest = elem[i].value;
							} else if (elem[i].id == 'frm2551Qv2018:txt22') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								i22Compromise = elem[i].value;
							} else if (elem[i].id == 'frm2551Qv2018:txt23') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								i23TotPenalties = elem[i].value;
							} else if (elem[i].id == 'frm2551Qv2018:txt24') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								i24ToRefund = elem[i].value;
							} else if (elem[i].id == 'drpATC1') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								sched1Atc1Code = elem[i].value;
							} else if (elem[i].id == 'drpATC2') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								sched1Atc2Code = elem[i].value;
							} else if (elem[i].id == 'drpATC3') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								sched1Atc3Code = elem[i].value;
							} else if (elem[i].id == 'drpATC4') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								sched1Atc4Code = elem[i].value;
							} else if (elem[i].id == 'drpATC5') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								sched1Atc5Code = elem[i].value;
							} else if (elem[i].id == 'drpATC6') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								sched1Atc6Code = elem[i].value;
							} else if (elem[i].id == 'txtATCAmt1') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								sched1TaxAmount1 = elem[i].value;
							} else if (elem[i].id == 'txtATCAmt2') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								sched1TaxAmount2 = elem[i].value;
							} else if (elem[i].id == 'txtATCAmt3') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								sched1TaxAmount3 = elem[i].value;
							} else if (elem[i].id == 'txtATCAmt4') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								sched1TaxAmount4 = elem[i].value;
							} else if (elem[i].id == 'txtATCAmt5') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								sched1TaxAmount5 = elem[i].value;
							} else if (elem[i].id == 'txtATCAmt6') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								sched1TaxAmount6 = elem[i].value;
							} else if (elem[i].id == 'txtATCRate1') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								sched1TaxRate1 = elem[i].value;
							} else if (elem[i].id == 'txtATCRate2') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								sched1TaxRate2 = elem[i].value;
							} else if (elem[i].id == 'txtATCRate3') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								sched1TaxRate3 = elem[i].value;
							} else if (elem[i].id == 'txtATCRate4') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								sched1TaxRate4 = elem[i].value;
							} else if (elem[i].id == 'txtATCRate5') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								sched1TaxRate5 = elem[i].value;
							} else if (elem[i].id == 'txtATCRate6') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								sched1TaxRate6 = elem[i].value;
							} else if (elem[i].id == 'txtATCDue1') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								sched1TaxDue1 = elem[i].value;
							} else if (elem[i].id == 'txtATCDue2') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								sched1TaxDue2 = elem[i].value;
							} else if (elem[i].id == 'txtATCDue3') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								sched1TaxDue3 = elem[i].value;
							} else if (elem[i].id == 'txtATCDue4') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								sched1TaxDue4 = elem[i].value;
							} else if (elem[i].id == 'txtATCDue5') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								sched1TaxDue5 = elem[i].value;
							} else if (elem[i].id == 'txtATCDue6') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								sched1TaxDue6 = elem[i].value;
							} else if (elem[i].id == 'txtTotalSched1') {
								allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
								sched1TotalTaxDue = elem[i].value;
							}
							else{
								allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab; //all select-one and text values
							}
							//Total Tax Payable Including Schedule1 Fields
					}
					if (elem[i].type == 'radio' || elem[i].type == 'checkbox') {
						allXML += "<div>" + elem[i].id + "=" + elem[i].checked + elem[i].id + "=</div>" + tab; //all radio and checkbox values	

						if (d.getElementById('frm2551Qv2018:forThe_1').checked == true) {
								i1Calendar = "True";
							} else if (d.getElementById('frm2551Qv2018:forThe_2').checked == true) {
								i1Fiscal  = "True";
							} else if (d.getElementById('frm2551Qv2018:qtr_1').checked == true) {
								i3Quarter1 = "True";
							} else if (d.getElementById('frm2551Qv2018:qtr_2').checked == true) {
								i3Quarter2 = "True";
							} else if (d.getElementById('frm2551Qv2018:qtr_3').checked == true) {
								i3Quarter3 = "True";
							} else if (d.getElementById('frm2551Qv2018:qtr_4').checked == true) {
								i3Quarter4 = "True";
							} else if (d.getElementById('frm2551Qv2018:amendedRtn_1').checked == true) {
								i4AmendedYes = "True";
								p3IsAmended = "Yes";
							} else if (d.getElementById('frm2551Qv2018:amendedRtn_2').checked == true) {
								i4AmendedNo = "True";
								p3IsAmended = "No";
							} else if (d.getElementById('frm2551Qv2018:taxTreaty_1').checked == true) {
								i12TaxTreatyYes = "True";
							} else if (d.getElementById('frm2551Qv2018:taxTreaty_2').checked == true) {
								i12TaxTreatyNo = "True";
							} else if (d.getElementById('frm2551Qv2018:taxRate1').checked == true) {
								i13TaxRateNet = "True";
							} else if (d.getElementById('frm2551Qv2018:taxRate2').checked == true) {
								i13TaxRateGross = "True";
							} else if (d.getElementById('frm2551Qv2018:overPayment1').checked == true) {
								i24ToRefund = "True";
							} else if (d.getElementById('frm2551Qv2018:overPayment2').checked == true) {
								i24ToTaxCredit = "True";
							}
					}

				}
			}
			var retPeriodSubStr = xmlFileName.substring(xmlFileName.lastIndexOf('-') + 1, xmlFileName.indexOf('.xml')); //111111111111-0605-09122011115519.xml (09/12/2011 11:55:19)
			p3ReturnPeriod = retPeriodSubStr.substring(0, 2) + "/" + retPeriodSubStr.substring(2, 6) + "-" + retPeriodSubStr.substring(6, 8);

			var mmYYYofQtr = "";
			if ('Q1' == retPeriodSubStr.substring(6, 8)) {
				mmYYYofQtr = getQuarterMonth(parseInt(retPeriodSubStr.substring(2, 6)), parseInt(retPeriodSubStr.substring(0, 2)), 'Q1'); //"03";
			} else if ('Q2' == retPeriodSubStr.substring(6, 8)) {
				mmYYYofQtr = getQuarterMonth(parseInt(retPeriodSubStr.substring(2, 6)), parseInt(retPeriodSubStr.substring(0, 2)), 'Q2'); //"06";
			} else if ('Q3' == retPeriodSubStr.substring(6, 8)) {
				mmYYYofQtr = getQuarterMonth(parseInt(retPeriodSubStr.substring(2, 6)), parseInt(retPeriodSubStr.substring(0, 2)), 'Q3'); //"09";
			} else if ('Q4' == retPeriodSubStr.substring(6, 8)) {
				mmYYYofQtr = getQuarterMonth(parseInt(retPeriodSubStr.substring(2, 6)), parseInt(retPeriodSubStr.substring(0, 2)), 'Q4'); //"09";
			}

			p3ReturnPeriodEnd = getLastDateOfMonthAndReturnMMDDYYYY(mmYYYofQtr.substring(3, 7), mmYYYofQtr.substring(0, 2));

			p3TPTIN = p3TPTIN1 + p3TPTIN2 + p3TPTIN3;
			/*--------------------- follow this format for parsing --------------------------- */

			if (submit) {
				allXML += tab + d.getElementById('xmlClose').innerHTML + "0";
			} else {
				allXML += tab + d.getElementById('xmlClose').innerHTML;
			}

			//Phase 3: This 'savefile' will be uploaded to IAF Infra for DI processing
			savedReturn = allXML;

			xmlFile.write(allXML);
			xmlFile.close();
			msg.innerHTML = '';

			if (submit == false) {
				alert('BIR Form saved successfully as : ' + xmlFileName);
			}

		}
		return true;
	}
	/*--------------------------------------------------------------*/

	var XMLrdoFile = '';

	function loadXMLrdo(fileLocation) {
		try {
			//This will load the Region file with filename 'fileLocation' if it exists
			var fsoXML = new ActiveXObject("Scripting.FileSystemObject");
			XMLrdoFile = fsoXML.OpenTextFile(fileLocation, 1);

			if (XMLrdoFile.AtEndOfStream)
				data = "";
			else {
				var responseRdo = d.getElementById('responseRdo'); //render file and write to hidden div
				responseRdo.innerHTML = XMLrdoFile.ReadAll(); //remove XML tag
				//responseRdo = replaceHtml(responseRdo, XMLrdoFile.ReadAll()); //Pattern:  el = replaceHtml(el, newHtml)
			}
			XMLrdoFile.Close(); //alert( responseRdo.innerHTML ); //Debug   
			loadRdo(); /*This will load ATC onto an array*/
		} catch (e) {
			msg.innerHTML = ""; //"Region File not Found.";
		} //this will Alert File not Found if it doesn't exist
	}

	var rdoCount = 0;

	function loadRdo() {
		/*This will load data onto an array*/
		var response = d.getElementById("responseRdo");

		var rdoCnt = String(response.innerHTML).split('rdoCount=');
		rdoCount = rdoCnt[1];

		var k = 0;
		//loads rdoList from xml
		for (var i = 1; i <= rdoCount; i++) {

			var rdo = String(response.innerHTML).split('rdo' + i + ':');
			var rdoStr = rdo[1];

			//Ensure that before writing to rdoPropertyJS the formType 2551Qv2018 is traceable in rdoxml
			if (rdoStr.indexOf('2551Q') >= 0) {
				var rdoValues = rdoStr.split('~');
				var rdoCode = rdoValues[0];
				var description = rdoValues[1];

				var objRdo = new rdoPropertyJS(rdoCode, description);
				rdoList[k] = objRdo;
				k++;
				//alert('2551Qv2018 successfully created array #'+i);

			} else {
				//alert('2551Qv2018 not found in array #'+i);
				continue;
			}
		}
	}

	function init() {
		getDrives();

		var dt = new Date();
		d.getElementById('frm2551Qv2018:txtYear').value = dt.getFullYear() - 1;

		/*
		dgarfin: Upon loading of form, form is defaulted to 2nd quarter . 
		Issue Log from iaf_efps_disclog_06142012v1--validated.xls
		Created: 6/15/2012 */

		/*var month = new Date();
		if (month.getMonth() == 0 || month.getMonth() == 1 || month.getMonth() == 2)
		{
			d.getElementById('frm2551Qv2018:qtr_1').checked = true;
		}
		else if (month.getMonth() == 3 || month.getMonth() == 4 || month.getMonth() == 5)
		{
			d.getElementById('frm2551Qv2018:qtr_2').checked = true;
		}
		else if (month.getMonth() == 6 || month.getMonth() == 7 || month.getMonth() == 8)
		{
			d.getElementById('frm2551Qv2018:qtr_3').checked = true;
		}
		else if (month.getMonth() == 9 || month.getMonth() == 10 || month.getMonth() == 11)
		{
			d.getElementById('frm2551Qv2018:qtr_4').checked = true;
		}*/

		//d.getElementById('frm2551Qv2018:forThe_1').disabled = true;
		//d.getElementById('frm2551Qv2018:forThe_2').disabled = true;
		d.getElementById('frm2551Qv2018:amendedRtn_1').disabled = false;
		d.getElementById('frm2551Qv2018:amendedRtn_2').disabled = false;
		//d.getElementById('frm2551Qv2018:txtSheets').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTIN1').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTIN2').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTIN3').disabled = true;
		//d.getElementById('frm2551Qv2018:txtBranchCode').disabled = true;
		//d.getElementById('frm2551Qv2018:txtRDOCode').disabled = true;
		//d.getElementById('frm2551Qv2018:txtLineofBus').disabled = true;
		//d.getElementById('frm2551Qv2018:registeredName').disabled = true;
		//d.getElementById('frm2551Qv2018:telNo').disabled = true;
		//d.getElementById('frm2551Qv2018:registeredAddress').disabled = true;
		//d.getElementById('frm2551Qv2018:zipCode').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTax14A').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTax14B').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTax14D').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTax14E').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTax15A').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTax15B').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTax15D').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTax15E').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTax16A').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTax16B').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTax16D').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTax16E').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTax17A').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTax17B').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTax17D').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTax17E').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTax18A').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTax18B').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTax18D').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTax18E').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTax19').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTax20B').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTax20C').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTax21').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTax22A').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTax22B').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTax22C').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTax22D').disabled = true;
		//d.getElementById('frm2551Qv2018:txtTax23').disabled = true;

		//d.getElementById('frm2551Qv2018:opt23_1').disabled = true;
		//d.getElementById('frm2551Qv2018:opt23_2').disabled = true;

		d.getElementById('frm2551Qv2018:cmdEdit').disabled = true;
		d.getElementById('frm2551Qv2018:btnFinalCopy').disabled = true;
		d.getElementById('btnPrint').disabled = true;

		d.getElementById('frm2551Qv2018:txtTaxReliefSpecify').disabled = true;

		loadXMLrdo('xml/rdo.xml');
		getRdo();

	}

	function populateATC() {
		codeATC = new Array();
		descATC = new Array();
		rateATC = new Array();

		//var atcSize = atcList.getSize();
		var atcSize = atcList.length;
		var i = 0;
		var j = 1;
		codeATC[0] = "";
		descATC[0] = "";
		rateATC[0] = "0.00";
		for (i = 0; i < atcSize; i++) {
			//var atc = atcList.get(i);
			var atc = atcList[i];
			if (atc.formType == "2551Qv2018") {

				codeATC[j] = atc.atcCode;
				descATC[j] = atc.description;
				rateATC[j++] = atc.rate;
			}
		}
       

	}



	function blockletter(e) {
		var number = parseFloat(e.value).toFixed(2);
		if (isNaN(number)) {
			var zero = 0;
			e.value = parseFloat(zero).toFixed(2);
		} else {
			e.value = '' + number;
		}
	}

	function showModalATC(flag) {
		if (d.getElementById('frm2551Qv2018:btn14B').disabled == false) {
			rowFlag = flag;

			//d.getElementById('formPaper').style.display = "inline";
			//d.getElementById('modalAtc').style.display = "block";
			d.getElementById('formPaper').style.display = "none";
			$('#modalAtc').show('blind');

			populateATC();

			var x = 1;
			var innerText = "";
			while (x < codeATC.length) {
				innerText = innerText +
					"<tr class='atc'><td width='5%' class='atc'><center><input type='radio' id='frm2551Qv2018:optATC" + x + "' name='frm2551Qv2018:optATC' /></center></td>" +
					"<td align='left' width='15%' class='atc'>" + codeATC[x] + "%</td>" +
					"<td align='left' width='55%' class='atc atcNames'>" + descATC[x] + "</td>" +
					"<td align='left' width='15%' class='atc'>" + rateATC[x] + "%</td></tr>";

				x++;
			}

			//d.getElementById('tBodyOfATC').innerHTML = innerText;
			$('#tBodyOfATC').html(innerText);
		}
		else {
			return false;
		}
	}

	function hideModalATC() {
		//d.getElementById('formPaper').style.display = 'block';
		//d.getElementById('modalAtc').style.display = 'none';
		//d.getElementById('DummyTxt').innerHTML = "Creator";
		//d.getElementById('DummyTxt').innerHTML = "";
		d.getElementById('formPaper').style.display = 'block';
		if ($('#modalAtc').css('display') != 'none') {
			$('#modalAtc').hide('blind');
		}
		$('#DummyTxt').html("Creator");
		$('#DummyTxt').html("");
	}

	function getATCCode() {
		var x = 1;
		var isOptChecked;
		while (x < codeATC.length) {
			isOptChecked = d.getElementById('frm2551Qv2018:optATC' + x).checked;
			if (isOptChecked) {
				if (compareATC(codeATC[x])) {
					return;
				} else {
					if (rowFlag == "14") {
						d.getElementById('frm2551Qv2018:txtTax14A').value = descATC[x];
						d.getElementById('frm2551Qv2018:txtTax14B').value = codeATC[x];
						d.getElementById('frm2551Qv2018:txtTax14D').value = rateATC[x];
						computeTaxDue('frm2551Qv2018:txtTax14C', 'frm2551Qv2018:txtTax14D', 'frm2551Qv2018:txtTax14E');
					} else if (rowFlag == "15") {
						d.getElementById('frm2551Qv2018:txtTax15A').value = descATC[x];
						d.getElementById('frm2551Qv2018:txtTax15B').value = codeATC[x];
						d.getElementById('frm2551Qv2018:txtTax15D').value = rateATC[x];
						computeTaxDue('frm2551Qv2018:txtTax15C', 'frm2551Qv2018:txtTax15D', 'frm2551Qv2018:txtTax15E');
					} else if (rowFlag == "16") {
						d.getElementById('frm2551Qv2018:txtTax16A').value = descATC[x];
						d.getElementById('frm2551Qv2018:txtTax16B').value = codeATC[x];
						d.getElementById('frm2551Qv2018:txtTax16D').value = rateATC[x];
						computeTaxDue('frm2551Qv2018:txtTax16C', 'frm2551Qv2018:txtTax16D', 'frm2551Qv2018:txtTax16E');
					} else if (rowFlag == "17") {
						d.getElementById('frm2551Qv2018:txtTax17A').value = descATC[x];
						d.getElementById('frm2551Qv2018:txtTax17B').value = codeATC[x];
						d.getElementById('frm2551Qv2018:txtTax17D').value = rateATC[x];
						computeTaxDue('frm2551Qv2018:txtTax17C', 'frm2551Qv2018:txtTax17D', 'frm2551Qv2018:txtTax17E');
					} else if (rowFlag == "18") {
						d.getElementById('frm2551Qv2018:txtTax18A').value = descATC[x];
						d.getElementById('frm2551Qv2018:txtTax18B').value = codeATC[x];
						d.getElementById('frm2551Qv2018:txtTax18D').value = rateATC[x];
						computeTaxDue('frm2551Qv2018:txtTax18C', 'frm2551Qv2018:txtTax18D', 'frm2551Qv2018:txtTax18E');
					}

					clearATCFlag();
				}
			}
			x++;
		}

		hideModalATC();
	}

	function compareATC(atc) {
		/*
		var y = 0;
		while (y < atcFlag.length) {
			if (atcFlag[y] == atc) {
				alert("Invalid input. Selected ATC already defined.");
				return true;
			}
			y++;
		}
		return false;
		*/
	}

	function clearATCFlag() {
		/*
		atcFlag = new Array();
		var x = 14;
		while (x < 19) {
			if (d.getElementById('frm2551Qv2018:txtTax' + x + 'B').value != "") {
				atcFlag[atcFlag.length] = d.getElementById('frm2551Qv2018:txtTax' + x + 'B').value;
			}

			x++;
		}*/
	}

	function checkOverpayment() {
		/*if (NumWithComma(d.getElementById('frm2551Qv2018:txtTax23').value) < 0) {
			d.getElementById('frm2551Qv2018:opt23_1').disabled = false;
			d.getElementById('frm2551Qv2018:opt23_2').disabled = false;
		} else {
			d.getElementById('frm2551Qv2018:opt23_1').disabled = true;
			d.getElementById('frm2551Qv2018:opt23_2').disabled = true;
			d.getElementById("frm2551Qv2018:opt23_1").checked = false;
			d.getElementById("frm2551Qv2018:opt23_2").checked = false;

		}*/
	}

	function computeTaxDue(taxAmount, taxRate, taxDue) {
		//d.getElementById(taxDue).value = formatCurrency(((NumWithComma(d.getElementById(taxAmount).value) * 1) / 100) * (NumWithComma(d.getElementById(taxRate).value) * 1));

		//computeTotalTaxDue();
	}

	function computeTotalTaxDue() {
		//var total = 0;
		//var x = 14;
		//while (x < 19) {
		//total = (total * 1) + (NumWithComma(d.getElementById('frm2551Qv2018:txtTax' + x + 'E').value) * 1);
		//x++;
		//}
		//d.getElementById('frm2551Qv2018:txtTax19').value = formatCurrency(total * 1);

		//computeTaxPayable();
	}

	function computeTotalTaxCreditForm2551Qv2018() {
		//d.getElementById('frm2551Qv2018:txtTax20C').value = formatCurrency((NumWithComma(d.getElementById('frm2551Qv2018:txtTax20A').value) * 1) + (NumWithComma(d.getElementById('frm2551Qv2018:txtTax20B').value) * 1));

		//computeTaxPayable();
	}

	function computeTaxPayable() {
		//d.getElementById('frm2551Qv2018:txtTax21').value = formatCurrency((NumWithComma(d.getElementById('frm2551Qv2018:txtTax19').value) * 1) - (NumWithComma(d.getElementById('frm2551Qv2018:txtTax20C').value) * 1));

		//computeTotalAmountPayable();
	}
	function computePenalties() {
		//d.getElementById('frm2551Qv2018:txtTax22D').value = formatCurrency(NumWithComma(d.getElementById('frm2551Qv2018:txtTax22A').value) * 1 + NumWithComma(d.getElementById('frm2551Qv2018:txtTax22B').value) * 1 + NumWithComma(d.getElementById('frm2551Qv2018:txtTax22C').value) * 1);
		//computeTotalAmountPayable();
	}
	function computeTotalAmountPayable() {
		//d.getElementById('frm2551Qv2018:txtTax23').value = formatCurrency((NumWithComma(d.getElementById('frm2551Qv2018:txtTax21').value) * 1) + (NumWithComma(d.getElementById('frm2551Qv2018:txtTax22D').value) * 1));
		//d.getElementById('frm2551Qv2018:txtTax23').value = formatCurrency((NumWithComma(d.getElementById('frm2551Qv2018:txtTax21').value)*1));

		//checkOverpayment();
	}

	function validateYear() {

	if (d.getElementById("frm2551Qv2018:txtYear").value < 2018) {
		alert("Please file using the old version of the form.");
		d.getElementById("frm2551Qv2018:txtYear").value = "2018";
	}
}

	function validateForm() {
		var m = new Date();
		var dt = new Date();

		if (d.getElementById('frm2551Qv2018:forThe_1').checked == false && d.getElementById('frm2551Qv2018:forThe_2').checked == false) {
			alert("Select a calendar type on Item no. 1.")
			return;
		}
		if (d.getElementById('frm2551Qv2018:rtnMonth').selectedIndex * 1 == 0) {
			alert("Please enter valid Year Ended month on item 2.")
			return;
		}

	
		if (d.getElementById('frm2551Qv2018:txtYear').value * 1 < 1900) {
			alert("Invalid date entry on Item no.2. Entry should not be lower than 1900.")
			return;
		}
		if (d.getElementById('frm2551Qv2018:qtr_1').checked == false && d.getElementById('frm2551Qv2018:qtr_2').checked == false && d.getElementById('frm2551Qv2018:qtr_3').checked == false && d.getElementById('frm2551Qv2018:qtr_4').checked == false) {
			alert("Select a Quarter on Item no. 3.")
			return;
		}
		
		if (d.getElementById('frm2551Qv2018:txtYear').value == "") {
			alert("Please enter valid year on item 2.");
			return;
		}

		if ((d.getElementById('frm2551Qv2018:txtTIN1').value == "" || d.getElementById('frm2551Qv2018:txtTIN2').value == "" || d.getElementById('frm2551Qv2018:txtTIN3').value == "" || d.getElementById('frm2551Qv2018:txtBranchCode').value == "")) {
			alert("Please enter a valid TIN number on Item 6.");
			return;
		}

		if(d.getElementById('frm2551Qv2018:txtRDOCode').value == "")  {
			alert("Please enter a valid RDO Code on Item 7.");
			return;
		}
		//if ((d.getElementById('frm2551Qv2018:txtLineofBus').value == "")) {
			//alert("Please enter a valid Line of Business/Occupation on Item 8.");
			//return;
		//}
		if ((d.getElementById('frm2551Qv2018:registeredName').value == "")) {
			alert("Please enter a valid Taxpayer Name on Item 8.");
			return;
		}
		if ((d.getElementById('frm2551Qv2018:telNo').value == "")) {
			alert("Please enter Telephone Number on Item 10.");
			return;
		}
		if ((d.getElementById('frm2551Qv2018:registeredAddress').value == "")) {
			alert("Please enter Taxpayer's Registered Address on Item 9.");
			return;
		}
		if ((d.getElementById('frm2551Qv2018:zipCode').value == "")) {
			alert("Please enter Zip Code on Item 9A.");
			return;
		}


		if (d.getElementById('frm2551Qv2018:taxTreaty_1').checked && d.getElementById('frm2551Qv2018:txtTaxReliefSpecify').selectedIndex == 0) {
			alert("Please specify Tax Relief on Item 12.")
			return;
		}

		if(d.getElementById('frm2551Qv2018:taxRate1').checked == false && d.getElementById('frm2551Qv2018:taxRate2').checked == false){
			alert("Please specify Tax Relief on Item 13.")
			return;
		}

		if (d.getElementById('frm2551Qv2018:txt24').value < 0) {
			if (d.getElementById('frm2551Qv2018:overPayment1').checked == false && d.getElementById('frm2551Qv2018:overPayment2').checked == false) {
				alert("Please specify If overpayment below Item 24.")
				return;
			}
		}

		if (NumWithComma(d.getElementById('frm2551Qv2018:txt24').value) < 0) {
			if (d.getElementById('frm2551Qv2018:overPayment1').checked == false && d.getElementById('frm2551Qv2018:overPayment2').checked == false) {
				alert("Please select overpayment option.");
				return;
			}
		}
		

		//if (NumWithComma(d.getElementById('frm2551Qv2018:txtTax23').value) * 1 < 0) {
			//if (d.getElementById('frm2551Qv2018:opt23_1').checked == false && d.getElementById('frm2551Qv2018:opt23_2').checked == false) {
				//alert("Please select an option on item no. 24.")
				//return;
			//}
		//}

		d.getElementById('frm2551Qv2018:cmdValidate').disabled = true;
		d.getElementById('frm2551Qv2018:cmdEdit').disabled = false;
		d.getElementById('frm2551Qv2018:btnFinalCopy').disabled = false;
		d.getElementById('btnPrint').disabled = false;
		//d.getElementById('frm2551Qv2018:txtTaxReliefSpecify').disabled = true;

		enableDisabledFields(true);

		alert("Validation successful. Click on Edit if you wish to modify your entries.");
		return;
	}

	function editForm() {

		enableDisabledFields(false);
		taxRateOption();
		refundOption();

		d.getElementById('frm2551Qv2018:cmdValidate').disabled = false;
		d.getElementById('frm2551Qv2018:cmdEdit').disabled = true;
		d.getElementById('btnSave').disabled = false;
		d.getElementById('btnPrint').disabled = true;
		d.getElementById('frm2551Qv2018:btnFinalCopy').disabled = true;
	}

	var disableElem = true;
	var enableElem = false;
	function enableDisabledFields(param) {
		//woi
		//changes
		/*if (d.getElementById('frm2551Qv2018:forThe_1').checked) {
			d.getElementById('frm2551Qv2018:rtnMonth').disabled = true;
		} else {
			d.getElementById('frm2551Qv2018:rtnMonth').disabled = param;
		}
		d.getElementById('frm2551Qv2018:txtYear').disabled = param;
		d.getElementById('frm2551Qv2018:qtr_1').disabled = param;
		d.getElementById('frm2551Qv2018:qtr_2').disabled = param;
		d.getElementById('frm2551Qv2018:qtr_3').disabled = param;
		d.getElementById('frm2551Qv2018:qtr_4').disabled = param;
		d.getElementById('frm2551Qv2018:amendedRtn_1').disabled = param;
		d.getElementById('frm2551Qv2018:amendedRtn_2').disabled = param;
		d.getElementById('frm2551Qv2018:txtSheets').disabled = param;
		d.getElementById('frm2551Qv2018:txtTIN1').disabled = param;
		d.getElementById('frm2551Qv2018:txtTIN2').disabled = param;
		d.getElementById('frm2551Qv2018:txtTIN3').disabled = param;
		d.getElementById('frm2551Qv2018:txtBranchCode').disabled = param;
		d.getElementById('frm2551Qv2018:txtRDOCode').disabled = param;
		d.getElementById('frm2551Qv2018:txtLineofBus').disabled = param;
		d.getElementById('frm2551Qv2018:registeredName').disabled = param;
		d.getElementById('frm2551Qv2018:telNo').disabled = param;
		d.getElementById('frm2551Qv2018:registeredAddress').disabled = param;
		d.getElementById('frm2551Qv2018:zipCode').disabled = param;
		d.getElementById('frm2551Qv2018:taxTreaty_1').disabled = param;
		d.getElementById('frm2551Qv2018:taxTreaty_2').disabled = param;
		d.getElementById('frm2551Qv2018:btn14B').disabled = param;
		d.getElementById('frm2551Qv2018:btn15B').disabled = param;
		d.getElementById('frm2551Qv2018:btn16B').disabled = param;
		d.getElementById('frm2551Qv2018:btn17B').disabled = param;
		d.getElementById('frm2551Qv2018:btn18B').disabled = param;
		d.getElementById('frm2551Qv2018:txtTax14C').disabled = param;
		d.getElementById('frm2551Qv2018:txtTax15C').disabled = param;
		d.getElementById('frm2551Qv2018:txtTax16C').disabled = param;
		d.getElementById('frm2551Qv2018:txtTax17C').disabled = param;
		d.getElementById('frm2551Qv2018:txtTax18C').disabled = param;
		d.getElementById('frm2551Qv2018:txtTax20A').disabled = param;
		d.getElementById('frm2551Qv2018:txtTax20B').disabled = param;
		d.getElementById('frm2551Qv2018:txtTax22A').disabled = param;
		d.getElementById('frm2551Qv2018:txtTax22B').disabled = param;
		d.getElementById('frm2551Qv2018:txtTax22C').disabled = param;

		//checkOverpayment();
		*/

		d.getElementById('frm2551Qv2018:forThe_1').disabled = param;
		d.getElementById('frm2551Qv2018:forThe_2').disabled = param;
		d.getElementById('frm2551Qv2018:txtYear').disabled = param;
		d.getElementById('frm2551Qv2018:txtSheets').disabled = param;
		
		d.getElementById('frm2551Qv2018:qtr_1').disabled = param;
		d.getElementById('frm2551Qv2018:qtr_2').disabled = param;
		d.getElementById('frm2551Qv2018:qtr_3').disabled = param;
		d.getElementById('frm2551Qv2018:qtr_4').disabled = param;
		d.getElementById('frm2551Qv2018:amendedRtn_1').disabled = param;
		d.getElementById('frm2551Qv2018:amendedRtn_2').disabled = param;
		d.getElementById('frm2551Qv2018:taxTreaty_1').disabled = param;
		d.getElementById('frm2551Qv2018:taxTreaty_2').disabled = param;
		d.getElementById('frm2551Qv2018:txtTaxReliefSpecify').disabled = param;
		d.getElementById('frm2551Qv2018:taxRate1').disabled = param;
		d.getElementById('frm2551Qv2018:taxRate2').disabled = param;
		//d.getElementById('frm2551Qv2018:txt14').disabled = param;
		d.getElementById('frm2551Qv2018:txt15').disabled = param;
		
		//16 is conditional
		if(d.getElementById('frm2551Qv2018:amendedRtn_1').checked == true)
		{
			d.getElementById('frm2551Qv2018:txt16').disabled = param;
			/*if(param == true)
			{
				d.getElementById('frm2551Qv2018:txt16').disabled = param;
			}
			else{
				d.getElementById('frm2551Qv2018:txt16').disabled = param;
			}*/
		}

		d.getElementById('frm2551Qv2018:txt17Specify').disabled = param;
		d.getElementById('frm2551Qv2018:txt17').disabled = param;
		//d.getElementById('frm2551Qv2018:txt18').disabled = param;
		//d.getElementById('frm2551Qv2018:txt19').disabled = param;
		d.getElementById('frm2551Qv2018:txt20').disabled = param;
		d.getElementById('frm2551Qv2018:txt21').disabled = param;
		d.getElementById('frm2551Qv2018:txt22').disabled = param;
		//d.getElementById('frm2551Qv2018:txt23').disabled = param;
		//d.getElementById('frm2551Qv2018:txt24').disabled = param;
		d.getElementById('frm2551Qv2018:overPayment1').disabled = param;
		d.getElementById('frm2551Qv2018:overPayment2').disabled = param;
		d.getElementById('drpATC1').disabled = param;
		d.getElementById('txtATCAmt1').disabled = param;
		d.getElementById('drpATC2').disabled = param;
		d.getElementById('txtATCAmt2').disabled = param;
		d.getElementById('drpATC3').disabled = param;
		d.getElementById('txtATCAmt3').disabled = param;
		d.getElementById('drpATC4').disabled = param;
		d.getElementById('txtATCAmt4').disabled = param;
		d.getElementById('drpATC5').disabled = param;
		d.getElementById('txtATCAmt5').disabled = param;
		d.getElementById('drpATC6').disabled = param;
		d.getElementById('txtATCAmt6').disabled = param;
		


		//updateAmended();
		disableElem;
		enableElem;
	}

	function getRdo() {
		var data = "<select class='iceSelOneMnu' disabled='true' id='frm2551Qv2018:txtRDOCode' name='frm2551Qv2018:txtRDOCode' size='1' ><option value='000'> </option>";

		for (var i = 0; i < rdoList.length; i++) {
			var rdo = rdoList[i];
			data = data + "<option value='" + rdo.rdoCode + "'>" + rdo.description + "</option>";

		}
		data = data + "</select>"

		$('#rdoSelect').html(data);

	}

	function blockletterWithout2Decimal(e) {
		var number = parseFloat(e.value);
		if (isNaN(number)) {
			e.value = "";
		} else {
			e.value = '' + number.toFixed(0);
		}
	}

	function chageTreaty() {
		if (d.getElementById('frm2551Qv2018:taxTreaty_1').checked) {
			d.getElementById('frm2551Qv2018:txtTaxReliefSpecify').disabled = false;
		} else {
			d.getElementById('frm2551Qv2018:txtTaxReliefSpecify').disabled = true;
			d.getElementById('frm2551Qv2018:txtTaxReliefSpecify').selectedIndex = 0;
		}
	}

	function updateAmended() {
		if (d.getElementById('frm2551Qv2018:amendedRtn_1').checked) {

			if (d.getElementById('frm2551Qv2018:taxRate2').checked == false) {
				d.getElementById('frm2551Qv2018:txt16').disabled = false;
				d.getElementById('frm2551Qv2018:txt16').backgroundColor = "#ffffff";
				i4AmendedYes = "True";
			}
			
		} else if (d.getElementById('frm2551Qv2018:amendedRtn_2').checked) {
			d.getElementById('frm2551Qv2018:txt16').disabled = true;
			//d.getElementById('frm2551Qv2018:txt16').style.backgroundColor = "#e2e2e2";
			d.getElementById('frm2551Qv2018:txt16').style.backgroundColor = "";

			d.getElementById('frm2551Qv2018:txt16').value = "0.00";
			i4AmendedYes = "False";

			computeAll();
		}
	}

	function initialValidateBeforeSave() {
		if (d.getElementById('frm2551Qv2018:rtnMonth').selectedIndex * 1 == 0) {
			alert("Please enter valid Year Ended month on item 2.")
			return false;
		}
		if (d.getElementById('frm2551Qv2018:qtr_1').checked == false && d.getElementById('frm2551Qv2018:qtr_2').checked == false && d.getElementById('frm2551Qv2018:qtr_3').checked == false && d.getElementById('frm2551Qv2018:qtr_4').checked == false) {
			alert("Select a Quarter on Item no. 3.")
			return false;
		}
		if ((d.getElementById('frm2551Qv2018:txtTIN1').value == "" || d.getElementById('frm2551Qv2018:txtTIN2').value == "" || d.getElementById('frm2551Qv2018:txtTIN3').value == "" || d.getElementById('frm2551Qv2018:txtBranchCode').value == "")) {
			alert("Please enter a valid TIN number on Item 6.");
			return false;
		}
		//if ((d.getElementById('frm2551Qv2018:txtRDOCode').value == "000")) {
			//alert("Please enter a valid RDO Code on Item 7.");
			//return false;
		//}
		if ((d.getElementById('frm2551Qv2018:registeredName').value == "")) {
			alert("Please enter a valid Taxpayer Name on Item 9.");
			return false;
		}
		return true;
	}
	//topNav
	$(document).ready(function () {
		$("ul.subnav").parent().append("<span></span>"); //Only shows drop down trigger when js is enabled (Adds empty span tag after ul.subnav*)  
		$("ul.topnav li span").click(function () { //When trigger is clicked...            
			//Following events are applied to the subnav itself (moving subnav up and down)  
			$(this).parent().find("ul.subnav").slideDown('fast').show(); //Drop down the subnav on click    
			$(this).parent().hover(function () {
			}, function () {
				$(this).parent().find("ul.subnav").slideUp('slow'); //When the mouse hovers out of the subnav, move it back up  
			});
			//Following events are applied to the trigger (Hover events for the trigger)  
		}).hover(function () {
			$(this).addClass("subhover"); //On hover over, add class "subhover"  
		}, function () {  //On Hover Out  
			$(this).removeClass("subhover"); //On hover out, remove class "subhover"  
		});
		$("ul.topnav .toplevel").click(function () { //When trigger is clicked...            
			//Following events are applied to the subnav itself (moving subnav up and down)  
			$(this).parent().find("ul.subnav").slideDown('fast').show(); //Drop down the subnav on click    
			$(this).parent().hover(function () {
			}, function () {
				$(this).parent().find("ul.subnav").slideUp('slow'); //When the mouse hovers out of the subnav, move it back up  
			});
			//Following events are applied to the trigger (Hover events for the trigger)  
		}).hover(function () {
			$(this).addClass("subhover"); //On hover over, add class "subhover"  
		}, function () {  //On Hover Out  
			$(this).removeClass("subhover"); //On hover out, remove class "subhover"  
		});

		//added 07/25/2015
		$('#ebirOnlineConfirmUsername, #ebirOnlineConfirmPassword, #ebirOnlinePassword, #ebirOnlineUsername').bind('paste drag drop', function (e) {
			e.preventDefault();
		});
	});
	function loadBGXML(loadWhere) {
		try {
			//This will load the file with filename loadWhere if it exists
			var fsoXML = new ActiveXObject("Scripting.FileSystemObject");
			XMLBGFile = fsoXML.OpenTextFile(loadWhere, 1);
			if (XMLBGFile.AtEndOfStream) {
				data = "";
			} else {
				var responseBG = d.getElementById('responseBG'); //render file and write to hidden div
				responseBG.innerHTML = XMLBGFile.ReadAll(); //remove XML tag			
			}
			XMLBGFile.Close();
			//alert( responseBG.innerHTML ); //Debug				
			loadBGData();	/*This will load data onto fields*/
		} catch (e) {
			msg.innerHTML = "";
		}
	}

	function loadBGData() {
		/*This will load data onto Background Information fields*/
		var responseBG = d.getElementById("responseBG");

		var formTypeVal = String(responseBG.innerHTML).split('formType='); //form_type

		if (formTypeVal[1] == '2551Qv2018') {

			var fnVal = String(responseBG.innerHTML).split('fn=');
			d.getElementById('frm2551Qv2018:registeredName').value = unescape(fnVal[1]);
			d.getElementById('frm2551Qv2018:txtPg2TaxpayerName').value = unescape(fnVal[1]);

			var tin1Val = String(responseBG.innerHTML).split('tin1=');
			d.getElementById('frm2551Qv2018:txtTIN1').value = tin1Val[1];
			d.getElementById('frm2551Qv2018:txtPg2TIN1').value = tin1Val[1];

			var tin2Val = String(responseBG.innerHTML).split('tin2=');
			d.getElementById('frm2551Qv2018:txtTIN2').value = tin2Val[1];
			d.getElementById('frm2551Qv2018:txtPg2TIN2').value = tin2Val[1];

			var tin3Val = String(responseBG.innerHTML).split('tin3=');
			d.getElementById('frm2551Qv2018:txtTIN3').value = tin3Val[1];
			d.getElementById('frm2551Qv2018:txtPg2TIN3').value = tin3Val[1];

			var tin4Val = String(responseBG.innerHTML).split('tin4=');
			d.getElementById('frm2551Qv2018:txtBranchCode').value = tin4Val[1];
			d.getElementById('frm2551Qv2018:txtPg2BranchCode').value = tin4Val[1];

			var rdoVal = String(responseBG.innerHTML).split('rdo=');
			d.getElementById('frm2551Qv2018:txtRDOCode').value = rdoVal[1];

			var lobVal = String(responseBG.innerHTML).split('lob=');
			//d.getElementById('frm2551Qv2018:txtLineofBus').value = unescape(lobVal[1]);
			tp_lob = unescape(lobVal[1]);

			var regAddrVal = String(responseBG.innerHTML).split('regAddr=');
			d.getElementById('frm2551Qv2018:registeredAddress').value = unescape(regAddrVal[1]);

			var zipVal = String(responseBG.innerHTML).split('zip=');
			d.getElementById('frm2551Qv2018:zipCode').value = zipVal[1];

			var telNoVal = String(responseBG.innerHTML).split('telNo=');
			d.getElementById('frm2551Qv2018:telNo').value = telNoVal[1];
		}

		var emailVal = String(responseBG.innerHTML).split('email=');
		if (emailVal[1] === undefined) {
			document.getElementById('txtEmail').value = "";
		}
		else {
			document.getElementById('txtEmail').value = emailVal[1];
			globalEmail = emailVal[1];
		}
		
	}

	function createXMLProfileName() {
		try {
			var xmlFileName = "";

			var titleTin1 = d.getElementById('frm2551Qv2018:txtTIN1');
			var titleTin2 = d.getElementById('frm2551Qv2018:txtTIN2');
			var titleTin3 = d.getElementById('frm2551Qv2018:txtTIN3');
			var titleBranchCode = d.getElementById('frm2551Qv2018:txtBranchCode');
			var titleTPName = d.getElementById('frm2551Qv2018:registeredName');
			var formType = "2551Qv2018";

			//woi
			//for dev purposes
			//xmlFileName = "E:\\BIR\\ebirforms\\profile\\" + titleTin1.value + titleTin2.value + titleTin3.value + titleBranchCode.value + ".xml";
			xmlFileName = "profile/" + titleTin1.value + titleTin2.value + titleTin3.value + titleBranchCode.value + ".xml";
			

			return xmlFileName;
		} catch (e) {
			alert('Exception : ' + e.description);
		}
	}

	function saveXMLProfile(isFinalCopy) {
		if (gIsReadOnly == false) {
			var valid = initialValidateBeforeSave();

			if (valid == true) {

				var xmlFileName = createXMLProfileName();

				msg.innerHTML = 'Generating File...';
				var fileSys = new ActiveXObject("Scripting.FileSystemObject");
				var xmlFile = fileSys.CreateTextFile(xmlFileName); //(saveWhere);

				var allXML = "<?xml version='1.0'?>", tab = d.getElementById('xmlFormat').innerHTML;
				allXML += tab; //adds line break			

				allXML += "<div>fn=" + escape(d.getElementById('frm2551Qv2018:registeredName').value) + "fn=</div>" + tab;
				allXML += "<div>tin1=" + d.getElementById('frm2551Qv2018:txtTIN1').value + "tin1=</div>" + tab;
				allXML += "<div>tin2=" + d.getElementById('frm2551Qv2018:txtTIN2').value + "tin2=</div>" + tab;
				allXML += "<div>tin3=" + d.getElementById('frm2551Qv2018:txtTIN3').value + "tin3=</div>" + tab;
				allXML += "<div>tin4=" + d.getElementById('frm2551Qv2018:txtBranchCode').value + "tin4=</div>" + tab;
				allXML += "<div>rdo=" + d.getElementById('frm2551Qv2018:txtRDOCode').value + "rdo=</div>" + tab;
				//allXML += "<div>lob=" + escape(d.getElementById('frm2551Qv2018:txtLineofBus').value) + "lob=</div>" + tab;
				allXML += "<div>lob=" + escape(tp_lob) + "lob=</div>" + tab;
				allXML += "<div>regAddr=" + escape(d.getElementById('frm2551Qv2018:registeredAddress').value) + "regAddr=</div>" + tab;
				allXML += "<div>zip=" + d.getElementById('frm2551Qv2018:zipCode').value + "zip=</div>" + tab;
				allXML += "<div>telNo=" + d.getElementById('frm2551Qv2018:telNo').value + "telNo=</div>" + tab;
				allXML += "<div>email=" + document.getElementById('txtEmail').value + "email=</div>" + tab; allXML += "<div>confirmemail=" + document.getElementById('txtEmail').value + "confirmemail=</div>" + tab;
				allXML += "<div>confirmtin1=" + d.getElementById('frm2551Qv2018:txtTIN1').value + "confirmtin1=</div>" + tab;
				allXML += "<div>confirmtin2=" + d.getElementById('frm2551Qv2018:txtTIN2').value + "confirmtin2=</div>" + tab;
				allXML += "<div>confirmtin3=" + d.getElementById('frm2551Qv2018:txtTIN3').value + "confirmtin3=</div>" + tab;
				allXML += "<div>confirmtin4=" + d.getElementById('frm2551Qv2018:txtBranchCode').value + "confirmtin4=</div>" + tab;
				allXML += "<div>formType=2551Qv2018formType=</div>" + tab;

				allXML += tab + d.getElementById('xmlClose').innerHTML;

				xmlFile.write(allXML);
				xmlFile.close();
				msg.innerHTML = '';

				if (isFinalCopy == false) {
					alert('Background information saved/updated successfully as : ' + xmlFileName);
				}
			}
		}
	}
	function cancel() {

		$('#bg').show();
		$('.printSignFooterClass').hide();
		$('.imgClass').hide();
		$('body').css('background', '#FFF');
		$('#formPaper').css({ 'width': 'auto', 'border': '#CCC 1px solid', 'margin': '0 auto', 'background': '#FFF' });

		
		$('#wrapper').css({ 'width': 'auto', 'padding': '1%', 'margin': '0 auto', 'position': 'relative' });
		$('#container').css({ 'width': '800px', 'padding-top': '70px', 'margin': '0 auto' });

		var elem = document.getElementById('frmMain').elements;
		for (var i = 0; i < elem.length; i++) {
			if (elem[i].type != 'hidden') { // && elem[i].type != 'undefined' 
				if (elem[i].type == 'text') {
					document.getElementById(elem[i].id).readOnly = false;
					if (d.getElementById('frm2551Qv2018:cmdValidate').disabled == false) {
						if (disabledItems.contains(elem[i].id)) {
							document.getElementById(elem[i].id).disabled = true;
						}
						else {
							document.getElementById(elem[i].id).disabled = false;
						}
					}
					else {
						if (disabledItems.contains(elem[i].id)) {
							document.getElementById(elem[i].id).disabled = true;
						}
						else {
							document.getElementById(elem[i].id).disabled = false;
						}
					}
				}
				if (elem[i].type == 'radio' || elem[i].type == 'checkbox' || elem[i].type == 'select-one') {
					if (d.getElementById('frm2551Qv2018:cmdValidate').disabled == false) {
						if (disabledItems.contains(elem[i].id)) {
							document.getElementById(elem[i].id).disabled = true;
						}
						else {
							document.getElementById(elem[i].id).disabled = false;
						}
					}
					else {
						if (disabledItems.contains(elem[i].id)) {
							document.getElementById(elem[i].id).disabled = true;
						}
						else {
							document.getElementById(elem[i].id).disabled = false;
						}
					}
				}

			}
		}

		$('input').each(function () {
			if (this.type == 'button') {
				if (this.id != 'test') {
					$(this).removeClass('previewButtonClass');
				}
			}
		});

		$('a').each(function () {
			if (this.id.length > 1) {
				if (d.getElementById('frm2551Qv2018:cmdValidate').disabled == false) {
					if (enableElem) {
						d.getElementById(this.id).disabled = true;
					}
					else if (disableElem) {
						d.getElementById(this.id).disabled = false;
					}
				}
				else {
					if (disableElem) {
						d.getElementById(this.id).disabled = true;
					}
					else if (enableElem) {
						d.getElementById(this.id).disabled = false;
					}
				}
			}
		});

		$('#formMenu').show('blind');
		if ($('#printMenu').css('display') != 'none') {
			$('#printMenu').hide('blind');
		}

		if (qs('xmlFileName') != null && qs('xmlFileName').indexOf('.xml') > -1) {
			d.getElementById('frm2551Qv2018:forThe_1').disabled = true;
			d.getElementById('frm2551Qv2018:forThe_2').disabled = true;
			d.getElementById('frm2551Qv2018:rtnMonth').disabled = true;
			d.getElementById('frm2551Qv2018:txtYear').disabled = true;
		}

	}

	Array.prototype.contains = Array.prototype.indexOf ?
		function (val) {
			return this.indexOf(val) > -1;
		} :
		function (val) {
			var i = this.length;
			while (i--) {
				if (this[i] === val) {
					return true;
				}
			}
			return false;
		};

	var disabledItems = new Array();
	function printme() {
	
		$('#bg').hide();
		$('.printSignFooterClass').css({ 'width':'94%','margin':'auto','margin-top':'15px','display':'block','position':'relative','overflow':'visible','page-break-before':'always', 'background':'#ffffff' });	
		//$('.printSignFooterClass').css({ 'width': 'auto', 'margin': 'auto', 'margin-top': '15px', 'display': 'block', 'position': 'relative', 'overflow': 'visible', 'page-break-before': 'always' });
		$('.imgClass').css({ 'margin': 'auto', 'display': 'block', 'position': 'relative', 'overflow': 'visible' });
		$('body').css('background', '#FFF');

		$('#formPaper').css({ 'max-width': '8.3in !important', 'border': '#000 3px solid' });
		$('#wrapper').css({ 'max-width': '8.3in !important' });
		$('#container').css({ 'max-width': '8.3in !important' });

		var elem = document.getElementById('frmMain').elements;
		var x = 0;
		disabledItems = new Array();
		for (var i = 0; i < elem.length; i++) {
			if (elem[i].type != 'hidden') { // && elem[i].type != 'undefined' 
				if (elem[i].type == 'text') {
					if (document.getElementById(elem[i].id).disabled) {
						disabledItems[x] = elem[i].id;
						x++;
					}
					document.getElementById(elem[i].id).disabled = false;
					document.getElementById(elem[i].id).readOnly = true;
					document.getElementById(elem[i].id).style.backgroundColor = '#FFFFFF';
					document.getElementById(elem[i].id).style.color = '#000000';
				}
				if (elem[i].type == 'radio' || elem[i].type == 'checkbox' || elem[i].type == 'select-one') {
					if (document.getElementById(elem[i].id).disabled) {
						disabledItems[x] = elem[i].id;
						x++;
					}
					document.getElementById(elem[i].id).disabled = true;
				}

			}
		}

		$('input').each(function () {
			if (this.type == 'button') {
				if (this.id != 'test') {
					$(this).addClass('previewButtonClass');
				}
			}
		});

		$('a').each(function () {
			if (this.id.length > 1) {
				d.getElementById(this.id).disabled = true;
			}
		});

		$('#printMenu').show('blind');
		if ($('#formMenu').css('display') != 'none') {
			$('#formMenu').hide('blind');
		}

		alert("This form must be printed on Legal Size Paper. Please update your Printer Settings (Set Paper Size to Legal under Preferences -> Advanced) to ensure the correct printout of the form.\n\n" +
			"If applicable, open Internet Explorer, go to File -> Page Setup and change Page Size to Legal, all Margins must be 0.166, Enable Shrink-to-Fit must be unchecked, and all Headers & Footers must be set to empty.");

		document.getElementById('frm2551Qv2018:txtCurrentPage').disabled = false;
		document.getElementById('frm2551Qv2018:txtCurrentPage').readOnly = false;
	}

	$(document).ready(function () {
		$("ul.subnav").parent().append("<span></span>"); //Only shows drop down trigger when js is enabled (Adds empty span tag after ul.subnav*)  
		$("ul.topnav li span").click(function () { //When trigger is clicked...            
			//Following events are applied to the subnav itself (moving subnav up and down)  
			$(this).parent().find("ul.subnav").slideDown('fast').show(); //Drop down the subnav on click    
			$(this).parent().hover(function () {
			}, function () {
				$(this).parent().find("ul.subnav").slideUp('slow'); //When the mouse hovers out of the subnav, move it back up  
			});
			//Following events are applied to the trigger (Hover events for the trigger)  
		}).hover(function () {
			$(this).addClass("subhover"); //On hover over, add class "subhover"  
		}, function () {  //On Hover Out  
			$(this).removeClass("subhover"); //On hover out, remove class "subhover"  
		});
		$("ul.topnav .toplevel").click(function () { //When trigger is clicked...            
			//Following events are applied to the subnav itself (moving subnav up and down)  
			$(this).parent().find("ul.subnav").slideDown('fast').show(); //Drop down the subnav on click    
			$(this).parent().hover(function () {
			}, function () {
				$(this).parent().find("ul.subnav").slideUp('slow'); //When the mouse hovers out of the subnav, move it back up  
			});
			//Following events are applied to the trigger (Hover events for the trigger)  
		}).hover(function () {
			$(this).addClass("subhover"); //On hover over, add class "subhover"  
		}, function () {  //On Hover Out  
			$(this).removeClass("subhover"); //On hover out, remove class "subhover"  
		});

		$("ul.asubnav").parent().append("<span style='display:none;'></span>"); //Only shows drop down trigger when js is enabled (Adds empty span tag after ul.subnav*)  
		$("ul.atopnav li span").click(function () { //When trigger is clicked...            
			//Following events are applied to the subnav itself (moving subnav up and down)  
			$(this).parent().find("ul.asubnav").slideDown('fast').show(); //Drop down the subnav on click    
			$(this).parent().hover(function () {
			}, function () {
				$(this).parent().find("ul.asubnav").slideUp('slow'); //When the mouse hovers out of the subnav, move it back up  
			});
			//Following events are applied to the trigger (Hover events for the trigger)  
		}).hover(function () {
			$(this).addClass("subhover"); //On hover over, add class "subhover"  
		}, function () {  //On Hover Out  
			$(this).removeClass("subhover"); //On hover out, remove class "subhover"  
		});
		$("ul.atopnav .atoplevel").click(function () { //When trigger is clicked...            
			//Following events are applied to the subnav itself (moving subnav up and down)  
			$(this).parent().find("ul.asubnav").slideDown('fast').show(); //Drop down the subnav on click    
			$(this).parent().hover(function () {
			}, function () {
				$(this).parent().find("ul.asubnav").slideUp('slow'); //When the mouse hovers out of the subnav, move it back up  
			});
			//Following events are applied to the trigger (Hover events for the trigger)  
		}).hover(function () {
			$(this).addClass("subhover"); //On hover over, add class "subhover"  
		}, function () {  //On Hover Out  
			$(this).removeClass("subhover"); //On hover out, remove class "subhover"  
		});
	});

	function encrypt(val) {

		//var bf = new Blowfish('i@f0ffl1n3F0rm$');
		//var ciphertext = bf.encrypt(val);

		var ciphertext = Aes.Ctr.encrypt(val, aesPW, 256);
		return ciphertext;
	}

	function showModalExport() {
		document.getElementById('container').style.display = "none"; //mainContent

		document.getElementById('driveSelectTPExport').disabled = false;
		document.getElementById('btnOkExport').disabled = false;
		document.getElementById('btnCancelExport').disabled = false;

		$('#modalExport').show('blind');
	}

	function cancelExportModal() {
		if ($('#modalExport').css('display') != 'none') {

			document.getElementById('container').style.display = 'block';
			$('#modalExport').hide('blind');
		}

		//refresh HTA page here. to address: 
		//Issue#380: A return tagged as final copy should not be edited by tp, rdo, rdc. Currently, user can still modify entries.
		//document.location.reload(true);
		disableAllElementIDs();
		d.getElementById('btnUpload').disabled = false;
	}

	function showModalImport() {
		$('#modalImport').show('blind');
	}

	function cancelImportModal() {
		if ($('#modalImport').css('display') != 'none') {
			$('#modalImport').hide('blind');
		}
	}
	function exportTPFiles(fnToExport) {
		try {
			var drive = d.getElementById('driveSelectTPExport').value;
			if (drive == '0') {
				alert("Please select the drive name of your USB flash drive or CD-RW."); return;
			}

			var fso, fldr;
			var sourceDir = "IAF_RDO_Copy/";
			var destDir = "IAF_RDO_Copy";
			fso = new ActiveXObject("Scripting.FileSystemObject");
			if (fso.FolderExists(sourceDir)) {
				if (fso.FolderExists(drive + destDir)) {
					//do nothing here...
				} else {
					fso.CreateFolder(drive + destDir);
				}
				fso.CopyFile(sourceDir + fnToExport, drive + destDir + "/");
			} else {
				alert("Copy Failed. No such directory: " + sourceDir); return;
			}

			alert("Successfully copied files to " + drive + destDir);
			cancelExportModal();

		} catch (e) {
			alert("No such drive or directory."); return;
		}

	}
	function exportTPFileInC() {
		try {
			var drive = "C:/";
			if (drive == '0') {
				alert("Please select the drive name of your USB flash drive or CD-RW."); return;
			}

			var fso, fldr;
			var sourceDir = "IAF_RDO_Copy/";
			var destDir = "IAF_RDO_Copy";
			fso = new ActiveXObject("Scripting.FileSystemObject");
			if (fso.FolderExists(sourceDir)) { //TODO: need to trap non-existing drive to avoid : "Error: Path not found"
				if (fso.FolderExists(drive + destDir)) {
					//do nothing here...
				} else {
					fso.CreateFolder(drive + destDir); //TODO: need to trap non-existing drive to avoid : "Error: Path not found"
				}
				fso.CopyFile(sourceDir + "*", drive + destDir + "/");
			} else {
				alert("Copy Failed. No such directory: " + sourceDir); return;
			}

			cancelExportModal();

		} catch (e) {
			alert("No such drive or directory."); return;
		}


	}
	function saveBeforeExit() {
		var y = confirm("Are you sure you want to exit?");
		if (y) {
			saveXML(false);
			//saveXMLProfile(false);
			try {
				deleteTemp();
				window.close(); self.close();
			}
			catch (err) {
				window.close(); self.close();
			}
		}
	}

	function validateItem2() {
		var dt = new Date();

		if (d.getElementById('frm2551Qv2018:txtYear').value == "") {
			alert("Please indicate a valid Year.");
			return;
		}
		if (d.getElementById('frm2551Qv2018:rtnMonth').value == 0) {
			alert("Please choose a valid Month.");
			return;
		}
		if (d.getElementById('frm2551Qv2018:txtYear').value * 1 > dt.getFullYear() * 1) {
			alert("Invalid date entry on Item 2. Entry should not be later than Current Date.")
			return;
		}
		if (d.getElementById('frm2551Qv2018:txtYear').value * 1 == dt.getFullYear() * 1 && d.getElementById('frm2551Qv2018:rtnMonth').value - 1 > dt.getMonth()) {
			alert("Invalid date entry on Item 2. Entry should not be later than Current Date.")
			return;
		}
	}

	function dateyear() {
		var year3 = new Date();
		if (d.getElementById('frm2551Qv2018:forThe_1').checked) {
			d.getElementById('frm2551Qv2018:rtnMonth').selectedIndex = 12;
			d.getElementById('frm2551Qv2018:rtnMonth').disabled = true;
			d.getElementById('frm2551Qv2018:txtYear').value = year3.getFullYear();
		}
		else {
			d.getElementById('frm2551Qv2018:rtnMonth').selectedIndex = 0;
			d.getElementById('frm2551Qv2018:rtnMonth').disabled = false;
			d.getElementById('frm2551Qv2018:txtYear').value = year3.getFullYear();
		}
	}
	function ShowContainer(param) {
		$('#' + param).show();
		//$('#container').hide();
	}

	function HideContainer(param) {
		if ($('#' + param).css('display') != 'none') {
			$('#' + param).hide();
		}
	}

	//Final Copy Button:
	function openAlertEmail() {
		var tinNumber = $('#frm2551Qv2018\\:txtTIN1').val() + $('#frm2551Qv2018\\:txtTIN2').val() + $('#frm2551Qv2018\\:txtTIN3').val();
		conService.initConConfig(tinNumber, '2551Qv2018');
		/*
		if (conService.canSendToEFPS()) {
			//Only '1700', '1701', '1702EX', '1702MX', '1702RT', '2200A', '2200T' are allowed to submit through eFPS
			//this block will never get executed.
			submitEbir();
		} else {
		*/
		if (document.getElementById('txtFinalFlag').value == '2') { reSendEmail(); return; }
		//woi
		//for dev purposes
		//var xmlFileName = createXMLFileName("E:\\BIR\\ebirforms\\savefile\\");
		var xmlFileName = createXMLFileName("savefile/");
		
		var isFileExists = doesFileExists(xmlFileName);
		var isAmendedReturn = isItAnAmendedReturn();

		//Added 10/21/2016
		var fileSys = new ActiveXObject("Scripting.FileSystemObject");
		var xmlFileNameValidate = "";

		//as of 10/21/2016
		//if there is already amended filed and will file a not amended,
		//it will restrict it
		if (isAmendedReturn == false) {

			if (xmlFileName.indexOf('V') == -1) {
				xmlFileNameValidate = xmlFileName.substring(xmlFileName.indexOf('/') + 1, xmlFileName.indexOf('.xml'));
			} else {
				xmlFileNameValidate = xmlFileName.substring(xmlFileName.indexOf('/') + 1, xmlFileName.indexOf('V'));
			}

			var hasVersion = false;
			//woi
			//for dev purposes
			//var objEnum = new Enumerator(fileSys.GetFolder("E:\\BIR\\ebirforms\\savefile\\").Files);
			var objEnum = new Enumerator(fileSys.GetFolder("savefile/").Files);
			
			for (i = 0; !objEnum.atEnd(); objEnum.moveNext()) {
				if (objEnum.item().name.indexOf(xmlFileNameValidate) > -1 && objEnum.item().name.indexOf("V") > -1) {
					hasVersion = true;
				}
			}
			if (hasVersion) {
				alert("If your intention is to make an amended return, kindly tick Amended Return to 'Yes' before hitting 'Save' or 'Final Copy' or 'Submit'.");
				return false;
			}
		}

		if (isFileExists) {
			isAFinalCopy = isItAFinalCopy(xmlFileName); if (document.getElementById('txtFinalFlag').value == '2') { isAFinalCopy = false; }
		}

		if (isFileExists && isAFinalCopy && isAmendedReturn == false && document.getElementById('txtFinalFlag').value != '3') {
			alert("If your intention is to make an amended return, kindly tick Amended Return to 'Yes' before hitting 'Save' or 'Final Copy' or 'Submit'."); ShowContainer('container');
			return false;
		}
		else {
			if (confirm("Please ensure that you have INTERNET access and a VALID email address is indicated in your tax return.\n\n" +
				"Are you sure you want to submit?") === true) {

				if (checkNetConnection() === true) {
					HideContainer("container"); if (document.getElementById('txtFinalFlag').value == "3") { document.getElementById('txtFinalFlag').value = "2" } else { document.getElementById('txtFinalFlag').value = "0" }; initializeOnOpenAlertEmail();
					ShowContainer("ebirEnroll");
				}
				else {
					alert("The system detected that you have no internet connection.\nPlease contact your internet service provider."); document.getElementById('txtFinalFlag').value = "3"; saveEncryptedProfile(); checkFinalCopyBtn('2551Qv2018');
					ShowContainer('container');//alert("There is no internet connection, please make sure that an internet connection is available before making a final copy.");
				}
			}
		}
		//}
	}





	function sendEmail(sourceElement) {

		var isRegisteredTP = (sourceElement.id !== "ebirOnlineConfirmSubmit") ? "N" : "Y"; if (isRegisteredTP == "Y" && (ValidateConfirm() == false)) { return; }
		var isAutoEnroll = (sourceElement.id == "ebirEnrollYes") ? "Y" : "N";
		if (isAutoEnroll == "Y") {
			document.getElementById("txtEnroll").value = "Y";
		}


		document.getElementById("ebirOnlineSecret").value = document.getElementById("ebirOnlinePassword").value; initializeOnSendEmail();










		var emailFilePath = saveEncryptedProfile(true);

		var dateSubmitted = new Date();

		var tpRDOCode = document.getElementById('frm2551Qv2018:txtRDOCode').value;
		var formType = "2551Qv2018";
		var tpTIN = document.getElementById('frm2551Qv2018:txtTIN1').value + document.getElementById('frm2551Qv2018:txtTIN2').value + document.getElementById('frm2551Qv2018:txtTIN3').value + document.getElementById('frm2551Qv2018:txtBranchCode').value;
		var qtr = "";
		if (document.getElementById('frm2551Qv2018:qtr_1').checked == true) {
			qtr = "Q1";
		}
		if (document.getElementById('frm2551Qv2018:qtr_2').checked == true) {
			qtr = "Q2";
		}
		if (document.getElementById('frm2551Qv2018:qtr_3').checked == true) {
			qtr = "Q3";
		}
		if (document.getElementById('frm2551Qv2018:qtr_4').checked == true) {
			qtr = "Q4";
		}
		var tpMonth = document.getElementById('frm2551Qv2018:rtnMonth').value;
		var tpYear = document.getElementById('frm2551Qv2018:txtYear').value + qtr;

		var fileNameEmail = emailFilePath.substring(emailFilePath.lastIndexOf("\\") + 1, emailFilePath.length);
		var versionNumber = fileNameEmail.lastIndexOf("V") > -1 ? fileNameEmail.substring(fileNameEmail.lastIndexOf("V"), fileNameEmail.lastIndexOf(".")) : "";

		//var emailTaxPayer = document.getElementById('frm1702MX:txtPg1Pt1I12Email').value;
		var emailTaxPayer = document.getElementById('txtEmail').value;
		var emailSubject = tpRDOCode + "_" + formType + "_" + tpTIN + "_" + tpMonth + tpYear + versionNumber;

		var emailBody = "Received Email subject to validation of BIR. <br> With attachment '" + fileNameEmail + "' <br> Date and time submitted: " + dateSubmitted +
			" <br><br> TIN: " + tpTIN +
			" <br> Name: " + document.getElementById("frm2551Qv2018:registeredName").value +
			" <br> Tax Type: Income Tax" +
			" <br> Form Type: " + formType +
			" <br> Return Period: " + tpMonth + "/" + tpYear +
			" <br> <br> Penalties may be imposed for any violation to the provisions of the NIRC and issuances thereof." +
			" <br> <br> FOR RETURNS WITH PAYMENT" +
			" <br> Please print the said email together with the Income Tax Return and then Proceed to Pay in the Authorized Agent Bank / Collection Agent under RDO where registered following existing issuances.";

		//alert("BIRSendEmail Initiated");

		// Display loader to show that an email is being sent
		$('#loader').css('background', 'transparent'); disableDropDown("before");
		$('#loader').show('blind');

		try {
			//BIRSendEmail('2551Qv2018@birgovph.org', '2551Qv2018@bir.gov.ph', emailTaxPayer, emailSubject, emailBody, emailFilePath, '2551Qv2018', 'smtp1.birgovph.org', '25', isRegisteredTP);
			var ftpFolder = enviService.getFtpFolder('2551Qv2018');
			var wsData = conService.getConConfig();
			var returnCode = RenameAndSendFile(emailFilePath, emailTaxPayer, ftpFolder, wsData.mode, wsData.srv, wsData.sslport, wsData.port, wsData.usr, wsData.pass); clearFileNameWOemail();
			$('#container').hide();

			if (returnCode == 0) {
				document.getElementById('txtFinalFlag').value = "1"; 
				updateFinalFlagOnSaveFile(fileNameEmail); 
				alert("Submit Successful. Subject to validation by BIR. \n\n A notification will be sent to your email (" + emailTaxPayer + "). Please print or save the email as an evidence of efiled return.");
				
				$('#paymentOption').show();

				$('#paymentOptionCloseBtn').on('click', function () {
					$('#paymentOption').hide();
					$('#container').show();
				});
			}
			else {
				document.getElementById('txtFinalFlag').value = "2"; updateFinalFlagOnSaveFile(fileNameEmail); alert('Your Tax Return was not submitted online due to any of the \n following reasons that may interrupt the submission process: \n - No internet connection \n - Slow internet connection \n - Overly restrictive firewall');
				$('#container').show();
			}
		}
		catch (e) {
			document.getElementById('txtFinalFlag').value = "2"; updateFinalFlagOnSaveFile(fileNameEmail); alert('Your Tax Return was not submitted online due to any of the \n following reasons that may interrupt the submission process: \n - No internet connection \n - Slow internet connection \n - Overly restrictive firewall');
			$('#container').show();
		}
		finally {
		}
		// Hide loader
		$('#loader').hide('blind');
		$('#loader').css('background', '#FFF'); checkFinalCopyBtn(formType); disableDropDown("after");
		HideContainer('ebirConfirmOnline');

		//06-20-2018
		//behaviour like 1601FQ
		//ShowContainer('container');
	}
	//--------------------------START:  Rollbase REST API using 'create2' and 'setBinaryData' --------------------------
	var sessionId;
	var respMsg;
	var create2Id;

	xmlHttp = new XMLHttpRequest(), loginXML = new XMLHttpRequest(), binReturnsUploadXML = new XMLHttpRequest();
	/*
	var gAdminUser = "";
	var gAdminPass = "";
	
	function getAdminUser(val) {
		gAdminUser = val;
	}
	function getAdminPass(val) {
		gAdminPass = val;
	}
	function validateAdminLogon() {
	
		if (gAdminUser.length > 0 && gAdminPass.length > 0) {
	
			var login = "https://ebirforms.bir.gov.ph:443/rest/api/login?loginName="+gAdminUser+"&password="+gAdminPass;		
			loginXML.open( "GET", login, true);		
			loginXML.send(null); 		
	
		} else {
			alert("Please provide Username and Password.");
			return;
		}	
	}
	
	function gotoAdmin() {
		showModalRollbaseLogin();	
	}
	function showModalRollbaseLogin() {
			document.getElementById('container').style.display = "none";
			$('#modalRollbaseLogin').show('blind');		
	} 
		    
	function cancelModalRollbaseLogin() {
			if ( $('#modalRollbaseLogin').css('display') != 'none' ) {
				document.getElementById('container').style.display = 'block';	
				$('#modalRollbaseLogin').hide('blind');
			}
	}*/

	var api, x, gRBSessionId;
	function openLogin() {
		document.getElementById('txtFinalFlag').value = '3'
		isSubmit = true;
		isSubmitFinal = true;
		if (gIsReadOnly) {
			isSubmitFinal = false;
		}
		var hasSavedReturn = saveXMLsubmit(true);
		if (hasSavedReturn) {
			var loginURL = geteBIRFormsOnlineLoginURL();
			x = window.open(loginURL, 'Login_Screen', 'resizable=1,scrollbars=1,height=850,width=900');
			api = window.setInterval(getAPI, 500);
		}
	}
	function getAPI() {
		try {
			if (x.closed) {
				if (api) {
					if (isSubmitFinal) {
						window.clearInterval(api);
						api = null;
						saveXMLsubmit(false);
					}
					else {
						window.clearInterval(api);
						api = null;
						saveXMLsubmit(true);
					}
				}
				return;
			}

			if ($("#response", x.document).length > 0)
				$("#responsetext").val($("#response", x.document).val());
			else return;
			var response = String($("#responsetext").val());
			gRBSessionId = response;

			sessionId = gRBSessionId.split('<sessionId>');
			sessionId = String(sessionId[1]);
			sessionId = sessionId.split('</sessionId>');
			sessionId = String(sessionId[0]);
			//alert('sessionId = '+sessionId);

			if (response.length != 0 && (sessionId != 'undefined' || sessionId != '<?xml ver')) {
				createRecord();
				window.clearInterval(api);
			}
		}
		catch (e) {
			return;
		}
	}

	/* Commented for logon IAF 
	function uploadMe() {	
		saveXML(true);
		gotoAdmin();
	}
	function uploadMe() {	
		saveXML(true);
		//dgarfin TODO: username/password should not be hard-coded here.  It should verify first if there's an IAF session.  
		//If it has, then supply it with 'loginName' and 'password'.  
		//Otherwise, popup a new window asking user to login to IAF then if logged in successfully, supply credentials to params
		var login = "https://ebirforms.bir.gov.ph:443/rest/api/login?loginName=dgarfin_tester@bir_dev&password=142857";
		loginXML.open( "GET", login, true);
		loginXML.send(null); 
	}
	
	loginXML.onreadystatechange = function() { 
		if ( loginXML.readyState == 4 && loginXML.status==200 ) { //Request Complete	
			sessionId = String(loginXML.responseText).split('sessionId');
			sessionId = String(sessionId[1]);
			sessionId = sessionId.substring(1,sessionId.length-2);		
			
	
			// Commented for logon IAF
			if ( $('#modalRollbaseLogin').css('display') != 'none' ) {
				document.getElementById('container').style.display = 'block';	
				$('#modalRollbaseLogin').hide('blind');
			}///		
			alert("Session ID : '"+sessionId+"' successfully created!");
			createRecord();
		 
		}
		else if ( loginXML.readyState == 3 && loginXML.status!=200 ) {
			//alert('readyState = '+loginXML.readyState+' status = '+loginXML.status);  //2/403;3/403;
			alert('Wrong credentials provided.  Pls try again.');
			return;
		}	
	}*/

	xmlFileForCreate2X = new Date();
	//getURL() is defined in string-util.js
	var rbURL = getURL();
	function createRecord() {

		createURL = rbURL + "/rest/api/create2?sessionId=" + sessionId + "&objName=upload1&tax_due=" + p3BasicTax + "&total_penalties=" + p3TotalPenalties + "&total_amount_payable=" + p3TotalAmountPayable + "&tp_zip=" + p3TPZip + "&tp_addr=" + p3TPAddress + "&tp_telnum=" + p3TPTelNum + "&tp_name=" + p3TPName + "&tp_lob=" + p3TPLineBus + "&tp_rdo_code=" + p3TPRDOCode + "&tp_branch_code=" + p3TPBranchCode + "&tp_tin=" + p3TPTIN + "&surcharge=" + p3Surcharge + "&compromise=" + p3Compromise + "&interest=" + p3Interest + "&is_amended_return=" + p3IsAmended + "&return_period=" + p3ReturnPeriod + "&return_period_end=" + p3ReturnPeriodEnd + "&useIds=false&form_type_text=2551Qv2018-Feb2002&load=" + xmlFileForCreate2X; //FOR create2

		xmlHttp.open("POST", createURL, false);
		xmlHttp.send();

		var respXMLMsg = xmlHttp.responseText;

		create2Id = respXMLMsg;
		create2Id = create2Id.split('id=');
		create2Id = String(create2Id[1]).replace(/"/gi, '');
		create2Id = String(parseInt(create2Id)).replace(/ /, '');

		//alert("Form ID : '"+create2Id+"' successfully created!");
		x.document.theForm.submit();
		uploadXMLFile();

	}

	/*xmlHttp.onreadystatechange = function() {
		if ( xmlHttp.readyState == 4 && xmlHttp.status==200 ) { //Request Complete-
	
			var respXMLMsg = xmlHttp.responseText;
			//Get ID of response from Create2
			create2Id = respXMLMsg.substring(respXMLMsg.indexOf('data  id=')+10, respXMLMsg.indexOf(' objName=')-1); //should be at least 8-digit ID here		
			//alert("Form ID : '"+create2Id+"' successfully created!");	
	
			if (isNaN(create2Id)) {
					//alert('Tax return filing is unsuccessful!');
					x.close();
					openLogin();
			} else {
					//alert("Form ID : '"+create2Id+"' successfully created!");     
					uploadXMLFile();                
			}
	
		}
	}*/

	function uploadXMLFile() {
		var binDataURL;

		//Dev Note: frmMainSrc contains the HTML and content of the form
		//frmMainSrc should get the print preview version
		// $('#frmMain').html(); //content of the loop
		printme();

		if (savedReturn != null && savedReturn.length > 0) {
			var intervalCnt = 1000;

			var xmlFileForUpload = savedReturn.replace(/&nbsp;/g, "<span style='padding-left:0.25em'> </span>");
			xmlFileForUpload = xmlFileForUpload.replace(/&amp;/g, "AND");
			xmlFileForUpload = xmlFileForUpload.replace(/&/g, "_AND_");
			xmlFileForUpload = xmlFileForUpload.replace(/\+/g, "_PLUS_");
			var savedReturnLen = xmlFileForUpload.length;

			//Loop Begin - create submit_return_data records, related to Created Upload File - 		
			var numOfSRLoops = Math.ceil(savedReturnLen * 1 / intervalCnt);
			var loopSRCnt = numOfSRLoops + 1;
			var startSRPost = 0;
			var endSRPost = intervalCnt;
			var partSRCnt = 1;

			for (var i = 0; i < numOfSRLoops; i++) {

				binDataURL = rbURL + "/rest/api/create2?sessionId=" + sessionId + "&objName=submit_return_data&useIds=false&index_=" + partSRCnt + "&name=2551Qv2018_part" + partSRCnt + "&R95607586=" + create2Id + "&content=" + xmlFileForUpload.substring(startSRPost, endSRPost);
				var binDataUploadXML = new XMLHttpRequest();
				binDataUploadXML.open("POST", encodeURI(binDataURL), false);
				binDataUploadXML.send();

				//xmlFn.writeLine(xmlFileInBase64.substring(startSRPost, endSRPost)+"\n\ncompleted\n\n");			
				//alert('i = '+i+' startSRPost = '+startSRPost+' endSRPost = '+endSRPost);	

				startSRPost = startSRPost + intervalCnt;
				if (i == numOfSRLoops - 1) {
					endSRPost = savedReturnLen;
				} else {
					endSRPost = endSRPost + intervalCnt;
				}
				partSRCnt++;
			}
			//alert("A total of "+loopSRCnt+" iterations are uploaded in 'submit_return_data' object for this form!");	
			cancel();
			disableAllElementIDs();
			//Open a new page, displaying the created form
			//alert("Finished Loading REST 'create2' request for FORMS object.");

			//getDisplayPageURL() is defined in string-util2014.js
			var redirectURL = x.window.location.href;
			var formURL = getDisplayPageURL(redirectURL, create2Id);
			if (parseInt(create2Id) > 0) window.open(formURL, 'Login_Screen', 'resizable=1,scrollbars=1,height=850,width=900');
		} else {
			alert("Tax Return file does not exists.  Cannot proceed with submission.");
			return;
		}

		//xmlFn.close();		

	}

	
	
//--------------------------END:  Rollbase REST API using 'create2' and 'setBinaryData' --------------------------	



</script>
