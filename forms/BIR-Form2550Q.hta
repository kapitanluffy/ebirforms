<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE8" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <hta:application id="Form2550Q"
        applicationname="2550Q"
        version="1.0"
        caption="yes"
        showintaskbar="yes"
        icon="../img/bir_icon.ico"
        singleinstance="YES"
        sysmenu="NO"
        navigable="YES"
        contextmenu="NO"
        windowstate="maximize"
        scrollflat="YES">	
		<script src='../jq/jquery-1.7.1.min.js'></script>
		<script src='../jq/jquery-ui-1.8.18.custom.min.js'></script>		        
        <link href="../css/styles.css" rel="stylesheet" type="text/css" />
		<link href="../css/print.css" rel="stylesheet" type="text/css" media="print" />		
        <script src='../js/environment.js'></script>
		<script src='../js/string-util.js'></script>
        <script src='../js/aes.js'></script>
		<script src='../js/rijndael.js'></script>
		<script src='../js/lz-string-1.0.2.js'></script>
		<script language="VBScript" src="../js/eBIRTools.vbs"></script>	
		
		<title>BIR Form No. 2550-Q</title>
</head>
<style media="print">
    #printer {
        display: inline !important;
    }
	</style>
<body>
    <ul id="printMenu" class="topnav printButtonClass">
        <li>
            <a href="#" class='toplevel printButtonClass'>File</a>
            <ul class="subnav printButtonClass">
                <li><a href="#" onclick="window.print();">Print</a></li>
                <li><a href="#" onclick="cancel();">Cancel Print</a></li>
            </ul>
        </li>
    </ul>
    <ul id="formMenu" class="topnav printButtonClass">
        <li>
            <a href="#" class='toplevel printButtonClass'>File</a>
            <ul class="subnav printButtonClass">
                <li><a href="#" onclick="window.location='../BIRForms.hta?xmlReloadProfile=' + createXMLProfileName() + '&formTyp=2550Q'">Main Screen</a></li>
                <li><a href="#" onclick="saveXML(false);">Save</a></li>
                <li><a href="#" onclick="printme();">Print Preview</a></li>
                <li><a href="#" onclick="isOnExit(); saveBeforeExit();">Exit</a></li>
            </ul>
        </li>
        <li>
            <a href="#" class='toplevel printButtonClass'>Help</a>
            <style>
                .asubnav {
                    text-indent: 20px;
                    list-style-type: none;
                }
            </style>
            <ul class="subnav printButtonClass">
                <li>
                    <ul class="atopnav">
                        <!--l3-->
                        <li>
                            <a href="#" class='atoplevel'>Documentary Stamp</a>
                            <ul class="asubnav" style="display: none;">
                                <li><a href="#" onclick="goToHelpPage('2000');return false">BIR Form 2000</a></li>
								<li><a href="#" onclick="goToHelpPage('2000v2018');return false">BIR Form 2000v2018</a></li> 
                            </ul>
                        </li>
                    </ul>
                    <!--l3-->
                    <ul class="atopnav">
                        <!--l3-->
                        <li>
                            <a href="#" class='atoplevel'>Excise</a>
                            <ul class="asubnav" style="display: none;">
                                <li><a href="#" onclick="goToHelpPage('2200A');return false">BIR Form 2200A</a></li>
                                <li><a href="#" onclick="goToHelpPage('2200P');return false">BIR Form 2200P</a></li> 
                                <li><a href="#" onclick="goToHelpPage('2200S');return false">BIR Form 2200S</a></li>
                                <li><a href="#" onclick="goToHelpPage('2200T');return false">BIR Form 2200T</a></li>
                                <li><a href="#" onclick="goToHelpPage('2200AN');return false">BIR Form 2200AN</a></li>
                                <li><a href="#" onclick="goToHelpPage('2200M');return false">BIR Form 2200M</a></li>
                            </ul>
                        </li>
                    </ul>
                    <!--l3-->
                    <ul class="atopnav">
                        <!--l3-->
                        <li>
                            <a href="#" class='atoplevel'>Income</a>
                            <ul class="asubnav" style="display: none;">
                                <li><a href="#" onclick="goToHelpPage('1701Q');return false">BIR Form 1701Q</a></li>
								<li><a href="#" onclick="goToHelpPage('1701Qv2018');return false">BIR Form 1701Qv2018</a></li> 
                                <li><a href="#" onclick="goToHelpPage('1704');return false">BIR Form 1704</a></li>
                                <li><a href="#" onclick="goToHelpPage('1702Q');return false">BIR Form 1702Q</a></li>
                            </ul>
                        </li>
                    </ul>
                    <!--l3-->
                    <ul class="atopnav">
                        <!--l3-->
                        <li>
                            <a href="#" class='atoplevel'>ONETT</a>
                            <ul class="asubnav" style="display: none;">
                                <li><a href="#" onclick="goToHelpPage('1606');return false">BIR Form 1606</a></li>
                                <li><a href="#" onclick="goToHelpPage('1706');return false">BIR Form 1706</a></li>
                                <li><a href="#" onclick="goToHelpPage('1707');return false">BIR Form 1707</a></li>
                                <li><a href="#" onclick="goToHelpPage('1800');return false">BIR Form 1800</a></li>
                                <li><a href="#" onclick="goToHelpPage('1801');return false">BIR Form 1801</a></li>
                                <li><a href="#" onclick="goToHelpPage('2000-OT');return false">BIR Form 2000-OT</a></li>
                            </ul>
                        </li>
                    </ul>
                    <!--l3-->
                    <ul class="atopnav">
                        <!--l3-->
                        <li>
                            <a href="#" class='atoplevel'>Payment</a>
                            <ul class="asubnav" style="display: none;">
                                <li><a href="#" onclick="goToHelpPage('0605');return false">BIR Form 0605</a></li>
                            </ul>
                        </li>
                    </ul>
                    <!--l3-->
                    <ul class="atopnav">
                        <!--l3-->
                        <li>
                            <a href="#" class='atoplevel'>Percentage</a>
                            <ul class="asubnav" style="display: none;">
                                <li><a href="#" onclick="goToHelpPage('2551');return false">BIR Form 2551Q</a></li>
								<li><a href="#" onclick="goToHelpPage('2551Qv2018');return false">BIR Form 2551Qv2018</a></li>
                                <li><a href="#" onclick="goToHelpPage('2551M');return false">BIR Form 2551M</a></li>
                                <li><a href="#" onclick="goToHelpPage('2552');return false">BIR Form 2552</a></li>
                                <li><a href="#" onclick="goToHelpPage('2553');return false">BIR Form 2553</a></li>
                            </ul>
                        </li>
                    </ul>
                    <!--l3-->
                    <ul class="atopnav">
                        <!--l3-->
                        <li>
                            <a href="#" class='atoplevel'>Value Added Tax</a>
                            <ul class="asubnav" style="display: none;">
                                <li><a href="#" onclick="goToHelpPage('2550M');return false">BIR Form 2550M</a></li>
                                <li><a href="#" onclick="goToHelpPage('2550Q');return false">BIR Form 2550Q</a></li>
                            </ul>
                        </li>
                    </ul>
                    <!--l3-->
                    <ul class="atopnav">
                        <!--l3-->
                        <li>
                            <a href="#" class='atoplevel'>Withholding</a>
                            <ul class="asubnav" style="display: none;">
                                <li><a href="#" onclick="goToHelpPage('0619E');return false">BIR Form 0619E</a></li>
                                <li><a href="#" onclick="goToHelpPage('0619F');return false">BIR Form 0619F</a></li>
                                <li><a href="#" onclick="goToHelpPage('1601C');return false">BIR Form 1601C</a></li>
								<li><a href="#" onclick="goToHelpPage('1601Cv2018');return false">BIR Form 1601Cv2018</a></li> 
                                <li><a href="#" onclick="goToHelpPage('1601E');return false">BIR Form 1601E</a></li>
                                <li><a href="#" onclick="goToHelpPage('1601EQ');return false">BIR Form 1601EQ</a></li>
                                <li><a href="#" onclick="goToHelpPage('1601F');return false">BIR Form 1601F</a></li>
                                <li><a href="#" onclick="goToHelpPage('1601FQ');return false">BIR Form 1601FQ</a></li>
                                <li><a href="#" onclick="goToHelpPage('1602');return false">BIR Form 1602</a></li>
								<li><a href="#" onclick="goToHelpPage('1602Q');return false">BIR Form 1602Qv2018</a></li>
                                <li><a href="#" onclick="goToHelpPage('1603');return false">BIR Form 1603</a></li>
								<li><a href="#" onclick="goToHelpPage('1603Q');return false">BIR Form 1603Qv2018</a></li> 
                                <li><a href="#" onclick="goToHelpPage('1600');return false">BIR Form 1600</a></li>
                                <li><a href="#" onclick="goToHelpPage('1600WP');return false">BIR Form 1600WP</a></li>
                                <li><a href="#" onclick="goToHelpPage('1604CF');return false">BIR Form 1604CF</a></li>
                                <li><a href="#" onclick="goToHelpPage('1604E');return false">BIR Form 1604E</a></li>
                            </ul>
                        </li>
                    </ul>
                    <!--l3-->
                </li>
            </ul>
        </li>
    </ul>
    <!--topnav-->
    <div class="printButtonClass" style="position: fixed; top: 10px; font-size: 11px; z-index: 1000000000000000; right: 5px; width: auto;">Government Property Not For Sale</div>

    <!--title-->
    <img class="printButtonClass" id="bg" src="../img/bg_n.png" height="100%" align="top" />
    <!--watermark-->

    <div id='loader'>
        <div id='text'>
            <img src="../img/ajax-loader-1.gif" width="440" height="30" alt="loader" />
        </div>
    </div>
    <style>
        #loader, #text {
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            position: fixed;
            background: #FFF;
            z-index: 5000;
        }

        #text {
            background: none;
            top: 50%;
            left: 50%;
            right: 68%;
            left: 32%;
            width: 440px;
            overflow: hidden;
        }
    </style>
    <style>
        .atcNames {
            font-weight: bold;
        }

        tr.atc td {
            border-bottom: 1px #e1e1e1 solid;
        }

        tr.atc:hover td {
            background: #FFC;
        }

        td.atc {
            padding: 4px;
        }

        .labels {
            background: #FFF;
            font-size: 8px;
            width: auto !important;
            display: inline;
            height: 9px;
            border: 2px inset #FFF;
            padding: 0 2px 0 2px;
        }


        #container {
            margin-top: 40px;
        }
    </style>
    <div class='printButtonClass menu'></div>
    <div class='printButtonClass' id='header'>
        <input type='button' class='printButtonClass' value='Main Menu' onclick="window.location = '../BIRForms.hta'; " />
        <input type='button' class='printButtonClass' value='Save' onclick='saveXML(false);' />
        <input type='button' class='printButtonClass' value='Print' onclick='window.print();' />
        <input type='button' class='printButtonClass' value='Exit' onclick='window.close(); self.close();' />
    </div>
    <!-- MODAL - Payment Option  -->
	<div id="paymentOption" class="payment-option">
        <div align="center">
            <img src="../img/bir_broadcast_logo.png" alt="bir logo" class="payment-option-content"/>
            <img src="../img/epay_logo.png" alt="bir logo" class="payment-option-content" />
            <br/><br/>
            <span class="payment-option-content">You can now pay electronically through the following channels</span>
            <br/><br/>
            <span class="payment-option-content">
                <a href="https://www.bir.gov.ph/index.php/eservices/epay.html" target="_blank">https://www.bir.gov.ph/index.php/eservices/epay.html</a>
            </span>
            <br/><br/>
        </div>
        <div id="paymentOptionFooter" class="payment-option-footer">
            <input id="paymentOptionCloseBtn" type="button" style="width:120px; height:30px;" value="Close" />
        </div>
    </div>
    <form id="frmMain" name="frmMain">
        <div id="container">
            <div id="wrapper" style="margin: 0 auto; position: relative; width: 747px;">

                <table border="0" width="747" cellspacing="0" cellpadding="0" align="center" style="background-image: url(../img/frmbg.png); background-repeat: repeat-x;">
                    <tr>
                        <td>

                            <div id="formPaper">
                                <div id="mainContent">
                                    <table width="747" border="0" cellspacing="0" cellpadding="0">
                                        <tr>
                                            <td>
                                                <!--<table width="100%" style="border-bottom: #AAAAAA 1px solid;">
										<tr>
											<td>
												<p>(To be filled up by the BIR)</p>	
											</td>
										</tr>
										<tr>
											<td>
												<p>> DLN:</p>	
											</td>
											<td>
												&nbsp;
											</td>
											<td>
												&nbsp;
											</td>
											<td>
												<p>> PSIC:</p>	
											</td>
										</tr>
									</table>
                                    <table width="747" border="0" cellspacing="0" cellpadding="0" style="height:0px;">
                                        <tr>
                                            <td width="82"  style='padding:0px;' valign="middle" align="center">										
												<p><img src="../img/birflog.gif" width="51" height="49" valign='3' halign='3' alt="birlogo" /></p>
											</td>
                                            <td width="158" valign="middle">
                                                <font face="Arial" size="1px">Republika ng Pilipinas
												<br/>Kagawaran ng Pananalapi
												<br/>Kawanihan ng Rentas Internas</font>
                                            </td>
                                            <td width="0" align="center">
                                                <font size="5px" style="font-weight:bold;">Quarterly Value-Added Tax Return<br/>(Cumulative For 3 Months)</font>
                                            </td>
                                            <td width="160" valign="center">
                                                <font face="Arial" size="1px">BIR Form No.<br/></font>
                                                <font face="Arial" size="6px">2550-Q<br/></font>
                                                <font face="Arial" size="1px">February 2007 (ENCS)</font>
                                        </tr>
                                    </table>	-->
                                                <div align='center' style="display: inline; width: 741px !important; height: 61px !important">
                                                    <img id="frm2550Q:header" src="../img/2550q_header.jpg" width="741" height="61" />
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <table width="741" border="0" cellspacing="0" cellpadding="0" class="tblForm">
                                                    <tr>
                                                        <td width="174" valign="top" class="tblFormTd" style="height=20px">
                                                            <table width="100%" border="0" cellspacing="0" cellpadding="0">
                                                                <!--<tr>
                                                        <td width="23"><font size="1.5" style="font-weight:bold;">&nbsp;1&nbsp;&nbsp;&nbsp;</font></td>
                                                        <td colspan="2"><font size="1">For the Year Ended (MM/YYYY)</font></td>
                                                    </tr>-->
                                                                <tr>
                                                                    <td colspan="2" align="left" style="height=20px" nowrap>
                                                                        <font size="0.75">Year Ended</font>
                                                                        <input
                                                                            id="frm2550q:optAmend:_1" name="frm2550q:optAmend" value="Y" type="radio" onclick="enableMonth(this);changeMonth(); " />
                                                                        <label for="frm2550q:optAmend:_1" style="font-size: 10px;">Calendar&nbsp;&nbsp;</label>
                                                                        <input
                                                                            id="frm2550q:optAmend:_2" name="frm2550q:optAmend"
                                                                            value="N"
                                                                            type="radio" onclick="changeMonth(); enableMonth(this);" />
                                                                        <label
                                                                            for="frm2550q:optAmend:_2" style="font-size: 10px;">
                                                                            Fiscal</label>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td width="100%" align="left" nowrap colspan="2" style="height=20px">
                                                                        <font size="0.75">(MM/YYYY)</font>
                                                                        <select size="1" name="frm2550q:RtnMonth" id="frm2550q:RtnMonth" onchange="changeMonth()">
                                                                            <option value="0"></option>
                                                                            <option value="01">January</option>
                                                                            <option value="02">February</option>
                                                                            <option value="03">March</option>
                                                                            <option value="04">April</option>
                                                                            <option value="05">May</option>
                                                                            <option value="06">June</option>
                                                                            <option value="07">July</option>
                                                                            <option value="8">August</option>
                                                                            <option value="9">September</option>
                                                                            <option value="10">October</option>
                                                                            <option value="11">November</option>
                                                                            <option value="12">December</option>
                                                                        </select>
                                                                        <input type="text" value="" size="2" name="frm2550q:txtYear" maxlength="4" id="frm2550q:txtYear" onblur="blockletterWithout2Decimal(this);changeYear()" onkeypress="return wholenumber(this, event)" />
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </td>

                                                        <td width="143" valign="top" class="tblFormTd" style="height=20px">
                                                            <table width="137" border="0" cellspacing="0" cellpadding="0" style="height=20px">
                                                                <tr>
                                                                    <td width="24"><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;2&nbsp;&nbsp;</font></td>
                                                                    <td width="113"><font size="1">Quarter</font></td>
                                                                </tr>
                                                                <tr>
                                                                    <td colspan="2">
                                                                        <!--<fieldset style="font-family: Verdana,Arial,Helvetica; font-size: 8pt;" id="frm2550q:j_id217">-->
                                                                        <div align="center" style="padding: 0px 0 0px 0;">
                                                                            <table cellspacing="0" cellpadding="0" border="0">
                                                                                <tbody>
                                                                                    <tr>
                                                                                        <td align="center">
                                                                                            <input type="radio" value="1" name="frm2550q:OptQuarter" id="frm2550q:OptQuarter1" checked onclick="changeYear()" />
                                                                                            <label for="frm2550q:OptQuarter1" style="font-size: 10px;">1st</label>
                                                                                            &nbsp;&nbsp;</td>
                                                                                        <td align="center">
                                                                                            <input type="radio" value="2" name="frm2550q:OptQuarter" id="frm2550q:OptQuarter2" onclick="changeYear()" />
                                                                                            <label for="frm2550q:OptQuarter2" style="font-size: 10px;">2nd</label>
                                                                                            &nbsp;&nbsp;</td>
                                                                                        <td align="center">
                                                                                            <input type="radio" value="3" name="frm2550q:OptQuarter" id="frm2550q:OptQuarter3" onclick="changeYear()" />
                                                                                            <label for="frm2550q:OptQuarter3" style="font-size: 10px;">3rd</label>
                                                                                            &nbsp;&nbsp;</td>
                                                                                        <td align="center">
                                                                                            <input type="radio" value="4" name="frm2550q:OptQuarter" id="frm2550q:OptQuarter4" onclick="changeYear()" />
                                                                                            <label for="frm2550q:OptQuarter4" style="font-size: 10px;">4th</label>
                                                                                            &nbsp;&nbsp;</td>
                                                                                    </tr>
                                                                                </tbody>
                                                                            </table>
                                                                        </div>
                                                                        <!-- </fieldset>-->
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                        <td width="169" valign="top" class="tblFormTd" style="height=20px">
                                                            <table width="159" border="0" cellspacing="0" cellpadding="0">
                                                                <tr>
                                                                    <td width="17" nowrap><font size="1.5" style="font-weight: bold;">&nbsp;3&nbsp;</font></td>
                                                                    <td colspan="3" nowrap align="center"><font size="1">Return Period(MM/DD/YYYY)</font></td>

                                                                </tr>
                                                                <tr>
                                                                    <td width="31" nowrap><font size="1">From:</font></td>
                                                                    <td width="111" nowrap>
                                                                        <input type="text" style="background-color: rgb(220, 220, 220); text-align: right;" size="6" maxlength="10" id="frm2550q:RtnPeriodFrom" disabled="true" /></td>
                                                                    <td nowrap><font size="1">To:</font></td>
                                                                    <td nowrap>
                                                                        <input type="text" style="background-color: rgb(220, 220, 220); text-align: right;" size="6" maxlength="10" id="frm2550q:RtnPeriodTo" disabled="true" /></td>

                                                                </tr>
                                                                <!--<tr>
                                                        <td>&nbsp;</td>
                                                        <td><font size="1">To:</font></td>
                                                        <td><input type="text" style="background-color: rgb(220, 220, 220); text-align: right;" size="10"  maxlength="10" id="frm2550q:RtnPeriodTo" disabled="true"  /></td>
                                                    </tr>-->
                                                            </table>
                                                        </td>
                                                        <td width="122" valign="top" class="tblFormTd" style="height=20px">
                                                            <table width="110" border="0" cellspacing="0" cellpadding="0">
                                                                <tr>
                                                                    <td width="23"><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;4&nbsp;&nbsp;</font></td>
                                                                    <td width="87"><font size="1">Amended Return?</font></td>
                                                                </tr>
                                                                <tr>
                                                                    <td colspan="2">
                                                                        <!--<fieldset style="font-family: Verdana,Arial,Helvetica; font-size: 8pt;" id="frm2550q:j_id217" class="iceSelOneRb-dis fieldText1-dis">-->
                                                                        <div align="center" style="padding: 0px 0 0px 0;">
                                                                            <table cellspacing="0" cellpadding="0" border="0" class="iceSelOneRb-dis fieldText1-dis">
                                                                                <tbody>
                                                                                    <tr>
                                                                                        <td align="center">&nbsp;<input type="radio" value="Y" name="frm2550q:AmendedRtn" id="frm2550q:AmendedRtnY" onclick="d.getElementById('frm2550q:txtTax26E').value = '0.00';d.getElementById('frm2550q:txtTax26E').disabled = false;compute26H();" />
                                                                                            <label for="frm2550q:j_id217:_1" style="font-size: 10px;">Yes</label>
                                                                                        </td>
                                                                                        <td align="center">
                                                                                            <input type="radio" value="N" name="frm2550q:AmendedRtn" id="frm2550q:AmendedRtnN" checked="checked" onclick="d.getElementById('frm2550q:txtTax26E').value = '0.00';d.getElementById('frm2550q:txtTax26E').disabled = true;compute26H();" />
                                                                                            <label for="frm2550q:j_id217:_2" style="font-size: 10px;">No</label>
                                                                                        </td>
                                                                                    </tr>
                                                                                </tbody>
                                                                            </table>
                                                                        </div>
                                                                        <!--</fieldset>-->
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                        <td width="133" valign="top" class="tblFormTd" style="height=20px">
                                                            <table width="125" border="0" cellspacing="0" cellpadding="0">
                                                                <tr>
                                                                    <td width="23"><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;5&nbsp;&nbsp;</font></td>
                                                                    <td width="102"><font size="1">Short Period Return?</font></td>
                                                                </tr>
                                                                <tr>
                                                                    <td colspan="2">
                                                                        <!--<fieldset style="font-family: Verdana,Arial,Helvetica; font-size: 8pt;" id="frm2550q:j_id217" class="iceSelOneRb-dis fieldText1-dis">-->
                                                                        <div align="center" style="padding: 0px 0 0px 0;">
                                                                            <table cellspacing="0" cellpadding="0" border="0" class="iceSelOneRb-dis fieldText1-dis">
                                                                                <tbody>
                                                                                    <tr>
                                                                                        <td align="center">&nbsp;<input type="radio" value="Y" name="frm2550q:OptShortPrd" id="frm2550q:OptShortPrd1" onclick='enableShortPeriod("yes");' />
                                                                                            <label for="frm2550q:j_id217:_1" style="font-size: 12px;">Yes</label>
                                                                                        </td>
                                                                                        <td align="center">
                                                                                            <input type="radio" value="N" name="frm2550q:OptShortPrd" id="frm2550q:OptShortPrd2" checked="checked" onclick='enableShortPeriod("no");' />
                                                                                            <label for="frm2550q:j_id217:_2" style="font-size: 12px;">No</label>
                                                                                        </td>
                                                                                    </tr>
                                                                                </tbody>
                                                                            </table>
                                                                        </div>
                                                                        <!--</fieldset>-->
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </td>


                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                        <!--<tr>
                                <td>
                                    <table width="741" border="0" cellspacing="0" cellpadding="0" class="tblForm">
                                        <tr>
                                            <td class="tblFormTdPart">
                                                <table width="" border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td width="88">&nbsp;&nbsp;&nbsp;<font size="1.5" style="font-weight:bold;">Part I</font></td>
                                                        <td width="565">
                                                            <div align="center"><font size="1.5" style="font-weight:bold;letter-spacing: 3px;">Background Information</font></div>
                                                        </td>
                                                        <td width="88">&nbsp;</td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>-->
                                        <tr>
                                            <td>
                                                <table style="width: 741px" border="0" cellspacing="0" cellpadding="0" class="tblForm">
                                                    <tr>
                                                        <td width="25%" valign="top" class="tblFormTd">
                                                            <table border="0" cellspacing="0" cellpadding="0" width="100%">
                                                                <tr>
                                                                    <td width="5%" nowrap><font size="1.5" style="font-weight: bold">&nbsp;6&nbsp;</font></td>
                                                                    <td width="95%" nowrap>
                                                                        <font size="1">TIN&nbsp;</font>
                                                                        <input type="text" value="" size="1" name="frm2550q:txtTIN1" maxlength="3" id="frm2550q:txtTIN1" onkeypress="return wholenumber(this, event)" />
                                                                        <input type="text" value="" size="1" name="frm2550q:txtTIN2" maxlength="3" id="frm2550q:txtTIN2" onkeypress="return wholenumber(this, event)" />
                                                                        <input type="text" value="" size="1" name="frm2550q:txtTIN3" maxlength="3" id="frm2550q:txtTIN3" onkeypress="return wholenumber(this, event)" />
                                                                        <input type="text" value="000" size="1" name="frm2550q:txtBranchCode" maxlength="3" id="frm2550q:txtBranchCode" onkeypress="return letternumber(event)" />
                                                                    </td>
                                                                </tr>

                                                            </table>
                                                        </td>
                                                        <td width="20%" valign="top" class="tblFormTd">
                                                            <table border="0" cellspacing="0" cellpadding="0">
                                                                <tr>
                                                                    <td width="5%" nowrap><font size="1.5" style="font-weight: bold">&nbsp;7&nbsp;</font><font size="1">RDO Code&nbsp;</font></td>
                                                                    <td width="95%" id="rdoSelect" nowrap>
                                                                        <!-- font size="1">RDO Code&nbsp;</font>
																	<font size="1.5" face="Arial">
																		<select class="iceSelOneMnu" id="frm2550q:txtRDOCode" name="frm2550q:txtRDOCode" size="1">
																			
																				<option value="001">001</option>
																				<option value="002">002</option>
																				<option value="003">003</option>
																				<option value="004">004</option>
																				<option value="005">005</option>
																				<option value="006">006</option>
																				<option value="007">007</option>
																				<option value="008">008</option>
																				<option value="009">009</option>
																				<option value="010">010</option>
																				<option value="011">011</option>
																				<option value="012">012</option>
																				<option value="013">013</option>
																				<option value="014">014</option>
																				<option value="015">015</option>
																				<option value="016">016</option>
																				<option value="17A">17A</option>
																				<option value="17B">17B</option>
																				<option value="018">018</option>
																				<option value="019">019</option>
																				<option value="020">020</option>
																				<option value="21A">21A</option>
																				<option value="21B">21B</option>
																				<option value="022">022</option>
																				<option value="23A">23A</option>
																				<option value="23B">23B</option>
																				<option value="024">024</option>
																				<option value="25A">25A</option>
																				<option value="25B">25B</option>
																				<option value="026">026</option>
																				<option value="027">027</option>
																				<option value="028">028</option>
																				<option value="029">029</option>
																				<option value="030">030</option>
																				<option value="031">031</option>
																				<option value="032">032</option>
																				<option value="033">033</option>
																				<option value="034">034</option>
																				<option value="035">035</option>
																				<option value="036">036</option>
																				<option value="037">037</option>
																				<option value="038">038</option>
																				<option value="039">039</option>
																				<option value="040">040</option>
																				<option value="041">041</option>
																				<option value="042">042</option>
																				<option value="43A">43A</option>
																				<option value="43B">43B</option>
																				<option value="044">044</option>
																				<option value="045">045</option>
																				<option value="046">046</option>
																				<option value="047">047</option>
																				<option value="048">048</option>
																				<option value="049">049</option>
																				<option value="050">050</option>
																				<option value="051">051</option>
																				<option value="052">052</option>
																				<option value="53A">53A</option>
																				<option value="53B">53B</option>
																				<option value="54A">54A</option>
																				<option value="54B">54B</option>
																				<option value="055">055</option>
																				<option value="056">056</option>
																				<option value="057">057</option>
																				<option value="058">058</option>
																				<option value="059">059</option>
																				<option value="060">060</option>
																				<option value="061">061</option>
																				<option value="062">062</option>
																				<option value="063">063</option>
																				<option value="064">064</option>
																				<option value="065">065</option>
																				<option value="066">066</option>
																				<option value="067">067</option>
																				<option value="068">068</option>
																				<option value="069">069</option>
																				<option value="070">070</option>
																				<option value="071">071</option>
																				<option value="072">072</option>
																				<option value="073">073</option>
																				<option value="074">074</option>
																				<option value="075">075</option>
																				<option value="076">076</option>
																				<option value="077">077</option>
																				<option value="078">078</option>
																				<option value="079">079</option>
																				<option value="080">080</option>
																				<option value="081">081</option>
																				<option value="082">082</option>
																				<option value="083">083</option>
																				<option value="084">084</option>
																				<option value="085">085</option>
																				<option value="086">086</option>
																				<option value="087">087</option>
																				<option value="088">088</option>
																				<option value="089">089</option>
																				<option value="090">090</option>
																				<option value="091">091</option>
																				<option value="092">092</option>
																				<option value="93A">93A</option>
																				<option value="93B">93B</option>
																				<option value="094">094</option>
																				<option value="095">095</option>
																				<option value="096">096</option>
																				<option value="097">097</option>
																				<option value="098">098</option>
																				<option value="099">099</option>
																				<option value="100">100</option>
																				<option value="101">101</option>
																				<option value="102">102</option>
																				<option value="103">103</option>
																				<option value="104">104</option>
																				<option value="105">105</option>
																				<option value="106">106</option>
																				<option value="107">107</option>
																				<option value="108">108</option>
																				<option value="109">109</option>
																				<option value="110">110</option>
																				<option value="111">111</option>
																				<option value="112">112</option>
																				<option value="113">113</option>
																				<option value="114">114</option>
																				<option value="115">115</option>
																				<option value="116">116</option>
																				<option value="117">117</option>
																				<option value="118">118</option>
																				<option value="119">119</option>
																				<option value="120">120</option>
																				<option value="121">121</option>
																				<option value="122">122</option>
																				<option value="123">123</option>
																				<option value="124">124</option>
																				<option value="125">125</option>
																				<option value="126">126</option>
																				<option value="132">132</option>
																		</select>
																	</font -->
                                                                    </td>
                                                                </tr>

                                                            </table>
                                                        </td>
                                                        <td width="25%" valign="top" class="tblFormTd">
                                                            <table width="100%" border="0" cellspacing="0" cellpadding="0">
                                                                <tr>
                                                                    <td width="5%" nowrap><font size="1.5" style="font-weight: bold;">&nbsp;8&nbsp;&nbsp;&nbsp;</font></td>
                                                                    <td width="95%" nowrap>
                                                                        <font size="1">No. of Sheets Attached</font>
                                                                        <input type="text" value="0" style="text-align: right" size="1" name="frm2550q:txtSheets" maxlength="2" id="frm2550q:txtSheets" onkeypress="return wholenumber(this, event)" />
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                        <td width="30%" valign="top" class="tblFormTd">
                                                            <table width="100%" border="0" cellspacing="0" cellpadding="0">
                                                                <tr>
                                                                    <td width="5%" nowrap><font size="1.5" style="font-weight: bold">&nbsp;9&nbsp;</font></td>
                                                                    <td width="95%" nowrap>
                                                                        <font size="1">Line of Business&nbsp;&nbsp;</font>
                                                                        <font size="1" face="Arial">
                                                                            <input type="text" value="" size="25" name="frm2550q:txtLineBus" maxlength="60" id="frm2550q:txtLineBus" />
                                                                        </font>
                                                                    </td>
                                                                </tr>

                                                            </table>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <table width="741" border="0" cellspacing="0" cellpadding="0" class="tblForm">
                                                    <tr>
                                                        <td width="65%" valign="top" class="tblFormTd">
                                                            <table border="0" cellspacing="0" cellpadding="0" width="100%">
                                                                <tr>
                                                                    <td width="100%">
                                                                        <table border="0" cellpadding="0" cellspacing="0" width="100%">
                                                                            <tr>
                                                                                <td width="3%" nowrap><font size="1.5" style="font-weight: bold;">&nbsp;10</font></td>
                                                                                <td width="97%" nowrap>&nbsp;&nbsp;
																		<font size="1">Taxpayer's Name 
                                                                        </font>
                                                                                    <input type="text" value="" size="60" maxlength="60" id="frm2550q:TaxPayer" onblur="return capital(this, event)" />
                                                                                </td>
                                                                            </tr>
                                                                        </table>
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                        <td width="35%" valign="top" class="tblFormTd">
                                                            <table border="0" cellspacing="0" cellpadding="0" width="100%">
                                                                <tr>
                                                                    <td width="100%">
                                                                        <table border="0" cellspacing="0" cellpadding="0" width="100%">
                                                                            <tr>
                                                                                <td width="35%" nowrap><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;11&nbsp;</font><font size="1">Telephone No.</font></td>
                                                                                <td width="65%" nowrap align="right">
                                                                                    <input type="text" value="" size="15" name="frm2550q:txtTelNum" maxlength="15" id="frm2550q:txtTelNum" onkeypress="return wholenumber(this, event)" />
                                                                                </td>
                                                                            </tr>
                                                                        </table>
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <table width="741" border="0" cellspacing="0" cellpadding="0" class="tblForm">
                                                    <tr>
                                                        <td width="60%" valign="top" class="tblFormTd">
                                                            <table border="0" cellspacing="0" cellpadding="0" width="100%">
                                                                <tr>
                                                                    <td width="100%">
                                                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                                                            <tr>
                                                                                <td width="3%" nowrap><font size="1.5" style="font-weight: bold;">&nbsp;12</font></td>
                                                                                <td width="97%" nowrap>
                                                                                    <font size="1">Registered Address</font>
                                                                                    <input type="text" value="" size="60" name="frm2550q:txtAddress" maxlength="150" id="frm2550q:txtAddress" onblur="return capital(this, event)" />
                                                                                </td>
                                                                            </tr>
                                                                        </table>
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                        <td width="40%" valign="top" class="tblFormTd">
                                                            <table border="0" cellspacing="0" cellpadding="0" width="100%">
                                                                <tr>
                                                                    <td width="100%" nowrap>
                                                                        <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                                                            <tr>
                                                                                <td width="35%" nowrap><font size="1.5" style="font-weight: bold;">&nbsp;13&nbsp;</font><font size="1">Zip Code</font></td>
                                                                                <td width="65%" nowrap align="right">
                                                                                    <input type="text" value="" size="15" maxlength="8" id="frm2550q:txtZipCode" name="frm2550q:txtZipCode" onkeypress="return wholenumber(this, event)" />
                                                                                </td>
                                                                            </tr>
                                                                        </table>
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <table width="741" border="0" cellspacing="0" cellpadding="0" class="tblForm">
                                                    <tr>
                                                        <td class="tblFormTdPart">
                                                            <table width="" border="0" cellspacing="0" cellpadding="0">
                                                                <tr>
                                                                    <td colspan="2"><font size="1.5" style="font-weight: bold;">&nbsp;14&nbsp;</font></td>
                                                                    <td colspan="2"><font size="1">Are you availing of tax relief under Special Law / International Tax Treaty?</font></td>
                                                                    <td width="19">&nbsp;</td>
                                                                    <td width="56">
                                                                        <input type="radio" value="Y" name="frm2550q:OptTreaty" id="frm2550q:OptTreaty1" onclick="enableSelTreaty()" />
                                                                        <label for="frm2550q:OptTreaty1" style="font-size: 10px;">Yes</label>&nbsp;&nbsp;&nbsp;
                                                                    </td>
                                                                    <td width="42">
                                                                        <input type="radio" value="N" name="frm2550q:OptTreaty" id="frm2550q:OptTreaty2" checked="checked" onclick="disableSelTreaty()" />
                                                                        <label for="frm2550q:OptTreaty2" style="font-size: 10px;">No</label>
                                                                    </td>
                                                                    <td width="10">&nbsp;</td>
                                                                    <td width="232"><font size="1" face="Arial, Helvetica, sans-serif">If yes, specify&nbsp;
                                                                <select disabled="disabled"
                                                                    id="frm2550q:lstTaxTreaty" name="frm2550q:lstTaxTreaty" size="1">
                                                                    <option selected="selected" value="0"></option>
                                                                    <option value="1">Special Rate</option>
                                                                    <option value="2">International Tax Treaty</option>
                                                                </select>
                                                                    </font>
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="height: 14px" width="100%" border="0.1" cellspacing="0" cellpadding="0">
                                                <hr />
                                                <img id="frm2550Q:part2_header" src="../img/2550m_part2_header.jpg" width="100%" height="14px" />
                                            </td>
                                        </tr>
                                        <!--<tr>
                                <td>
                                    <table width="741" border="0" cellspacing="0" cellpadding="0" class="tblForm">
                                        <tr>
                                            <td class="tblFormTdPart">
                                                <table width="" border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td width="88">&nbsp;&nbsp;&nbsp;<font size="1.5" style="font-weight:bold;">Part II</font></td>
                                                        <td width="565">
                                                            <div align="center"><font size="1.5" face="Arial, Helvetica, sans-serif"><b>Computation of Tax</b></font></div>
                                                        </td>
                                                        <td width="88">&nbsp;</td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>-->
                                        <tr>
                                            <td>
                                                <table width="741" border="0" cellspacing="0" cellpadding="0" class="tblForm">
                                                    <tr>
                                                        <td class="tblFormTd">
                                                            <table width="100%" border="0" cellspacing="0" cellpadding="0">
                                                                <tr>
                                                                    <td width="26">&nbsp;</td>
                                                                    <td colspan="2" align="center"><font size="1">Sales/Receipts for the Quarter (Exclusive of VAT)</font></td>
                                                                    <td align="center"><font size="1">Output Tax Due for the Quarter</font></td>
                                                                </tr>
                                                                <tr>
                                                                    <td width="26"><font size="1.5" style="font-weight: bold;">&nbsp;15&nbsp;&nbsp;</font></td>
                                                                    <!--<td width="297"><font size="1" face="Arial, Helvetica, sans-serif">Vatable Sales/Receipt - Private  ( <input type="button" class="printButtonClass" value='Sch. 1' id='btnSched1' onclick="showSched1()" />)</font></td>-->
                                                                    <td width="297"><font size="1" face="Arial, Helvetica, sans-serif">Vatable Sales/Receipt - Private  ( <a href="#" id='btnSched1' onclick="showSched1()">Sch. 1</a> )</font></td>
                                                                    <td width="198"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">15A</font>&nbsp;
                                                                <input type="text" value="0.00" style="background-color: rgb(220, 220, 220); color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax15A" />
                                                                    </span></td>

                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">15B</font>&nbsp;
                                                                <input type="text" value="0.00" style="background-color: rgb(220, 220, 220); color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax15B" />
                                                                    </span></td>
                                                                </tr>


                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;16&nbsp;</font></td>
                                                                    <td><font size="1"></font><font size="1" face="Arial, Helvetica, sans-serif">Sales to Government</font></td>
                                                                    <td width="198"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">16A</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax16A" onblur='round(this,2);compute16B();compute19AB();changedTxtTax16A();valuesSched4and5();' onkeypress="return numbersonly(this, event)" />
                                                                    </span></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">16B</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax16B" onblur='round(this,2);compute19AB()' onkeypress="return numbersonly(this, event)" />
                                                                    </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;17</font></td>
                                                                    <td><font size="1" face="Arial, Helvetica, sans-serif">Zero Rated Sales/Receipts</font></td>
                                                                    <td width="198"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">17</font>&nbsp;&nbsp;&nbsp;&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax17" onblur='round(this,2);compute19AB()' onkeypress="return numbersonly(this, event)" />
                                                                    </span></td>
                                                                    <td width="219"></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;18</font></td>
                                                                    <td><font size="1" face="Arial, Helvetica, sans-serif">Exempt Sales/Receipts</font></td>
                                                                    <td width="198"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">18</font>&nbsp;&nbsp;&nbsp;&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax18" onblur='round(this,2);compute19AB();valuesSched4and5();' onkeypress="return numbersonly(this, event)" />
                                                                    </span></td>
                                                                    <td width="219"></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;19</font></td>
                                                                    <td><font size="1" face="Arial, Helvetica, sans-serif">Total Sales/Receipts and Output Tax Due</font></td>
                                                                    <td width="198"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">19A&nbsp;</font>
                                                                        <input type="text" value="0.00" style="background-color: rgb(220, 220, 220); color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax19A" onblur='valuesSched4and5();' />
                                                                    </span></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">19B</font>
                                                                        <input type="text" value="0.00" style="background-color: rgb(220, 220, 220); color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax19B" />
                                                                    </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;20&nbsp;</font></td>
                                                                    <td><font size="1" face="Arial, Helvetica, sans-serif">Less: Allowable Input Tax</font></td>
                                                                    <td width="198"><span class="spacePadder"></span></td>
                                                                    <td width="219"><span class="spacePadder"></span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;</font></td>
                                                                    <td colspan="2"><font size="1.5" style="font-weight: bold;">20</font><font size="1.5" style="font-weight: bold;">A&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Input Tax Carried Over from Previous Period</font></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">20A</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax20A" onblur="round(this,2);compute20F() " onkeypress="return numbersonly(this, event)" />
                                                                    </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;</font></td>
                                                                    <td colspan="2"><font size="1.5" style="font-weight: bold;">20</font><font size="1.5" style="font-weight: bold;">B&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Input Tax Deferred on Capital Goods Exceeding P1Million from Previous Period</font></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">20B</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax20B" onblur="round(this,2);compute20F()" onkeypress="return numbersonly(this, event)" />
                                                                    </span></td>
                                                                </tr>


                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;</font></td>
                                                                    <td><font size="1.5" style="font-weight: bold;">20</font><font size="1.5" style="font-weight: bold;">C&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Transitional Input Tax</font></td>
                                                                    <td width="198"></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">20C</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax20C" onblur="round(this,2);compute20F()" onkeypress="return numbersonly(this, event)" />
                                                                    </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;</font></td>
                                                                    <td><font size="1.5" style="font-weight: bold;">20</font><font size="1.5" style="font-weight: bold;">D&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Presumptive Input Tax</font></td>
                                                                    <td width="198"></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">20D</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax20D" onblur="round(this,2);compute20F()" onkeypress="return numbersonly(this, event)" />
                                                                    </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;</font></td>
                                                                    <td><font size="1.5" style="font-weight: bold;">20</font><font size="1.5" style="font-weight: bold;">E&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Others</font></td>
                                                                    <td width="198"></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">20E</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax20E" onblur="round(this,2);compute20F()" onkeypress="return numbersonly(this, event)" />
                                                                    </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;</font></td>
                                                                    <td><font size="1.5" style="font-weight: bold;">20</font><font size="1.5" style="font-weight: bold;">F&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Total (Sum of Item 20A, 20B, 20C, 20D &  20E)</font></td>
                                                                    <td width="198"></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">20F</font>&nbsp;
                                                                <input type="text" value="0.00" style="background-color: rgb(220, 220, 220); color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax20F" />
                                                                    </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;21&nbsp;</font></td>
                                                                    <td><font size="1" face="Arial, Helvetica, sans-serif">Current Transactions</font></td>
                                                                    <td align="center"><font size="1">Purchases</font></td>
                                                                    <td width="219"><span class="spacePadder"></span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;</font></td>
                                                                    <!--<td><font size="1.5" style="font-weight:bold;">21</font><font size="1.5" style="font-weight:bold;">A/B&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">	Purchase of Capital Goods not exceeding P1Million  (See <input type="button" class="printButtonClass" value='Sch. 2' id='btnSched2' onclick="showSched2()" /> )</font></td>-->
                                                                    <td nowrap><font size="1.5" style="font-weight: bold;">21</font><font size="1.5" style="font-weight: bold;">A/B&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">	Purchase of Capital Goods not exceeding P1Million  ( <a href="#" id='btnSched2' onclick="showSched2()">Sch. 2</a> )</font></td>
                                                                    <td width="198"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">21A</font>&nbsp;
                                                                <input type="text" value="0.00" style="background-color: rgb(220, 220, 220); color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax21A" />
                                                                    </span></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">21B</font>&nbsp;
                                                                <input type="text" value="0.00" style="background-color: rgb(220, 220, 220); color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax21B" />
                                                                    </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;</font></td>
                                                                    <!--<td> <font size="1.5" style="font-weight:bold;">21</font><font size="1.5" style="font-weight:bold;">C/D&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">	Purchase of Capital Goods exceeding P1Million  (See <input type="button" class="printButtonClass" value='Sch. 3' id='btnSched3A' onclick="showSched3();" /> )</font></td>-->
                                                                    <td><font size="1.5" style="font-weight: bold;">21</font><font size="1.5" style="font-weight: bold;">C/D&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">	Purchase of Capital Goods exceeding P1Million  ( <a href="#" id='btnSched3A' onclick="showSched3();">Sch. 3</a> )</font></td>
                                                                    <td width="198"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">21C</font>&nbsp;
                                                                <input type="text" value="0.00" style="background-color: rgb(220, 220, 220); color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax21C" />
                                                                    </span></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">21D</font>&nbsp;
                                                                <input type="text" value="0.00" style="background-color: rgb(220, 220, 220); color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax21D" />
                                                                    </span></td>
                                                                </tr>


                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;</font></td>
                                                                    <td><font size="1.5" style="font-weight: bold;">21</font><font size="1.5" style="font-weight: bold;">E/F&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Domestic Purchases of Goods Other than Capital Goods</font></td>
                                                                    <td width="198"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">21E</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax21E" onblur="round(this,2);compute21P();compute21TransactionbyRow('E')" onkeypress="return numbersonly(this, event)" />
                                                                    </span></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">21F</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax21F" onblur="round(this,2);compute22()" onkeypress="return numbersonly(this, event)" />
                                                                    </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;</font></td>
                                                                    <td><font size="1.5" style="font-weight: bold;">21</font><font size="1.5" style="font-weight: bold;">G/H&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Importation of Goods Other than Capital Goods</font></td>
                                                                    <td width="198"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">21G</font>
                                                                        <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax21G" onblur="round(this,2);compute21P();compute21TransactionbyRow('G')" onkeypress="return numbersonly(this, event)" />
                                                                    </span></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">21H</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax21H" onblur="round(this,2);compute22()" onkeypress="return numbersonly(this, event)" />
                                                                    </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;</font></td>
                                                                    <td><font size="1.5" style="font-weight: bold;">21</font><font size="1.5" style="font-weight: bold;">I/J&nbsp;&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Domestic Purchase of Services</font></td>
                                                                    <td width="198"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">21I</font>&nbsp;&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax21I" onblur="round(this,2);compute21P();compute21TransactionbyRow('I')" onkeypress="return numbersonly(this, event)" />
                                                                    </span></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">21J</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax21J" onblur="round(this,2);compute22()" onkeypress="return numbersonly(this, event)" />
                                                                    </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;</font></td>
                                                                    <td><font size="1.5" style="font-weight: bold;">21</font><font size="1.5" style="font-weight: bold;">K/L&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Services rendered by Non-residents</font></td>
                                                                    <td width="198"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">21K</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax21K" onblur="round(this,2);compute21P();compute21TransactionbyRow('K')" onkeypress="return numbersonly(this, event)" />
                                                                    </span></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">21L</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax21L" onblur="round(this,2);compute22()" onkeypress="return numbersonly(this, event)" />
                                                                    </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;</font></td>
                                                                    <td><font size="1.5" style="font-weight: bold;">21</font><font size="1.5" style="font-weight: bold;">M&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Purchases Not Qualified for Input Tax</font></td>
                                                                    <td width="198"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">21M</font>
                                                                        <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax21M" onblur="round(this,2);compute21P()" onkeypress="return numbersonly(this, event)" />
                                                                    </span></td>
                                                                    <td width="219"></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;</font></td>
                                                                    <td><font size="1.5" style="font-weight: bold;">21</font><font size="1.5" style="font-weight: bold;">N/O&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Others</font></td>
                                                                    <td width="198"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">21N</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax21N" onblur="round(this,2);compute21P();compute21TransactionbyRow('N')" onkeypress="return numbersonly(this, event)" />
                                                                    </span></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">21O</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax21O" onblur="round(this,2);compute22()" onkeypress="return numbersonly(this, event)" />
                                                                    </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;</font></td>
                                                                    <td><font size="1.5" style="font-weight: bold;">21</font><font size="1.5" style="font-weight: bold;">P&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">	Total Current Purchases (Sum of Item 21A, 21C, 21E, 21G, 21I, 21K, 21M & 21N)</font></td>
                                                                    <td width="198"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">21P</font>&nbsp;
                                                                <input type="text" value="0.00" style="background-color: rgb(220, 220, 220); color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax21P" />
                                                                    </span></td>
                                                                    <td width="219"></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;22&nbsp;&nbsp;</font></td>
                                                                    <td colspan="2"><font size="1" face="Arial, Helvetica, sans-serif">Total Available Input Tax (Sum of Item 20F, 21B, 21D, 21F, 21H, 21J, 21L & 21O)</font></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">22</font>&nbsp;&nbsp;&nbsp;
                                                                <input type="text" value="0.00" style="background-color: rgb(220, 220, 220); color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax22" />
                                                                    </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;23&nbsp;</font></td>
                                                                    <td><font size="1" face="Arial, Helvetica, sans-serif">Less: Deductions from Input Tax</font></td>
                                                                    <td width="198"><span class="spacePadder"></span></td>
                                                                    <td width="219"><span class="spacePadder"></span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;</font></td>
                                                                    <!--<td colspan="2"> <font size="1.5" style="font-weight:bold;">23A&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Input Tax on Purchases of Capital Goods exceeding P1Million deferred for      the succeeding period  (See <input type="button" class="printButtonClass" value='Sch. 3' id='btnSched3B' onclick="showSched3();" /> )</font></td>-->
                                                                    <td colspan="2" nowrap><font size="1.5" style="font-weight: bold;">23A&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Input Tax on Purchases of Capital Goods exceeding P1Million deferred for the succeeding period  ( <a href="#" id='btnSched3B' onclick="showSched3();">Sch. 3</a> )</font></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">23A</font>&nbsp;
                                                                <input type="text" value="0.00" style="background-color: rgb(220, 220, 220); color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax23A" />
                                                                    </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;</font></td>
                                                                    <!--<td colspan="2"> <font size="1.5" style="font-weight:bold;">23B&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Input Tax on Sale to Gov't. closed to expense  ( <input type="button" class="printButtonClass" value='Sch. 4' id='btnSched4' onclick="showSched4()" /> )</font></td>-->
                                                                    <td colspan="2"><font size="1.5" style="font-weight: bold;">23B&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Input Tax on Sale to Gov't. closed to expense  ( <a href="#" id='btnSched4' onclick="showSched4()">Sch. 4</a> )</font></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">23B</font>&nbsp;
                                                                <input type="text" value="0.00" style="background-color: rgb(220, 220, 220); color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax23B" />
                                                                    </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;</font></td>
                                                                    <!--<td colspan="2"> <font size="1.5" style="font-weight:bold;">23C&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Input Tax allocable to Exempt Sales  ( <input type="button" class="printButtonClass" value='Sch. 5' id='btnSched5' onclick="showSched5()" /> )</font></td>-->
                                                                    <td colspan="2"><font size="1.5" style="font-weight: bold;">23C&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Input Tax allocable to Exempt Sales  ( <a href="#" id='btnSched5' onclick="showSched5()">Sch. 5</a> )</font></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">23C</font>&nbsp;
                                                                <input type="text" value="0.00" style="background-color: rgb(220, 220, 220); color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax23C" />
                                                                    </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;</font></td>
                                                                    <td colspan="2"><font size="1.5" style="font-weight: bold;">23D&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">VAT Refund/TCC claimed</font></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">23D</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax23D" onblur="round(this,2);compute23F()" onkeypress="return numbersonly(this, event)" />
                                                                    </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;</font></td>
                                                                    <td colspan="2"><font size="1.5" style="font-weight: bold;">23E&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Others</font></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">23E</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax23E" onblur="round(this,2);compute23F()" onkeypress="return numbersonly(this, event)" />
                                                                    </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;</font></td>
                                                                    <td colspan="2"><font size="1.5" style="font-weight: bold;">23F&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Total (Sum of Item 23A, 23B, 23C, 23D & 23E)</font></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">23F</font>&nbsp;
                                                                <input type="text" value="0.00" style="background-color: rgb(220, 220, 220); color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax23F" />
                                                                    </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;24&nbsp;&nbsp;</font></td>
                                                                    <td colspan="2"><font size="1" face="Arial, Helvetica, sans-serif">Total Allowable Input Tax (Item 22 less Item 23F)</font></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">24</font>&nbsp;&nbsp;&nbsp;
                                                                <input type="text" value="0.00" style="background-color: rgb(220, 220, 220); color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax24" />
                                                                    </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;25&nbsp;&nbsp;</font></td>
                                                                    <td colspan="2"><font size="1" face="Arial, Helvetica, sans-serif">Net VAT Payable (item 19B less Item 24)</font></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">25</font>&nbsp;&nbsp;&nbsp;
                                                                <input type="text" value="0.00" style="background-color: rgb(220, 220, 220); color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax25" />
                                                                    </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;26&nbsp;</font></td>
                                                                    <td><font size="1" face="Arial, Helvetica, sans-serif">Less: Tax Credits/Payments</font></td>
                                                                    <td width="198"><span class="spacePadder"></span></td>
                                                                    <td width="219"><span class="spacePadder"></span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;</font></td>
                                                                    <td colspan="2"><font size="1.5" style="font-weight: bold;">26A&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Monthly VAT Payments - previous two months</font></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">26A</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax26A" onblur='round(this,2);compute26H()' onkeypress="return numbersonly(this, event)" />
                                                                    </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;</font></td>
                                                                    <!--<td colspan="2"> <font size="1.5" style="font-weight:bold;">26B&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Creditable Value-Added Tax Withheld (See <input type="button" class="printButtonClass" value='Sch. 6' id='btnSched6' onclick="showSched6();" /> )</font></td>-->
                                                                    <td colspan="2"><font size="1.5" style="font-weight: bold;">26B&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Creditable Value-Added Tax Withheld ( <a href="#" id='btnSched6' onclick="showSched6();">Sch. 6</a> )</font></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">26B</font>&nbsp;
                                                                <input type="text" value="0.00" style="background-color: rgb(220, 220, 220); color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax26B" />
                                                                    </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;</font></td>
                                                                    <!--<td colspan="2"> <font size="1.5" style="font-weight:bold;">26C&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Advance Payment for Sugar and Flour Industries( <input type="button" class="printButtonClass" value='Sch. 7' id='btnSched7' onclick="showSched7();" /> )</font></td>-->
                                                                    <td colspan="2"><font size="1.5" style="font-weight: bold;">26C&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Advance Payment for Sugar and Flour Industries( <a href="#" id='btnSched7' onclick="showSched7();">Sch. 7</a> )</font></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">26C</font>&nbsp;
                                                                <input type="text" value="0.00" style="background-color: rgb(220, 220, 220); color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax26C" />
                                                                    </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;</font></td>
                                                                    <!--<td colspan="2"> <font size="1.5" style="font-weight:bold;">26D&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">VAT withheld on Sales to Government  ( <input type="button" class="printButtonClass" value='Sch. 8' id='btnSched8' onclick="showSched8();" /> )</font></td>-->
                                                                    <td colspan="2"><font size="1.5" style="font-weight: bold;">26D&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">VAT withheld on Sales to Government  ( <a href="#" id='btnSched8' onclick="showSched8();">Sch. 8</a> )</font></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">26D</font>&nbsp;
                                                                <input type="text" value="0.00" style="background-color: rgb(220, 220, 220); color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax26D" />
                                                                    </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;</font></td>
                                                                    <td colspan="2"><font size="1.5" style="font-weight: bold;">26E&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">VAT paid in return previously filed, if this is an amended return</font></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">26E</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax26E" onblur='round(this,2);compute26H()' onkeypress='return numbersonly(this, event)' />
                                                                    </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;</font></td>
                                                                    <td colspan="2"><font size="1.5" style="font-weight: bold;">26F&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Advance Payments made (please attach proof of payments - BIR Form No. 0605)</font></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">26F</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax26F" onblur='round(this,2);compute26H()' onkeypress='return numbersonly(this, event)' />
                                                                    </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;</font></td>
                                                                    <td colspan="2"><font size="1.5" style="font-weight: bold;">26G&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Others</font></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">26G</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax26G" onblur='round(this,2);compute26H()' onkeypress='return numbersonly(this, event)' />
                                                                    </span></td>
                                                                </tr>

                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;</font></td>
                                                                    <td colspan="2"><font size="1.5" style="font-weight: bold;">26H&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Total Tax Credits/Payments(Sum of Item 26A, 26B, 26C, 26D, 26E, 26F, & 26G)</font></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">26H</font>&nbsp;
                                                                <input type="text" value="0.00" style="background-color: rgb(220, 220, 220); color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax26H" />
                                                                    </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;27&nbsp;&nbsp;</font></td>
                                                                    <td colspan="2"><font size="1" face="Arial, Helvetica, sans-serif">Tax Still Payable/ (Overpayment) (Item 25 less Item 26H)</font></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">27</font>&nbsp;&nbsp;&nbsp;&nbsp;
                                                                <input type="text" value="0.00" style="background-color: rgb(220, 220, 220); color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax27" />
                                                                    </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td colspan="4">
                                                                        <table width="732">
                                                                            <tr>
                                                                                <td width="22"><font size="1.5" style="font-weight: bold;">&nbsp;28&nbsp;</font></td>
                                                                                <td width="75" align="center"><font size="1" face="Arial, Helvetica, sans-serif">&nbsp;Add Penalties </font></td>
                                                                                <td align="center"><font size="1" face="Arial, Helvetica, sans-serif">Surcharge</font></td>
                                                                                <td align="center"><font size="1" face="Arial, Helvetica, sans-serif">Interest</font></td>
                                                                                <td align="center"><font size="1" face="Arial, Helvetica, sans-serif">Compromise</font></td>
                                                                                <td align="center"></td>
                                                                            </tr>
                                                                            <tr>
                                                                                <td width="22"><font size="1.5" style="font-weight: bold;">&nbsp;&nbsp;</font></td>
                                                                                <td width="75" align="center">&nbsp;</td>
                                                                                <td width="130"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">28A</font>&nbsp;
                                                                            <input type="text" value="0.00" style="color: black; text-align: right;" size="17" maxlength="15" id="frm2550q:txtTax28A" onblur="round(this,2);computePenalties()" onkeypress="return numbersonly(this, event)" />
                                                                                </span></td>
                                                                                <td width="130"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">28B</font>&nbsp;
                                                                            <input type="text" value="0.00" style="color: black; text-align: right;" size="17" maxlength="15" id="frm2550q:txtTax28B" onblur="round(this,2);computePenalties()" onkeypress="return numbersonly(this, event)" />
                                                                                </span></td>
                                                                                <td width="130"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">28C</font>&nbsp;
                                                                            <input type="text" value="0.00" style="color: black; text-align: right;" size="17" maxlength="15" id="frm2550q:txtTax28C" onblur="round(this,2);computePenalties()" onkeypress="return numbersonly(this, event)" />
                                                                                </span></td>
                                                                                <td width="206"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">28D</font>&nbsp;
                                                                            <input type="text" value="0.00" style="background-color: rgb(220, 220, 220); color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax28D" />
                                                                                </span></td>
                                                                            </tr>
                                                                        </table>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td><font size="1.5" style="font-weight: bold;">&nbsp;29&nbsp;&nbsp;</font></td>
                                                                    <td colspan="2"><font size="1" face="Arial, Helvetica, sans-serif">Total Amount Payable (Overpayment) (Sum of Item 27& 28D)</font></td>
                                                                    <td width="219"><span class="spacePadder"><font size="1.5" style="font-weight: bold;">29</font>&nbsp;
                                                                <input type="text" value="0.00" style="background-color: rgb(220, 220, 220); color: black; text-align: right;" size="20" maxlength="25" id="frm2550q:txtTax29" />
                                                                    </span></td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <div class="imgClass" align='center' style="display: none; width: 741px !important;">
                                                    <!-- <img id="frm2550Q:jurat" src="../img/jurat/2550Q.jpg" width="741" height="300"/> -->
                                                    <table style="border-top: 3px solid black; border-collapse: collapse; font-family: arial; font-size: 10px; text-align: center; table-layout: fixed; background-color: white;">
                                                        <col width="33%" />
                                                        <col width="19%" />
                                                        <col width="19%" />
                                                        <col width="29%" />
                                                        <tr>
                                                            <td colspan="4">&nbsp;&nbsp;&nbsp;&nbsp;I declare, under the penalties of perjury, that this return has been made in good faith, verified by me, and to the best of my knowledge, and 
								  					<br />
                                                                belief, is true and correct, pursuant to the provisions of the National Internal Revenue Code, as amended, and the regulations issued under authority thereof.
								  					<br />
                                                                &nbsp;</td>
                                                        </tr>
                                                        <tr>
                                                            <td colspan="3"><b>30</b>______________________________________________________________________________
									  				&nbsp;&nbsp;&nbsp;&nbsp;
									  				<br />
                                                                President/Vice President/Principal Officer/Accredited Tax Agent/
								    				<br />
                                                                Authorized Representative/Taxpayer
								    				<br />
                                                                (Signature Over Printed Name)</td>
                                                            <td><b>31</b>_____________________________
								    				<br />
                                                                Treasurer/Assistant Treasurer
								    				<br />
                                                                (Signature Over Printed Name)
								    				<br />
                                                                &nbsp;</td>
                                                        </tr>
                                                        <tr>
                                                            <td>_______________________________________
							    					<br />
                                                                Title/Position of Signatory</td>
                                                            <td colspan="2">______________________________________
								    				<br />
                                                                TIN of Signatory</td>
                                                            <td>______________________________
									    			<br />
                                                                Title/Position of Signatory</td>
                                                        </tr>
                                                        <tr>
                                                            <td>_______________________________________
								    				<br />
                                                                Tax Agent Acc. No./Atty's Roll No.(if applicable)</td>
                                                            <td>_______________
								    				<br />
                                                                Date of Issuance</td>
                                                            <td>_______________
								    				<br />
                                                                Date of Expiry</td>
                                                            <td>______________________________
									    			<br />
                                                                TIN of Signatory</td>
                                                        </tr>
                                                    </table>
                                                </div>
                                                <div class="imgClass" align='center' style="display: none; width: 741px !important;">
                                                    <img id="frm2550Q:jurat" src="../img/jurat/2550Q_new.jpg" width="741" />
                                                </div>
                                                <div class="imgClass" align='center' style="display: none; width: 741px !important;">
                                                    <table style="font-size: 10px; text-align: left; vertical-align: top; background-color: white;">
                                                        <tr>
                                                            <td>&nbsp;Machine Validation/Revenue Official Receipt Details (If not filed with an Authorized Agent Bank)<br />
                                                                <br />
                                                                <br />
                                                                <br />
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </div>
                                                <table width="741" border="0" cellspacing="0" cellpadding="0" class="tblForm printButtonClass">
                                                    <tr>
                                                        <td class="tblFormTdPart">
                                                            <table width="" border="0" cellspacing="0" cellpadding="0">
                                                                <tbody>
                                                                    <tr valign="middle">
                                                                        <td width="55"></td>
                                                                        <td width="697">
                                                                            <div align="center">
                                                                                <input class="printButtonClass" type="button" value="Validate" style="width: 100px;" name="frm2550q:cmdValidate" id="frm2550q:cmdValidate" onclick="validate()" />
                                                                                <input class="printButtonClass" type="button" value="Edit" style="width: 100px;" name="frm2550q:cmdEdit" id="frm2550q:cmdEdit" onclick="AllControlDisabled(false)" />
                                                                                <!--<input class="printButtonClass" type="button" value="Submit" style="width: 100px;" name="btnUpload" id="btnUpload" />-->
                                                                                <input class="printButtonClass" type="hidden" value="Submit" style="width: 100px;" name="btnUpload" id="btnUpload" />
                                                                                <input class="printButtonClass" type="button" value="Save" style="width: 100px;" name="btnSave" id="btnSave" onclick="saveXML(false);" />
                                                                                <input class="printButtonClass" type="button" value="Print" style="width: 100px;" name="btnPrint" id="btnPrint" onclick="printme();" />
                                                                                <input class="printButtonClass" type="button" value="Submit / Final Copy" style="width: 200px;" name="frm2550q:btnFinalCopy" id="frm2550q:btnFinalCopy" onclick="openAlertEmail();" />
                                                                                <div id="msg" class="printButtonClass" style="display: none;"></div>
                                                                            </div>
                                                                        </td>
                                                                        <div id="DummyTxt" style='display: none;'></div>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>

                        </td>
                        <td valign="top">
                            <img id="frm2550Q:bcsImg" src="../img/BCS.jpg" /></td>
                    </tr>
                </table>

            </div>
        </div>

        <!-- modal Sched1  -->
        <!--<div id="modalSched1" class="aBox2550mSched1" style="width: 820px; display:none;" align="center">-->
        <div id="modalSched1" class="printSignFooterClass aBox2550mSched1" style="width: 94%; display: none; height: 50%; position: fixed; top: 3%; left: 3%; right: auto; overflow-y: auto; overflow-x: hidden; background: #e2e2e2;" align="center">
            <br />
            <br />

            <table border="1" cellspacing="3" cellpadding="3" style="position: static; width: 100%" id="tblTax">
                <tr>
                    <td class="modalHeader" colspan="4">Schedule 1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                Schedule of Sales/Receipts and Output Tax (Attach additional sheet, if necessary) </td>
                </tr>
                <tr class="modalColumnHeader">
                    <td width='50%' align="center"><b>Industry Covered by VAT </b></td>
                    <td width='10%'>
                        <input id="btnSched1ATC" type="button" class="printButtonClass" value="ATC" onclick="showModalAtc()" />
                    </td>
                    <td width='20%'><b>Amount of Sales/Receipts For the Period </b></td>
                    <td width='20%'><b>Output Tax for the Period </b></td>

                </tr>
                <tr>
                    <td class="modalContent" colspan="4">
                        <table id="tblSched1Atc" cellspacing="3" cellpadding="3" width="100%">
                            <tr>
                                <td></td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
            <table style="position: static; width: 100%" border="1">
                <tr>
                    <td class="modalColumnHeader" width="60%" colspan="2">To Item 15A/B</td>
                    <td width="20%">
                        <input type="text" style="text-align: right; background-color: rgb(220, 220, 220);" id="txtmodaltxtTotal15A" size="20" value="0.00" disabled />
                    </td>
                    <td width="20%">
                        <input type="text" style="text-align: right; background-color: rgb(220, 220, 220);" id="txtmodaltxtTotal15B" size="20" value="0.00" disabled />
                    </td>
                </tr>
            </table>
            <br />
            <br />
            <div align="center">
                <input type="button" class="printButtonClass" name="btnOkPop" id="btnOkPop1" style="width: 120px; height: 30px;" value="OK" onclick="getSched1Modal()" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <input type="button" class="printButtonClass" name="btnClearPop" id="btnClearPop" style="width: 120px; height: 30px;" value="CLEAR" onclick="clearSched1Modal()">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <input type="button" class="printButtonClass" name="btnCancelPop" id="btnCancelPop" style="width: 120px; height: 30px;" value="CANCEL" onclick="cancelSched1Modal()" />
            </div>
            <br />
            <br />
        </div>

        <!-- modal Atc List  -->
        <!--<div id="modalAtc" class="aBox2550mAtc" style="width: 720px;display:none;" align="center">-->
        <div id="modalAtc" class="aBox2550mAtc" style="width: 70%; display: none; height: 90%; position: fixed; top: 3%; left: 15%; right: auto; overflow-y: auto; overflow-x: hidden; background: #e2e2e2;" align="center">
            <br />
            <br />
            <table border="0" cellspacing="3" cellpadding="3" style="position: static; width: 100%">
                <tr>
                    <td colspan="2">&nbsp;</td>
                </tr>
                <tr class="modalColumnHeader">
                    <td width="20%"><b>ATC </b></td>

                    <td width="80%"><b>INDUSTRIES COVERED BY VAT </b></td>
                </tr>
                <tr>
                    <td colspan="2">
                        <hr />
                    </td>
                </tr>

            </table>

            <div style="height: 80%; overflow: auto; width: 90%">
                <table class="modalContent" id="tbllistAtcCode" cellspacing="0" cellpadding="0" width="100%">
                    <tr>
                        <td></td>
                    </tr>
                </table>
            </div>
            <div align="center">
                <input type="button" class="printButtonClass" name="btnOkPop" id="btnOkPop" style="width: 120px; height: 30px;" value="OK" onclick="getATCCode()" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            </div>
            <br />
            <br />
        </div>

        <!-- modal Sched2  -->
        <!--<div id="modalSched2" class="aBox2550mSched2" style="width: 820px;display:none;" align="center">-->
        <div id="modalSched2" class="printSignFooterClass aBox2550mSched2" style="width: 94%; display: none; height: 50%; position: fixed; top: 3%; left: 3%; right: auto; overflow-y: auto; overflow-x: hidden; background: #e2e2e2;" align="center">
            <br />
            <br />

            <table border="1" cellspacing="3" cellpadding="3" width="100%">
                <tr class="modalHeader">
                    <td>Schedule 2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                Purchases/Importation of Capital Goods (Aggregate Amount Not Exceeding P1Million)   </td>
                </tr>

                <tr>
                    <table border="1" cellspacing="3" cellpadding="3" width="100%" id="tblSched2">
                        <thead>
                            <tr class="modalColumnHeader">
                                <td width="4%">&nbsp;  </td>
                                <td width='20%' align="center"><b>Date Purchased </b></td>
                                <td width='30%' align="center"><b>Description </b></td>
                                <td width='20%' align="center"><b>Amount (Net of VAT) </b></td>
                                <td width='20%' align="center"><b>Input Tax </b></td>
                            </tr>
                        </thead>
                        <tbody id="tbodyllistSched2">
                            <tr>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </tr>
                <tr>
                    <table border="1" cellspacing="3" cellpadding="3" width="100%" id="tblSched2">
                        <tr>
                            <td colspan='3' class="modalColumnHeader" align="left" width='54%'>&nbsp;&nbsp;&nbsp;&nbsp;Total (To Item 21C/D)</td>
                            <td width='20%' align="center">
                                <input type="text" disabled id="txtmodalTotalAmt" style="text-align: right; background-color: rgb(220, 220, 220);" size="20" value="0.00" /></td>
                            <td width='20%' align="center">
                                <input type="text" disabled id="txtmodalTotalInputTax" style="text-align: right; background-color: rgb(220, 220, 220);" size="20" value="0.00" /></td>
                        </tr>
                    </table>
                </tr>
            </table>

            <br />
            <br />
            <div align="center">
                <td width='20%' align="center">
                    <input type='button' class="printButtonClass" id="btnAdd1" value='Add' onclick="addlistSched2()" /></td>
                <td width='20%' align="center">
                    <input type='button' class="printButtonClass" id="btnDelete1" value='Delete' onclick="deletelistSched2()" /></td>
                <br />
                <br />
                <input type="button" class="printButtonClass" name="btnOkPop" id="btnOkPop2" style="width: 120px; height: 30px;" value="OK" onclick="getSched2Modal()" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <input type="button" class="printButtonClass" name="btnClearPop2" id="btnClearPop2" style="width: 120px; height: 30px;" value="CLEAR" onclick="clearSched2Modal()">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <input type="button" class="printButtonClass" name="btnCancelPop2" id="btnCancelPop2" style="width: 120px; height: 30px;" value="CANCEL" onclick="cancelSched2Modal()" />
            </div>
            <br />
            <br />
        </div>

        <!-- modal Sched3  -->
        <!--<div id="modalSched3" class="aBox2550mSched3" style="width: 920px;display:none;" align="left">-->
        <div id="modalSched3" class="printSignFooterClass aBox2550mSched3" style="width: 100%; display: none; height: 90%; position: fixed; top: 3%; right: auto; overflow-y: auto; overflow-x: hidden; background: #e2e2e2;" align="center">
            <br />
            <br />

            <div style="width: 100%" align="center">
                <table border="1" cellspacing="0" cellpadding="0" width="100%">
                    <tr>
                        <td>
                            <!--<table border="1" cellspacing="0" cellpadding="0" width="100%">
				<tr class="modalHeader"><td>Schedule 3 Purchases/Importation of Capital Goods (Aggregate Amount Exceeds P1 Million)</td></tr><br/></table>-->
                            <table border="0" cellspacing="3" cellpadding="3" width="100%" align="center">
                                <tr class="modalHeader">
                                    <td>Schedule 3 Purchases/Importation of Capital Goods (Aggregate Amount Exceeds P1 Million)</td>
                                </tr>
                                <tr class="modalColumnHeader">
                                    <td align="left">A) Purchases/Importations This Period</td>
                                </tr>
                            </table>
                            <table border="0" cellspacing="3" cellpadding="3" width="100%" id="tblSched3A" align="center">
                                <thead>
                                    <tr class="modalColumnHeader">
                                        <td width='4%'>&nbsp;</td>
                                        <td width='12%' align="center"><b>Date Purchased</b></td>
                                        <td width='12%' align="center"><b>Description</b></td>
                                        <td width='12%' align="center"><b>Amount (Net of VAT)</b></td>
                                        <td width='12%' align="center"><b>Input Tax (C*TaxRate)</b></td>
                                        <td width='12%' align="center"><b>Est. Life (in months)</b></td>
                                        <td width='12%' align="center"><b>Recognized Life (In Months)Useful life or 60 mos. (whichever is shorter)</b></td>
                                        <td width='12%' align="center"><b>Allowable Input Tax for the Period (D) divided by (F)</b></td>
                                        <td width='12%' align="center"><b>Balance of Input Tax to be carried to Next Period (D) less (G)</b></td>
                                    </tr>
                                    <tr class="modalColumnHeader">
                                        <td width='4%'>&nbsp;</td>
                                        <td width='12%' align="center">A</td>
                                        <td width='12%' align="center">B</td>
                                        <td width='12%' align="center">C</td>
                                        <td width='12%' align="center">D</td>
                                        <td width='12%' align="center">E</td>
                                        <td width='12%' align="center">F</td>
                                        <td width='12%' align="center">G</td>
                                        <td width='12%' align="center">H</td>
                                    </tr>
                                </thead>
                                <tbody id="tbodyllistSched3A">
                                    <tr>
                                        <td></td>
                                    </tr>
                                </tbody>
                                <tfoot>
                                    <tr>
                                        <td class="modalColumnHeader" colspan="3" align="left">Total (To Item 21C/D)</td>
                                        <td width='12%' align="center">
                                            <input type="text" style="text-align: right; background-color: rgb(220, 220, 220);" id="txtmodalTotalAmountSched3" size="20" value="0.00" /></td>
                                        <td width='12%' align="center">
                                            <input type="text" style="text-align: right; background-color: rgb(220, 220, 220);" id="txtmodalTotalInputTaxSched3" size="20" value="0.00" /></td>
                                        <td colspan="3">&nbsp;</td>
                                        <!--<td width="12%" align="center"><input type="text" style="text-align: right; background-color: rgb(220, 220, 220);" id="txtmodalTotalInputDdivFTaxSched" size="20" value="0.00"/></td> JTrac767-->
                                        <td width='12%' align="center">
                                            <input type="text" style="text-align: right; background-color: rgb(220, 220, 220);" id="txtmodalTotalBalanceSched3A" size="20" value="0.00" /></td>
                                    </tr>
                                </tfoot>
                            </table>
                            <div align="center">

                                <input type='button' class="printButtonClass" class="printButtonClass" id="btnAdd2" value='Add' onclick="addlistSched3A()" />
                                <input type='button' class="printButtonClass" id="btnDelete2" value='Delete' onclick="deletelistSched3A()" />

                            </div>
                            <!--<br /><br /><br /><br />-->
                            <table border="0" cellspacing="3" cellpadding="3" width="100%" align="center">
                                <tr class="modalColumnHeader">
                                    <td align="left">B) Purchases/Importations Previous Period</td>
                                </tr>
                            </table>
                            <table border="0" cellspacing="3" cellpadding="3" width="100%" id="tblSched3B" align="center">
                                <thead>
                                    <!--<tr class="modalColumnHeader"><td align="left" colspan="9">B) Purchases/Importations Previous Period</td></tr>					-->
                                    <tr class="modalColumnHeader">
                                        <td width='4%'>&nbsp;</td>
                                        <td width='12%' align="center"><b>Date Purchased</b></td>
                                        <td width='12%' align="center"><b>Description</b></td>
                                        <td width='12%' align="center"><b>Amount (Net of VAT)</b></td>
                                        <td width='12%' align="center"><b>Balance of Input Tax from previous period</b></td>
                                        <td width='12%' align="center"><b>Est. Life (in months)</b></td>
                                        <td width='12%' align="center"><b>Recognized Life (In Months)Useful life or 60 mos. (whichever is shorter)</b></td>
                                        <td width='12%' align="center"><b>Allowable Input Tax for the Period (D) divided by (F)</b></td>
                                        <td width='12%' align="center"><b>Balance of Input Tax to be carried to Next Period (D) less (G)</b></td>
                                    </tr>
                                    <tr class="modalColumnHeader">
                                        <td width='4%'>&nbsp;</td>
                                        <td width='12%' align="center">A</td>
                                        <td width='12%' align="center">B</td>
                                        <td width='12%' align="center">C</td>
                                        <td width='12%' align="center">D</td>
                                        <td width='12%' align="center">E</td>
                                        <td width='12%' align="center">F</td>
                                        <td width='12%' align="center">G</td>
                                        <td width='12%' align="center">H</td>
                                    </tr>
                                </thead>
                                <tbody id="tbodyllistSched3B">
                                    <tr>
                                        <td></td>
                                    </tr>
                                </tbody>
                                <tfoot>
                                    <tr>
                                        <td class="modalColumnHeader" colspan="8" align="left">Total</td>
                                        <td>
                                            <input type="text" style="text-align: right; background-color: rgb(220, 220, 220);" id="txtmodalTotalBalanceSched3B" size="20" value="0.00" />
                                        </td>
                                    </tr>
                                </tfoot>
                            </table>
                            <div align="center">
                                <!--<br />-->
                                <input type='button' class="printButtonClass" id="btnAdd3" value='Add' onclick="addlistSched3B()" />
                                <input type='button' class="printButtonClass" id="btnDelete3" value='Delete' onclick="deletelistSched3B()" />
                                <!--<br />-->
                            </div>
                            <table border="0" cellspacing="3" cellpadding="3" width="100%" align="center">
                                <!--<br />-->
                                <tr>
                                    <td class="modalColumnHeader" align="left" width="88%">C) Total Input Tax Deferred for future period from current and previous purchase (To item 23A)
                            <br />
                                        * - D divided by F multiplied by Number of months in use during the quarter
                                    </td>
                                    <td align="center" width="12%">
                                        <input type='text' style="text-align: right; background-color: rgb(220, 220, 220);" id="txtmodalTotalInputTax20ASched3" size="20" value='0.00' /></td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
            </div>
            <br />
            <br />
            <br />
            <br />
            <div align="center">
                <input type="button" class="printButtonClass" name="btnOkPop" id="btnOkPop3" style="width: 120px; height: 30px;" value="OK" onclick="getSched3Modal()" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <input type="button" class="printButtonClass" name="btnClearPop3" id="btnClearPop3" style="width: 120px; height: 30px;" value="CLEAR" onclick="clearSched3Modal()">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <input type="button" class="printButtonClass" name="btnCancelPop3" id="btnCancelPop3" style="width: 120px; height: 30px;" value="CANCEL" onclick="cancelSched3Modal()" />
                <br />
                <br />
            </div>
        </div>

        <!-- modal Sched4  -->
        <!--<div id="modalSched4" class="aBox2550mSched4" style="width: 820px;display:none;" align="center">-->
        <div id="modalSched4" class="printSignFooterClass aBox2550mSched4" style="width: 94%; display: none; height: 50%; position: fixed; top: 3%; left: 3%; right: auto; overflow-y: auto; overflow-x: hidden; background: #e2e2e2;" align="center">
            <br />
            <br />
            <!--<div align="center" style="width: 90%">
				<table border="1" width="100%">
                <tr class="modalHeader"> <td>Schedule 4 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    Input Tax Attributable to Sale to Government   </td></tr>
				</table>
            </div>-->
            <div style="width: 90%">
                <table border="1" cellspacing="3" cellpadding="3" width="90%" id="tblTax">
                    <tr class="modalHeader">
                        <td colspan="5">Schedule 4 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    Input Tax Attributable Sale to Government   </td>
                    </tr>
                    <tr>
                        <td class="modalContent" rowspan="2" colspan="4" align="right">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            Input Tax directly attributable to sale to government 
                            <br />
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            Add: Ratable portion of Input Tax not directly attributable to any activity:
                        </td>
                        <td align="center">
                            <input type="text" style="text-align: right" id="txtinputtaxSched4" size="20" value="0.00" onblur="round(this,2);computeInputTaxSched4()" onkeypress="return numbersonly(this, event)" />
                        </td>
                    </tr>
                    <tr>
                        <td align="center">&nbsp; </td>
                    </tr>
                    <tr class="modalContent">
                        <td align="right">Taxable sales to government </td>
                        <td>
                            <input type="text" style="text-align: right; background-color: rgb(220, 220, 220);" id="txtTaxableSaleSched4" size="20" value="0.00" />
                        </td>
                        <td rowspan="2">X Amount of Input Tax not
                            <br />
                            directly attributable   </td>
                        <td rowspan="2">
                            <input type="text" style="text-align: right;" id="txtInputTaxnotDirectSched4" size="20" value="0.00" onblur="round(this,2);computeInputTaxSched4()" onkeypress="return numbersonly(this, event)" />
                        </td>
                        <td rowspan="2">
                            <input type="text" style="text-align: right; background-color: rgb(220, 220, 220);" id="txtTotalInputTaxnotDirectSched4" size="20" value="0.00" />
                        </td>
                    </tr>
                    <tr class="modalContent">
                        <td align="right">----------------------------------------------
                            <br />
                            Total Sales             </td>
                        <td>
                            <input type="text" style="text-align: right; background-color: rgb(220, 220, 220);" id="txtTotalSaleSched4" size="20" value="0.00" />
                        </td>
                    </tr>
                    <tr>
                        <td class="modalContent" colspan="4" align="right">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            Total Input Tax attributable to sale to government</td>
                        <td>
                            <input type="text" style="text-align: right; background-color: rgb(220, 220, 220);" id="txtTotalInputSaletoGovernmentSched4" size="20" value="0.00" />
                        </td>
                    </tr>
                    <tr>
                        <td class="modalContent" colspan="4" align="right">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            Less: Standard Input Tax to sale to government</td>
                        <td>
                            <input type="text" style="text-align: right" id="txtlessStdTaxSched4" size="20" value="0.00" onblur="round(this,2);computeInputTaxSched4()" onkeypress="return numbersonly(this, event)" />
                        </td>
                    </tr>
                    <tr>
                        <td class="modalContent" colspan="4" align="right">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            Input Tax on Sale to Govt. closed to expense (To Item 20B)</td>
                        <td>
                            <input type="text" style="text-align: right; background-color: rgb(220, 220, 220);" id="txtTotal20BSched4" size="20" value="0.00" />
                        </td>
                    </tr>
                </table>

            </div>
            <br />
            <br />
            <div align="center">
                <input type="button" class="printButtonClass" name="btnOkPop" id="btnOkPop4" style="width: 120px; height: 30px;" value="OK" onclick="getSched4Modal()" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <input type="button" class="printButtonClass" name="btnClearPop4" id="btnClearPop4" style="width: 120px; height: 30px;" value="CLEAR" onclick="clearSched4Modal()">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <input type="button" class="printButtonClass" name="btnCancelPop4" id="btnCancelPop4" style="width: 120px; height: 30px;" value="CANCEL" onclick="cancelSched4Modal()" />
            </div>
            <br />
            <br />
        </div>

        <!-- modal Sched5  -->
        <!--<div id="modalSched5" class="aBox2550mSched5" style="width: 820px;display:none;" align="center">-->
        <div id="modalSched5" class="printSignFooterClass aBox2550mSched5" style="width: 94%; display: none; height: 50%; position: fixed; top: 3%; left: 3%; right: auto; overflow-y: auto; overflow-x: hidden; background: #e2e2e2;" align="center">
            <br />
            <br />
            <div style="width: 90%">
                <table border="1" cellspacing="3" cellpadding="3" width="90%" id="tblTax">
                    <tr class="modalHeader">
                        <td colspan="6">Schedule 5 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    Input Tax Attributable to Exempt Sales   </td>
                    </tr>
                    <tr class="modalContent">
                        <td rowspan="2" colspan="5" align="right">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            Input Tax directly attributable to exempt sale  
                            <br />
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            Add: Ratable portion of Input Tax not directly attributable to any activity:
                        </td>
                        <td align="center">
                            <input type="text" style="text-align: right" id="txtinputtaxSched5" size="20" value="0.00" onblur="round(this,2);computeInputTaxSched5()" onkeypress="return numbersonly(this, event)" />
                        </td>
                    </tr>
                    <tr>
                        <td align="center">&nbsp; </td>
                    </tr>
                    <tr>
                        <td class="modalContent">Total Sales  </td>
                        <td>
                            <input type="text" style="text-align: right; background-color: rgb(220, 220, 220);" id="txtTotSaleSched5" size="20" value="0.00" />
                        </td>
                        <td>&nbsp; </td>
                    </tr>
                    <tr class="modalContent">
                        <td colspan="2">Total Exempt sale 
                            <br />
                            -----------------------------------------X  </td>
                        <td rowspan="2">Amount of Input Tax not directly attributable   </td>
                        <td rowspan="2">
                            <input type="text" style="text-align: right" id="txtAmountInputnotDirectSched5" size="20" value="0.00" onblur="round(this,2);computeInputTaxSched5()" onkeypress="return numbersonly(this, event)" />
                        </td>
                        <td rowspan="2">
                            <input type="text" style="text-align: right; background-color: rgb(220, 220, 220);" id="txtProductnotDirectSched5" size="20" value="0.00" />
                        </td>
                        <td></td>
                    </tr>
                    <tr class="modalContent">
                        <td>Total Sales  
                            <br />
                        </td>
                        <td>
                            <input type="text" style="text-align: right; background-color: rgb(220, 220, 220);" id="txtSumTotalSaleSched5" size="20" value="0.00" />
                        </td>
                    </tr>
                    <tr class="modalContent">
                        <td colspan="5">Total input tax attributable to exempt sale (To item 20 C)
                        </td>
                        <td>
                            <input type="text" style="text-align: right; background-color: rgb(220, 220, 220);" id="txtTotal20CSched5" size="20" value="0.00" />
                        </td>
                    </tr>
                </table>
            </div>
            <br />
            <br />
            <div align="center">
                <input type="button" class="printButtonClass" name="btnOkPop" id="btnOkPop5" style="width: 120px; height: 30px;" value="OK" onclick="getSched5Modal()" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <input type="button" class="printButtonClass" name="btnClearPop5" id="btnClearPop5" style="width: 120px; height: 30px;" value="CLEAR" onclick="clearSched5Modal()">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            
			<input type="button" class="printButtonClass" name="btnCancelPop5" id="btnCancelPop5" style="width: 120px; height: 30px;" value="CANCEL" onclick="cancelSched5Modal()" />
            </div>
            <br />
            <br />
        </div>

        <!-- modal Sched6  -->
        <!--<div id="modalSched6" class="aBox2550qSched6" style="width: 820px; display:none;" align="center">-->
        <div id="modalSched6" class="printSignFooterClass aBox2550qSched6" style="width: 94%; display: none; height: 50%; position: fixed; top: 3%; left: 3%; right: auto; overflow-y: auto; overflow-x: hidden; background: #e2e2e2;" align="center">
            <br />
            <br />
            <table border="1" width="100%">
                <tr class="modalHeader">
                    <td>Schedule 6 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                Tax Withheld Claimed as Tax Credit </td>
                </tr>
            </table>
            <table border="1" cellspacing="0" cellpadding="0" width="100%" id="tblSched6">
                <thead>
                    <tr class="modalColumnHeader">
                        <td width='4%'>&nbsp;  </td>
                        <td width='16%' align='center'><b>Period Covered </b></td>
                        <td width='16%' align='center'><b>Name of Withholding Agent </b></td>
                        <td width='16%' align='center'><b>Income Payment </b></td>
                        <td width='16%' align='center'><b>Total Tax Withheld</b></td>
                        <td width='16%' align='center'><b>Previous 2 mos</b></td>
                        <td width='16%' align='center'><b>Applied Current mo.</b></td>
                    </tr>
                </thead>
                <tbody id="tbodyllistSched6">
                    <tr>
                        <td></td>
                    </tr>
                </tbody>
            </table>
            <table cellspacing="3" cellpadding="3" width="100%" border="1">
                <tr>
                    <td width="66%" class="modalColumnHeader" align="left" colspan="5">&nbsp;&nbsp;&nbsp;&nbsp;Total (To Item 26B)</td>
                    <td width="17%" align="center">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="text" style="text-align: right; background-color: rgb(220, 220, 220);" id="txtmodalTotal23A" value="0.00" disabled style="width: 150px" />
                    </td>
                    <td width="17%" align="center">&nbsp;&nbsp;<input type="text" style="text-align: right; background-color: rgb(220, 220, 220);" id="txtmodalTotalSched6AppliedCurrent" value="0.00" disabled style="width: 150px" />
                    </td>
                </tr>
            </table>
            <div>
                <input type='button' class="printButtonClass" id="btnAdd4" value='Add' onclick="addlistSched6()" />
                <input type='button' class="printButtonClass" id="btnDelete4" value='Delete' onclick="deletelistSched6()" />
            </div>
            <br />
            <br />
            <div align="center">
                <input type="button" class="printButtonClass" name="btnOkPop" id="btnOkPop6" style="width: 120px; height: 30px;" value="OK" onclick="getSched6Modal()" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <input type="button" class="printButtonClass" name="btnClearPop6" id="btnClearPop6" style="width: 120px; height: 30px;" value="CLEAR" onclick="clearSched6Modal()">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <input type="button" class="printButtonClass" name="btnCancelPop6" id="btnCancelPop6" style="width: 120px; height: 30px;" value="CANCEL" onclick="cancelSched6Modal()" />
            </div>
            <br />
            <br />
        </div>

        <!-- modal Sched7  -->
        <!--<div id="modalSched7" class="aBox2550qSched7" style="width: 920px; display:none;" align="center">-->
        <div id="modalSched7" class="printSignFooterClass aBox2550qSched7" style="width: 94%; display: none; height: 50%; position: fixed; top: 3%; left: 3%; right: auto; overflow-y: auto; overflow-x: hidden; background: #e2e2e2;" align="center">
            <br />
            <br />
            <table border="1" width="100%" align="center">
                <tr class="modalHeader">
                    <td>Schedule 7 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                Schedule of Advance Payment </td>
                </tr>
            </table>
            <table border="1" width="100%" id="tblSched7">
                <thead>
                    <tr class="modalColumnHeader">
                        <td width='2%'>&nbsp;  </td>
                        <td width='14%' align='center'><b>Period Covered </b></td>
                        <td width='14%' align='center'><b>Name of Miller </b></td>
                        <td width='14%' align='center'><b>Name of Tax Payer </b></td>
                        <td width='14%' align='center'><b>Official Reciept Number</b></td>
                        <td width='14%' align='center'><b>Amount Paid</b></td>
                        <td width='14%' align='center'><b>Previous 2 mos</b></td>
                        <td width='14%' align='center'><b>Applied Current mo.</b></td>
                    </tr>
                </thead>
                <tbody id="tbodyllistSched7">
                    <tr>
                        <td></td>
                    </tr>
                </tbody>
            </table>
            <table border="1" width="100%">
                <tr>
                    <td width="60%" class="modalColumnHeader" align="left" colspan="2">&nbsp;&nbsp;&nbsp;&nbsp;Total (To Item 26C)</td>
                    <td width="40%" align="right">
                        <input type="text" style="text-align: right; background-color: rgb(220, 220, 220);" id="txtmodalTotal23B" value="0.00" disabled style="width: 150px" />&nbsp;&nbsp;
                    <input type="text" style="text-align: right; background-color: rgb(220, 220, 220);" id="txtmodalTotalSched7AppliedCurrent" value="0.00" disabled style="width: 150px" />&nbsp;</td>
                </tr>
            </table>
            <div align="center">
                <input type='button' class="printButtonClass" id="btnAdd5" value='Add' onclick="addlistSched7()" />
                <input type='button' class="printButtonClass" id="btnDelete5" value='Delete' onclick="deletelistSched7()" />
                <br />
                <br />
                <input type="button" class="printButtonClass" name="btnOkPop" id="btnOkPop7" style="width: 120px; height: 30px;" value="OK" onclick="getSched7Modal()" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <input type="button" class="printButtonClass" name="btnClearPop7" id="btnClearPop7" style="width: 120px; height: 30px;" value="CLEAR" onclick="clearSched7Modal()">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <input type="button" class="printButtonClass" name="btnCancelPop7" id="btnCancelPop7" style="width: 120px; height: 30px;" value="CANCEL" onclick="cancelSched7Modal()" />
            </div>
            <br />
            <br />
        </div>
        <!-- modal Sched8  -->
        <!--<div id="modalSched8" class="aBox2550qSched8" style="width: 820px; display:none;" align="center">-->
        <div id="modalSched8" class="printSignFooterClass aBox2550qSched8" style="width: 94%; display: none; height: 50%; position: fixed; top: 3%; left: 3%; right: auto; overflow-y: auto; overflow-x: hidden; background: #e2e2e2;" align="center">
            <br />
            <br />
            <table border="1" width="100%" align="center">
                <tr class="modalHeader">
                    <td>Schedule 8 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                VAT Withheld on Sales to Government </td>
                </tr>
            </table>

            <table border="1" width="100%" id="tblSched8">
                <thead>
                    <tr class="modalColumnHeader">
                        <td width="4%">&nbsp;  </td>
                        <td width='16%' align="center"><b>Period Covered </b></td>
                        <td width='16%' align="center"><b>Name of Withholding Agent </b></td>
                        <td width='16%' align="center"><b>Income Payment </b></td>
                        <td width='16%' align="center"><b>Total Tax Withheld</b></td>
                        <td width='16%' align="center"><b>Previous 2 mos</b></td>
                        <td width='16%' align="center"><b>Applied Current mo.</b></td>
                    </tr>
                </thead>
                <tbody id="tbodyllistSched8">
                    <tr>
                        <td></td>
                    </tr>
                </tbody>
            </table>
            <table width="100%" border="1">
                <tr>
                    <td width="68%" class="modalColumnHeader" align="left" colspan="2">&nbsp;&nbsp;&nbsp;&nbsp;Total (To Item 26D)</td>
                    <td width="16%">
                        <input type="text" style="text-align: right; background-color: rgb(220, 220, 220);" id="txtmodalTotal23C" value="0.00" disabled style="width: 150px" />
                    </td>
                    <td width="16%">
                        <input type="text" style="text-align: right; background-color: rgb(220, 220, 220);" id="txtmodalTotalSched8AppliedCurrent" value="0.00" disabled style="width: 150px" />
                    </td>
                </tr>
            </table>
            <div>
                <input type='button' class="printButtonClass" id="btnAdd6" value='Add' onclick="addlistSched8()" />
                <input type='button' class="printButtonClass" id="btnDelete6" value='Delete' onclick="deletelistSched8()" />
            </div>
            <br />
            <br />
            <div align="center">
                <input type="button" class="printButtonClass" name="btnOkPop" id="btnOkPop8" style="width: 120px; height: 30px;" value="OK" onclick="getSched8Modal()" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <input type="button" class="printButtonClass" name="btnClearPop8" id="btnClearPop8" style="width: 120px; height: 30px;" value="CLEAR" onclick="clearSched8Modal()">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <input type="button" class="printButtonClass" name="btnCancelPop8" id="btnCancelPop8" style="width: 120px; height: 30px;" value="CANCEL" onclick="cancelSched8Modal()" />
            </div>
            <br />
            <br />
        </div>

        <!-- import modal -->
        <div id="modalImport" style="width: 50%; display: none; height: 40%; position: fixed; top: 3%; left: 25%; right: auto; overflow-y: auto; overflow-x: hidden; background: #e2e2e2;" align="center">
            <br />
            <br />
            <table border="0" width="60%" align="center">
                <tr class="modalHeader">
                    <td>Import</td>
                </tr>
            </table>
            <table border="0" cellspacing="3" cellpadding="3" width="60%">
                <tr>
                    <td>&nbsp;</td>
                </tr>
            </table>
            <div align="center">
                <br />
                <br />
                <input type="button" class="printButtonClass" name="btnOkImport" id="btnOkImport" style="width: 120px; height: 30px;" value="OK" onclick="importFiles()" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				<input type="button" class="printButtonClass" name="btnCancelImport" id="btnCancelImport" style="width: 120px; height: 30px;" value="CANCEL" onclick="cancelImportModal()" />
            </div>
            <br />
            <br />
        </div>
        <!-- Send Email -->
        <div id="hiddenEnroll" style="display: none;">
            <input id="txtFinalFlag" class="FinalFlag" name="txtFinalFlag" type="text" onblur="" onkeypress="" value="0" maxlength="60" />
            <input id="txtEnroll" name="txtEnroll" type="text" onblur="" onkeypress="" value="N" maxlength="60" />
        </div>
        <div id="ebirConfirmOnline" style="display: none; position: fixed; top: 20%; left: 32%; right: auto; overflow-y: auto; overflow-x: hidden; background: #e2e2e2; padding: 20px; border: 2px solid blue;">
            <div style="position: relative; width: 100%;">

                <span style="font-weight: bold; font-size: largerBold;">Please Re - enter your eBIRForms Online Username and Password.</span>

            </div>
            <div class="modalInner" style="width: 98%;">
                <table>
                    <tr>
                        <td>Confirm USERNAME:
                        </td>
                        <td>

                            <input type="text" id="ebirOnlineConfirmUsername" maxlength="50" />
                        </td>
                    </tr>
                    <tr>
                        <td>Confirm	PASSWORD:
                        </td>
                        <td>
                            <input type="password" id="ebirOnlineConfirmPassword" maxlength="50" />
                        </td>
                    </tr>

                    <tr>
                        <td>
                            <input type="button" id="ebirOnlineConfirmSubmit" value="Submit" onclick="sendEmail(this);" />
                        </td>
                        <td>
                            <input type="button" id="ebirOnlineConfirmCancel" value="Cancel" onclick="SetFinalFlagTo0();HideContainer('ebirConfirmOnline'); ShowContainer('container'); " />
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <div id="tosa" style="display: none;">
            <h2>Terms of Service Agreement</h2>
            <p class="indentTosa">
                Thank you for visiting the eBIRForms webpage. By accessing and/or using any part of this website and eBIRForms System (including the online and offline services), herein collectively called the "Service", you shall be deemed to have accepted to be legally bound by these Terms of Service.
            </p>
            <p class="indentTosa">
                Please review the following terms carefully. The terms "Bureau", "we", "us" and "our" refer to the Bureau of Internal Revenue or BIR, the legal name of the owner of the website. The term "you" refers to the taxpayer, tax agent, tax software provider or any user or viewer of our site. The Bureau reserves the right to modify these terms or provide additional terms from time to time. The continued use of the Service following the posting of any changes to the Terms of Service constitutes your acceptance of such changes.
            </p>

            <h2>Description of Service</h2>

            <p class="indentTosa">The Service provides you with the facility to file/submit returns and pay taxes due thereon using the eBIRForms System. It also receives returns generated by the third party software and filed by the taxpayer or tax agent.</p>
            <p class="indentTosa">The Service provides you with the following services:</p>
            <ul class="indentTosa">
                <li class="indentTosa">downloadable tax preparation software package</li>
                <li class="indentTosa">taxpayer, tax agent and tax software provider enrollment</li>
                <li class="indentTosa">file/submit tax returns, and attachments (upon system’s update)</li>
                <li class="indentTosa">access to payment facility to make payments</li>
                <li class="indentTosa">access to the taxpayer’s record</li>
                <li class="indentTosa">access to tax records of tax agent including client/s who authorized such tax agent for electronic  filing and/or payment</li>
                <li class="indentTosa">update user record</li>
                <li class="indentTosa">assign tax agent by taxpayer and correspondingly, tax agent to represent a taxpayer</li>
                <li class="indentTosa">third party data lay-out requirements publication</li>
                <li class="indentTosa">third party software compliance testing</li>
            </ul>


            <h2>General User's Obligations</h2>

            <h4>Filing/Submitting Tax Returns</h4>
            <p class="indentTosa">In filing or submitting tax returns, you may either use the eBIRForms software package or the system’s upload facility for the returns generated by an accredited third party software.</p>
            <p class="indentTosa">It is your responsibility to file your return and pay the correct taxes on time, failure to do so may result to the imposition of corresponding penalties (e.g., surcharge and interest) and to civil and criminal liability as provided by law and regulations.</p>

            <h4>Use of eBIRForms Software Package</h4>
            <p class="indentTosa">The eBIRForms software package is for your personal, non-commercial use only. The downloaded software package is used for filling up of tax returns, and there is a facility for its electronic submission.  It is designed with automatic population of selected taxpayer information and automatic mathematical computation of tax due based on encoded taxable amounts.</p>
            <p class="indentTosa">It may be used by accredited tax agents/practitioners enrolled in the system in providing services for their clients who have authorized them to file tax returns on said taxpayers’ behalf.</p>
            <p class="indentTosa">The Service ensures the preservation of data transmitted and includes safeguards against efforts to tamper with, manipulate, alter, or subvert the data. Tampering or any attempt to tamper the eBIRForms application software package or data will be dealt with in accordance with the applicable laws.</p>
            <p class="indentTosa">You are responsible for using the eBIRForms software package only on computers and telephone or other lines that you have permission to use, and you are responsible for all related charges, if applicable, such as cable, ISP, and telephone charges.</p>
            <p class="indentTosa">You are strictly prohibited from modifying, copying, distributing, transmitting, displaying, performing, reproducing, publishing, licensing, creating derivative works, transferring or selling any information contained in the package, for a fee or otherwise.</p>

            <h4>Updates of eBIRForms software package</h4>
            <p class="indentTosa">You are required to download updated eBIRForms software package when notified of new versions of the said package.</p>

            <h4>Use of third party software for filing</h4>
            <p class="indentTosa">You are only allowed to use the accredited third party software to generate tax returns for filing.</p>

            <h4>Inactive Accounts</h4>
            <p class="indentTosa">To ensure efficiency in the Service, dormant accounts or those with prolonged period of inactivity shall be suspended and shall be archived and cleaned-up from the system. The system shall notify you through email in case of any account suspension.</p>

            <h4>Session Log-out</h4>
            <p class="indentTosa">Your eBIRForms session shall automatically log-out after a predefined duration of no keyboard activity.</p>

            <h2>Taxpayer's Obligations</h2>

            <h4>Enrollment Obligation</h4>
            <p class="indentTosa">In consideration of your use of the Service, you undertake to provide true, accurate, current and complete information about yourself or your organization as required by the eBIRForms enrollment process. You shall maintain and update the data to keep it true, accurate, current and complete.</p>
            <p class="indentTosa">BIR reserves the right to terminate or suspend your account and to refuse current or future use of the eBIRForms in case any information you provided is found to be untrue, inaccurate, obsolete or incomplete.</p>

            <h4>Security Obligation</h4>
            <p class="indentTosa">You undertake to use the Service in a manner that protects your privacy and the data/information you provide.</p>
            <p class="indentTosa">As part of the enrollment process, you will be provided with an account username and password. You agree not to disclose your account password to anyone and you are fully responsible for all activities that occur under your account username.</p>
            <p class="indentTosa">You are advised to use a strong password consisting of at least eight (8) characters, with numeric as well as alphabetic characters, and with a mix of upper and lower case alphabetic characters and at least one special character (for example, !,@,#).</p>
            <p class="indentTosa">You agree to log-out or lock your computer if unattended to ensure that unauthorized users do not gain access to your account and the data you provided and were provided to you through the Service. You should ensure that you exit from your account at the end of every session.</p>
            <p class="indentTosa">To ensure adequate security in the system, note that the maximum limit set for unsuccessful log-on attempts is three (3) within a sixty-minute period. In the event of account lock, you should request your Revenue District Office (RDO) in writing to unlock your account so you may resume access thereto.</p>
            <p class="indentTosa">You are responsible for the protection of your computer where eBIRForms system is installed against viruses, worms or malwares.</p>
            <p class="indentTosa">You shall immediately notify the BIR Helpdesk at telephone number (02) 981-7050 or (02) 981-7051 of any unauthorized use of your password or account, or any other breach of security.</p>

            <h4>Legal Obligation</h4>
            <p class="indentTosa">The Service provides you various email notifications that may require response or confirmation relative to your use of the system. You must promptly respond to or confirm the email notifications when required.</p>
            <p class="indentTosa">In filing tax returns using the eBIRForms software package or third party software generated return, you may only file your own or your organization's tax returns. You are not allowed to file tax returns of other persons/parties, unless you are a tax agent  duly authorized by your client to file such tax returns.</p>

            <h4>Payment Obligation</h4>
            <p class="indentTosa">It is your obligation to ensure that payment shall be received by the BIR and be cleared on the BIR account on or before the due dates.</p>


            <h2>Accredited Tax Agent's Obligations</h2>

            <h4>Enrollment Obligation</h4>
            <p class="indentTosa">In consideration of your use of the Service, you undertake to provide true, accurate, current and complete information about yourself and the taxpayer you are duly authorized to represent as required by the eBIRForms enrollment process. You shall maintain and update the data to keep it true, accurate, current and complete.</p>
            <p class="indentTosa">BIR reserves the right to terminate or suspend your account and to refuse current or future use of the eBIRForms in case any information you provided is found to be untrue, inaccurate, obsolete or incomplete.</p>

            <h4>Security Obligation</h4>
            <p class="indentTosa">You undertake to use the Service in a manner that protects your privacy and the privacy of the taxpayer you are duly authorized to represent and the data/information you provide.</p>
            <p class="indentTosa">As part of the enrollment process, you will be provided with an account username and password. You agree not to disclose your account password to anyone and you are fully responsible for all activities that occur under your account username.</p>
            <p class="indentTosa">You are advised to use a strong password consisting of at least eight (8) characters, with numeric as well as alphabetic characters, and with a mix of upper and lower case alphabetic characters and at least one special character (for example, !,@,#).</p>
            <p class="indentTosa">You are advised to change your password periodically (i.e., monthly or as may be deemed necessary).</p>
            <p class="indentTosa">You agree to log-out or lock your computer if unattended to ensure that unauthorized users do not gain access to your account and the data you provided and were provided to you through the Service. You should ensure that you exit from your account at the end of every session.</p>
            <p class="indentTosa">To ensure adequate security in the system, note that the maximum limit set for unsuccessful log-on attempts is three (3) within a sixty-minute period. In the event of account lock, you should request your RDO in writing to unlock your account so you may resume access thereto.</p>
            <p class="indentTosa">You are responsible for the protection of your computer where eBIRForms system is installed against viruses, worms or malwares.</p>
            <p class="indentTosa">You shall immediately notify the BIR Helpdesk at telephone number (02) 981-7050 or (02) 981-7051 of any unauthorized use of your password or account, or any other breach of security.</p>

            <h4>Legal Obligation</h4>
            <p class="indentTosa">To be able use this website to access data or perform activities as agent of another person/taxpayer, you should have been duly authorized/appointed/designated as the taxpayer's agent, which authority continues to be effective or must not have been revoked.</p>
            <p class="indentTosa">For purposes of using the Service as a tax agent of another person/taxpayer, you should be an accredited tax agent/practitioner before the BIR pursuant to Revenue Regulations No. 11-2006, as amended by Revenue Regulations No. 4-2010.</p>
            <p class="indentTosa">You may only act as an agent and represent another person/taxpayer after receiving an email confirmation from the BIR allowing you to do so.</p>
            <p class="indentTosa">The Service provides you various email notifications that may require response or confirmation relative to your use of the system. You must promptly respond to or confirm the email notifications when required.</p>
            <p class="indentTosa">You shall not upload files other than the tax returns of taxpayers you are duly authorized to represent and the corresponding attachments. Any violation of this condition shall constitute a ground for the Bureau to terminate or suspend your account and refuse current or future use of the Service.</p>

            <h4>Payment Obligation</h4>
            <p class="indentTosa">It is your obligation to ensure that payment shall be received by the BIR and be cleared on the BIR account on or before the due dates.</p>

            <h2>Tax Software Provider's Obligations</h2>

            <h4>Enrollment Obligation</h4>
            <p class="indentTosa">In consideration of your use of the Service, you undertake to provide true, accurate, current and complete information about yourself or your organization as required by the eBIRForms enrollment process. You shall maintain and update the data to keep it true, accurate, current and complete.</p>
            <p class="indentTosa">BIR reserves the right to terminate or suspend your account and to refuse current or future use of the eBIRForms in case any information you provided is found to be untrue, inaccurate, obsolete or incomplete.</p>

            <h4>Security Obligation</h4>
            <p class="indentTosa">You undertake to use the Service in a manner that protects your privacy and the privacy of any other person/taxpayer and the data/information you provide.</p>
            <p class="indentTosa">As part of the enrollment process, you will be provided with an account username and password. You agree not to disclose your account password to anyone and you are fully responsible for all activities that occur under your account username.</p>
            <p class="indentTosa">You are advised to use a strong password consisting of at least eight (8) characters, with numeric as well as alphabetic characters, and with a mix of upper and lower case alphabetic characters and at least one special character (for example, !,@,#).</p>
            <p class="indentTosa">You are advised to change your password periodically (i.e., monthly or as may be deemed necessary).</p>
            <p class="indentTosa">You agree to log-out or lock your computer if unattended to ensure that unauthorized users do not gain access to your account and the data you provided and were provided to you through the Service. You should ensure that you exit from your account at the end of every session.</p>
            <p class="indentTosa">To ensure adequate security in the system, note that the maximum limit set for unsuccessful log-on attempts is three (3) within a sixty-minute period. In the event of account lock, you should request your RDO in writing to unlock your account so you may resume access thereto.</p>
            <p class="indentTosa">You are responsible for the protection of your computer where eBIRForms system is installed against viruses, worms or malwares.</p>
            <p class="indentTosa">You shall immediately notify the BIR Helpdesk at telephone number (02) 981-7050 or (02) 981-7051 of any unauthorized use of your password or account, or any other breach of security.</p>

            <h4>Legal Obligation</h4>
            <p class="indentTosa">The Service provides you various email notifications that may require response or confirmation relative to your use of the system. You must promptly respond to or confirm the email notifications when required.</p>
            <p class="indentTosa">You are strictly prohibited from sharing your certification number and access credentials to a third party software provider not accredited by the eBIRForms system.</p>
            <p class="indentTosa">You undertake to strictly follow the instructions and guidelines for tax software providers as issued by BIR.</p>
            <p class="indentTosa">You agree to provide software with an electronic export facility that will generate the tax returns.</p>
            <p class="indentTosa">It must be understood that the accreditation issued by the BIR to the tax software provider does not constitute endorsement, sponsorship or approval of the software used to generate the tax returns.</p>

            <h2>Disclaimer</h2>
            <p class="indentTosa">The BIR is providing the eBIRForms website as an alternative mode of filing tax returns. The content of the website is provided in an "as is basis" and without any express or implied warranties.</p>
            <p class="indentTosa">The BIR does not warrant that the Service will be uninterrupted; be free from inaccuracies, errors, viruses or other harmful components; operate in the configuration or with the hardware or software you use.</p>
            <p class="indentTosa">The BIR is not liable or responsible for any damages, expenses, costs or loss of any kind (including, but not limited to, any direct, indirect, special, incidental, or consequential damages, financial losses, loss of profits, loss of any data or loss of any opportunity) caused as a result (directly or indirectly) of, or in connection with, your use of the Service (including the downloads and/or use of the services) or reliance on any information, materials, tools, provided in or available from this site.</p>

            <h5>Last update: June 1, 2015 </h5>
            <div class="centerButton">
                <input type="button" id="btnAgree" value="Agree" onclick="hideTosa(); disableDropDown('after');" />
            </div>
        </div>
        <div id="ebirEnroll" style="display: none; position: fixed; top: 20%; left: 20%; right: auto; overflow-y: auto; overflow-x: hidden; background: #e2e2e2; padding: 20px; border: 2px solid blue;">
            <div style="position: relative; width: 100%;">

                <span style="font-weight: bold;">eBIRForms Terms of Service Agreement (TOSA)</span><br>
                <br />
                <span>Thank you for using eBIRForms. By clicking Agree, you confirm that you have read, understood and agreed to the TOSA.</span><br />
                <br />

                <span>The full eBIRForms TOSA can be accessed <a href="#" onclick="openTermsandAgreement();disableDropDown('before');">here</a>.</span><br />
                <span></span>
                <br />
                <br />

            </div>
            <div class="modalInner" style="width: 98%;">
                <table>
                    </tr>
							<td>
                                <input type="button" id="ebirEnrollYes" value="  Ok  " onclick="sendEmail(this); HideContainer('ebirEnroll');" />
                            </td>
                    <td>
                        <input type="button" id="ebirEnrollNo" value="Cancel" onclick="SetFinalFlagTo0();HideContainer('ebirEnroll'); ShowContainer('container'); " />
                    </td>
                    <tr>
                    </tr>
                </table>
            </div>
        </div>
        <div id="isRegister" style="display: none; position: fixed; top: 40%; left: 35%; right: auto; overflow-y: auto; overflow-x: hidden; background: #e2e2e2; padding: 20px; border: 2px solid blue;">
            <div style="position: relative; width: 100%;">

                <span style="font-weight: bold; font-size: largerBold;">Are you a registered eBIRForms Online User?</span>

            </div>
            <div class="modalInner" style="width: 98%;">
                <table>
                    </tr>
							<td>
                                <input type="button" id="isregistered" value="YES" onclick="HideContainer('isRegister'); ShowContainer('ebirOnline') " />
                            </td>
                    <td>
                        <input type="button" id="notregistered" value="NO" onclick="HideContainer('isRegister');ShowContainer('ebirEnroll'); " />
                    </td>
                    <tr>
                    </tr>
                </table>
            </div>
        </div>

        <div id="ebirOnline" style="display: none; position: fixed; top: 20%; left: 32%; right: auto; overflow-y: auto; overflow-x: hidden; background: #e2e2e2; padding: 20px; border: 2px solid blue;">
            <div style="position: relative; width: 100%;">

                <span style="font-weight: bold; font-size: largerBold;">Please enter your eBIRForms Online Username and Password.</span>

            </div>
            <div class="modalInner" style="width: 98%;">
                <table>
                    <tr>
                        <td>USERNAME:
                        </td>
                        <td>

                            <input type="text" id="ebirOnlineUsername" maxlength="50" />
                        </td>
                    </tr>
                    <tr>
                        <td>PASSWORD:
                        </td>
                        <td>
                            <input type="password" id="ebirOnlinePassword" maxlength="50" />
                            <input type="text" id="ebirOnlineSecret" maxlength="50" style="display: none;" />
                        </td>
                    </tr>

                    <tr>
                        <td>
                            <input type="button" id="ebirOnlineSubmit" value="Submit" onclick="ValidateUserPass();" />
                        </td>
                        <td>
                            <input type="button" id="ebirOnlineCancel" value="Cancel" onclick="SetFinalFlagTo0();HideContainer('ebirOnline'); ShowContainer('container'); " />
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <div id="hiddenEmail" style="display: none;">
            <input id="txtEmail" class="emailClass" name="txtEmail" type="text" onblur="" onkeypress="" maxlength="60" />
        </div>
        <!-- Send Email -->
        <!-- export modal -->
        <div id="modalExport" style="width: 50%; display: none; height: 43%; position: fixed; top: 3%; left: 25%; right: auto; overflow-y: auto; overflow-x: hidden; background: #e2e2e2;" align="center">
            <br />
            <br />
            <table border="0" width="60%" align="center">
                <tr class="modalHeader">
                    <td>Have Disk</td>
                </tr>
            </table>
            <table border="0" cellspacing="3" cellpadding="3" width="60%">
                <tr>
                    <td>&nbsp;</td>
                </tr>
                <tr>
                    <td>&nbsp;</td>
                </tr>
                <tr>
                    <td class="modalColumnHeader">Make sure that a recordable media [diskette/universal serial bus (USB) flash drive, compact disc (cd), digital video disc (dvd)] is already inserted.</td>
                </tr>
                <tr>
                    <td>&nbsp;</td>
                </tr>
                <tr>
                    <td>&nbsp;</td>
                </tr>
                <tr>
                    <td class="modalColumnHeader">Drive: 
						<select class="driveSelect" id="driveSelectTPExport" name="driveSelectTPExport" size="1" class="modalContent">
                        </select>
                    </td>
                </tr>
            </table>
            <div align="center">
                <br />
                <br />
                <input type="button" class="printButtonClass" name="btnOk" id="btnOkExport" style="width: 120px; height: 30px;" value="OK" onclick="exportTPFiles(fileNameToExport); checkFinalCopyBtn('2550Q');" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				<input type="button" class="printButtonClass" name="btnCancel" id="btnCancelExport" style="width: 120px; height: 30px;" value="CANCEL" onclick="cancelExportModal(); checkFinalCopyBtn('2550Q');" />
            </div>
            <br />
            <br />
        </div>
    </form>
    <textarea id='responsetext' style="display: none;"></textarea>
    <!-- XML retrieval -->
    <div style="display: none;">
        <xmp id='xmlFormat'>	
            </xmp>
        <!--format the doc -->
        <span id='xmlClose'>All Rights Reserved BIR 2012.</span>
    </div>
    <div id="responseBG" style="display: none;">
        <!--loaded files render here-->
    </div>
    <div id="response" style="display: none;">
        <!--loaded files render here-->
    </div>
    <div id="responseATC" style="display: none;">
        <!--loaded files render here-->
    </div>
    <div id="responseRdo" style="display: none;">
        <!--loaded files render here-->
    </div>
</body>
</html>


<script type="text/javascript">
	var isSubmitFinal = false;
	var isSubmit = false;
	
	var fileName = "";
	var existingXMLFileName = "";
	
	var gIsReadOnly = false;
	
	/*----------------------------------*/
    var d=document,XMLBGFile='',data='',XMLFile='', XMLATCFile='',msg = d.getElementById('msg'),flag=true,flag2=true,flag3A=true,flag3B=true,flag6=true,flag7=true,flag8=true;
	var loader=d.getElementById('loader');
	/*----------------------------------*/	
	
    var viewUploadFlag = false;
    var tempRowSizeSched1 = 0;
    var tempAtcCode = new Array();
    var tempAmtSales = new Array();
    var tempOutputTax = new Array();

    var tempRowSizeSched2 = 0;
    var tempTempPurDate = new Array();
    var tempDescription = new Array();
    var tempPurAmt = new Array();
    var tempInputTax = new Array();

    var tempRowSizeSched3a = 0;
    var tempTempPeriodCovered = new Array();
    var description = new Array();
    var purAmt = new Array();
    var inputTax = new Array();
    var estMo = new Array();
    var recMo = new Array();
    var allowInput = new Array();
    var balInputTax = new Array();
    var tempPartATotalBal = new Array();

    var tempRowSizeSched3b = 0;
    var tempTempPeriodCoveredB = new Array();
    var tempDescriptionB = new Array();
    var tempPurAmtB = new Array();
    var tempInputTaxB = new Array();
    var tempEstMoB = new Array();
    var tempRecMoB = new Array();
    var tempAllowInputB = new Array();
    var tempBalInputTaxB = new Array();
    var tempTempPartBTotalBalB = new Array();

    var tempDirInputTax = "0.00";
    var tempInputNotAttrib = "0.00";
    var tempRatInputTax = "0.00";
    var tempTotalInputTaxSched4 = "0.00";
    var tempStanInputTax = "0.00";
    var tempInputSaleExp = "0.00";

    var inputTaxExmpt = d.getElementById("txtinputtaxSched5").value = "0.00";
    var inputNotAttribSched5 = d.getElementById("txtAmountInputnotDirectSched5").value = "0.00";
    var ratInputTaxSched5 = d.getElementById("txtProductnotDirectSched5").value = "0.00";
    var totalInputExmpt = d.getElementById("txtTotal20CSched5").value = "0.00";

    var tempRowSizeSched6 = 0;
    var tempTempPeriodCovered = new Array();
    var tempAgentNm = new Array();
    var tempIncPaymnt = new Array();
    var totalTaxWithld = new Array();
    var appPrev = new Array();
    var appCurr = new Array();
    var sched7TotalPrev = new Array();
    var sched7TotalCurr = new Array();

    var tempRowSizeSched7 = 0;
    var tempTempPeriodCovered7 = new Array();
    var tempMillerNm7 = new Array();
    var tempAgentNm7 = new Array();
    var tempOrNumber7 = new Array();
    var tempAmtPaid7 = new Array();
    var tempAppPrev7 = new Array();
    var tempAppCurr7 = new Array();
    var tempSched8TotalPrev7 = new Array();
    var tempSched8TotalCurr7 = new Array();

    var tempRowSizeSched8 = 0;
    var tempTempPeriodCovered8 = new Array();
    var tempAgentNm8 = new Array();
    var tempIncPaymnt8 = new Array();
    var tempTotalTaxWithld8 = new Array();
    var tempAppPrev8 = new Array();
    var tempAppCurr8 = new Array();
    var tempSched9TotalPrev8 = new Array();
    var tempSched9TotalCurr8 = new Array();

	var atcList = new Array();
	var atcCount=0;
	
	var savedReturn = "";
	var p3Compromise = "";
	var p3Surcharge = "";
	var p3Interest = "";
	var p3IsAmended = "";
	var p3FilingDate = "";
	var p3ReturnPeriod = "";
	var p3ReturnPeriodEnd = "";		
	
	var p3BasicTax = "";
	var p3TotalPenalties = "";
	var p3TotalAmountPayable = "";
	
	var p3TPTIN1 = "";
	var p3TPTIN2 = "";
	var p3TPTIN3 = "";
	var p3TPTIN = "";
	var p3TPBranchCode = "";
	var p3TPRDOCode = "";
	var p3TPLineBus = "";
	var p3TPName = "";
	var p3TPTelNum = "";
	var p3TPAddress = "";
	var p3TPZip = "";	
	var globalEmail = "";
    var isReload = false;
    setTimeout("sleeptime()", 300);

	
	function sleeptime()
    {
        isReload = true;
        init();
		
		var bgFileName =  qs('xmlBGInfoFileName'); 
		if (bgFileName != null && bgFileName.indexOf('.xml') > -1) {
			loadBGXML(bgFileName);	
		} 
		
		fileName =  qs('xmlFileName'); 
		if (fileName != null && fileName.indexOf('.xml') > -1) {
			var tin = fileName.split("/")[1].split("-");
			loadBGXML("profile/"+ tin[0]+".xml");
			loadXML(fileName); 
			
			d.getElementById('frm2550q:RtnMonth').disabled = true;
			d.getElementById('frm2550q:txtYear').disabled = true;
			
			existingXMLFileName = fileName;
			if (gIsReadOnly) { 
			window.setTimeout("disableAllElementIDs(); d.getElementById('btnUpload').disabled = false;",1000); 
			}
			//loadXMLWellFormed("savefile/2550Q-wellformed.xml");			
		} else {
			window.setTimeout("$('#loader').hide('blind');",100);
		}
		if ( $('#printMenu').css('display') != 'none' ) {	
			$('#printMenu').hide('blind');
		}
		document.getElementById('frm2550q:txtTIN1').disabled = true; document.getElementById('frm2550q:txtTIN2').disabled = true; document.getElementById('frm2550q:txtTIN3').disabled = true; document.getElementById('frm2550q:txtBranchCode').disabled = true;
	    window.setTimeout("checkFinalCopyBtn('2550Q'); isReload = false;", 2000);
   }
	
	function rdoPropertyJS(rdoCode, description) 
	{
	 this.rdoCode=rdoCode;
	 this.description=description;
	}
	 
	var rdoList = new Array();


    function toggleDisabled(el) {
        try {
            el.disabled = true;
        }
        catch(e){
        }
        if (el.childNodes && el.childNodes.length > 0) {
            for (var x = 0; x < el.childNodes.length; x++) {
                toggleDisabled(el.childNodes[x]);
            }
        }
    }

    function toggleAllDisabled() {
        toggleDisabled(d.getElementById("modalSched1"));
        toggleDisabled(d.getElementById("modalSched2"));
        toggleDisabled(d.getElementById("modalSched3"));
        toggleDisabled(d.getElementById("modalSched4"));
        toggleDisabled(d.getElementById("modalSched5"));
        toggleDisabled(d.getElementById("modalSched6"));
        toggleDisabled(d.getElementById("modalSched7"));
        toggleDisabled(d.getElementById("modalSched8"));
    }

    function init()
    {
        var date = new Date();
		var month = new Date();
		var year = new Date();
		

		
		d.getElementById('frm2550q:RtnMonth').selectedIndex = month.getMonth() + 1; 
		d.getElementById('frm2550q:txtYear').value = date.getFullYear();
		
		d.getElementById('frm2550q:optAmend:_1').disabled = false;
        d.getElementById('frm2550q:optAmend:_2').disabled = false;
        if( d.getElementById('frm2550q:OptShortPrd2').checked ) {
            d.getElementById('frm2550q:RtnMonth').disabled = false;
        }

        d.getElementById('frm2550q:RtnPeriodFrom').disabled = true;
        d.getElementById('frm2550q:RtnPeriodTo').disabled = true;
        d.getElementById('frm2550q:AmendedRtnY').disabled = false;
        d.getElementById('frm2550q:AmendedRtnN').disabled = false;
		
		d.getElementById('frm2550q:optAmend:_1').checked = true;
        d.getElementById('frm2550q:optAmend:_1').onclick();
		
        /*d.getElementById('frm2550q:txtTIN1').disabled = true;
        d.getElementById('frm2550q:txtTIN2').disabled = true;
        d.getElementById('frm2550q:txtTIN3').disabled = true;
        d.getElementById('frm2550q:txtBranchCode').disabled = true;
        d.getElementById('frm2550q:txtRDOCode').disabled = true;
        d.getElementById('frm2550q:txtSheets').disabled = true;
        d.getElementById('frm2550q:txtLineBus').disabled = true;
        d.getElementById('frm2550q:TaxPayer').disabled = true;
        d.getElementById('frm2550q:txtTelNum').disabled = true;
        d.getElementById('frm2550q:txtAddress').disabled = true;
        d.getElementById('frm2550q:txtZipCode').disabled = true;*/
		
        if(d.getElementById('frm2550q:OptTreaty2').checked ) {
            d.getElementById('frm2550q:lstTaxTreaty').disabled = true;
        }
        if( d.getElementById('frm2550q:OptTreaty1').checked ) {
            d.getElementById('frm2550q:OptQuarter1').disabled = true;
            d.getElementById('frm2550q:OptQuarter2').disabled = true;
            d.getElementById('frm2550q:OptQuarter3').disabled = true;
            d.getElementById('frm2550q:OptQuarter4').disabled = true;
        }
        d.getElementById('frm2550q:txtTax15A').disabled = true;
        d.getElementById('frm2550q:txtTax15B').disabled = true;
        d.getElementById('frm2550q:txtTax19A').disabled = true;
        d.getElementById('frm2550q:txtTax19B').disabled = true;
        d.getElementById('frm2550q:txtTax20F').disabled = true;
        d.getElementById('frm2550q:txtTax21A').disabled = true;
        d.getElementById('frm2550q:txtTax21B').disabled = true;
        d.getElementById('frm2550q:txtTax21C').disabled = true;
        d.getElementById('frm2550q:txtTax21D').disabled = true;
        d.getElementById('frm2550q:txtTax21P').disabled = true;
        d.getElementById('frm2550q:txtTax22').disabled = true;
        d.getElementById('frm2550q:txtTax23A').disabled = true;
        d.getElementById('frm2550q:txtTax23A').disabled = true;
        d.getElementById('frm2550q:txtTax23B').disabled = true;
        d.getElementById('frm2550q:txtTax23C').disabled = true;
        d.getElementById('frm2550q:txtTax23F').disabled = true;
        d.getElementById('frm2550q:txtTax24').disabled = true;
        d.getElementById('frm2550q:txtTax25').disabled = true;
        d.getElementById('frm2550q:txtTax26B').disabled = true;
        d.getElementById('frm2550q:txtTax26C').disabled = true;
        d.getElementById('frm2550q:txtTax26D').disabled = true;
        d.getElementById('frm2550q:txtTax26E').disabled = true;
        d.getElementById('frm2550q:txtTax26H').disabled = true;
        d.getElementById('frm2550q:txtTax27').disabled = true;
        d.getElementById('frm2550q:txtTax28A').disabled = false;
        d.getElementById('frm2550q:txtTax28B').disabled = false;
        d.getElementById('frm2550q:txtTax28C').disabled = false;
        d.getElementById('frm2550q:txtTax28D').disabled = true;
        d.getElementById('frm2550q:txtTax29').disabled = true;

        d.getElementById('btnPrint').disabled = true;
        d.getElementById('frm2550q:cmdEdit').disabled = true;
		d.getElementById('frm2550q:btnFinalCopy').disabled = true;
        d.getElementById('btnUpload').disabled = true;
        
		//d.getElementById('tbllistAtcCode').innerHTML = "";
        //d.getElementById('tblSched1Atc').innerHTML = "";
        //d.getElementById('tbodyllistSched2').innerHTML = "";
        //d.getElementById('tbodyllistSched3A').innerHTML = "";
        //d.getElementById('tbodyllistSched3B').innerHTML = "";
        //d.getElementById('tbodyllistSched6').innerHTML = "";
        //d.getElementById('tbodyllistSched7').innerHTML = "";
        //d.getElementById('tbodyllistSched8').innerHTML = "";
        $('#tbllistAtcCode').html("");
		$('#tblSched1Atc').html("");
		$('#tbodyllistSched2').html("");
		$('#tbodyllistSched3A').html("");
		$('#tbodyllistSched3B').html("");
		$('#tbodyllistSched6').html("");
		$('#tbodyllistSched7').html("");
		$('#tbodyllistSched8').html("");
		
		loadXMLATC('xml/atcCodes.xml');
        ATCList();
        changeMonth();
		getDrives();
		
		loadXMLrdo('xml/rdo.xml');
		getRdo();

    }
	
	
	/*--------------------------------------------------------------*/
	//Added By dgarfin
	function loadXMLATC(fileLocation) {
		try {
			//This will load the ATC file with filename 'fileLocation' if it exists
			var fsoXML = new ActiveXObject("Scripting.FileSystemObject");
			XMLATCFile = fsoXML.OpenTextFile(fileLocation,1);	
	
			if (XMLATCFile.AtEndOfStream)
				data = "";
			else {
				var responseATC = d.getElementById('responseATC'); //render file and write to hidden div
				responseATC.innerHTML = XMLATCFile.ReadAll(); //remove XML tag
			}
			XMLATCFile.Close(); //alert( responseATC.innerHTML ); //Debug			
			loadATC();	/*This will load ATC onto an array*/	
		} catch(e) {
			msg.innerHTML = "ATC File not Found.";
		} //this will Alert File not Found if it doesn't exist
	}	
	
	var atcCount=0;
	
	function loadATC() {
		/*This will load data onto an array*/
		var response = d.getElementById("responseATC");
		
		var atcCnt = String(response.innerHTML).split('atcCount=');
		atcCount = atcCnt[1]; 	
		var j = 0;
		//loads atcList from xml
		for (var i = 1; i <= atcCount; i++) { 
			
			var atc = String(response.innerHTML).split('atc'+i+':');
			var atcStr = atc[1];		

			//Ensure that before writing to atcPropertyJS the formType 2550Q is traceable in atcStr
			if (atcStr.indexOf('2550Q') >= 0) {
			    var atcValues = atcStr.split('~');				
				
				var formType = "2550Q";
				var atcCode = atcValues[0];
				var description = atcValues[1];
				var rate = atcValues[2];
				var category = atcValues[3];
				
				var base = '';
				var compType = '';
				var constTaxDue = '';
				var minimum = '';
				var maximum = '';
				
				var objATC = new atcPropertyJS(formType, atcCode, description, rate, category, base, compType, constTaxDue, minimum, maximum);
				atcList[j] = objATC; 
			
				j++;
				//alert('2550Q successfully created array #'+i);
				
			} else {		
				//alert('2550Q not found in array #'+i);
				continue;
			}
		}					
	}	
	
	function atcPropertyJS(formType, atcCode, description, rate, category, base, compType, constTaxDue, minimum, maximum)
	{
		this.formType=formType;
		this.atcCode=atcCode;
		this.description=description;
		this.rate=rate;
		this.category=category;
		this.base=base;
		this.compType=compType;
		this.constTaxDue=constTaxDue;
		this.minimum=minimum;
		this.maximum=maximum;
	}	

	/*--------------------------------------------------------------*/		
	
	function setInputTextControl_HorizontalAlignment(id,align) {
		if (d.getElementById(id) != null) {
			//d.getElementById(id).textIndent = parseInt(align);
			d.getElementById(id).style.textAlign = "right";
		}
	}
	function setInputTextControl_NumberFormatter(id,limit,deci) {
		if (d.getElementById(id) != null) {
			d.getElementById(id).size = parseInt(limit);
			d.getElementById(id).value = parseFloat(d.getElementById(id).value).toFixed( parseInt(deci) );		
		}
	}
	function setInputTextControl_NumberFormatterNonNegative(id,limit,deci) {
		if (d.getElementById(id) != null) {
			d.getElementById(id).size = parseInt(limit);
			d.getElementById(id).value = parseFloat(d.getElementById(id).value).toFixed( parseInt(deci) );		
		}	
	}		
	
	function loadXMLWellFormed(loadWhere) {
		try {
			//This will load the file with filename loadWhere if it exists
			var fsoXML = new ActiveXObject("Scripting.FileSystemObject");
			XMLFile = fsoXML.OpenTextFile(loadWhere,1);	

			if (XMLFile.AtEndOfStream)
				data = "";
			else {
				var response = d.getElementById('response'); //render file and write to hidden div
				response.innerHTML = XMLFile.ReadAll(); //remove XML tag
			}
			XMLFile.Close(); //alert( response.innerHTML ); //Debug				

			if (loadWhere != null && loadWhere != "") {
			
				loadWFData();	/*This will load data onto fields*/								
				
			if (response.innerHTML.indexOf("All Rights Reserved BIR 2012.0") >= 0) {
				gIsReadOnly = true;
			}
		
			if (gIsReadOnly) {
				d.getElementById('frm2550q:cmdValidate').disabled = true;
				d.getElementById('btnSave').disabled = true;
			}

				
				/*-------------Schedule 1 : Find Instances of Dynamic Rows within the XML and add to modal-----------*/			
				getATCCode();					
				window.setTimeout("loadWFDataWithATC();",300);					
				window.setTimeout("loadWFData();",410);
				window.setTimeout("loadWFDataATCRow();getSched1Modal();",450); //flag=true;			
				/*------------- modalSched2 -----------*/
				flag2=false;
				var count=0;
				var responses = d.getElementById('response').getElementsByTagName('*');
				var sPar = 'chxSched2'; 		
				
				do {
				    if (responses.item(count).tagName.indexOf('/') == -1 && responses.item(count).tagName.indexOf(sPar.toUpperCase()) != -1) {  	
						var temp = String(responses.item(count).tagName);
						temp = temp.substring(0,sPar.length+1); //substring to length of search param for index - check files
						temp = temp.substring(sPar.length,sPar.length+1); //get the last character for checking
						if ( !isNaN(temp) ) addlistSched2Reload(); //if last char is a number, add modal section
					} count++;
				} while (count!=responses.length);
				loadWFData();
				getSched2Modal();
				flag2=true;	
				
				/*--------------------------------------------------------------------------------------*/

				/*------------- modalSched3 -----------*/
				flag3A=false;
				var count3A=0;
				var responses3A = d.getElementById('response').getElementsByTagName('*');
				var sPar3A = 'txtAmt3A'; 					
				do {
					if (responses3A.item(count3A).tagName.indexOf('/') == -1 && responses3A.item(count3A).tagName.indexOf(sPar3A.toUpperCase()) != -1) { 
						var temp = String(responses3A.item(count3A).tagName);
						temp = temp.substring(0,sPar3A.length+1); //substring to length of search param for index - check files
						temp = temp.substring(sPar3A.length,sPar3A.length+1); //get the last character for checking
						if ( !isNaN(temp) ) addlistSched3AReload(); //if last char is a number, add modal section
					} count3A++;
				} while (count3A!=responses3A.length);
				
				flag3B=false;
				var count3B=0;
				var responses3B = d.getElementById('response').getElementsByTagName('*');
				var sPar3B = 'txtAmt3B'; 					
				do {
					if (responses3B.item(count3B).tagName.indexOf('/') == -1 && responses3B.item(count3B).tagName.indexOf(sPar3B.toUpperCase()) != -1) { 					
						var temp = String(responses3B.item(count3B).tagName);
						temp = temp.substring(0,sPar3B.length+1); //substring to length of search param for index - check files
						temp = temp.substring(sPar3B.length,sPar3B.length+1); //get the last character for checking
						if ( !isNaN(temp) ) addlistSched3BReload(); //if last char is a number, add modal section
					} count3B++;
				} while (count3B!=responses3B.length);					
				loadWFData();
				getSched3Modal();
				flag3A=true;
				flag3B=true;				
				/*--------------------------------------------------------------------------------------*/	

				/*------------- modalSched6 -----------*/
				flag6=false;
				var count6=0;
				var responses6 = d.getElementById('response').getElementsByTagName('*');
				var sPar6 = 'txtPeriodCovered'; 		
				
				do {
					if (responses6.item(count6).tagName.indexOf('/') == -1 && responses6.item(count6).tagName.indexOf(sPar6.toUpperCase()) != -1) { 					
						var temp = String(responses6.item(count6).tagName);
						temp = temp.substring(0,sPar6.length+1); //substring to length of search param for index - check files
						temp = temp.substring(sPar6.length,sPar6.length+1); //get the last character for checking
						if ( !isNaN(temp) ) addlistSched6Reload(); //if last char is a number, add modal section
					} count6++;
				} while (count6!=responses6.length);
				loadWFData();
				getSched6Modal();
				flag6=true;				
				/*--------------------------------------------------------------------------------------*/			
				
				/*------------- modalSched7 -----------*/
				flag7=false;
				var count7=0;
				var responses7 = d.getElementById('response').getElementsByTagName('*');
				var sPar7 = 'txtPeriodCoveredSch7'; 		
				
				do {
					if (responses7.item(count7).tagName.indexOf('/') == -1 && responses7.item(count7).tagName.indexOf(sPar7.toUpperCase()) != -1) { 								
						var temp = String(responses7.item(count7).tagName);
						temp = temp.substring(0,sPar7.length+1); //substring to length of search param for index - check files
						temp = temp.substring(sPar7.length,sPar7.length+1); //get the last character for checking
						if ( !isNaN(temp) ) addlistSched7Reload(); //if last char is a number, add modal section
					} count7++;
				} while (count7!=responses7.length);
				loadWFData();
				getSched7Modal();
				flag7=true;					
				/*--------------------------------------------------------------------------------------*/		

				/*------------- modalSched8 -----------*/
				flag8=false;
				var count8=0;
				var responses8 = d.getElementById('response').getElementsByTagName('*');
				var sPar8 = 'txtNameAgentSch8'; 		
				
				do {
					if (responses8.item(count8).tagName.indexOf('/') == -1 && responses8.item(count8).tagName.indexOf(sPar8.toUpperCase()) != -1) { 							
						var temp = String(responses8.item(count8).tagName);
						temp = temp.substring(0,sPar8.length+1); //substring to length of search param for index - check files
						temp = temp.substring(sPar8.length,sPar8.length+1); //get the last character for checking
						if ( !isNaN(temp) ) addlistSched8Reload(); //if last char is a number, add modal section
					} count8++;
				} while (count8!=responses8.length);
				loadWFData();
				getSched8Modal();
				flag8=true;	
				/*--------------------------------------------------------------------------------------*/				
				window.setTimeout("$('#loader').hide('blind');",2000);	
			}			
			
		} catch(e) {
			msg.innerHTML = ""; //"Save File not Found.";
		} //this will Alert File not Found if it doesn't exist	
	}

	/*--------------------------------------------------------------*/
	function loadXML(loadWhere) {
		try {
			//This will load the file with filename loadWhere if it exists
			var fsoXML = new ActiveXObject("Scripting.FileSystemObject");
			XMLFile = fsoXML.OpenTextFile(loadWhere,1);	

			if (XMLFile.AtEndOfStream)
				data = "";
			else {
				var response = d.getElementById('response'); //render file and write to hidden div
				response.innerHTML = XMLFile.ReadAll(); //remove XML tag
			}
			XMLFile.Close(); //alert( response.innerHTML ); //Debug				

			if (loadWhere != null && loadWhere != "") {
			
				loadData();	/*This will load data onto fields*/								
				
				if (response.innerHTML.indexOf("All Rights Reserved BIR 2012.0") >= 0) {
				gIsReadOnly = true;
			}
		
			if (gIsReadOnly) {
				d.getElementById('frm2550q:cmdValidate').disabled = true;
				d.getElementById('btnSave').disabled = true;
			}

				
				/*-------------Schedule 1 : Find Instances of Dynamic Rows within the XML and add to modal-----------*/			
				getATCCode();
				window.setTimeout("loadDataWithATC();",300);					
				window.setTimeout("loadData();",410);
				window.setTimeout("loadDataATCRow();getSched1Modal();",450); //flag=true;		
				
				/*------------- modalSched2 -----------*/
				flag2=false;
				var count=0;
				var responses = d.getElementById('response').getElementsByTagName('div');
				var sPar = 'chxSched2'; 		
				
				do {
					if (responses.item(count).innerHTML.indexOf(sPar) != -1) {
						var temp = String(responses.item(count).innerHTML);
						temp = temp.substring(0,sPar.length+1); //substring to length of search param for index - check files
						temp = temp.substring(sPar.length,sPar.length+1); //get the last character for checking
						if ( !isNaN(temp) ) addlistSched2Reload(); //if last char is a number, add modal section
					} count++;
				} while (count!=responses.length);
				window.setTimeout("loadData();getSched2Modal();flag2=true;",510);	
				/*--------------------------------------------------------------------------------------*/

				/*------------- modalSched3 -----------*/
				flag3A=false;
				var count3A=0;
				var responses3A = d.getElementById('response').getElementsByTagName('div');
				var sPar3A = 'txtAmt3A'; 					
				do {
					if (responses3A.item(count3A).innerHTML.indexOf(sPar3A) != -1) {
						var temp = String(responses3A.item(count3A).innerHTML);
						temp = temp.substring(0,sPar3A.length+1); //substring to length of search param for index - check files
						temp = temp.substring(sPar3A.length,sPar3A.length+1); //get the last character for checking
						if ( !isNaN(temp) ) addlistSched3AReload(); //if last char is a number, add modal section
					} count3A++;
				} while (count3A!=responses3A.length);
				
				flag3B=false;
				var count3B=0;
				var responses3B = d.getElementById('response').getElementsByTagName('div');
				var sPar3B = 'txtAmt3B'; 					
				do {
					if (responses3B.item(count3B).innerHTML.indexOf(sPar3B) != -1) {
						var temp = String(responses3B.item(count3B).innerHTML);
						temp = temp.substring(0,sPar3B.length+1); //substring to length of search param for index - check files
						temp = temp.substring(sPar3B.length,sPar3B.length+1); //get the last character for checking
						if ( !isNaN(temp) ) addlistSched3BReload(); //if last char is a number, add modal section
					} count3B++;
				} while (count3B!=responses3B.length);
				window.setTimeout("loadData();getSched3Modal();flag3A=true;flag3B=true;",510);				
				//window.setTimeout("loadDataATCRow();",610);	
				/*--------------------------------------------------------------------------------------*/	

				/*------------- modalSched6 -----------*/
				flag6=false;
				var count6=0;
				var responses6 = d.getElementById('response').getElementsByTagName('div');
				var sPar6 = 'txtPeriodCovered'; 		
				
				do {
					if (responses6.item(count6).innerHTML.indexOf(sPar6) != -1) {
						var temp = String(responses6.item(count6).innerHTML);
						temp = temp.substring(0,sPar6.length+1); //substring to length of search param for index - check files
						temp = temp.substring(sPar6.length,sPar6.length+1); //get the last character for checking
						if ( !isNaN(temp) ) addlistSched6Reload(); //if last char is a number, add modal section
					} count6++;
				} while (count6!=responses6.length);
				window.setTimeout("loadData();getSched6Modal();flag6=true;",710);	
				/*--------------------------------------------------------------------------------------*/			
				
				/*------------- modalSched7 -----------*/
				flag7=false;
				var count7=0;
				var responses7 = d.getElementById('response').getElementsByTagName('div');
				var sPar7 = 'txtPeriodCoveredSch7'; 		
				
				do {
					if (responses7.item(count7).innerHTML.indexOf(sPar7) != -1) {
						var temp = String(responses7.item(count7).innerHTML);
						temp = temp.substring(0,sPar7.length+1); //substring to length of search param for index - check files
						temp = temp.substring(sPar7.length,sPar7.length+1); //get the last character for checking
						if ( !isNaN(temp) ) addlistSched7Reload(); //if last char is a number, add modal section
					} count7++;
				} while (count7!=responses7.length);
				window.setTimeout("loadData();getSched7Modal();flag7=true;",710);	
				/*--------------------------------------------------------------------------------------*/		

				/*------------- modalSched8 -----------*/
				flag8=false;
				var count8=0;
				var responses8 = d.getElementById('response').getElementsByTagName('div');
				var sPar8 = 'txtNameAgentSch8'; 		
				
				do {
					if (responses8.item(count8).innerHTML.indexOf(sPar8) != -1) {
						var temp = String(responses8.item(count8).innerHTML);
						temp = temp.substring(0,sPar8.length+1); //substring to length of search param for index - check files
						temp = temp.substring(sPar8.length,sPar8.length+1); //get the last character for checking
						if ( !isNaN(temp) ) addlistSched8Reload(); //if last char is a number, add modal section
					} count8++;
				} while (count8!=responses8.length);
				window.setTimeout("loadData();getSched8Modal();flag8=true;",710);	
				/*--------------------------------------------------------------------------------------*/	
				
				window.setTimeout("$('#loader').hide('blind');",2000);	
			}			
			
		} catch(e) {
			msg.innerHTML = ""; //"Save File not Found.";
		} //this will Alert File not Found if it doesn't exist
	}

	function loadDataATCRow() {
		/*This will load data onto fields*/
		var response = d.getElementById("response");		
        var elem = document.getElementById('frmMain').elements;
        for(var i = 0; i < elem.length; i++) {
			
			if (elem[i].type != 'hidden' && elem[i].type != 'undefined') { 
				if (elem[i].type == 'text' || elem[i].type == 'select-one') {
					var fieldVal = String( $("#response").html() ).split(elem[i].id+'=');
					if (fieldVal != null && fieldVal.length > 1) {					
						elem[i].value = ''; 
						elem[i].selectedIndex = 0;
						if(elem[i].id == 'frm2550q:TaxPayer' || elem[i].id == 'frm2550q:txtLineBus' || elem[i].id == 'frm2550q:txtAddress'){
							elem[i].value = unescape(fieldVal[1]);
						}
						else{
							elem[i].value = fieldVal[1]; //all select-one and text values		 		
						}

					}
				}				
			}				
        }
	}	
	
	function loadWFDataATCRow() {
		/*This will load data onto fields*/
		var response = d.getElementById("response");		
        var elem = document.getElementById('frmMain').elements;
        for(var i = 0; i < elem.length; i++) {
			
			if (elem[i].type != 'hidden' && elem[i].type != 'undefined') { 
				if (elem[i].type == 'text' || elem[i].type == 'select-one') {
					var fieldVal = String(response.innerHTML).split(elem[i].id+'>');
					if (fieldVal != null && fieldVal.length > 1) {					
						elem[i].value = ''; 
						elem[i].selectedIndex = 0;
						elem[i].value = fieldVal[1].substring(0, fieldVal[1].indexOf("</")); //all select-one and text values

					}
				}				
			}				
        }
		
	}	
	
	function loadWFDataWithATC() {
		var response = d.getElementById("response");
	
        var elem = d.getElementById('frmMain').elements;
        for(var i = 0; i < elem.length; i++)
        {

			if (elem[i].type != 'hidden' && elem[i].type != 'undefined') {	//elem[i].type != 'button' &&  			
				if (elem[i].type == 'text' || elem[i].type == 'select-one') {
					var fieldVal = String(response.innerHTML).split(elem[i].id+'>'); 
					if (fieldVal != null && fieldVal.length > 1) {
						elem[i].value = fieldVal[1].substring(0, fieldVal[1].indexOf("</")); //all select-one and text values		  
					} 	
				}
				if (elem[i].type == 'radio') {
					var rdoVal = String(response.innerHTML).split(elem[i].id+'>');				
					if (rdoVal[1].substring(0, rdoVal[1].indexOf("</")) == 'true') {
						elem[i].checked = rdoVal[1].substring(0, rdoVal[1].indexOf("</"));
					}						
				}	
				if (elem[i].type == 'checkbox') {
					var chkboxVal = String(response.innerHTML).split(elem[i].id+'>');	

					if (chkboxVal[1].substring(0, chkboxVal[1].indexOf("</")) == 'true') {
						elem[i].checked = chkboxVal[1].substring(0, chkboxVal[1].indexOf("</"));						
					}	
				}			
			}

        } 			
	}
	
	function loadDataWithATC() {
		/*This will load data onto fields*/
		var response = d.getElementById("response");
		
        var elem = d.getElementById('frmMain').elements;
        for(var i = 0; i < elem.length; i++)
        {
			
			if (elem[i].type != 'hidden' && elem[i].type != 'undefined') {	//elem[i].type != 'button' &&  			
				if (elem[i].type == 'text' || elem[i].type == 'select-one') {
					var fieldVal = String( $("#response").html() ).split(elem[i].id+'='); 
						if (fieldVal != null && fieldVal.length > 1) {
							if(elem[i].id == 'frm2550q:TaxPayer' || elem[i].id == 'frm2550q:txtLineBus' || elem[i].id == 'frm2550q:txtAddress'){
								elem[i].value = unescape(fieldVal[1]);
							}
							else{
								elem[i].value = fieldVal[1]; //all select-one and text values		 		
							}
						}		 		
				}
				if (elem[i].type == 'radio') {
					var rdoVal = String( $("#response").html() ).split(elem[i].id+'=');				
					if (rdoVal[1] == 'true') {
						elem[i].checked = rdoVal[1];						
						//if (elem[i].id != 'frm2550q:OptShortPrd1' || ) { 
						//	elem[i].onclick();													
						//}
					}					
				}	
				if (elem[i].type == 'checkbox') {
					var chkboxVal = String( $("#response").html() ).split(elem[i].id+'=');				
					if (chkboxVal[1] == 'true') {
						elem[i].checked = chkboxVal[1];
					}					
				}			
			}

        } 			
	}		
	
	function loadWFData() {
		/*This will load data onto fields*/
		var response = d.getElementById("response");

        var elem = document.getElementById('frmMain').elements;
        for(var i = 0; i < elem.length; i++)
        {

			try{
				if (elem[i].type != 'hidden' && elem[i].type != 'undefined') {	//elem[i].type != 'button' &&  			
					if (elem[i].type == 'text' || elem[i].type == 'select-one') {
						var fieldVal = String(response.innerHTML).split(elem[i].id+'>'); 
						//elem[i].value = fieldVal[1]; //all select-one and text values		 		
						if (fieldVal != null && fieldVal.length > 1) {
							elem[i].value = fieldVal[1].substring(0, fieldVal[1].indexOf("</"));
						}		
					}

					if (elem[i].type == 'radio') {
						var rdoVal = String(response.innerHTML).split(elem[i].id+'>');				
						if (rdoVal[1].substring(0, rdoVal[1].indexOf("</")) == 'true') {
							elem[i].checked = rdoVal[1].substring(0, rdoVal[1].indexOf("</"));
						}					
					}	
					if (elem[i].type == 'checkbox') {
						var chkboxVal = String(response.innerHTML).split(elem[i].id+'>');				
						if (chkboxVal[1].substring(0, chkboxVal[1].indexOf("</")) == 'true') {
							elem[i].checked = chkboxVal[1].substring(0, chkboxVal[1].indexOf("</"));
						}						
					}
				
				}
			} catch(e) {
				//alert('exception thrown : e : '+e.description);
			}

        } 			
	}	
	
	function loadData() {
		/*This will load data onto fields*/
		var response = d.getElementById("response");

        var elem = document.getElementById('frmMain').elements;
        for(var i = 0; i < elem.length; i++)
        {
			try{
				if (elem[i].type != 'hidden' && elem[i].type != 'undefined') {	//elem[i].type != 'button' &&  			
					if (elem[i].type == 'text' || elem[i].type == 'select-one') {
						var fieldVal = String( $("#response").html() ).split(elem[i].id+'='); 
						if(elem[i].id == 'frm2550q:TaxPayer' || elem[i].id == 'frm2550q:txtLineBus' || elem[i].id == 'frm2550q:txtAddress'){
							elem[i].value = unescape(fieldVal[1]);
						}
						else if (elem[i].className.indexOf("FinalFlag") > -1) {
                        elem[i].value = typeof (fieldVal[1]) === "undefined" ? "3" : fieldVal[1];
						}
						else{
							elem[i].value = fieldVal[1]; //all select-one and text values		 		
						}
					}
					if (elem[i].type == 'radio') {
						var rdoVal = String( $("#response").html() ).split(elem[i].id+'=');				
						if (rdoVal[1] == 'true') {
							elem[i].checked = rdoVal[1];
							//if (elem[i].id != 'frm2550q:OptShortPrd1') {
							//	elem[i].onclick();
							//}
						}					
					}	
					if (elem[i].type == 'checkbox') {
						var chkboxVal = String( $("#response").html() ).split(elem[i].id+'=');				
						if (chkboxVal[1] == 'true') {
							elem[i].checked = chkboxVal[1];
						}					
					}
				
				}
			} catch(e) {
				//alert('exception thrown : e : '+e.description);
			}

        } 			
	if(d.getElementById('frm2550q:AmendedRtnY').checked){
			d.getElementById('frm2550q:txtTax26E').disabled = false
		}
		document.getElementById('txtEmail').value = globalEmail;
	}
	function createEncXMLFileName(subFolder) {
		var xmlFileName = "";
	    var titleTin1 = d.getElementById('frm2550q:txtTIN1');
	    var titleTin2 = d.getElementById('frm2550q:txtTIN2');
		var titleTin3 = d.getElementById('frm2550q:txtTIN3');
		var titleBranchCode = d.getElementById('frm2550q:txtBranchCode');	
		var titleTPName = d.getElementById('frm2550q:TaxPayer');			

		var qtr = "";
		if (d.getElementById('frm2550q:OptQuarter1').checked == true) {
			qtr = "Q1";
		}
		if (d.getElementById('frm2550q:OptQuarter2').checked == true) {
			qtr = "Q2";
		}
		if (d.getElementById('frm2550q:OptQuarter3').checked == true) {
			qtr = "Q3";
		}
		if (d.getElementById('frm2550q:OptQuarter4').checked == true) {
			qtr = "Q4";
		}		
		var returnPeriod = d.getElementById('frm2550q:RtnMonth').value + d.getElementById('frm2550q:txtYear').value + qtr;
		
				
			
			xmlFileName = subFolder + titleTin1.value + titleTin2.value + titleTin3.value + titleBranchCode.value +
			"-2550Q-" +
			returnPeriod +
			".xml";	
		
		
		fileName = titleTin1.value + titleTin2.value + titleTin3.value + titleBranchCode.value +
		"-2550Q-" +
		returnPeriod +
		".xml";	 
		
		return xmlFileName; 
	}
	
	function createXMLFileName(subFolder) {
	    var xmlFileName = "";
	    var titleTin1 = d.getElementById('frm2550q:txtTIN1');
	    var titleTin2 = d.getElementById('frm2550q:txtTIN2');
		var titleTin3 = d.getElementById('frm2550q:txtTIN3');
		var titleBranchCode = d.getElementById('frm2550q:txtBranchCode');	
		var titleTPName = d.getElementById('frm2550q:TaxPayer');			

		var qtr = "";
		if (d.getElementById('frm2550q:OptQuarter1').checked == true) {
			qtr = "Q1";
		}
		if (d.getElementById('frm2550q:OptQuarter2').checked == true) {
			qtr = "Q2";
		}
		if (d.getElementById('frm2550q:OptQuarter3').checked == true) {
			qtr = "Q3";
		}
		if (d.getElementById('frm2550q:OptQuarter4').checked == true) {
			qtr = "Q4";
		}		
		var returnPeriod = d.getElementById('frm2550q:RtnMonth').value + d.getElementById('frm2550q:txtYear').value + qtr;
		
		if (existingXMLFileName != null && existingXMLFileName.length > 0) {
			xmlFileName = existingXMLFileName;
			
		} else {		
			
			xmlFileName = subFolder + titleTin1.value + titleTin2.value + titleTin3.value + titleBranchCode.value +
			"-2550Q-" +
			returnPeriod +
			".xml";	
		}
		
		fileName = titleTin1.value + titleTin2.value + titleTin3.value + titleBranchCode.value +
		"-2550Q-" +
		returnPeriod +
		".xml";	 
		
		return xmlFileName; 
	}	
	
	function saveEncryptedProfile(isFromSubmit) {
			var isSaveSuccessful = saveXML(true); 	
			//saveXMLProfile(true);	
		var fnNew = "";	
			
		if (isSaveSuccessful) {		
		
			if (existingXMLFileName.indexOf('/') > -1) { //Means existingXMLFileName is the same as the preloaded file yyy
				fnNew = existingXMLFileName.substring(existingXMLFileName.indexOf('/')+1, existingXMLFileName.length);
			} else {
				if (fileName.indexOf('/') > -1) { //Means fileName is the same as the preloaded file
					fnNew = fileName.substring(fileName.indexOf('/')+1, fileName.length);
				} else {
					fnNew = fileName;
				}
			}
		}else {
			return;
		}			

			if(document.getElementById('txtFinalFlag').value == "3"){ fnNew = fnNew.split(".xml")[0] + "#" + globalEmail + "#.xml"; }      var xmlFileName =  "IAF_RDO_Copy/" + fnNew; //createXMLFileName("IAF_RDO_Copy/");//
			msg.innerHTML='Generating File...';
			var fileSys = new ActiveXObject("Scripting.FileSystemObject");
			var xmlFile = "";
			//dgarfin todo: alert user that it will overwrite existing zzz
			if (doesFileExists(xmlFileName)) {
				//alert("File '"+xmlFileName+"' already exists!\n\nThis will overwrite existing data.");				
			}
			xmlFile = fileSys.CreateTextFile(xmlFileName);
			fileNameToExport = fnNew;
			var allXML = "<?xml version='1.0'?>",tab=d.getElementById('xmlFormat').innerHTML;
			allXML += tab; //adds line break
			
			/*--------------------- follow this format for parsing --------------------------- */
			var elem = document.getElementById('frmMain').elements;
			for(var i = 0; i < elem.length; i++)
			{
				if (elem[i].type != 'button' && elem[i].type != 'hidden' && elem[i].type != 'undefined') {				
					if (elem[i].type == 'text' || elem[i].type == 'select-one') {
						allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab; //all select-one and text values
					}
					if (elem[i].type == 'radio' || elem[i].type == 'checkbox') {
						allXML += "<div>"+elem[i].id+"=" +elem[i].checked+elem[i].id+"=</div>"+tab; //all radio and checkbox values			
					}	
					
				}
			} 				
			/*--------------------- follow this format for parsing --------------------------- */
			allXML += tab+d.getElementById('xmlClose').innerHTML+"0";
			
			//Encryption of data content 'allXML' 
			//allXML = LZString.compress(allXML);
			//var encryptedAllXML = encrypt(allXML);
			
			 xmlFile.write(allXML); 
			xmlFile.close();
			// External compression and encryption
        	var succ = EncryptFile(xmlFileName);
			
			msg.innerHTML = '';
			if (typeof(isFromSubmit) === "undefined") {
				if (confirm('File saved and encrypted.\nDo you want to save this in USB flash drive or CD-RW?')) {
					//alert("Make sure you already inserted your USB flash drive or CD-RW before proceeding.");		
					//show modal "Have Disk"...
					showModalExport();				
					//window.history.go(0);
				} else { // return; //cancel finalcopy
					//exportTPFileInC();
					//alert("You have not saved the file to either your USB flash drive or CD-RW.\n\n In case you want to submit it via email,\nyou may locate it under : 'C:\\IAF_RDO_Copy'");
					//window.history.go(0);
					
					//refresh HTA page here. to address: 
					//Issue#380: A return tagged as final copy should not be edited by tp, rdo, rdc. Currently, user can still modify entries.
					//document.location.reload(true);
					disableAllElementIDs();
					d.getElementById('btnUpload').disabled = false;
				}
			}
			else{
					disableAllElementIDs();
					d.getElementById('btnUpload').disabled = false;
			}
			return fileSys.GetAbsolutePathName(xmlFileName);
		
	}
	
	function doesFileExists(xmlFile) {
		var fileSysObj = new ActiveXObject("Scripting.FileSystemObject");
		if (fileSysObj.FileExists(xmlFile)) {
			return true;
		} else {
			return false;
		}		
	}
	
	function isItAnAmendedReturn(xmlFile) {	
		if(d.getElementById('frm2550q:AmendedRtnY').checked) {
			return true;
		} else {
			return false;
		}		
	}
	
	function isItAFinalCopy(xmlFile) {	
			var fsoXML = new ActiveXObject("Scripting.FileSystemObject");
			fn = fsoXML.OpenTextFile(xmlFile,1);
			var fnContent = fn.ReadAll();
			fn.Close();	

			if (fnContent.indexOf("All Rights Reserved BIR 2012.0") >= 0) {
				return true;
			} else {
				return false;
			}	
	}	
	
	function createNewXMLFileName(subFolder, xmlFileName) {
		//Conditions met here: (isFileExists && isFinalCopy && isAmendedReturn) 
		var fso = new ActiveXObject("Scripting.FileSystemObject");
		var fileNm = "";
		var newFileNm = "";
		
		//Added 10/21/2016
		var subFileName = "";
		var version = 0;

		if (xmlFileName.indexOf('V') == -1) {
			fileNm = xmlFileName.substring(xmlFileName.indexOf('/')+1, xmlFileName.indexOf('.xml'));			
		} else {
			fileNm = xmlFileName.substring(xmlFileName.indexOf('/')+1, xmlFileName.indexOf('V'));			
		}
			
		var sameFileNameCtr = 0;
		//if (fso.FileExists(xmlFileName)) {
			if(subFolder.length>0 && fso.FolderExists(subFolder)) {
				var objEnum = new Enumerator(fso.GetFolder(subFolder).Files);				
				for(i=0;!objEnum.atEnd();objEnum.moveNext()) {
					if (objEnum.item().name.indexOf(fileNm) > -1 && objEnum.item().name.indexOf('V') > -1) {
						//sameFileNameCtr++;
						
						//as of 10/21/2016
						var isAFinalCopy = isItAFinalCopy(subFolder+objEnum.item().name);
						//if (isAFinalCopy) {
						//no longer counts the file but gets the highest version number and add plus 1
						subFileName = objEnum.item().name.substring(objEnum.item().name.indexOf('V')+1,objEnum.item().name.indexOf('.xml'));
						version = parseInt(subFileName);
							if (version >= sameFileNameCtr) {
								sameFileNameCtr = version+1;
							}
						//}
					}
				}	
				
				if (sameFileNameCtr > 0) {
					newFileNm = subFolder + fileNm + "V" + sameFileNameCtr + ".xml";			
					
				} else {
					//unlikely to happend since saveXML() altered filtered out the scenario that will call this function
					//amended default
					newFileNm = subFolder + fileNm + "V1.xml";
				}
				return newFileNm;
			}
		//} else {
			//unlikely to happend since saveXML() altered filtered out the scenario that will call this function
		//}		
	}
	
	function saveXML(isFinalCopy) {	
		var isFileExists = false;
		var isAmendedReturn = false;
		var isAFinalCopy = false;
		
		if (gIsReadOnly && document.getElementById("txtFinalFlag").value != "2") {
			if (confirm('You will no longer be allowed to modify since this is already the final copy.\nDo you want to save this in USB flash drive or CD-RW instead?')) {
				var xmlFileName = createEncXMLFileName("IAF_RDO_Copy/");
				msg.innerHTML='Generating File...';
				var fileSys = new ActiveXObject("Scripting.FileSystemObject");
				var xmlFile=fileSys.CreateTextFile(xmlFileName); //(saveWhere);
				//
				fileNameToExport = fileName;
				var allXML = "<?xml version='1.0'?>",tab=d.getElementById('xmlFormat').innerHTML;
				allXML += tab; //adds line break
				
				/*--------------------- follow this format for parsing --------------------------- */
				var elem = document.getElementById('frmMain').elements;
				for(var i = 0; i < elem.length; i++)
				{
					if (elem[i].type != 'button' && elem[i].type != 'hidden' && elem[i].type != 'undefined') {				
						if (elem[i].type == 'text' || elem[i].type == 'select-one') {
							if(elem[i].id == 'frm2550q:TaxPayer' || elem[i].id == 'frm2550q:txtLineBus' || elem[i].id == 'frm2550q:txtAddress'){
								allXML += "<div>"+elem[i].id+"=" +escape(elem[i].value)+elem[i].id+"=</div>"+tab;
							}
							else{
								allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab; //all select-one and text values
							}
						}
						if (elem[i].type == 'radio' || elem[i].type == 'checkbox') {
							allXML += "<div>"+elem[i].id+"=" +elem[i].checked+elem[i].id+"=</div>"+tab; //all radio and checkbox values			
						}	
						
					}
				} 				
				/*--------------------- follow this format for parsing --------------------------- */
				
				allXML += tab+d.getElementById('xmlClose').innerHTML+"0";
				
				//Encryption of data content 'allXML' 
				//allXML = LZString.compress(allXML);
				//var encryptedAllXML = encrypt(allXML);
				
				 xmlFile.write(allXML); 
				xmlFile.close();
				// External compression and encryption
        	var succ = EncryptFile(xmlFileName);
			
				msg.innerHTML = '';
				
				showModalExport();
				
				saveXMLProfile(true);		
				// saveXML(true); 
			} else {
				return false;
			}
		} else {	
			var valid = initialValidateBeforeSave();
		
			if (valid == true) {
				//Added 10/21/2016
				var xmlFileNameValidate = "";
				var isFinalFlag2 = false; 
			
				var xmlFileName = createXMLFileName("savefile/");
				msg.innerHTML='Generating File...';
				var fileSys = new ActiveXObject("Scripting.FileSystemObject");
				var xmlFile = "";
				
				//---------------------------------------------------------------
				//START:  New logic in handling amended returns			
				isFileExists = doesFileExists(xmlFileName);	
				isAmendedReturn = isItAnAmendedReturn();	
				
				//as of 10/21/2016
				//if there is already amended filed and will file a not amended,
				//it will restrict it
				if (isAmendedReturn == false) {
					
					if (xmlFileName.indexOf('V') == -1) {
						xmlFileNameValidate = xmlFileName.substring(xmlFileName.indexOf('/')+1,xmlFileName.indexOf('.xml'));			
					} else {
						xmlFileNameValidate = xmlFileName.substring(xmlFileName.indexOf('/')+1,xmlFileName.indexOf('V'));			
					}
					
					var hasVersion = false;
					var objEnum = new Enumerator(fileSys.GetFolder("savefile/").Files);
					for(i=0;!objEnum.atEnd();objEnum.moveNext()) {
						if (objEnum.item().name.indexOf(xmlFileNameValidate) > -1 && objEnum.item().name.indexOf("V") > -1) {
							hasVersion = true;
						}
					}	
                    	if (hasVersion) {
							if (!onExit)
							alert("If your intention is to make an amended return, kindly tick Amended Return to 'Yes' before hitting 'Save' or 'Final Copy' or 'Submit'.");
							return false;
						}
              	}
				
				if (isFileExists) {
					isAFinalCopy = isItAFinalCopy(xmlFileName);  if(document.getElementById('txtFinalFlag').value == '2'){isAFinalCopy = false;
					isFinalFlag2 = true;}	
				}
				
				//1) check if fileExists, if not regular routine
				if (isFileExists  == false) {
				//as of 10/21/2016
					if (isAmendedReturn) {
							var fn = createNewXMLFileName("savefile/", xmlFileName);
							xmlFile = fileSys.CreateTextFile(fn);
							xmlFileName = fn;
							existingXMLFileName = fn;
					}
					else
					xmlFile = fileSys.CreateTextFile(xmlFileName); //xmlFileName should be the newly created xml filename here.
				}				
				//2) if (fileExists && FinalCopy  && Amended) {versionFile} 
				else if (isFileExists && isAFinalCopy && isAmendedReturn) {
				//as of 10/21/2016
					if (existingXMLFileName != null && existingXMLFileName.length > 0) {
						xmlFile = fileSys.CreateTextFile(xmlFileName); //xmlFileName should be the preloaded xml filename here.
					}
					else {
					//versionFile xxx
					var fn = createNewXMLFileName("savefile/", xmlFileName);
					xmlFile = fileSys.CreateTextFile(fn);
					xmlFileName = fn;
					existingXMLFileName = fn;
					}
				}				
				//3)if (fileExists && FinalCopy  && Not Amended) {throw error message: "If your intention is to make an amended return, kindly tick Amended Return to 'Yes'".} 
				else if (isFileExists && isAFinalCopy && isAmendedReturn == false && document.getElementById('txtFinalFlag').value != '3') {
					if (!onExit)
						 alert("If your intention is to make an amended return, kindly tick Amended Return to 'Yes' before hitting 'Save' or 'Final Copy' or 'Submit'.");
					return false;
				}					
				//4) if (fileExists && Not FinalCopy  && Not Amended/Amended) {regular routine} 				
				else if (isFileExists && isAFinalCopy == false) {
				//as of 10/21/2016
					if (existingXMLFileName != null && existingXMLFileName.length > 0) {
						xmlFile = fileSys.CreateTextFile(xmlFileName); //xmlFileName should be the preloaded xml filename here.
					}
					else {
						//as of 10/21/2016
						if (isAmendedReturn && isFinalFlag2 == false) {
							var fn = createNewXMLFileName("savefile/", xmlFileName);
							xmlFile = fileSys.CreateTextFile(fn);
							xmlFileName = fn;
							existingXMLFileName = fn;
						}
						else
						xmlFile = fileSys.CreateTextFile(xmlFileName); //xmlFileName should be the preloaded xml filename here.
					}
				}				
				else {			
					xmlFile = fileSys.CreateTextFile(xmlFileName);
				}
				//END:  New logic in handling amended returns						
				//---------------------------------------------------------------
				
				//
				var allXML = "<?xml version='1.0'?>",tab=d.getElementById('xmlFormat').innerHTML;
				allXML += tab; //adds line break
				
				/*--------------------- follow this format for parsing --------------------------- */
				var elem = document.getElementById('frmMain').elements;
				for(var i = 0; i < elem.length; i++)
				{
					if (elem[i].type != 'button' && elem[i].type != 'hidden' && elem[i].type != 'undefined') {				
						if (elem[i].type == 'text' || elem[i].type == 'select-one') {
							if (elem[i].id == 'frm2550q:TaxPayer') {
								allXML += "<div>"+elem[i].id+"=" +escape(elem[i].value)+elem[i].id+"=</div>"+tab;
								p3TPName = escape(elem[i].value);
							}
							else if (elem[i].id == 'frm2550q:txtLineBus') {
								allXML += "<div>"+elem[i].id+"=" +escape(elem[i].value)+elem[i].id+"=</div>"+tab;
								p3TPLineBus = escape(elem[i].value);
							}
							else if (elem[i].id == 'frm2550q:txtAddress') {
								allXML += "<div>"+elem[i].id+"=" +escape(elem[i].value)+elem[i].id+"=</div>"+tab;
								p3TPAddress = escape(elem[i].value);
							}
							
							//Get surcharge, compromise, interest, returnPeriod, filingDate
							//basicTax, total penalties, total amount payable
							//TIN, branchCode, rdoCode, TPClass, LOB, TPName, TelNo, Addr, Zip
							else if (elem[i].id == 'frm2550q:txtTax28A') {
								allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
								p3Surcharge = elem[i].value;
							} else if (elem[i].id == 'frm2550q:txtTax28B') {
								allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
								p3Interest = elem[i].value;
							} else if (elem[i].id == 'frm2550q:txtTax28C') {
								allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
								p3Compromise = elem[i].value;
							} else if (elem[i].id == 'frm2550q:txtTax27') {
								allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
								p3BasicTax = elem[i].value;
							} else if (elem[i].id == 'frm2550q:txtTax28D') {
								allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
								p3TotalPenalties = elem[i].value;
							} else if (elem[i].id == 'frm2550q:txtTax29') {
								allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
								p3TotalAmountPayable = elem[i].value;
							} else if (elem[i].id == 'frm2550q:txtTIN1') {
								allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
								p3TPTIN1 = elem[i].value;
							} else if (elem[i].id == 'frm2550q:txtTIN2') {
								allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
								p3TPTIN2 = elem[i].value;
							} else if (elem[i].id == 'frm2550q:txtTIN3') {
								allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
								p3TPTIN3 = elem[i].value;
							} else if (elem[i].id == 'frm2550q:txtBranchCode') {
								allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
								p3TPBranchCode = elem[i].value;
							} else if (elem[i].id == 'frm2550q:txtRDOCode') {
								allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
								p3TPRDOCode = elem[i].value;
							} else if (elem[i].id == 'frm0605:txtClassification:_1') {
								allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
								p3TPClassIndi = elem[i].checked;
							} else if (elem[i].id == 'frm0605:txtClassification:_2') {
								allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
								p3TPClassNonIndi = elem[i].checked;
							} 
							/*else if (elem[i].id == 'frm2550q:txtLineBus') {
								p3TPLineBus = escape(elem[i].value);
							} else if (elem[i].id == 'frm2550q:TaxPayer') {
								p3TPName = escape(elem[i].value);
							}*/ 
							else if (elem[i].id == 'frm2550q:txtTelNum') {
								allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
								p3TPTelNum = elem[i].value;
							} 
							/*else if (elem[i].id == 'frm2550q:txtAddress') {
								p3TPAddress = escape(elem[i].value);
							}*/ 
							else if (elem[i].id == 'frm2550q:txtZipCode') {
								allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
								p3TPZip = elem[i].value;
							} else if (elem[i].id == 'frm2550q:RtnPeriodTo') {
								allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
								p3ReturnPeriod = elem[i].value;
							}
							else{
								allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab; //all select-one and text values
							}
						}
						if (elem[i].type == 'radio' || elem[i].type == 'checkbox') {
							allXML += "<div>"+elem[i].id+"=" +elem[i].checked+elem[i].id+"=</div>"+tab; //all radio and checkbox values	
							if (d.getElementById('frm2550q:AmendedRtnY').checked == true) {
								p3IsAmended = "Yes";
							} else if (d.getElementById('frm2550q:AmendedRtnN').checked == true) {
								p3IsAmended = "No";
							}							
						}							
					}
					
					//var retPeriodSubStr = xmlFileName.substring(xmlFileName.lastIndexOf('-')+1, xmlFileName.indexOf('.xml')); //111111111111-0605-09122011115519.xml (09/12/2011 11:55:19)
					//p3ReturnPeriod = retPeriodSubStr.substring(0,2) + "/" + retPeriodSubStr.substring(2,6) + "-" + retPeriodSubStr.substring(6,8);		
					//p3ReturnPeriod = ;
					p3ReturnPeriodEnd = p3ReturnPeriod;
					
					p3TPTIN = p3TPTIN1 + p3TPTIN2 + p3TPTIN3;
					
					//Dev Note: This is only a utility so we can generate well-formed XML sample test data
					//Real requirement here are: 
					//loadXMLWellFormed() to mimic loadXML()
					//loadWFData()  to mimic loadData()
					//This is the original XML formatter per row with <div> </div> separator					
					
					/*if (elem[i].type != 'button' && elem[i].type != 'hidden' && elem[i].type != 'undefined') {		
						if (elem[i].type == 'text' || elem[i].type == 'select-one') {
						
							//With this well-formed XML, we need to validate field content if it has '>'  and '<'
							//if so, then replace it with : '&gt;' and '&lt;' respectively.							
							if (elem[i].value.indexOf('>') >= 0 && elem[i].value.indexOf('<') < 0) {
								elemVal = elem[i].value.replace(/[>]+/g, '&gt;');
							} 
							if (elem[i].value.indexOf('<') >= 0 && elem[i].value.indexOf('>') < 0) {
								elemVal = elem[i].value.replace(/[<]+/g, '&lt;');
							} 
							if (elem[i].value.indexOf('<') >= 0 && elem[i].value.indexOf('>') >= 0) {
								elemVal = elem[i].value.replace(/[<]+/g, '&lt;');
								elemVal = elemVal.replace(/[>]+/g, '&gt;');
							} 							
							else {
								elemVal = elem[i].value;
							}						
							
							allXML += "<"+elem[i].id+">"+elemVal+"</"+elem[i].id+">"+tab; //all select-one and text values
						}
						if (elem[i].type == 'radio' || elem[i].type == 'checkbox') {
							allXML += "<"+elem[i].id+">"+elem[i].checked+"</"+elem[i].id+">"+tab; //all radio and checkbox values			
						}							
					}*/
					//END: Dev Note						
				} 				
				/*--------------------- follow this format for parsing --------------------------- */
				
				if (isFinalCopy) {
					allXML += tab+d.getElementById('xmlClose').innerHTML+"0";
					gIsReadOnly = true;
				} else {	
					allXML += tab+d.getElementById('xmlClose').innerHTML;
				}
				
				//Phase 3: This 'savefile' will be uploaded to IAF Infra for DI processing
				savedReturn = allXML;
				
				xmlFile.write(allXML);
				xmlFile.close();
				msg.innerHTML = '';
				
				if (isFinalCopy == false) {
					alert('BIR Form saved successfully as : '+xmlFileName);
				}	
				
				saveXMLProfile(false);
				return true;
			}
		}
		return true;
	}
	
	function saveXMLsubmit(submit){
		var valid = initialValidateBeforeSave();
		var isBFinalCopy = false;
		if (valid == true) {
			//Added 10/21/2016
			var xmlFileNameValidate = "";
		
			var xmlFileName = createXMLFileName("savefile/");
			msg.innerHTML='Generating File...';
			var fileSys = new ActiveXObject("Scripting.FileSystemObject");
			var xmlFile = "";
			
			//---------------------------------------------------------------
			//START:  New logic in handling amended returns			
			isFileExists = doesFileExists(xmlFileName);	
			isAmendedReturn = isItAnAmendedReturn();	
			
			//as of 10/21/2016
			//if there is already amended filed and will file a not amended,
			//it will restrict it
			if (isAmendedReturn == false) {
					if (xmlFileName.indexOf('V') == -1) {
						xmlFileNameValidate = xmlFileName.substring(xmlFileName.indexOf('/')+1, xmlFileName.indexOf('.xml'));			
					} else {
						xmlFileNameValidate = xmlFileName.substring(xmlFileName.indexOf('/')+1, xmlFileName.indexOf('V'));			
					}
					
				var hasVersion = false;
				var objEnum = new Enumerator(fileSys.GetFolder("savefile/").Files);
				for(i=0;!objEnum.atEnd();objEnum.moveNext()) {
					if (objEnum.item().name.indexOf(xmlFileName) > -1 && objEnum.item().name.indexOf("V") > -1) {
						hasVersion = true;
					}
				}	
                 	if (hasVersion) {
					if (!onExit && !isSubmit)
						alert("If your intention is to make an amended return, kindly tick Amended Return to 'Yes' before hitting 'Save' or 'Final Copy' or 'Submit'.");
					return false;
				}
           	}
			
			if (isFileExists) {
				if(document.getElementById('txtFinalFlag').value == '2'){isAFinalCopy = false;}	
			}
			
			//1) check if fileExists, if not regular routine
			if (isFileExists  == false) {

				xmlFile = fileSys.CreateTextFile(xmlFileName); //xmlFileName should be the newly created xml filename here.
			}				
			//2) if (fileExists && FinalCopy  && Amended) {versionFile} 
			else if (isFileExists && isBFinalCopy && isAmendedReturn) {
				//versionFile xxx
			
				var fn = createNewXMLFileName("savefile/", xmlFileName);
				xmlFile = fileSys.CreateTextFile(fn);
				xmlFileName = fn;
				existingXMLFileName = fn;
			}				
			//3)if (fileExists && FinalCopy  && Not Amended) {throw error message: "If your intention is to make an amended return, kindly tick Amended Return to 'Yes'".} 
			else if (isFileExists && isBFinalCopy && isAmendedReturn == false && document.getElementById('txtFinalFlag').value != '3') {
				if (!onExit && !isSubmit){
					 alert("If your intention is to make an amended return, kindly tick Amended Return to 'Yes' before hitting 'Save' or 'Final Copy' or 'Submit'.");
					return false;
				}
				else {
					xmlFile = fileSys.CreateTextFile(xmlFileName);
				}
			}					
			//4) if (fileExists && Not FinalCopy  && Not Amended/Amended) {regular routine} 				
			else if (isFileExists && isBFinalCopy == false) {
	
				xmlFile = fileSys.CreateTextFile(xmlFileName); //xmlFileName should be the preloaded xml filename here.
			}	
			else {			
				xmlFile = fileSys.CreateTextFile(xmlFileName);
			}
			//END:  New logic in handling amended returns						
			//---------------------------------------------------------------
			
			//
			var allXML = "<?xml version='1.0'?>",tab=d.getElementById('xmlFormat').innerHTML;
			allXML += tab; //adds line break
			
			/*--------------------- follow this format for parsing --------------------------- */
			var elem = document.getElementById('frmMain').elements;
			for(var i = 0; i < elem.length; i++)
			{
				if (elem[i].type != 'button' && elem[i].type != 'hidden' && elem[i].type != 'undefined') {				
					if (elem[i].type == 'text' || elem[i].type == 'select-one') {
						if (elem[i].id == 'frm2550q:TaxPayer') {
							allXML += "<div>"+elem[i].id+"=" +escape(elem[i].value)+elem[i].id+"=</div>"+tab;
							p3TPName = escape(elem[i].value);
						}
						else if (elem[i].id == 'frm2550q:txtLineBus') {
							allXML += "<div>"+elem[i].id+"=" +escape(elem[i].value)+elem[i].id+"=</div>"+tab;
							p3TPLineBus = escape(elem[i].value);
						}
						else if (elem[i].id == 'frm2550q:txtAddress') {
							allXML += "<div>"+elem[i].id+"=" +escape(elem[i].value)+elem[i].id+"=</div>"+tab;
							p3TPAddress = escape(elem[i].value);
						}
						
						//Get surcharge, compromise, interest, returnPeriod, filingDate
						//basicTax, total penalties, total amount payable
						//TIN, branchCode, rdoCode, TPClass, LOB, TPName, TelNo, Addr, Zip
						else if (elem[i].id == 'frm2550q:txtTax28A') {
							allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
							p3Surcharge = elem[i].value;
						} else if (elem[i].id == 'frm2550q:txtTax28B') {
							allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
							p3Interest = elem[i].value;
						} else if (elem[i].id == 'frm2550q:txtTax28C') {
							allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
							p3Compromise = elem[i].value;
						} else if (elem[i].id == 'frm2550q:txtTax27') {
							allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
							p3BasicTax = elem[i].value;
						} else if (elem[i].id == 'frm2550q:txtTax28D') {
							allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
							p3TotalPenalties = elem[i].value;
						} else if (elem[i].id == 'frm2550q:txtTax29') {
							allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
							p3TotalAmountPayable = elem[i].value;
						} else if (elem[i].id == 'frm2550q:txtTIN1') {
							allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
							p3TPTIN1 = elem[i].value;
						} else if (elem[i].id == 'frm2550q:txtTIN2') {
							allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
							p3TPTIN2 = elem[i].value;
						} else if (elem[i].id == 'frm2550q:txtTIN3') {
							allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
							p3TPTIN3 = elem[i].value;
						} else if (elem[i].id == 'frm2550q:txtBranchCode') {
							allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
							p3TPBranchCode = elem[i].value;
						} else if (elem[i].id == 'frm2550q:txtRDOCode') {
							allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
							p3TPRDOCode = elem[i].value;
						} else if (elem[i].id == 'frm0605:txtClassification:_1') {
							allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
							p3TPClassIndi = elem[i].checked;
						} else if (elem[i].id == 'frm0605:txtClassification:_2') {
							allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
							p3TPClassNonIndi = elem[i].checked;
						} 
						/*else if (elem[i].id == 'frm2550q:txtLineBus') {
							p3TPLineBus = escape(elem[i].value);
						} else if (elem[i].id == 'frm2550q:TaxPayer') {
							p3TPName = escape(elem[i].value);
						}*/ 
						else if (elem[i].id == 'frm2550q:txtTelNum') {
							allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
							p3TPTelNum = elem[i].value;
						} 
						/*else if (elem[i].id == 'frm2550q:txtAddress') {
							p3TPAddress = escape(elem[i].value);
						}*/ 
						else if (elem[i].id == 'frm2550q:txtZipCode') {
							allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
							p3TPZip = elem[i].value;
						} else if (elem[i].id == 'frm2550q:RtnPeriodTo') {
							allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab;
							p3ReturnPeriod = elem[i].value;
						}
						else{
							allXML += "<div>"+elem[i].id+"=" +elem[i].value+elem[i].id+"=</div>"+tab; //all select-one and text values
						}
					}
					if (elem[i].type == 'radio' || elem[i].type == 'checkbox') {
						allXML += "<div>"+elem[i].id+"=" +elem[i].checked+elem[i].id+"=</div>"+tab; //all radio and checkbox values	
						if (d.getElementById('frm2550q:AmendedRtnY').checked == true) {
							p3IsAmended = "Yes";
						} else if (d.getElementById('frm2550q:AmendedRtnN').checked == true) {
							p3IsAmended = "No";
						}							
					}							
				}
				
				//var retPeriodSubStr = xmlFileName.substring(xmlFileName.lastIndexOf('-')+1, xmlFileName.indexOf('.xml')); //111111111111-0605-09122011115519.xml (09/12/2011 11:55:19)
				//p3ReturnPeriod = retPeriodSubStr.substring(0,2) + "/" + retPeriodSubStr.substring(2,6) + "-" + retPeriodSubStr.substring(6,8);		
				//p3ReturnPeriod = ;
				p3ReturnPeriodEnd = p3ReturnPeriod;
				
				p3TPTIN = p3TPTIN1 + p3TPTIN2 + p3TPTIN3;
				
				//Dev Note: This is only a utility so we can generate well-formed XML sample test data
				//Real requirement here are: 
				//loadXMLWellFormed() to mimic loadXML()
				//loadWFData()  to mimic loadData()
				//This is the original XML formatter per row with <div> </div> separator					
				
				/*if (elem[i].type != 'button' && elem[i].type != 'hidden' && elem[i].type != 'undefined') {		
					if (elem[i].type == 'text' || elem[i].type == 'select-one') {
					
						//With this well-formed XML, we need to validate field content if it has '>'  and '<'
						//if so, then replace it with : '&gt;' and '&lt;' respectively.							
						if (elem[i].value.indexOf('>') >= 0 && elem[i].value.indexOf('<') < 0) {
							elemVal = elem[i].value.replace(/[>]+/g, '&gt;');
						} 
						if (elem[i].value.indexOf('<') >= 0 && elem[i].value.indexOf('>') < 0) {
							elemVal = elem[i].value.replace(/[<]+/g, '&lt;');
						} 
						if (elem[i].value.indexOf('<') >= 0 && elem[i].value.indexOf('>') >= 0) {
							elemVal = elem[i].value.replace(/[<]+/g, '&lt;');
							elemVal = elemVal.replace(/[>]+/g, '&gt;');
						} 							
						else {
							elemVal = elem[i].value;
						}						
						
						allXML += "<"+elem[i].id+">"+elemVal+"</"+elem[i].id+">"+tab; //all select-one and text values
					}
					if (elem[i].type == 'radio' || elem[i].type == 'checkbox') {
						allXML += "<"+elem[i].id+">"+elem[i].checked+"</"+elem[i].id+">"+tab; //all radio and checkbox values			
					}							
				}*/
				//END: Dev Note						
			} 				
			/*--------------------- follow this format for parsing --------------------------- */
			
			if (submit) {
				allXML += tab+d.getElementById('xmlClose').innerHTML+"0";
			} else {	
				allXML += tab+d.getElementById('xmlClose').innerHTML;
			}
			
			//Phase 3: This 'savefile' will be uploaded to IAF Infra for DI processing
			savedReturn = allXML;
			
			xmlFile.write(allXML);
			xmlFile.close();
			msg.innerHTML = '';
			
			if (submit == false) {
				alert('BIR Form saved successfully as : '+xmlFileName);
			}	
			
		}
		return true;
	}
	/*--------------------------------------------------------------*/	
	
	var XMLrdoFile='';

 function loadXMLrdo(fileLocation) {
  try {
   //This will load the Region file with filename 'fileLocation' if it exists
   var fsoXML = new ActiveXObject("Scripting.FileSystemObject");
   XMLrdoFile = fsoXML.OpenTextFile(fileLocation,1); 
 
   if (XMLrdoFile.AtEndOfStream)
    data = "";
   else {
    var responseRdo = d.getElementById('responseRdo'); //render file and write to hidden div
    responseRdo.innerHTML = XMLrdoFile.ReadAll(); //remove XML tag
    //responseRdo = replaceHtml(responseRdo, XMLrdoFile.ReadAll()); //Pattern:  el = replaceHtml(el, newHtml)
   }
   XMLrdoFile.Close(); //alert( responseRdo.innerHTML ); //Debug   
   loadRdo(); /*This will load ATC onto an array*/ 
  } catch(e) {
   msg.innerHTML = ""; //"Region File not Found.";
  } //this will Alert File not Found if it doesn't exist
 }
 
var rdoCount=0;

function loadRdo() {
  /*This will load data onto an array*/
  var response = d.getElementById("responseRdo");
  
  var rdoCnt = String(response.innerHTML).split('rdoCount=');
  rdoCount = rdoCnt[1]; 
 
  var k = 0;
  //loads rdoList from xml
  for (var i = 1; i <= rdoCount; i++) { 
   
   var rdo = String(response.innerHTML).split('rdo'+i+':');
   var rdoStr = rdo[1];
  
   //Ensure that before writing to rdoPropertyJS the formType 2550Q is traceable in rdoStr
   if (rdoStr.indexOf('2550Q') >= 0) {
       var rdoValues = rdoStr.split('~');       
    var rdoCode = rdoValues[0];
    var description = rdoValues[1];    
    
    var objRdo = new rdoPropertyJS(rdoCode, description);
    rdoList[k] = objRdo; 
    k++;
    //alert('2550Q successfully created array #'+i);
    
   } else {  
    //alert('2550Q not found in array #'+i);
    continue;
   }
  }     
 }

    function Schedule2()
    {
        this.txtDatePurchase = '';
        this.txtDescription = '';
        this.txtAmt = '0.00';
        this.txtInputTax = '0.00';
    }

    function Schedule3()
    {
        this.txtDatePurchase = '';
        this.txtDescription = '';
        this.txtAmt = '0.00';
        this.txtInputTax = '0.00';
        this.txtEstLife = '0';
        this.txtRecogLife = '1';
        this.txtAllowInputTax = '0.00';
        this.txtBalInputTax = '0.00';
    }

    function Schedule6and8()
    {
        this.txtPeriodCovered = '';
        this.txtNameAgent = '';
        this.txtIncomePayment = '0.00';
        this.txtTotalWithheld = '0.00';
        this.txtPrevious2Mo = '0.00';
        this.txtAppliedCurrMo = '0.00';
    }

    function Schedule7()
    {
        this.txtPeriodCovered = '';
        this.txtNameMiller = '';
        this.txtNameTaxPayer = '';
        this.txtORNumber = '';
        this.txtAmountPaid = '0.00';
        this.txtPrevious2Mo = '0.00';
        this.txtAppliedCurrMo = '0.00';
    }

    var sched2 = new Array();
    var sched2ToCommit = new Array();
    var sched3A = new Array();
    var sched3AToCommit = new Array();
    var sched3B = new Array();
    var sched3BToCommit = new Array();
    var sched6 = new Array();
    var sched6ToCommit = new Array();
    var sched7 = new Array();
    var sched7ToCommit = new Array();
    var sched8 = new Array();
    var sched8ToCommit = new Array();


    var ATCnameCode = new Array() ;
    var NaturePayment = new Array() ;
    //var TaxRate = new Array();
    function getPopulateATC()
    {


        ATCnameCode = new Array() ;
        NaturePayment = new Array() ;

        var atcSize = atcList.length;
        var i = 0;
        var j = 1;
        for(i = 0; i < atcSize; i++) {
            var atc = atcList[i];
            // same as 2550Q and 2550M
            if(atc.formType == "2550Q") {
                ATCnameCode[j] = atc.atcCode;
                NaturePayment[j++] = atc.description;
                //TaxRate[j++] = atc.rate;
            }
        }
    }

    function ATCList()
    {
   
        var i;
        getPopulateATC();
        //d.getElementById('tbllistAtcCode').innerHTML = "";
		$('#tbllistAtcCode').html("");
        for(i = 1 ; i < ATCnameCode.length ; i++  )
        {
            //d.getElementById('tbllistAtcCode').innerHTML =  d.getElementById('tbllistAtcCode').innerHTML +
			$('#tbllistAtcCode').html(  d.getElementById('tbllistAtcCode').innerHTML +
                "<tr class='atc'><td width='20%' class='atc'> <input id='AtcCode"+i+"' name='AtcCode' type='checkbox' value='"+ATCnameCode[i]+"' /> "+ATCnameCode[i]+ " </td> <td align='left' width='80%' class='atc atcNames' id='AtcNaturePayment"+i+"' >"+ NaturePayment[i]+ " </td> </tr>");
        }
    }

	function getRdo()
    {
        var data = "<select class='iceSelOneMnu' id='frm2550q:txtRDOCode' name='frm2550q:txtRDOCode' size='1' ><option value='000'> </option>";
  
		  for(var i = 0; i < rdoList.length; i++) {
					var rdo = rdoList[i];
					data = data + "<option value='" + rdo.rdoCode + "'>" + rdo.description + "</option>";
		   
				}
		  data = data + "</select>"
		  
		  $('#rdoSelect').html(data);  
  
    }

	
    function enableSelTreaty()
    {
        d.getElementById('frm2550q:lstTaxTreaty').disabled = false;
        d.getElementById('frm2550q:lstTaxTreaty').selectedIndex = 1;

    }

    function disableSelTreaty()
    {
        d.getElementById('frm2550q:lstTaxTreaty').disabled = true;
        d.getElementById('frm2550q:lstTaxTreaty').selectedIndex = 0;
    }

    function blockletter(e)
    {
        var number = parseFloat(e.value).toFixed(2);
        if(isNaN(number)) {
            //var zero = 0;
            //e.value = parseFloat(zero).toFixed(2);
            e.value = "0.00";
        } else {
            e.value = '' + number;
        }
    }

    function blockletterWithout2Decimal(e)
    {
        var number = parseFloat(e.value);
        if(isNaN(number))
        {
            //var zero = 0;
            //e.value = parseFloat(zero).toFixed(2);
            e.value = "";
        }else {
            e.value = '' + number.toFixed(0);
        }
    }
    
    function showSched1(){
        saveTempSched1Data();

        //d.getElementById('mainContent').style.display = "inline";
        //d.getElementById('modalSched1').style.display = "block";
		d.getElementById('mainContent').style.display = "none";
        $('#modalSched1').show('blind');				

        for(var x = 0; x < d.getElementById('tblSched1Atc').rows.length; x++) {
            setTimeout("setInputTextControl_HorizontalAlignment('frm2550q:txtAmountSales" + (x + 1) + "', 4);", 100);
            setTimeout("setInputTextControl_HorizontalAlignment('frm2550q:txtOutputTax" + (x + 1) + "', 4);", 100);
            //setTimeout("setInputTextControl_NumberFormatter('frm2550q:txtAmountSales" + (x + 1) + "', 12, 2);", 100);
            //setTimeout("setInputTextControl_NumberFormatter('frm2550q:txtOutputTax" + (x + 1) + "', 12, 2);", 100);
        }

        //setTimeout("d.getElementById('txtmodaltxtTotal15A').disabled = true; setInputTextControl_HorizontalAlignment('txtmodaltxtTotal15A', 4); setInputTextControl_NumberFormatter('txtmodaltxtTotal15A', 12, 2);" +
        //    "d.getElementById('txtmodaltxtTotal15B').disabled = true; setInputTextControl_HorizontalAlignment('txtmodaltxtTotal15B', 4); setInputTextControl_NumberFormatter('txtmodaltxtTotal15B', 12, 2);", 100);
		setTimeout("d.getElementById('txtmodaltxtTotal15A').disabled = true; setInputTextControl_HorizontalAlignment('txtmodaltxtTotal15A', 4);" +
            "d.getElementById('txtmodaltxtTotal15B').disabled = true; setInputTextControl_HorizontalAlignment('txtmodaltxtTotal15B', 4);", 100);

        if(viewUploadFlag) {
            setTimeout("d.getElementById('btnSched1ATC').disabled = true;", 100);
            setTimeout("d.getElementById('btnClearPop').disabled = true;", 100);
            setTimeout("d.getElementById('btnCancelPop').disabled = true;", 100);
            setTimeout("toggleAllDisabled();", 100);
            setTimeout("d.getElementById('btnOkPop1').disabled = false;", 100);
        }
    }

    var tempATC = new Array();
    var tempATCAmount = new Array();
    var tempATCOutput = new Array();
    function showModalAtc() {
        tempATC = new Array();
        tempATCAmount = new Array();
        tempATCOutput = new Array();
        for(var i = 0; i < d.getElementById('tblSched1Atc').rows.length; i++) { 
            tempATC[i] = d.getElementById('frm2550q:txtAtcCde'+ (i + 1)).value;
            tempATCAmount[i] = d.getElementById('frm2550q:txtAmountSales'+ (i + 1)).value;
            tempATCOutput[i] = d.getElementById('frm2550q:txtOutputTax'+(i +1)).value;

        }

        //d.getElementById('modalSched1').style.display = "none";
        //d.getElementById('modalAtc').style.display = "block";
		d.getElementById('modalSched1').style.display = "none";
        $('#modalAtc').show('blind');		
    }

    function getATCCode() {
        d.getElementById('modalSched1').style.display = 'block';
        //d.getElementById('modalAtc').style.display = 'none';
		if ( $('#modalAtc').css('display') != 'none' ) {
			$('#modalAtc').hide('blind');
		}
        //d.getElementById('tblSched1Atc').innerHTML = "";
		$('#tblSched1Atc').html("");
		
        var x = 1;
        var listATCtable =   d.getElementById('tbllistAtcCode');
        for(var i = 1 ; i <= listATCtable.rows.length; i++ )
        {
            if(d.getElementById('AtcCode'+i) != null)
            {
                // check if checked id'ed ATC
                if (d.getElementById('AtcCode'+i).checked == true )
                {
                    var taxAmounttemp = "0.00";
                    var taxOutputtemp = "0.00";
                    for(var tempCount = 0 ; tempCount < tempATC.length; tempCount++) {
                        if(tempATC[tempCount] == d.getElementById('AtcCode'+i).value){
                            taxAmounttemp = tempATCAmount[tempCount];
                            taxOutputtemp = tempATCOutput[tempCount];
                            break;
                        }
                    }

                    //d.getElementById('tblSched1Atc').innerHTML =  d.getElementById('tblSched1Atc').innerHTML +
					$('#tblSched1Atc').html(  d.getElementById('tblSched1Atc').innerHTML + 
                        "<tr><td id='txtNaturePayment"+x+"' width='50%' > "+ d.getElementById('AtcNaturePayment'+i).innerHTML + " </td>" +
                        "<td width='10%'> <input type='text' id='frm2550q:txtAtcCde"+x+"' style='width: 50px' class='styletxtAtcCode' value='"+ d.getElementById('AtcCode'+i).value + "' />  </td>" +
                        "<td width='20%'> <input type='text' id='frm2550q:txtAmountSales"+x+"' class='styletxtAmountSales' value='"+taxAmounttemp +"' style='text-align:right' onkeypress='return numbersonly(this, event)' size='20' onblur='round(this,2);getRequiredWithheld("+x+");totalAmountandOutputTax()' /> </td>" +
                        "<td width='30%'> <input type='text' id='frm2550q:txtOutputTax"+x+"' class='styletxtOutputTax' value='"+taxOutputtemp +"'style='text-align:right; background-color: rgb(220, 220, 220)'  size='20'  disabled onblur='totalAmountandOutputTax();'/> </td>" +
                        "</tr>");

                    //setTimeout("d.getElementById('frm2550q:txtAtcCde"+x+"').disabled = true; " +
                        //"setInputTextControl_HorizontalAlignment('frm2550q:txtAmountSales"+x+"', 4);setInputTextControl_NumberFormatter('frm2550q:txtAmountSales"+x+"', 17, 2);" +
                        //"setInputTextControl_HorizontalAlignment('frm2550q:txtOutputTax"+x+"', 4);setInputTextControl_NumberFormatter('frm2550q:txtOutputTax"+x+"', 17, 2);" +
                        //"getRequiredWithheld("+x+");" , 100);
					setTimeout("d.getElementById('frm2550q:txtAtcCde"+x+"').disabled = true; " +
                        "setInputTextControl_HorizontalAlignment('frm2550q:txtAmountSales"+x+"', 4);" +
                        "setInputTextControl_HorizontalAlignment('frm2550q:txtOutputTax"+x+"', 4);" +
                        "getRequiredWithheld("+x+");" , 100);
                    setTimeout("d.getElementById('frm2550q:txtAmountSales"+x+"').value += '';" +
                        "d.getElementById('frm2550q:txtOutputTax"+x+"').value += '';", 100);
                    x++;
                }

            }
        }
        totalAmountandOutputTax();
    }

    function saveTempSched1Data() {
        var x = 0;
        tempRowSizeSched1 = d.getElementById("tblSched1Atc").rows.length;

        for(x = 0; x < tempRowSizeSched1; x++){
            tempAtcCode[x] = d.getElementById("frm2550q:txtAtcCde" + (x + 1)).value;
            tempAmtSales[x] = d.getElementById("frm2550q:txtAmountSales" + (x + 1)).value;
            tempOutputTax[x] = d.getElementById("frm2550q:txtOutputTax" + (x + 1)).value;
        }
    }

    function restoreTempSched1Data() {
        if(tempRowSizeSched1 > 0) {
            var x = 0;

            var i;
            getPopulateATC();
            //d.getElementById('tbllistAtcCode').innerHTML = "";
			$('#tbllistAtcCode').html("");
			
            for(i = 1 ; i < ATCnameCode.length ; i++  )
            {
                var checkFlag = "";
                for(x = 0; x < tempRowSizeSched1; x++){
                    var atccode = "" + tempAtcCode[x];
                    if(ATCnameCode[i] == atccode) {
                        checkFlag = "checked";
                        break;
                    }
                }
                //d.getElementById('tbllistAtcCode').innerHTML =  d.getElementById('tbllistAtcCode').innerHTML +
				$('#tbllistAtcCode').html(  d.getElementById('tbllistAtcCode').innerHTML + 
                    "<tr class='atc'><td width='20%' class='atc'> <input id='AtcCode"+i+"' name='AtcCode' type='checkbox' value='"+ATCnameCode[i]+"' " + checkFlag + " /> "+ATCnameCode[i]+ " </td> <td align='left' width='80%' class='atc atcNames' id='AtcNaturePayment"+i+"' >"+ NaturePayment[i]+ " </td> </tr>");
            }

            getATCCode();

            for(x = 0; x < tempRowSizeSched1; x++){
                d.getElementById("frm2550q:txtAtcCde" + (x + 1)).value = tempAtcCode[x];
                d.getElementById("frm2550q:txtAmountSales" + (x + 1)).value = tempAmtSales[x];
                d.getElementById("frm2550q:txtOutputTax" + (x + 1)).value = tempOutputTax[x];
            }

            totalAmountandOutputTax();
        }
    }

    function clearSched1Modal() {
        d.getElementById('txtmodaltxtTotal15A').value = "0.00"
		d.getElementById('txtmodaltxtTotal15B').value = "0.00"
		
		var x = 0;
        var rowSizeSched1 = d.getElementById("tblSched1Atc").rows.length;
        
        for(x = 0; x < rowSizeSched1; x++){
            //d.getElementById("frm2550q:txtAtcCde" + (x + 1)).value = "";
            d.getElementById("frm2550q:txtAmountSales" + (x + 1)).value = "0.00";
            d.getElementById("frm2550q:txtOutputTax" + (x + 1)).value = "0.00";
        }
    }

    function cancelSched1Modal() {
        restoreTempSched1Data();

        //d.getElementById('mainContent').style.display = 'block';
        //d.getElementById('modalSched1').style.display = 'none';
        //d.getElementById('DummyTxt').innerHTML = "Creator";
        //d.getElementById('DummyTxt').innerHTML = "";
		d.getElementById('mainContent').style.display = 'block';
		if ( $('#modalSched1').css('display') != 'none' ) {
			$('#modalSched1').hide('blind');
		}
		$('#DummyTxt').html("Creator");
		$('#DummyTxt').html("");			

        isModalTurnOn = false;
    }

    function getSched1Modal(){
        if (checkifFieldEmptySched1() )
        {
            //d.getElementById('mainContent').style.display = 'block';
            //d.getElementById('modalSched1').style.display = 'none';
            //d.getElementById('DummyTxt').innerHTML = "Creator";
            //d.getElementById('DummyTxt').innerHTML = "";
			 d.getElementById('mainContent').style.display = 'block';
			 if ( $('#modalSched1').css('display') != 'none' ) {
				$('#modalSched1').hide('blind');
			 }
			 $('#DummyTxt').html("Creator");
			 $('#DummyTxt').html("");
			
            d.getElementById('frm2550q:txtTax15A').value  = d.getElementById('txtmodaltxtTotal15A').value;
            d.getElementById('frm2550q:txtTax15B').value  = d.getElementById('txtmodaltxtTotal15B').value;
            compute19AB();
        }
    }

    function getRequiredWithheld(numIndex)
    {
        d.getElementById('frm2550q:txtOutputTax'+numIndex).value = formatCurrency(NumWithComma( d.getElementById('frm2550q:txtAmountSales'+numIndex).value) * 0.12 );
    }

    function totalAmountandOutputTax() {
        var tbl =  d.getElementById('tblSched1Atc')
        var txt12A = 0;
        var txt12B = 0;
        for(var i = 1 ; i <= tbl.rows.length ; i ++){
            txt12A = txt12A +  NumWithComma(d.getElementById('frm2550q:txtAmountSales'+i).value);
            txt12B = txt12B +  NumWithComma(d.getElementById('frm2550q:txtOutputTax'+i).value);
        }
        d.getElementById('txtmodaltxtTotal15A').value = formatCurrency(txt12A);
        d.getElementById('txtmodaltxtTotal15B').value = formatCurrency(txt12B);
    }

    function checkifFieldEmptySched1()
    {
        var tbl =  d.getElementById('tblSched1Atc')
        for(var i = 1 ; i <= tbl.rows.length ; i ++){
            if( d.getElementById('frm2550q:txtAmountSales'+i).value <= 0 || d.getElementById('frm2550q:txtOutputTax'+i).value <= 0 )
            {
                alert("Please enter valid value for the Amount of Sales/Receipt for the period on row " + i); return;
            }
        }
        return true;
    }

	function prevalidateReturnPeriod() {
		var validated = false;
		
		if (d.getElementById('frm2550q:RtnPeriodFrom').value != "" && d.getElementById('frm2550q:RtnPeriodTo').value != "") {
			validated = true;
		}
		
		return validated;
	}
	
    function showSched2(){
        saveTempSched2Data();
		
		if (prevalidateReturnPeriod()) {
			if(d.getElementById('frm2550q:txtYear').value <= 2000 || d.getElementById('frm2550q:txtYear').value >= 2020 ) {
				alert("Please enter a valid year for Item 1. Valid year is 2001 and beyond."); return;
			} else {
				//d.getElementById('mainContent').style.display = "inline";
				//d.getElementById('modalSched2').style.display = "block";
				d.getElementById('mainContent').style.display = "none";
				$('#modalSched2').show('blind');	
				
				for(var x = 0; x < d.getElementById("tblSched2").rows.length; x++) {
					setTimeout("setInputTextControl_HorizontalAlignment('txtAmt" + x + "', 4);", 100);
					setTimeout("setInputTextControl_HorizontalAlignment('txtInputTax" + x + "', 4);", 100);
					//setTimeout("setInputTextControl_NumberFormatter('txtAmt" + x + "', 12, 2);", 100);
					//setTimeout("setInputTextControl_NumberFormatter('txtInputTax" + x + "', 12, 2);", 100);
				}

				setTimeout("d.getElementById('txtmodalTotalAmt').disabled = true; setInputTextControl_HorizontalAlignment('txtmodalTotalAmt', 4);" +
					"d.getElementById('txtmodalTotalInputTax').disabled = true; setInputTextControl_HorizontalAlignment('txtmodalTotalInputTax', 4);", 100);

			}

			if(viewUploadFlag) {
				setTimeout("d.getElementById('btnAdd1').disabled = true;", 100);
				setTimeout("d.getElementById('btnDelete1').disabled = true;", 100);
				setTimeout("d.getElementById('btnClearPop2').disabled = true;", 100);
				setTimeout("d.getElementById('btnCancelPop2').disabled = true;", 100);
				setTimeout("toggleAllDisabled();", 100);
				setTimeout("d.getElementById('btnOkPop2').disabled = false;", 100);
			}
		} else { alert("Please enter a valid date for Item 1."); return; }
    }

    function saveTempSched2Data() {
        var x = 0;
        tempRowSizeSched2 = d.getElementById("tblSched2").rows.length - 1;

        for(x = 0; x < tempRowSizeSched2; x++){
            tempTempPurDate[x] = d.getElementById("txtDatePurchased" + x).value;
            tempDescription[x] = d.getElementById("txtDescription" + x).value;
            tempPurAmt[x] = d.getElementById("txtAmt" + x).value;
            tempInputTax[x] = d.getElementById("txtInputTax" + x).value;
        }
    }

    function restoreTempSched2Data() {
        if(tempRowSizeSched2 > 0) {
            sched2ToCommit = new Array();
            //d.getElementById("tbodyllistSched2").innerHTML = "";
			$('#tbodyllistSched2').html("");
            var x = 0;
          
            for(x = 0; x < tempRowSizeSched2; x++){
                addlistSched2();

                d.getElementById("txtDatePurchased" + x).value = tempTempPurDate[x];
                d.getElementById("txtDescription" + x).value = tempDescription[x];
                d.getElementById("txtAmt" + x).value = tempPurAmt[x];

                getInputTaxCompute(x);

                d.getElementById("txtInputTax" + x).value = tempInputTax[x];

                computeSumTax();
            }
        }
    }

    function clearSched2Modal() {
        d.getElementById('txtmodalTotalAmt').value = "0.00"
		d.getElementById('txtmodalTotalInputTax').value = "0.00"
		
		var x = 0;
        var rowSizeSched2 = d.getElementById("tblSched2").rows.length - 1;
        
        for(x = 0; x < rowSizeSched2; x++){
            d.getElementById("txtDatePurchased" + x).value = "";
            d.getElementById("txtDescription" + x).value = "";
            d.getElementById("txtAmt" + x).value = "0.00";
            d.getElementById("txtInputTax" + x).value = "0.00";
        }
    }

    function cancelSched2Modal() {
        isReload = true;
        restoreTempSched2Data();

        //d.getElementById('mainContent').style.display = 'block';
        //d.getElementById('modalSched2').style.display = 'none';
        //d.getElementById('DummyTxt').innerHTML = "Creator";
        //d.getElementById('DummyTxt').innerHTML = "";
		d.getElementById('mainContent').style.display = 'block';
		if ( $('#modalSched2').css('display') != 'none' ) {
			$('#modalSched2').hide('blind');
		}
		$('#DummyTxt').html("Creator");
		$('#DummyTxt').html("");
		
		isModalTurnOn = false;
		isReload = false;
    }

    function getSched2Modal(){
        if (checkifEmptyFieldSched2() && checkSched2Data())
        {
            //d.getElementById('mainContent').style.display = 'block';
            //d.getElementById('modalSched2').style.display = 'none';
            //d.getElementById('DummyTxt').innerHTML = "Creator";
            //d.getElementById('DummyTxt').innerHTML = "";
			
			//if (NumWithComma(d.getElementById('txtmodalTotalAmt').value) > 1000000) {
			//	alert("The total aggregate amount should not exceed 1 Million.\n Please re-enter the values of Schedule 2."); return ;
			//}
			
			 d.getElementById('mainContent').style.display = 'block';
			 if ( $('#modalSched2').css('display') != 'none' ) {
				$('#modalSched2').hide('blind');
			 }
			 $('#DummyTxt').html("Creator");
			 $('#DummyTxt').html("");	
			
            d.getElementById('frm2550q:txtTax21A').value  = d.getElementById('txtmodalTotalAmt').value;
            d.getElementById('frm2550q:txtTax21B').value  = d.getElementById('txtmodalTotalInputTax').value;
            compute21P();
            compute22();
        }
    }

    function checkSched2Data() {
        var size = sched2ToCommit.length; 
        for(var i = 0 ; i < size ; i++) {
            if((d.getElementById('txtAmt'+i).value * 1) > 1000000) {
                alert("The aggregate amount on row " + (i + 1) + " should not be greater than P1 Million.");
                return false;
            }
        }

        if((d.getElementById('txtmodalTotalAmt').value * 1) > 1000000) {
            alert("The total aggregate amount should be greater than 1 Million.");
            return false;
        }

        return true;
    }

    function checkifEmptyFieldSched2() {

        var size = sched2ToCommit.length;
        var firstAggregate = 0;
        var secondAggregate = 0;
        var thirdAggregate = 0;

        for(var i = 0 ; i < size ; i++)
        {
            if(d.getElementById('txtDatePurchased'+ i).value == "" || d.getElementById('txtDescription'+ i).value == "") {
                alert("Please enter valid row " + (i + 1) + " data for Schedule 2.\n" +
                    "Empty fields are not allowed."); return ;
            }
			
			if (NumWithComma(d.getElementById('txtAmt'+i).value) > 1000000) {
				alert("Please enter valid data.\n Aggregate amount should not exceed P1 Million."); return ;
			}

            strmmddyyy = d.getElementById('txtDatePurchased'+i).value;
            var aggregateAmount =  d.getElementById('txtAmt'+i).value;
			
			
			//--Benjie Manalaysay 11/06/2013
			if(strmmddyyy != ""){
				var result = strmmddyyy.split("/")
				if(result.length == 3 ){
					//Variables
					var month = result[0];
					var day = result[1];
					var year = result[2];
					
					var isLeap = new Date(year, 1, 29).getMonth() == 1;
						
					if(isNaN(month) || isNaN(day) || isNaN(year)){
						alert("Please enter a valid date for Date of Purchase on row "+(i+1)+".\n" +
						"Please enter a date in the MM/DD/YYYY format.");
					return;
					}else{ // Validate of valid Day for the month
						//Check if valid date
						var month31 = (['01', '03', '05', '07', '08', '10', '12']);
						var month30 = (['04', '06', '09', '11']);
						if (month == 2) {
						    //Special Handling for Leap Year
						    if (!isLeap && day == 29) {
						        alert("Invalid entry on row " + (i + 1) + ". Date of Purchase must be within the Return Period only.");
						        return;
						    }
						    if (!isLeap && day > 29) {
						        alert("Invalid entry on row " + (i + 1) + ". Date of Purchase must be within the Return Period only.");
						        return;
						    }
						    if (isLeap && day > 29) {
						        alert("Invalid entry on row " + (i + 1) + ". Date of Purchase must be within the Return Period only.");
						        return;
						    }

						}
						if (month31.contains(month) && day > 31)
						{
							alert("Invalid entry on row " + (i +1) + ". Date of Purchase must be within the Return Period only.");
							return;
						}
						else if (month30.contains(month) && day > 30)
						{
							alert("Invalid entry on row " + (i +1) + ". Date of Purchase must be within the Return Period only.");
							return;
						}
						else {
							//Validation if year is within the period
							//Initialize value
							var strmmddyyyFrom = d.getElementById('frm2550q:RtnPeriodFrom').value;
							var strmmddyyyTo= d.getElementById('frm2550q:RtnPeriodTo').value;
							//var resultFrom = strmmddyyyFrom.split("/");
							//var resultTo = strmmddyyyTo.split("/");
							
							var purchaseDate = new Date(strmmddyyy);
							
							if (purchaseDate < new Date(strmmddyyyFrom) || purchaseDate > new Date(strmmddyyyTo)) {
                                alert("Invalid entry on row " + (i +1) + ". Date of Purchase must be within the Return Period only."); return;
							}


                            //If valid Date of Purchase, get the sum of Amount (Net of Vat) field per month 12/10/2015
							if (month == 1 || month == 4 || month == 7 || month == 10) {
                                firstAggregate += NumWithComma(aggregateAmount);
							} else if (month == 2 || month == 5 || month == 8 || month == 11) {
                                secondAggregate += NumWithComma(aggregateAmount);
							} else if (month == 3 || month == 6 || month == 9 || month == 12) {
                                thirdAggregate += NumWithComma(aggregateAmount);
                            }
                            
							if (!isReload && (firstAggregate > 1000000 || secondAggregate > 1000000 || thirdAggregate > 1000000)) {
                                var months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
                                alert("Please enter valid data.\n Sum of Aggregate amount for the month of " + months[month - 1]  + " should not exceed P1 Million."); 
                                return;
							}
						
						}

					}
				}else{
				alert("Please enter a valid date for Date of Purchase on row "+(i+1)+".\n" +
				"Please enter a date in the MM/DD/YYYY format.");
				return;
				}
			}

			
            // check if the string is within the return period
            //  if(result[0] != d.getElementById('frm2550q:RtnMonth').value) {
            //      alert("Invalid entry on row " + (i +1) + ". Date of Purchase must be within the Return Period only."); return;
            //  }
            if( d.getElementById('txtAmt'+ i).value <= 0 ) {
                alert("Please enter amount for Net of VAT on row " + ( i + 1) + ".\n" +
                    "Value must be greater than 0."); return;
            }
        }

        return true;
    }

    function addlistSched2Reload()
    {
            var size = sched2ToCommit.length; 
            for(var i = 0 ; i < size ; i++)
            {
                sched2ToCommit[i].txtDatePurchase = d.getElementById('txtDatePurchased'+i).value;
                sched2ToCommit[i].txtDescription = d.getElementById('txtDescription'+i).value;
                sched2ToCommit[i].txtAmt = d.getElementById('txtAmt'+i).value;
                sched2ToCommit[i].txtInputTax = d.getElementById('txtInputTax'+i).value;
            }
            i = sched2ToCommit.length;
            sched2ToCommit[i] = new Schedule2();

            //d.getElementById("tbodyllistSched2").innerHTML = "";
			$('#tbodyllistSched2').html("");
			
            for(i = 0; i < sched2ToCommit.length; i++) {

                //d.getElementById("tbodyllistSched2").innerHTML += "<tr>" +
				$('#tbodyllistSched2').html(  d.getElementById('tbodyllistSched2').innerHTML + "<tr>" +
                    "<td> <input type='checkbox' id='chxSched2"+i+"' /> </td>" +
                    "<td> <input type='text'  id='txtDatePurchased"+i+"' style='width: 150px' value='"+ sched2ToCommit[i].txtDatePurchase +"' maxlength='10' onkeypress='return dateOnly(this, event)'  > </td>" +
                    "<td> <input type='text'  id='txtDescription"+i+"' style='width: 190px' value='"+ sched2ToCommit[i].txtDescription +"'  maxlength='50' > </td> " +
                    "<td><input type='text' id='txtAmt"+i+"' style='width: 150px' value='"+ sched2ToCommit[i].txtAmt +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2); getInputTaxCompute("+i+")' size='20' maxlength='25' /> </td> " +
                    "<td><input type='text' id='txtInputTax"+i+"' style='width: 150px'  value='"+ sched2ToCommit[i].txtInputTax +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2);computeSumTax()' size='20' maxlength='25' /> </td>");



                setTimeout("setInputTextControl_HorizontalAlignment('txtAmt"+i+"',4);" +
                    "setInputTextControl_HorizontalAlignment('txtInputTax"+i+"',4);",100);
              //  setTimeout("setInputTextControl_NumberFormatter('txtAmt"+i+"',12,2);" +
               //     "setInputTextControl_NumberFormatter('txtInputTax"+i+"',12,2);",100);
                setTimeout("d.getElementById('txtAmt"+i+"').value += '';" +
                    "d.getElementById('txtInputTax"+i+"').value += '';",100);
            }
    }	
	
    function addlistSched2()
    {
        if(checkifEmptyFieldSched2()) {
            var size = sched2ToCommit.length;
            for(var i = 0 ; i < size ; i++)
            {
                sched2ToCommit[i].txtDatePurchase = d.getElementById('txtDatePurchased'+i).value;
                sched2ToCommit[i].txtDescription = d.getElementById('txtDescription'+i).value;
                sched2ToCommit[i].txtAmt = d.getElementById('txtAmt'+i).value;
                sched2ToCommit[i].txtInputTax = d.getElementById('txtInputTax'+i).value;
            }
            i = sched2ToCommit.length;
            sched2ToCommit[i] = new Schedule2();

            //d.getElementById("tbodyllistSched2").innerHTML = "";
			$('#tbodyllistSched2').html("");
			
            for(i = 0; i < sched2ToCommit.length; i++) {

                //d.getElementById("tbodyllistSched2").innerHTML += "<tr>" +
				$('#tbodyllistSched2').html(  d.getElementById('tbodyllistSched2').innerHTML + "<tr>" +
                    "<td> <input type='checkbox' id='chxSched2"+i+"' /> </td>" +
                    "<td> <input type='text'  id='txtDatePurchased"+i+"' style='width: 150px' value='"+ sched2ToCommit[i].txtDatePurchase +"' maxlength='10' onkeypress='return dateOnly(this, event)'  > </td>" +
                    "<td> <input type='text'  id='txtDescription"+i+"' style='width: 190px' value='"+ sched2ToCommit[i].txtDescription +"'  maxlength='50' > </td> " +
                    "<td><input type='text' id='txtAmt"+i+"' style='width: 150px' value='"+ sched2ToCommit[i].txtAmt +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2); getInputTaxCompute("+i+")' size='20' maxlength='25' /> </td> " +
                    "<td><input type='text' id='txtInputTax"+i+"' style='width: 150px'  value='"+ sched2ToCommit[i].txtInputTax +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2);computeSumTax()' size='20' maxlength='25' /> </td>");



                setTimeout("setInputTextControl_HorizontalAlignment('txtAmt"+i+"',4);" +
                    "setInputTextControl_HorizontalAlignment('txtInputTax"+i+"',4);",100);
              //  setTimeout("setInputTextControl_NumberFormatter('txtAmt"+i+"',12,2);" +
             //       "setInputTextControl_NumberFormatter('txtInputTax"+i+"',12,2);",100);
                setTimeout("d.getElementById('txtAmt"+i+"').value += '';" +
                    "d.getElementById('txtInputTax"+i+"').value += '';",100);
            }
        }
    }

    function deletelistSched2()
    {
        var sched2Temp = new Array();
        var i = 0;
        var size = sched2ToCommit.length;
        for(i = 0 ; i < size ; i++)
        {
            sched2ToCommit[i].txtDatePurchase = d.getElementById('txtDatePurchased'+i).value;
            sched2ToCommit[i].txtDescription = d.getElementById('txtDescription'+i).value;
            sched2ToCommit[i].txtAmt = d.getElementById('txtAmt'+i).value;
            sched2ToCommit[i].txtInputTax = d.getElementById('txtInputTax'+i).value;
        }
        i = 0;
        for(var j = 0; j < size ; j++) {
            if(!d.getElementById("chxSched2" + j).checked) {
                sched2Temp[i++] = sched2ToCommit[j];
            }
        }

        if(sched2Temp.length > 0) {
            sched2ToCommit = new Array();
            sched2ToCommit = sched2Temp;
            //d.getElementById("tbodyllistSched2").innerHTML = "";
			$('#tbodyllistSched2').html("");
            for(i = 0; i < sched2Temp.length; i++) {
                sched2ToCommit[i] = sched2Temp[i];
                //d.getElementById("tbodyllistSched2").innerHTML += "<tr>" +
				$('#tbodyllistSched2').html(  d.getElementById('tbodyllistSched2').innerHTML + "<tr>" +
                    "<td> <input type='checkbox' id='chxSched2"+i+"' /> </td>" +
                    "<td> <input type='text'  id='txtDatePurchased"+i+"' style='width: 150px' value='"+ sched2ToCommit[i].txtDatePurchase +"'  maxlength='10' onkeypress='return dateOnly(this, event)'  > </td>" +
                    "<td> <input type='text'  id='txtDescription"+i+"' style='width: 190px' value='"+ sched2ToCommit[i].txtDescription +"' maxlength='50' > </td> " +
                    "<td><input type='text' id='txtAmt"+i+"' style='width: 150px' value='"+ sched2ToCommit[i].txtAmt +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2); getInputTaxCompute("+i+")' maxlength='17' /> </td> " +
                    "<td><input type='text' id='txtInputTax"+i+"' style='width: 150px'  value='"+ sched2ToCommit[i].txtInputTax +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2);computeSumTax()' maxlength='17' /> </td>");


                setTimeout("setInputTextControl_HorizontalAlignment('txtAmt"+i+"',4);" +
                    "setInputTextControl_HorizontalAlignment('txtInputTax"+i+"',4);",100);
              //  setTimeout("setInputTextControl_NumberFormatter('txtAmt"+i+"',12,2);" +
              //      "setInputTextControl_NumberFormatter('txtInputTax"+i+"',12,2);",100);
            }
        } else {
            sched2ToCommit = new Array();
            //d.getElementById("tbodyllistSched2").innerHTML = "";
			$('#tbodyllistSched2').html("");
        }
        computeSumTax();
    }

    function showSched3(){
        saveTempSched3Data();
        
        if(d.getElementById('frm2550q:txtYear').value <= 2000 && d.getElementById('frm2550q:txtYear').value <= 2020 ) {
            alert("Please  enter a valid year for the Return Period. Only values 2000 and beyond will be accepted."); return;
        } else {
            //d.getElementById('mainContent').style.display = "inline";
            //d.getElementById('modalSched3').style.display = "block";
			d.getElementById('mainContent').style.display = "none";
			$('#modalSched3').show('blind');	
				
            for(var x = 0; x < d.getElementById("tblSched3A").rows.length; x++) {
                setTimeout("setInputTextControl_HorizontalAlignment('txtAmt3A" + x + "', 4);", 100);
                setTimeout("setInputTextControl_HorizontalAlignment('txtInputTax3A" + x + "', 4);", 100);
                setTimeout("setInputTextControl_HorizontalAlignment('txtAllowInputTax3A" + x + "', 4);", 100);
                setTimeout("setInputTextControl_HorizontalAlignment('txtBalInputTax3A" + x + "', 4);", 100);

              //  setTimeout("setInputTextControl_NumberFormatter('txtAmt3A" + x + "', 12,2);", 100);
             //   setTimeout("setInputTextControl_NumberFormatter('txtInputTax3A" + x + "', 12,2);", 100);
             //   setTimeout("setInputTextControl_NumberFormatter('txtAllowInputTax3A" + x + "', 12,2);", 100);
             //   setTimeout("setInputTextControl_NumberFormatter('txtBalInputTax3A" + x + "', 12,2);", 100);
            }

            for(var x = 0; x < d.getElementById("tblSched3B").rows.length; x++) {
                setTimeout("setInputTextControl_HorizontalAlignment('txtAmt3B" + x + "', 4);", 100);
                setTimeout("setInputTextControl_HorizontalAlignment('txtBalInputTaxPrevious3B" + x + "', 4);", 100);
                setTimeout("setInputTextControl_HorizontalAlignment('txtAllowInputTax3B" + x + "', 4);", 100);
                setTimeout("setInputTextControl_HorizontalAlignment('txtBalInputTax3B" + x + "', 4);", 100);

             //   setTimeout("setInputTextControl_NumberFormatter('txtAmt3B" + x + "', 12,2);", 100);
            //    setTimeout("setInputTextControl_NumberFormatter('txtBalInputTaxPrevious3B" + x + "', 12,2);", 100);
            //    setTimeout("setInputTextControl_NumberFormatter('txtAllowInputTax3B" + x + "', 12,2);", 100);
            //    setTimeout("setInputTextControl_NumberFormatter('txtBalInputTax3B" + x + "', 12,2);", 100);
            }


            setTimeout("d.getElementById('txtmodalTotalAmountSched3').disabled = true; setInputTextControl_HorizontalAlignment('txtmodalTotalAmountSched3', 4);" +
                "d.getElementById('txtmodalTotalInputTaxSched3').disabled = true; setInputTextControl_HorizontalAlignment('txtmodalTotalInputTaxSched3', 4);" +
                "d.getElementById('txtmodalTotalBalanceSched3A').disabled = true; setInputTextControl_HorizontalAlignment('txtmodalTotalBalanceSched3A', 4);" +
                "d.getElementById('txtmodalTotalBalanceSched3B').disabled = true; setInputTextControl_HorizontalAlignment('txtmodalTotalBalanceSched3B', 4);" +
                "d.getElementById('txtmodalTotalInputTax20ASched3').disabled = true; setInputTextControl_HorizontalAlignment('txtmodalTotalInputTax20ASched3', 4);", 100);

         //   setTimeout("setInputTextControl_NumberFormatter('txtmodalTotalAmountSched3', 12,2);" +
               // "setInputTextControl_NumberFormatter('txtmodalTotalInputTaxSched3', 12,2);" +
               // "setInputTextControl_NumberFormatter('txtmodalTotalBalanceSched3A', 12,2);" +
              //  "setInputTextControl_NumberFormatter('txtmodalTotalBalanceSched3B', 12,2);" +
              //  "setInputTextControl_NumberFormatter('txtmodalTotalInputTax20ASched3', 12,2);", 100);

        }

        if(viewUploadFlag) {
            setTimeout("d.getElementById('btnAdd2').disabled = true;", 100);
            setTimeout("d.getElementById('btnDelete2').disabled = true;", 100);
            setTimeout("d.getElementById('btnAdd3').disabled = true;", 100);
            setTimeout("d.getElementById('btnDelete3').disabled = true;", 100);
            setTimeout("d.getElementById('btnClearPop3').disabled = true;", 100);
            setTimeout("d.getElementById('btnCancelPop3').disabled = true;", 100);
            setTimeout("toggleAllDisabled();", 100);
            setTimeout("d.getElementById('btnOkPop3').disabled = false;", 100);
        }
    }

    function checkifEmptyFieldSched3(nameTable) {
        if(nameTable == "A" || nameTable == "AandB" ) {
            var size = sched3AToCommit.length;
            for(var i = 0 ; i < size ; i++)
            {
                if(d.getElementById('txtDatePurchased3A'+ i).value == "" || d.getElementById('txtDescription3A'+ i).value == "" ||
                    d.getElementById('txtAllowInputTax3A'+ i).value == 0  ) {
                    alert("Please enter valid row " + (i + 1) + " data for Schedule 3A.\n" +
                        "Empty fields are not allowed.");
                    return ;
                } strmmddyyy = d.getElementById('txtDatePurchased3A'+i).value;

				
				
			//--Benjie Manalaysay 11/06/2013
			if(strmmddyyy != ""){
				var result = strmmddyyy.split("/")
				if(result.length == 3 ){
					//Variables
					var month = result[0];
					var day = result[1];
					var year = result[2];
					
					var isLeap = new Date(year, 1, 29).getMonth() == 1;
						
					if(isNaN(month) || isNaN(day) || isNaN(year)){
					    alert("Please enter a valid date for Date of Purchase on row " + (i + 1) + " Part A.\n" +
						"Please enter a date in the MM/DD/YYYY format.");
					return;
					}else{ // Validate of valid Day for the month
						//Check if valid date
						var month31 = (['01', '03', '05', '07', '08', '10', '12']);
						var month30 = (['04', '06', '09', '11']);
						if (month == 2) {
						    //Special Handling for Leap Year
						    if (!isLeap && day == 29) {
						        alert("Invalid entry on row " + (i + 1) + " Part A. Date of Purchase must be within the Return Period only.");
						        return;
						    }
						    if (!isLeap && day > 29) {
						        alert("Invalid entry on row " + (i + 1) + " Part A. Date of Purchase must be within the Return Period only.");
						        return;
						    }
						    if (isLeap && day > 29) {
						        alert("Invalid entry on row " + (i + 1) + " Part A. Date of Purchase must be within the Return Period only.");
						        return;
						    }

						}
						if (month31.contains(month) && day > 31)
						{
						    alert("Invalid entry on row " + (i + 1) + " Part A. Date of Purchase must be within the Return Period only.");
							return;
						}
						else if (month30.contains(month) && day > 30)
						{
						    alert("Invalid entry on row " + (i + 1) + " Part A. Date of Purchase must be within the Return Period only.");
							return;
						}
						else {
						    //Validation if year is within the period
						    //Initialize value
						    var strmmddyyyFrom = d.getElementById('frm2550q:RtnPeriodFrom').value;
						    var strmmddyyyTo = d.getElementById('frm2550q:RtnPeriodTo').value;
						    //var resultFrom = strmmddyyyFrom.split("/");
						    //var resultTo = strmmddyyyTo.split("/");

						    var purchaseDate = new Date(strmmddyyy);

						    if (purchaseDate < new Date(strmmddyyyFrom) || purchaseDate > new Date(strmmddyyyTo)) {
						        alert("Invalid entry on row " + (i + 1) + " Part A. Date of Purchase must be within the Return Period only."); return;
						    }

						}
					}
				}else{
				    alert("Please enter a valid date for Date of Purchase on row " + (i + 1) + " Part A.\n" +
				"Please enter a date in the MM/DD/YYYY format.");
				return;
				}
			}

			
                // check if the string is within the return period
                //  if(result[0] != d.getElementById('frm2550q:RtnMonth').value) {
                //      alert("Invalid entry on row " + (i +1) + ". Date of Purchase must be within the Return Period only."); return;
                //  }
                if( d.getElementById('txtAmt3A'+ i).value <= 0 ) {
                    alert("Please enter amount for Net of VAT on row " + ( i + 1) + ".\n" +
                        "Value must be greater than 0.");
                    return;
                }
                if( d.getElementById('txtEstLife3A'+ i).value <= 0 || d.getElementById('txtEstLife3A'+ i).value > 999 ) {
                    alert("Please enter a value 1 to 999 for Estimated Life on row " + ( i + 1) + " Schedule 3" +
                        " Part A.");
                    return;
                }
                if( d.getElementById('txtRecogLife3A'+ i).value <= 0 || d.getElementById('txtRecogLife3A'+ i).value > 60 ) {
                    alert("Please enter a value 1 to 60 for Recognized Life on row " + ( i + 1) +
                        " Part A.");
                    return;
                }
            }
			
            // check if above 1M the table A.
            if(nameTable == "AandB") { 
				if(sched3AToCommit.length > 0) { 
					if(NumWithComma(d.getElementById('txtmodalTotalAmountSched3').value) <= 1000000 ) {
						alert("The total aggregate amount does not exceed 1 Million.\n Please re-enter the values of Schedule 3.");
						return;
						//sched3AToCommit = new Array();
						//d.getElementById("tbodyllistSched3A").innerHTML = "";
						//computeSumTax3A();
					}
				}
            }
        }
        if(nameTable == "B" || nameTable == "AandB") {
            var size = sched3BToCommit.length;
            for(var i = 0 ; i < size ; i++)
            {
                if(d.getElementById('txtDatePurchased3B'+ i).value == "" || d.getElementById('txtDescription3B'+ i).value == "" ) {
                    alert("If you don't have any entries for Schedule 3b,\n" +
                        "please delete the row on this schedule if not applicable.");
                    return ;
                } strmmddyyy = d.getElementById('txtDatePurchased3B'+i).value;
                var ifyearless = "false";

				//--Benjie Manalaysay							
				if(strmmddyyy != ""){
					var result = strmmddyyy.split("/")
					if(result.length == 3 ){
						//Variables
						var month = result[0];
						var day = result[1];
						var year = result[2];
						
						var isLeap = new Date(year, 1, 29).getMonth() == 1;
							
						if(isNaN(month) || isNaN(day) || isNaN(year)){
						    alert("Please enter a valid date for Date of Purchase on row " + (i + 1) + " Part B.\n" +
							"Please enter a date in the MM/DD/YYYY format.");
						return;
						}else{ // Validate of valid Day for the month
						
						//check if year is < current Year
						if(year < d.getElementById('frm2550q:txtYear').value  ){
						ifyearless = "true";
						}
							
							//Check if valid date
							var month31 = (['01', '03', '05', '07', '08', '10', '12']);
							var month30 = (['04', '06', '09', '11']);
							if (month == 2) {
							    //Special Handling for Leap Year
							    if (!isLeap && day == 29) {
							        alert("Invalid entry on row " + (i + 1) + " Part B. Date of Purchase must be within the Return Period only.");
							        return;
							    }
							    if (!isLeap && day > 29) {
							        alert("Invalid entry on row " + (i + 1) + " Part B. Date of Purchase must be within the Return Period only.");
							        return;
							    }
							    if (isLeap && day > 29) {
							        alert("Invalid entry on row " + (i + 1) + " Part B. Date of Purchase must be within the Return Period only.");
							        return;
							    }

							}
							if (month31.contains(month) && day > 31)
							{
							    alert("Invalid entry on row " + (i + 1) + " Part B. Date of Purchase must be within the Return Period only.");
								return;
							}
							else if (month30.contains(month) && day > 30)
							{
							    alert("Invalid entry on row " + (i + 1) + " Part B. Date of Purchase must be within the Return Period only.");
								return;
							}
							else {
							    //Validation if year is within the period
							    //Initialize value
							    var strmmddyyyFrom = d.getElementById('frm2550q:RtnPeriodFrom').value;
							    var strmmddyyyTo = d.getElementById('frm2550q:RtnPeriodTo').value;
							    //var resultFrom = strmmddyyyFrom.split("/");
							    //var resultTo = strmmddyyyTo.split("/");

							    var purchaseDate = new Date(strmmddyyy);

							    if (purchaseDate >= new Date(strmmddyyyFrom) || purchaseDate > new Date(strmmddyyyTo)) {
							        alert("Invalid entry on row " + (i + 1) + " Part B. Date of Purchase must be within the Previous Period only."); return;
							    }

							}
						}
					}else{
					    alert("Please enter a valid date for Date of Purchase on row " + (i + 1) + " Part B.\n" +
					"Please enter a date in the MM/DD/YYYY format.");
					return;
					}
				}
				
                if( d.getElementById('txtAmt3B'+ i).value <= 0 ) {
                    alert("Please enter amount for Net of VAT on row " + ( i + 1) + ".\n" +
                        "Value must be greater than 0 in Part B.");
                    return;
                }
                if( d.getElementById('txtEstLife3B'+ i).value <= 0 || d.getElementById('txtEstLife3B'+ i).value > 999 ) {
                    alert("Please enter a value 1 to 999 for Estimated Life on row " + ( i + 1) + " Schedule 3" +
                        " Part B.");
                    return;
                }
                if( d.getElementById('txtRecogLife3B'+ i).value <= 0 || d.getElementById('txtRecogLife3B'+ i).value > 60 ) {
                    alert("Please enter a value 1 to 60 for Recognized Life on row " + ( i + 1) +
                        " Part B.");
                    return;
                }
            }
        }
        return true;
    }

    function saveTempSched3Data() {
        var x = 0;
        tempRowSizeSched3a = d.getElementById("tblSched3A").rows.length - 3;
        for(x = 0; x < tempRowSizeSched3a; x++){
            tempTempPeriodCovered[x] = d.getElementById("txtDatePurchased3A" + x).value;
            description[x] = d.getElementById("txtDescription3A" + x).value;
            purAmt[x] = d.getElementById("txtAmt3A" + x).value;
            inputTax[x] = d.getElementById("txtInputTax3A" + x).value;
            estMo[x] = d.getElementById("txtEstLife3A" + x).value;
            recMo[x] = d.getElementById("txtRecogLife3A" + x).value;
            allowInput[x] = d.getElementById("txtAllowInputTax3A" + x).value;
            balInputTax[x] = d.getElementById("txtBalInputTax3A" + x).value;
            tempPartATotalBal[x] =  d.getElementById("txtmodalTotalBalanceSched3A").value;
        }

        tempRowSizeSched3b = d.getElementById("tblSched3B").rows.length - 3;
        for(x = 0; x < tempRowSizeSched3b; x++){
            tempTempPeriodCoveredB[x] = d.getElementById("txtDatePurchased3B" + x).value;
            tempDescriptionB[x] = d.getElementById("txtDescription3B" + x).value;
            tempPurAmtB[x] = d.getElementById("txtAmt3B" + x).value;
            tempInputTaxB[x] = d.getElementById("txtBalInputTaxPrevious3B" + x).value;
            tempEstMoB[x] = d.getElementById("txtEstLife3B" + x).value;
            tempRecMoB[x] = d.getElementById("txtRecogLife3B" + x).value;
            tempAllowInputB[x] = d.getElementById("txtAllowInputTax3B" + x).value;
            tempBalInputTaxB[x] = d.getElementById("txtBalInputTax3B" + x).value;
            tempTempPartBTotalBalB[x] = d.getElementById("txtmodalTotalBalanceSched3B").value;
        }
    }

    function restoreTempSched3Data() {
        if(tempRowSizeSched3a > 0) {
            sched3AToCommit = new Array();
            //d.getElementById("tbodyllistSched3A").innerHTML
			$('#tbodyllistSched3A').html("");
			
            var x = 0;
            var initCount = 0;
            for(x = 0; x < tempRowSizeSched3a; x++){
                addlistSched3A();

                d.getElementById("txtDatePurchased3A" + x).value = tempTempPeriodCovered[x];
                d.getElementById("txtDescription3A" + x).value = description[x];
                d.getElementById("txtAmt3A" + x).value = purAmt[x];
                getInputTaxCompute3A(x);
                d.getElementById("txtInputTax3A" + x).value = inputTax[x];
                d.getElementById("txtEstLife3A" + x).value = estMo[x];
                d.getElementById("txtRecogLife3A" + x).value = recMo[x];
                d.getElementById("txtAllowInputTax3A" + x).value = allowInput[x];
                d.getElementById("txtBalInputTax3A" + x).value = balInputTax[x];

                if(initCount == (tempRowSizeSched3a - 1)){
                    d.getElementById("txtmodalTotalBalanceSched3A").value = tempPartATotalBal[x];
                }

                initCount++;
                computeSumTax3A();
            }
        }

        if(tempRowSizeSched3b > 0) {
            sched3BToCommit = new Array();
            //d.getElementById("tbodyllistSched3B").innerHTML = "";
			$('#tbodyllistSched3B').html("");
			
            var x = 0;
            x = 0;
            var initCount = 0;

            for(x = 0; x < tempRowSizeSched3b; x++){
                addlistSched3B();

                d.getElementById("txtDatePurchased3B" + x).value = tempTempPeriodCoveredB[x];
                d.getElementById("txtDescription3B" + x).value = tempDescriptionB[x];
                d.getElementById("txtAmt3B" + x).value = tempPurAmtB[x];
                d.getElementById("txtBalInputTaxPrevious3B" + x).value = tempInputTaxB[x];
                d.getElementById("txtEstLife3B" + x).value = tempEstMoB[x];
                d.getElementById("txtRecogLife3B" + x).value = tempRecMoB[x];
                d.getElementById("txtAllowInputTax3B" + x).value = tempAllowInputB[x];
                d.getElementById("txtBalInputTax3B" + x).value = tempBalInputTaxB[x];

                if(initCount == (tempRowSizeSched3b - 1)){
                    d.getElementById("txtmodalTotalBalanceSched3B").value = tempTempPartBTotalBalB[x];
                }

                initCount++;
                computeSumTax3B();
            }
        }
    }

    function clearSched3Modal() {
        var x = 0;
        var rowSizeSched3a = d.getElementById("tblSched3A").rows.length - 3;
        var rowSizeSched3b = d.getElementById("tblSched3B").rows.length - 3;

        for(x = 0; x < rowSizeSched3a; x++){
            d.getElementById("txtDatePurchased3A" + x).value = "";
            d.getElementById("txtDescription3A" + x).value = "";
            d.getElementById("txtAmt3A" + x).value = "0.00";
            d.getElementById("txtInputTax3A" + x).value = "0.00";
            d.getElementById("txtEstLife3A" + x).value = "0";
            d.getElementById("txtRecogLife3A" + x).value = "1";
            d.getElementById("txtAllowInputTax3A" + x).value = "0.00";
            d.getElementById("txtBalInputTax3A" + x).value = "0.00";
            d.getElementById("txtmodalTotalBalanceSched3A").value = "0.00";
        }

        for(x = 0; x < rowSizeSched3b; x++){
            d.getElementById("txtDatePurchased3B" + x).value = "";
            d.getElementById("txtDescription3B" + x).value = "";
            d.getElementById("txtAmt3B" + x).value = "0.00";
            d.getElementById("txtBalInputTaxPrevious3B" + x).value = "0.00";
            d.getElementById("txtEstLife3B" + x).value = "0";
            d.getElementById("txtRecogLife3B" + x).value = "1";
            d.getElementById("txtAllowInputTax3B" + x).value = "0.00";
            d.getElementById("txtBalInputTax3B" + x).value = "0.00";
            d.getElementById("txtmodalTotalBalanceSched3B").value = "0.00";
        }
		
		d.getElementById("txtmodalTotalAmountSched3").value = "0.00";
		d.getElementById("txtmodalTotalInputTaxSched3").value = "0.00";
		d.getElementById("txtmodalTotalBalanceSched3A").value = "0.00";

		d.getElementById("txtmodalTotalBalanceSched3B").value = "0.00";

		d.getElementById("txtmodalTotalInputTax20ASched3").value = "0.00";
		
    }

    function cancelSched3Modal() {
        restoreTempSched3Data();

        //d.getElementById('mainContent').style.display = 'block';
        //d.getElementById('modalSched3').style.display = 'none';
        //d.getElementById('DummyTxt').innerHTML = "Creator";
        //d.getElementById('DummyTxt').innerHTML = "";
		d.getElementById('mainContent').style.display = 'block';
		if ( $('#modalSched3').css('display') != 'none' ) {
			$('#modalSched3').hide('blind');
		}
		$('#DummyTxt').html("Creator");
		$('#DummyTxt').html("");	
		
        isModalTurnOn = false;
    }

    function getSched3Modal(){
        if (checkifEmptyFieldSched3("AandB") )
        {   
            //d.getElementById('mainContent').style.display = 'block';
            //d.getElementById('modalSched3').style.display = 'none';
            //d.getElementById('DummyTxt').innerHTML = "Creator";
            //d.getElementById('DummyTxt').innerHTML = "";
			 d.getElementById('mainContent').style.display = 'block';
			 if ( $('#modalSched3').css('display') != 'none' ) {
				$('#modalSched3').hide('blind');
			 }
			 $('#DummyTxt').html("Creator");
			 $('#DummyTxt').html("");				
						
            //if(sched3AToCommit.length < 0) {
            //     if( d.getElementById('txtmodalTotalAmountSched3').value <= 1000000 ) {
            //          alert("The total aggregate amount does not exceeds 1 Million.\n" +
            //             "Please re-enter the values to Schedule 2.");
            //         sched3AToCommit = new Array();
            //          d.getElementById("tbodyllistSched3A").innerHTML = "";
            //          computeSumTax3A();
            //      }
            //   }
            d.getElementById('frm2550q:txtTax21C').value  = d.getElementById('txtmodalTotalAmountSched3').value;
            d.getElementById('frm2550q:txtTax21D').value  = d.getElementById('txtmodalTotalInputTaxSched3').value;
            d.getElementById('frm2550q:txtTax23A').value  = d.getElementById('txtmodalTotalInputTax20ASched3').value;
            compute21P();
            compute22();
            compute23F();
        }
    }

    function addlistSched3AReload()
    {
            var size = sched3AToCommit.length;
            for(var i = 0 ; i < size ; i++)
            {
                sched3AToCommit[i].txtDatePurchase = d.getElementById('txtDatePurchased3A'+i).value;
                sched3AToCommit[i].txtDescription = d.getElementById('txtDescription3A'+i).value;
                sched3AToCommit[i].txtAmt = d.getElementById('txtAmt3A'+i).value;
                sched3AToCommit[i].txtInputTax = d.getElementById('txtInputTax3A'+i).value;
                sched3AToCommit[i].txtEstLife = d.getElementById('txtEstLife3A'+i).value;
                sched3AToCommit[i].txtRecogLife = d.getElementById('txtRecogLife3A'+i).value;
                sched3AToCommit[i].txtAllowInputTax = d.getElementById('txtAllowInputTax3A'+i).value;
                sched3AToCommit[i].txtBalInputTax = d.getElementById('txtBalInputTax3A'+i).value;
            }
            i = sched3AToCommit.length;
            sched3AToCommit[i] = new Schedule3();

            //d.getElementById("tbodyllistSched3A").innerHTML = "";
			$('#tbodyllistSched3A').html("");
			
            for(i = 0; i < sched3AToCommit.length; i++) {

                //d.getElementById("tbodyllistSched3A").innerHTML += "<tr>" +
				$('#tbodyllistSched3A').html(  d.getElementById('tbodyllistSched3A').innerHTML + "<tr>" +
                    "<td width='4%'> <input type='checkbox' class='printButtonClass' id='chxSched3A"+i+"' /> </td>" +
                    "<td width='12%'> <input type='text'  id='txtDatePurchased3A"+i+"' style='width: 100px' value='"+ sched3AToCommit[i].txtDatePurchase +"' maxlength='10' onkeypress='return dateOnly(this, event)'  > </td>" +
                    "<td width='12%'> <input type='text'  id='txtDescription3A"+i+"' style='width: 150px' value='"+ sched3AToCommit[i].txtDescription +"' maxlength='50' > </td> " +
                    "<td width='12%'><input type='text' id='txtAmt3A"+i+"' value='"+ sched3AToCommit[i].txtAmt +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2); getInputTaxCompute3A("+i+")' size='20' maxlength='25' /> </td> " +
                    "<td width='12%'><input type='text' id='txtInputTax3A"+i+"' value='"+ sched3AToCommit[i].txtInputTax +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2); computeSumTax3A()' size='20' maxlength='25'  /> </td>" +
                    "<td width='12%'><input type='text' id='txtEstLife3A"+i+"' style='width: 80px'  value='"+ sched3AToCommit[i].txtEstLife +"' style='text-align: right' onkeypress='return numbersonly(this, event)' onblur='blockletterWithout2Decimal(this);' maxlength='3'  /> </td>" +
                    "<td width='12%'><input type='text' id='txtRecogLife3A"+i+"' style='width: 80px'  value='"+ sched3AToCommit[i].txtRecogLife +"' style='text-align: right' onkeypress='return numbersonly(this, event)' onblur='blockletterWithout2Decimal(this);computeSumTax3A();' maxlength='2'  /> </td>" +
                    "<td width='12%'><input type='text' id='txtAllowInputTax3A"+i+"' onblur='round(this,2); computeSumTax3A()' size='20' value='"+ sched3AToCommit[i].txtAllowInputTax +"'  /> </td>" +
                    "<td width='12%'><input type='text' id='txtBalInputTax3A"+i+"'style='background-color: rgb(220, 220, 220)' size='20' value='"+ sched3AToCommit[i].txtBalInputTax +"'  /> </td>");



                setTimeout("setInputTextControl_HorizontalAlignment('txtAmt3A"+i+"',4 );" +
                    "setInputTextControl_HorizontalAlignment('txtInputTax3A"+i+"',4 ); " +
                    "setInputTextControl_HorizontalAlignment('txtAllowInputTax3A"+i+"',4 ); " +
                    "d.getElementById('txtBalInputTax3A"+i+"').disabled = true; setInputTextControl_HorizontalAlignment('txtBalInputTax3A"+i+"',4 ); " +
                    "",100);

              //  setTimeout("setInputTextControl_NumberFormatter('txtAmt3A"+i+"',12,2 );" +
                 //   "setInputTextControl_NumberFormatter('txtInputTax3A"+i+"',12,2 ); " +
               //     "setInputTextControl_NumberFormatter('txtAllowInputTax3A"+i+"',12,2 ); " +
               //     "setInputTextControl_NumberFormatter('txtBalInputTax3A"+i+"',12,2 ); " +
               //     "",100);
            }
    }
	
	
    function addlistSched3A()
    {
        if(checkifEmptyFieldSched3("A")) {
            var size = sched3AToCommit.length;
            for(var i = 0 ; i < size ; i++)
            {
                sched3AToCommit[i].txtDatePurchase = d.getElementById('txtDatePurchased3A'+i).value;
                sched3AToCommit[i].txtDescription = d.getElementById('txtDescription3A'+i).value;
                sched3AToCommit[i].txtAmt = d.getElementById('txtAmt3A'+i).value;
                sched3AToCommit[i].txtInputTax = d.getElementById('txtInputTax3A'+i).value;
                sched3AToCommit[i].txtEstLife = d.getElementById('txtEstLife3A'+i).value;
                sched3AToCommit[i].txtRecogLife = d.getElementById('txtRecogLife3A'+i).value;
                sched3AToCommit[i].txtAllowInputTax = d.getElementById('txtAllowInputTax3A'+i).value;
                sched3AToCommit[i].txtBalInputTax = d.getElementById('txtBalInputTax3A'+i).value;
            }
            i = sched3AToCommit.length;
            sched3AToCommit[i] = new Schedule3();

            //d.getElementById("tbodyllistSched3A").innerHTML = "";
			$('#tbodyllistSched3A').html("");
			
            for(i = 0; i < sched3AToCommit.length; i++) {

                //d.getElementById("tbodyllistSched3A").innerHTML += "<tr>" +
				$('#tbodyllistSched3A').html(  d.getElementById('tbodyllistSched3A').innerHTML + "<tr>" +
                    "<td width='4%'> <input type='checkbox' class='printButtonClass' id='chxSched3A"+i+"' /> </td>" +
                    "<td width='12%'> <input type='text'  id='txtDatePurchased3A"+i+"' style='width: 100px' value='"+ sched3AToCommit[i].txtDatePurchase +"' maxlength='10' onkeypress='return dateOnly(this, event)'  > </td>" +
                    "<td width='12%'> <input type='text'  id='txtDescription3A"+i+"' style='width: 150px' value='"+ sched3AToCommit[i].txtDescription +"' maxlength='50' > </td> " +
                    "<td width='12%'><input type='text' id='txtAmt3A"+i+"' value='"+ sched3AToCommit[i].txtAmt +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2); getInputTaxCompute3A("+i+")' size='20' maxlength='25' /> </td> " +
                    "<td width='12%'><input type='text' id='txtInputTax3A"+i+"' value='"+ sched3AToCommit[i].txtInputTax +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2); computeSumTax3A()' size='20' maxlength='25'  /> </td>" +
                    "<td width='12%'><input type='text' id='txtEstLife3A"+i+"' style='width: 80px'  value='"+ sched3AToCommit[i].txtEstLife +"' style='text-align: right' onkeypress='return numbersonly(this, event)' onblur='blockletterWithout2Decimal(this);' maxlength='3'  /> </td>" +
                    "<td width='12%'><input type='text' id='txtRecogLife3A"+i+"' style='width: 80px'  value='"+ sched3AToCommit[i].txtRecogLife +"' style='text-align: right' onkeypress='return numbersonly(this, event)' onblur='blockletterWithout2Decimal(this);computeSumTax3A();' maxlength='2'  /> </td>" +
                    "<td width='12%'><input type='text' id='txtAllowInputTax3A"+i+"' onblur='round(this,2); computeSumTax3A()' size='20' value='"+ sched3AToCommit[i].txtAllowInputTax +"'  /> </td>" +
                    "<td width='12%'><input type='text' id='txtBalInputTax3A"+i+"'style='background-color: rgb(220, 220, 220)' size='20' value='"+ sched3AToCommit[i].txtBalInputTax +"'  /> </td>");



                setTimeout("setInputTextControl_HorizontalAlignment('txtAmt3A"+i+"',4 );" +
                    "setInputTextControl_HorizontalAlignment('txtInputTax3A"+i+"',4 ); " +
                    "setInputTextControl_HorizontalAlignment('txtAllowInputTax3A"+i+"',4 ); " +
                    "d.getElementById('txtBalInputTax3A"+i+"').disabled = true; setInputTextControl_HorizontalAlignment('txtBalInputTax3A"+i+"',4 ); " +
                    "",100);

             //   setTimeout("setInputTextControl_NumberFormatter('txtAmt3A"+i+"',12,2 );" +
             //       "setInputTextControl_NumberFormatter('txtInputTax3A"+i+"',12,2 ); " +
             //       "setInputTextControl_NumberFormatter('txtAllowInputTax3A"+i+"',12,2 ); " +
             //       "setInputTextControl_NumberFormatter('txtBalInputTax3A"+i+"',12,2 ); " +
             //       "",100);
            }
        }
    }

    function deletelistSched3A()
    {
        var sched3ATemp = new Array();
        var i = 0;
        var size = sched3AToCommit.length;
        for(i = 0 ; i < size ; i++)
        {
            sched3AToCommit[i].txtDatePurchase = d.getElementById('txtDatePurchased3A'+i).value;
            sched3AToCommit[i].txtDescription = d.getElementById('txtDescription3A'+i).value;
            sched3AToCommit[i].txtAmt = d.getElementById('txtAmt3A'+i).value;
            sched3AToCommit[i].txtInputTax = d.getElementById('txtInputTax3A'+i).value;
            sched3AToCommit[i].txtEstLife = d.getElementById('txtEstLife3A'+i).value;
            sched3AToCommit[i].txtRecogLife = d.getElementById('txtRecogLife3A'+i).value;
            sched3AToCommit[i].txtAllowInputTax = d.getElementById('txtAllowInputTax3A'+i).value;
            sched3AToCommit[i].txtBalInputTax = d.getElementById('txtBalInputTax3A'+i).value;
        }
        i = 0;
        for(var j = 0; j < size ; j++) {
            if(!d.getElementById("chxSched3A" + j).checked) {
                sched3ATemp[i++] = sched3AToCommit[j];
            }
        }

        if(sched3ATemp.length > 0) {
            sched3AToCommit = new Array();
            sched3AToCommit = sched3ATemp;
            //d.getElementById("tbodyllistSched3A").innerHTML = "";
			$('#tbodyllistSched3A').html("");

            for(i = 0; i < sched3ATemp.length; i++) {
                sched3AToCommit[i] = sched3ATemp[i];
                //d.getElementById("tbodyllistSched3A").innerHTML += "<tr>" +
				$('#tbodyllistSched3A').html(  d.getElementById('tbodyllistSched3A').innerHTML + "<tr>" +
                    "<td width='4%'> <input type='checkbox' class='printButtonClass' id='chxSched3A"+i+"' style='width: 20px' /> </td>" +
                    "<td width='12%'> <input type='text'  id='txtDatePurchased3A"+i+"' style='width: 100px' value='"+ sched3AToCommit[i].txtDatePurchase +"' maxlength='10' onkeypress='return dateOnly(this, event)'  > </td>" +
                    "<td width='12%'> <input type='text'  id='txtDescription3A"+i+"' style='width: 150px' value='"+ sched3AToCommit[i].txtDescription +"' maxlength='50' > </td> " +
                    "<td width='12%'><input type='text' id='txtAmt3A"+i+"' value='"+ sched3AToCommit[i].txtAmt +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2); getInputTaxCompute3A("+i+")' size='20' maxlength='25' /> </td> " +
                    "<td width='12%'><input type='text' id='txtInputTax3A"+i+"' value='"+ sched3AToCommit[i].txtInputTax +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2); computeSumTax3A()' size='20' maxlength='25'  /> </td>" +
                    "<td width='12%'><input type='text' id='txtEstLife3A"+i+"' style='width: 80px'  value='"+ sched3AToCommit[i].txtEstLife +"' style='text-align: right' onkeypress='return numbersonly(this, event)' onblur='blockletterWithout2Decimal(this);' maxlength='3'  /> </td>" +
                    "<td width='12%'><input type='text' id='txtRecogLife3A"+i+"' style='width: 80px'  value='"+ sched3AToCommit[i].txtRecogLife +"' style='text-align: right' onkeypress='return numbersonly(this, event)' onblur='blockletterWithout2Decimal(this);computeSumTax3A();' maxlength='2'  /> </td>" +
                    "<td width='12%'><input type='text' id='txtAllowInputTax3A"+i+"' onblur='round(this,2); computeSumTax3A()' size='20' value='"+ sched3AToCommit[i].txtAllowInputTax +"'  /> </td>" +
                    "<td width='12%'><input type='text' id='txtBalInputTax3A"+i+"'style='background-color: rgb(220, 220, 220)' size='20' value='"+ sched3AToCommit[i].txtBalInputTax +"'  /> </td>");



                setTimeout("setInputTextControl_HorizontalAlignment('txtAmt3A"+i+"',4 );" +
                    "setInputTextControl_HorizontalAlignment('txtInputTax3A"+i+"',4 ); " +
                    "setInputTextControl_HorizontalAlignment('txtAllowInputTax3A"+i+"',4 ); " +
                    "d.getElementById('txtBalInputTax3A"+i+"').disabled = true; setInputTextControl_HorizontalAlignment('txtBalInputTax3A"+i+"',4 ); " +
                    "",100);
              //  setTimeout("setInputTextControl_NumberFormatter('txtAmt3A"+i+"',12,2 );" +
               //     "setInputTextControl_NumberFormatter('txtInputTax3A"+i+"',12,2 ); " +
               //     "setInputTextControl_NumberFormatter('txtAllowInputTax3A"+i+"',12,2 ); " +
              //      "setInputTextControl_NumberFormatter('txtBalInputTax3A"+i+"',12,2 ); " +
              //      "",100);

            }
        } else {
            sched3AToCommit = new Array();
            //d.getElementById("tbodyllistSched3A").innerHTML = "";
			$('#tbodyllistSched3A').html("");
        }
        computeSumTax3A();
    }

    function addlistSched3BReload()
    {
            var size = sched3BToCommit.length;
            for(var i = 0 ; i < size ; i++)
            {
                sched3BToCommit[i].txtDatePurchase = d.getElementById('txtDatePurchased3B'+i).value;
                sched3BToCommit[i].txtDescription = d.getElementById('txtDescription3B'+i).value;
                sched3BToCommit[i].txtAmt = d.getElementById('txtAmt3B'+i).value;
                sched3BToCommit[i].txtInputTax = d.getElementById('txtBalInputTaxPrevious3B'+i).value;
                sched3BToCommit[i].txtEstLife = d.getElementById('txtEstLife3B'+i).value;
                sched3BToCommit[i].txtRecogLife = d.getElementById('txtRecogLife3B'+i).value;
                sched3BToCommit[i].txtAllowInputTax = d.getElementById('txtAllowInputTax3B'+i).value;
                sched3BToCommit[i].txtBalInputTax = d.getElementById('txtBalInputTax3B'+i).value;
            }
            i = sched3BToCommit.length;
            sched3BToCommit[i] = new Schedule3();

            //d.getElementById("tbodyllistSched3B").innerHTML = "";
			$('#tbodyllistSched3B').html("");
			
            for(i = 0; i < sched3BToCommit.length; i++) {

                //d.getElementById("tbodyllistSched3B").innerHTML += "<tr>" +
				$('#tbodyllistSched3B').html(  d.getElementById('tbodyllistSched3B').innerHTML + "<tr>" +
                    "<td> <input type='checkbox' class='printButtonClass' id='chxSched3B"+i+"' /> </td>" +
                    "<td> <input type='text'  id='txtDatePurchased3B"+i+"' style='width: 100px' value='"+ sched3BToCommit[i].txtDatePurchase +"' maxlength='10' onkeypress='return dateOnly(this, event)'  > </td>" +
                    "<td> <input type='text'  id='txtDescription3B"+i+"' style='width: 150px' value='"+ sched3BToCommit[i].txtDescription +"' maxlength='50' > </td> " +
                    "<td><input type='text' id='txtAmt3B"+i+"' value='"+ sched3BToCommit[i].txtAmt +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2)' size='20' maxlength='25' /> </td> " +
                    "<td><input type='text' id='txtBalInputTaxPrevious3B"+i+"' value='"+ sched3BToCommit[i].txtInputTax +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2); computeSumTax3B()' size='20' maxlength='25'  /> </td>" +
                    "<td><input type='text' id='txtEstLife3B"+i+"' style='width: 80px'  value='"+ sched3BToCommit[i].txtEstLife +"' style='text-align: right' onkeypress='return numbersonly(this, event)' onblur='blockletterWithout2Decimal(this);' maxlength='3'  /> </td>" +
                    "<td><input type='text' id='txtRecogLife3B"+i+"' style='width: 80px'  value='"+ sched3BToCommit[i].txtRecogLife +"' style='text-align: right' onkeypress='return numbersonly(this, event)' onblur='blockletterWithout2Decimal(this);computeSumTax3B();' maxlength='2'  /> </td>" +
                    "<td><input type='text' id='txtAllowInputTax3B"+i+"' onblur='round(this,2); computeSumTax3B()' size='20' value='"+ sched3BToCommit[i].txtAllowInputTax +"'  /> </td>" +
                    "<td><input type='text' id='txtBalInputTax3B"+i+"'style='background-color: rgb(220, 220, 220)' size='20'  value='"+ sched3BToCommit[i].txtBalInputTax +"'  /> </td>");



                setTimeout("setInputTextControl_HorizontalAlignment('txtAmt3B"+i+"',4 );" +
                    "setInputTextControl_HorizontalAlignment('txtBalInputTaxPrevious3B"+i+"',4 ); " +
                    "setInputTextControl_HorizontalAlignment('txtAllowInputTax3B"+i+"',4 ); " +
                    "d.getElementById('txtBalInputTax3B"+i+"').disabled = true; setInputTextControl_HorizontalAlignment('txtBalInputTax3B"+i+"',4 ); " +
                    "",100);

          //      setTimeout("setInputTextControl_NumberFormatter('txtAmt3B"+i+"',12,2 );" +
            //        "setInputTextControl_NumberFormatter('txtBalInputTaxPrevious3B"+i+"',12,2 ); " +
              //      "setInputTextControl_NumberFormatter('txtAllowInputTax3B"+i+"',12,2 ); " +
                //    "setInputTextControl_NumberFormatter('txtBalInputTax3B"+i+"',12,2 ); " +
                  //  "",100);
            }
    }	
	
    function addlistSched3B()
    {
        if(checkifEmptyFieldSched3("B")) {
            var size = sched3BToCommit.length;
            for(var i = 0 ; i < size ; i++)
            {
                sched3BToCommit[i].txtDatePurchase = d.getElementById('txtDatePurchased3B'+i).value;
                sched3BToCommit[i].txtDescription = d.getElementById('txtDescription3B'+i).value;
                sched3BToCommit[i].txtAmt = d.getElementById('txtAmt3B'+i).value;
                sched3BToCommit[i].txtInputTax = d.getElementById('txtBalInputTaxPrevious3B'+i).value;
                sched3BToCommit[i].txtEstLife = d.getElementById('txtEstLife3B'+i).value;
                sched3BToCommit[i].txtRecogLife = d.getElementById('txtRecogLife3B'+i).value;
                sched3BToCommit[i].txtAllowInputTax = d.getElementById('txtAllowInputTax3B'+i).value;
                sched3BToCommit[i].txtBalInputTax = d.getElementById('txtBalInputTax3B'+i).value;
            }
            i = sched3BToCommit.length;
            sched3BToCommit[i] = new Schedule3();

            //d.getElementById("tbodyllistSched3B").innerHTML = "";
			$('#tbodyllistSched3B').html("");
			
            for(i = 0; i < sched3BToCommit.length; i++) {

                //d.getElementById("tbodyllistSched3B").innerHTML += "<tr>" +
				$('#tbodyllistSched3B').html(  d.getElementById('tbodyllistSched3B').innerHTML + "<tr>" +
                    "<td> <input type='checkbox' class='printButtonClass' id='chxSched3B"+i+"' /> </td>" +
                    "<td> <input type='text'  id='txtDatePurchased3B"+i+"' style='width: 100px' value='"+ sched3BToCommit[i].txtDatePurchase +"' maxlength='10' onkeypress='return dateOnly(this, event)'  > </td>" +
                    "<td> <input type='text'  id='txtDescription3B"+i+"' style='width: 150px' value='"+ sched3BToCommit[i].txtDescription +"' maxlength='50' > </td> " +
                    "<td><input type='text' id='txtAmt3B"+i+"' value='"+ sched3BToCommit[i].txtAmt +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2)' size='20' maxlength='25' /> </td> " +
                    "<td><input type='text' id='txtBalInputTaxPrevious3B"+i+"' value='"+ sched3BToCommit[i].txtInputTax +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2);computeSumTax3B()' size='20' maxlength='25'  /> </td>" +
                    "<td><input type='text' id='txtEstLife3B"+i+"' style='width: 80px'  value='"+ sched3BToCommit[i].txtEstLife +"' style='text-align: right' onkeypress='return numbersonly(this, event)' onblur='blockletterWithout2Decimal(this);' maxlength='3'  /> </td>" +
                    "<td><input type='text' id='txtRecogLife3B"+i+"' style='width: 80px'  value='"+ sched3BToCommit[i].txtRecogLife +"' style='text-align: right' onkeypress='return numbersonly(this, event)' onblur='blockletterWithout2Decimal(this);computeSumTax3B();' maxlength='2'  /> </td>" +
                    "<td><input type='text' id='txtAllowInputTax3B"+i+"' onblur='round(this,2); computeSumTax3B()' size='20' value='"+ sched3BToCommit[i].txtAllowInputTax +"'  /> </td>" +
                    "<td><input type='text' id='txtBalInputTax3B"+i+"'style='background-color: rgb(220, 220, 220)' size='20'  value='"+ sched3BToCommit[i].txtBalInputTax +"'  /> </td>");



                setTimeout("setInputTextControl_HorizontalAlignment('txtAmt3B"+i+"',4 );" +
                    "setInputTextControl_HorizontalAlignment('txtBalInputTaxPrevious3B"+i+"',4 ); " +
                    "setInputTextControl_HorizontalAlignment('txtAllowInputTax3B"+i+"',4 ); " +
                    "d.getElementById('txtBalInputTax3B"+i+"').disabled = true; setInputTextControl_HorizontalAlignment('txtBalInputTax3B"+i+"',4 ); " +
                    "",100);

             //   setTimeout("setInputTextControl_NumberFormatter('txtAmt3B"+i+"',12,2 );" +
             //       "setInputTextControl_NumberFormatter('txtBalInputTaxPrevious3B"+i+"',12,2 ); " +
              //      "setInputTextControl_NumberFormatter('txtAllowInputTax3B"+i+"',12,2 ); " +
               //     "setInputTextControl_NumberFormatter('txtBalInputTax3B"+i+"',12,2 ); " +
                //    "",100);
            }
        }
    }

    function deletelistSched3B()
    {
        var sched3BTemp = new Array();
        var i = 0;
        var size = sched3BToCommit.length;
        for(i = 0 ; i < size ; i++)
        {
            sched3BToCommit[i].txtDatePurchase = d.getElementById('txtDatePurchased3B'+i).value;
            sched3BToCommit[i].txtDescription = d.getElementById('txtDescription3B'+i).value;
            sched3BToCommit[i].txtAmt = d.getElementById('txtAmt3B'+i).value;
            sched3BToCommit[i].txtInputTax = d.getElementById('txtBalInputTaxPrevious3B'+i).value;
            sched3BToCommit[i].txtEstLife = d.getElementById('txtEstLife3B'+i).value;
            sched3BToCommit[i].txtRecogLife = d.getElementById('txtRecogLife3B'+i).value;
            sched3BToCommit[i].txtAllowInputTax = d.getElementById('txtAllowInputTax3B'+i).value;
            sched3BToCommit[i].txtBalInputTax = d.getElementById('txtBalInputTax3B'+i).value;
        }
        i = 0;
        for(var j = 0; j < size ; j++) {
            if(!d.getElementById("chxSched3B" + j).checked) {
                sched3BTemp[i++] = sched3BToCommit[j];
            }
        }

        if(sched3BTemp.length > 0) {
            sched3BToCommit = new Array();
            sched3BToCommit = sched3BTemp;
            //d.getElementById("tbodyllistSched3B").innerHTML = "";
			$('#tbodyllistSched3B').html("");
			
            for(i = 0; i < sched3BTemp.length; i++) {
                sched3BToCommit[i] = sched3BTemp[i];
                //d.getElementById("tbodyllistSched3B").innerHTML += "<tr>" +
				$('#tbodyllistSched3B').html(  d.getElementById('tbodyllistSched3B').innerHTML + "<tr>" +
                    "<td> <input type='checkbox' class='printButtonClass' id='chxSched3B"+i+"' /> </td>" +
                    "<td> <input type='text'  id='txtDatePurchased3B"+i+"' style='width: 100px' value='"+ sched3BToCommit[i].txtDatePurchase +"' maxlength='10' onkeypress='return dateOnly(this, event)'  > </td>" +
                    "<td> <input type='text'  id='txtDescription3B"+i+"' style='width: 150px' value='"+ sched3BToCommit[i].txtDescription +"' maxlength='50' > </td> " +
                    "<td><input type='text' id='txtAmt3B"+i+"' style='width: 100px' value='"+ sched3BToCommit[i].txtAmt +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2)' size='20' maxlength='25' /> </td> " +
                    "<td><input type='text' id='txtBalInputTaxPrevious3B"+i+"' style='width: 100px'  value='"+ sched3BToCommit[i].txtInputTax +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2);computeSumTax3B()' size='20' maxlength='25'  /> </td>" +
                    "<td><input type='text' id='txtEstLife3B"+i+"' style='width: 80px'  value='"+ sched3BToCommit[i].txtEstLife +"' style='text-align: right' onkeypress='return numbersonly(this, event)' onblur='blockletterWithout2Decimal(this);' maxlength='3'  /> </td>" +
                    "<td><input type='text' id='txtRecogLife3B"+i+"' style='width: 80px'  value='"+ sched3BToCommit[i].txtRecogLife +"' style='text-align: right' onkeypress='return numbersonly(this, event)' onblur='blockletterWithout2Decimal(this);computeSumTax3B();' maxlength='2'  /> </td>" +
                    "<td><input type='text' id='txtAllowInputTax3B"+i+"' onblur='round(this,2); computeSumTax3B()' size='20' value='"+ sched3BToCommit[i].txtAllowInputTax +"'  /> </td>" +
                    "<td><input type='text' id='txtBalInputTax3B"+i+"'style='background-color: rgb(220, 220, 220)' size='20' value='"+ sched3BToCommit[i].txtBalInputTax +"'  /> </td>");

                setTimeout("setInputTextControl_HorizontalAlignment('txtAmt3B"+i+"',4 );" +
                    "setInputTextControl_HorizontalAlignment('txtBalInputTaxPrevious3B"+i+"',4 ); " +
                    "setInputTextControl_HorizontalAlignment('txtAllowInputTax3B"+i+"',4 ); " +
                    "d.getElementById('txtBalInputTax3B"+i+"').disabled = true; setInputTextControl_HorizontalAlignment('txtBalInputTax3B"+i+"',4 ); " +
                    "",100);

         //       setTimeout("setInputTextControl_NumberFormatter('txtAmt3B"+i+"',12,2 );" +
           //         "setInputTextControl_NumberFormatter('txtBalInputTaxPrevious3B"+i+"',12,2 ); " +
             //       "setInputTextControl_NumberFormatter('txtAllowInputTax3B"+i+"',12,2 ); " +
               //     "setInputTextControl_NumberFormatter('txtBalInputTax3B"+i+"',12,2 ); " +
                 //   "",100);
            }
        } else {
            sched3BToCommit = new Array();
            //d.getElementById("tbodyllistSched3B").innerHTML = "";
			$('#tbodyllistSched3B').html("");
        }
        computeSumTax3B();
    }
	
	//jtrac 1311 rpangan 21May2013
	function valuesSched4and5(){
		d.getElementById('txtTaxableSaleSched4').value = d.getElementById('frm2550q:txtTax16A').value;
		d.getElementById('txtTotalSaleSched4').value = d.getElementById('frm2550q:txtTax19A').value;

		d.getElementById('txtTotSaleSched5').value = d.getElementById('frm2550q:txtTax18').value;
		d.getElementById('txtSumTotalSaleSched5').value = d.getElementById('frm2550q:txtTax19A').value;
	}
	
    function showSched4(){
        saveTempSched4Data();
        
        if(d.getElementById('frm2550q:txtTax16A').value <= 0 ) {
            alert("Please enter a valid value on Item 16A to be able to load the Schedule 4."); return;
        } else {
            //d.getElementById('mainContent').style.display = "inline";
            //d.getElementById('modalSched4').style.display = "block";
			d.getElementById('mainContent').style.display = "none";
			$('#modalSched4').show('blind');					

            d.getElementById('txtTaxableSaleSched4').value = d.getElementById('frm2550q:txtTax16A').value;
            d.getElementById('txtTotalSaleSched4').value = d.getElementById('frm2550q:txtTax19A').value;
            // to initialize values in page
            computeInputTaxSched4();
            setTimeout("setInputTextControl_HorizontalAlignment('txtinputtaxSched4', 4);" +
                "d.getElementById('txtTaxableSaleSched4').disabled = true; setInputTextControl_HorizontalAlignment('txtTaxableSaleSched4', 4);" +
                "setInputTextControl_HorizontalAlignment('txtInputTaxnotDirectSched4', 4);" +
                "d.getElementById('txtTotalInputTaxnotDirectSched4').disabled = true; setInputTextControl_HorizontalAlignment('txtTotalInputTaxnotDirectSched4', 4);" +
                "d.getElementById('txtTotalSaleSched4').disabled = true; setInputTextControl_HorizontalAlignment('txtTotalSaleSched4', 4);" +
                "d.getElementById('txtTotalInputSaletoGovernmentSched4').disabled = true; setInputTextControl_HorizontalAlignment('txtTotalInputSaletoGovernmentSched4', 4);" +
                "setInputTextControl_HorizontalAlignment('txtlessStdTaxSched4', 4);" +
                "d.getElementById('txtTotal20BSched4').disabled = true; setInputTextControl_HorizontalAlignment('txtTotal20BSched4', 4);", 100);

         //   setTimeout("setInputTextControl_NumberFormatter('txtinputtaxSched4', 12,2);" +
           //     "setInputTextControl_NumberFormatter('txtTaxableSaleSched4', 12,2);" +
         //       "setInputTextControl_NumberFormatter('txtInputTaxnotDirectSched4', 12,2);" +
         //       "setInputTextControl_NumberFormatter('txtTotalInputTaxnotDirectSched4', 12,2);" +
         //       "setInputTextControl_NumberFormatter('txtTotalSaleSched4', 12,2);" +
         //       "setInputTextControl_NumberFormatter('txtTotalInputSaletoGovernmentSched4', 12,2);" +
         //       "setInputTextControl_NumberFormatter('txtlessStdTaxSched4', 12,2);" +
         //       "setInputTextControl_NumberFormatter('txtTotal20BSched4', 12,2);", 100);

        }

        if(viewUploadFlag) {
            setTimeout("d.getElementById('btnClearPop4').disabled = true;", 100);
            setTimeout("d.getElementById('btnCancelPop4').disabled = true;", 100);
            setTimeout("toggleAllDisabled();", 100);
            setTimeout("d.getElementById('btnOkPop4').disabled = false;", 100);
        }

    }

    function checkifEmptyFieldSched4(){
        return true;
    }

    function saveTempSched4Data() {
        tempDirInputTax = d.getElementById("txtinputtaxSched4").value;
        tempInputNotAttrib = d.getElementById("txtInputTaxnotDirectSched4").value;
        tempRatInputTax = d.getElementById("txtTotalInputTaxnotDirectSched4").value;
        tempTotalInputTaxSched4 = d.getElementById("txtTotalInputSaletoGovernmentSched4").value;
        tempStanInputTax = d.getElementById("txtlessStdTaxSched4").value;
        tempInputSaleExp = d.getElementById("txtTotal20BSched4").value;
    }

    function restoreTempSched4Data() {
        d.getElementById("txtinputtaxSched4").value = tempDirInputTax;
        d.getElementById("txtInputTaxnotDirectSched4").value = tempInputNotAttrib;
        d.getElementById("txtTotalInputTaxnotDirectSched4").value = tempRatInputTax;
        d.getElementById("txtTotalInputSaletoGovernmentSched4").value = tempTotalInputTaxSched4;
        d.getElementById("txtlessStdTaxSched4").value = tempStanInputTax;
        d.getElementById("txtTotal20BSched4").value = tempInputSaleExp;
    }

    function clearSched4Modal() {
        d.getElementById("txtinputtaxSched4").value = "0.00";
        d.getElementById("txtInputTaxnotDirectSched4").value = "0.00";
        d.getElementById("txtTotalInputTaxnotDirectSched4").value = "0.00";
        d.getElementById("txtTotalInputSaletoGovernmentSched4").value = "0.00";
        d.getElementById("txtlessStdTaxSched4").value = "0.00";
        d.getElementById("txtTotal20BSched4").value = "0.00";
    }

    function cancelSched4Modal() {
        restoreTempSched4Data();

        //d.getElementById('mainContent').style.display = 'block';
        //d.getElementById('modalSched4').style.display = 'none';
        //d.getElementById('DummyTxt').innerHTML = "Creator";
        //d.getElementById('DummyTxt').innerHTML = "";
		d.getElementById('mainContent').style.display = 'block';
		if ( $('#modalSched4').css('display') != 'none' ) {
			$('#modalSched4').hide('blind');
		}
		$('#DummyTxt').html("Creator");
		$('#DummyTxt').html("");			

        isModalTurnOn = false;
    }

    function getSched4Modal(){
        if (checkifEmptyFieldSched4() )
        {
            d.getElementById('mainContent').style.display = 'block';
            d.getElementById('modalSched4').style.display = 'none';
            d.getElementById('DummyTxt').innerHTML = "Creator";
            d.getElementById('DummyTxt').innerHTML = "";

            d.getElementById('frm2550q:txtTax23B').value  = d.getElementById('txtTotal20BSched4').value;
            compute23F();
        }
    }

    function showSched5(){
        saveTempSched5Data();
        
        if(d.getElementById('frm2550q:txtTax18').value <= 0 ) {
            alert("Please enter a valid value on Item 18 to be able to load the Schedule 5."); return;
        } else {
            //d.getElementById('mainContent').style.display = "inline";
            //d.getElementById('modalSched5').style.display = "block";
			d.getElementById('mainContent').style.display = "none";
			$('#modalSched5').show('blind');				

            d.getElementById('txtTotSaleSched5').value = d.getElementById('frm2550q:txtTax18').value;
            d.getElementById('txtSumTotalSaleSched5').value = d.getElementById('frm2550q:txtTax19A').value;

            setTimeout("setInputTextControl_HorizontalAlignment('txtinputtaxSched5', 4);" +
                "d.getElementById('txtTotSaleSched5').disabled = true; setInputTextControl_HorizontalAlignment('txtTotSaleSched5', 4);" +
                "setInputTextControl_HorizontalAlignment('txtAmountInputnotDirectSched5', 4);" +
                "d.getElementById('txtProductnotDirectSched5').disabled = true; setInputTextControl_HorizontalAlignment('txtProductnotDirectSched5', 4);" +
                "d.getElementById('txtSumTotalSaleSched5').disabled = true; setInputTextControl_HorizontalAlignment('txtSumTotalSaleSched5', 4);" +
                "d.getElementById('txtTotal20CSched5').disabled = true; setInputTextControl_HorizontalAlignment('txtTotal20CSched5', 4);", 100);

         //   setTimeout("setInputTextControl_NumberFormatter('txtinputtaxSched5', 12,2);" +
         //       "setInputTextControl_NumberFormatter('txtTotSaleSched5', 12,2);" +
         //       "setInputTextControl_NumberFormatter('txtAmountInputnotDirectSched5', 12,2);" +
         //       "setInputTextControl_NumberFormatter('txtProductnotDirectSched5', 12,2);" +
         //       "setInputTextControl_NumberFormatter('txtSumTotalSaleSched5', 12,2);" +
         //       "setInputTextControl_NumberFormatter('txtTotal20CSched5', 12,2);", 100);

        }

        if(viewUploadFlag) {
            setTimeout("d.getElementById('btnClearPop5').disabled = true;", 100);
            setTimeout("d.getElementById('btnCancelPop5').disabled = true;", 100);
            setTimeout("toggleAllDisabled();", 100);
            setTimeout("d.getElementById('btnOkPop5').disabled = false;", 100);
        }
    }

    function checkifEmptyFieldSched5(){
        return true;
    }

    function saveTempSched5Data() {
        inputTaxExmpt = d.getElementById("txtinputtaxSched5").value;
        inputNotAttribSched5 = d.getElementById("txtAmountInputnotDirectSched5").value;
        ratInputTaxSched5 = d.getElementById("txtProductnotDirectSched5").value;
        totalInputExmpt = d.getElementById("txtTotal20CSched5").value;
    }

    function restoreTempSched5Data() {
        d.getElementById("txtinputtaxSched5").value = inputTaxExmpt;
        d.getElementById("txtAmountInputnotDirectSched5").value = inputNotAttribSched5;
        d.getElementById("txtProductnotDirectSched5").value = ratInputTaxSched5;
        d.getElementById("txtTotal20CSched5").value = totalInputExmpt;
    }

    function clearSched5Modal() {
        d.getElementById("txtinputtaxSched5").value = "0.00";
        d.getElementById("txtAmountInputnotDirectSched5").value = "0.00";
        d.getElementById("txtProductnotDirectSched5").value = "0.00";
        d.getElementById("txtTotal20CSched5").value = "0.00";
    }

    function cancelSched5Modal() {
        restoreTempSched5Data();

        //d.getElementById('mainContent').style.display = 'block';
        //d.getElementById('modalSched5').style.display = 'none';
        //d.getElementById('DummyTxt').innerHTML = "Creator";
        //d.getElementById('DummyTxt').innerHTML = "";
		d.getElementById('mainContent').style.display = 'block';
		if ( $('#modalSched5').css('display') != 'none' ) {
			$('#modalSched5').hide('blind');
		}
		$('#DummyTxt').html("Creator");
		$('#DummyTxt').html("");
		
        isModalTurnOn = false;
    }

    function getSched5Modal(){
        if (checkifEmptyFieldSched5() )
        {
            //d.getElementById('mainContent').style.display = 'block';
            //d.getElementById('modalSched5').style.display = 'none';
            //d.getElementById('DummyTxt').innerHTML = "Creator";
            //d.getElementById('DummyTxt').innerHTML = "";
			 d.getElementById('mainContent').style.display = 'block';
			 if ( $('#modalSched5').css('display') != 'none' ) {
				$('#modalSched5').hide('blind');
			 }
			 $('#DummyTxt').html("Creator");
			 $('#DummyTxt').html("");	
			
            d.getElementById('frm2550q:txtTax23C').value  = d.getElementById('txtTotal20CSched5').value;
            compute23F();
        }
    }

    function checkifEmptyFieldSched6() {

        var size = sched6ToCommit.length;
        for(var i = 0 ; i < size ; i++)
        {
            if(d.getElementById('txtPeriodCovered'+ i).value == "" || d.getElementById('txtNameAgent'+ i).value == "") {
                alert("Please enter valid row " + (i + 1) + " data for Schedule 6.\n" +
                    "Empty fields are not allowed."); return ;
            } strmmddyyy = d.getElementById('txtPeriodCovered'+i).value;
            
			
			//--Benjie Manalaysay 11/06/2013
			if(strmmddyyy != ""){
				var result = strmmddyyy.split("/")
				if(result.length == 3 ){
					//Variables
					var month = result[0];
					var day = result[1];
					var year = result[2];
					
					var isLeap = new Date(year, 1, 29).getMonth() == 1;
						
					if(isNaN(month) || isNaN(day) || isNaN(year)){
						alert("Please enter a valid date for Date of Purchase on row "+(i+1)+".\n" +
						"Please enter a date in the MM/DD/YYYY format.");
					return;
					}else{ // Validate of valid Day for the month
						//Check if valid date
						var month31 = (['01', '03', '05', '07', '08', '10', '12']);
						var month30 = (['04', '06', '09', '11']);
						if (month == 2) {
						    //Special Handling for Leap Year
						    if (!isLeap && day == 29) {
						        alert("Invalid entry on row " + (i + 1) + ". Date of Purchase must be within the Return Period only.");
						        return;
						    }
						    if (!isLeap && day > 29) {
						        alert("Invalid entry on row " + (i + 1) + ". Date of Purchase must be within the Return Period only.");
						        return;
						    }
						    if (isLeap && day > 29) {
						        alert("Invalid entry on row " + (i + 1) + ". Date of Purchase must be within the Return Period only.");
						        return;
						    }

						}
						if (month31.contains(month) && day > 31)
						{
							alert("Invalid entry on row " + (i +1) + ". Date of Purchase must be within the Return Period only.");
							return;
						}
						else if (month30.contains(month) && day > 30)
						{
							alert("Invalid entry on row " + (i +1) + ". Date of Purchase must be within the Return Period only.");
							return;
						} 
						else {
						    //Validation if year is within the period
						    //Initialize value
						    var strmmddyyyFrom = d.getElementById('frm2550q:RtnPeriodFrom').value;
						    var strmmddyyyTo = d.getElementById('frm2550q:RtnPeriodTo').value;
						    //var resultFrom = strmmddyyyFrom.split("/");
						    //var resultTo = strmmddyyyTo.split("/");

						    var purchaseDate = new Date(strmmddyyy);

						    if (purchaseDate < new Date(strmmddyyyFrom) || purchaseDate > new Date(strmmddyyyTo)) {
						        alert("Invalid entry on row " + (i + 1) + ". Date of Purchase must be within the Return Period only."); return;
						    }

						}
					}
				}else{
				alert("Please enter a valid date for Date of Purchase on row "+(i+1)+".\n" +
				"Please enter a date in the MM/DD/YYYY format.");
				return;
				}
			}



            // check if the string is within the return period
            //  if(result[0] != d.getElementById('frm2550q:RtnMonth').value) {
            //      alert("Invalid entry on row " + (i +1) + ". Date of Purchase must be within the Return Period only."); return;
            //  }
            if( d.getElementById('txtIncomePayment'+ i).value <= 0 ) {
                alert("Please enter a valid amount for Income Payment on row " + ( i + 1) + ".\n" +
                    "Value must be greater than 0."); return;
            }
            if( d.getElementById('txtTotalWithheld'+ i).value <= 0 ) {
                alert("Please enter a valid amount for Total Tax Withheld on row " + ( i + 1) + ".\n" +
                    "Value must be greater than 0."); return;
            }
            if( d.getElementById('txtAppliedCurr'+ i).value <= 0 ) {
                alert("Please enter a valid amount for Applied Current Month on row " + ( i + 1) + ".\n" +
                    "Value must be greater than 0."); return;
            }
            if( NumWithComma(d.getElementById('txtAppliedCurr'+ i).value) > NumWithComma(d.getElementById('txtTotalWithheld'+ i).value)   ) {
                alert("The Applied Current Month on row " + ( i + 1) + " should not be greater than the Total Tax Withheld." ); return;
            }
        }

        return true;
    }

    function addlistSched6Reload()
    {
            var size = sched6ToCommit.length;
            for(var i = 0 ; i < size ; i++)
            {
                sched6ToCommit[i].txtPeriodCovered = d.getElementById('txtPeriodCovered'+i).value;
                sched6ToCommit[i].txtNameAgent = d.getElementById('txtNameAgent'+i).value;
                sched6ToCommit[i].txtIncomePayment = d.getElementById('txtIncomePayment'+i).value;
                sched6ToCommit[i].txtTotalWithheld = d.getElementById('txtTotalWithheld'+i).value;
                sched6ToCommit[i].txtPrevious2Mo = d.getElementById('txtPrevious2Mo'+i).value;
                sched6ToCommit[i].txtAppliedCurrMo = d.getElementById('txtAppliedCurr'+i).value;
            }
            i = sched6ToCommit.length;
            sched6ToCommit[i] = new Schedule6and8();

            //d.getElementById("tbodyllistSched6").innerHTML = "";
			$('#tbodyllistSched6').html("");
			
            for(i = 0; i < sched6ToCommit.length; i++) {

                //d.getElementById("tbodyllistSched6").innerHTML += "<tr>" +
				$('#tbodyllistSched6').html(  d.getElementById('tbodyllistSched6').innerHTML + "<tr>" +
                    "<td> <input type='checkbox' id='chxSched6"+i+"' /> </td>" +
                    "<td> <input type='text'  id='txtPeriodCovered"+i+"' style='width: 150px' value='"+ sched6ToCommit[i].txtPeriodCovered  +"' maxlength='10' onkeypress='return dateOnly(this, event)'  > </td>" +
                    "<td> <input type='text'  id='txtNameAgent"+i+"' style='width: 190px' value='"+ sched6ToCommit[i].txtNameAgent +"'  maxlength='50' > </td> " +
                    "<td><input type='text' id='txtIncomePayment"+i+"' style='width: 150px' value='"+ sched6ToCommit[i].txtIncomePayment +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2)' maxlength='17' /> </td> " +
                    "<td><input type='text' id='txtTotalWithheld"+i+"' style='width: 150px'  value='"+ sched6ToCommit[i].txtTotalWithheld +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2)' maxlength='17' /> </td>" +
                    "<td><input type='text' id='txtPrevious2Mo"+i+"' style='width: 150px'  value='"+ sched6ToCommit[i].txtPrevious2Mo +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2);computeSumWithheldApp()' maxlength='17' /> </td>" +
                    "<td><input type='text' id='txtAppliedCurr"+i+"' style='width: 150px'  value='"+ sched6ToCommit[i].txtAppliedCurrMo +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2);computeSumWithheldApp()' maxlength='17' /> </td>");



                setTimeout("setInputTextControl_HorizontalAlignment('txtIncomePayment"+i+"',4 );" +
                    "setInputTextControl_HorizontalAlignment('txtTotalWithheld"+i+"',4 ); " +
                    "setInputTextControl_HorizontalAlignment('txtPrevious2Mo"+i+"',4 ); " +
                    "setInputTextControl_HorizontalAlignment('txtAppliedCurr"+i+"',4 );",100);

              //  setTimeout("setInputTextControl_NumberFormatter('txtIncomePayment"+i+"',12,2 );" +
              //      "setInputTextControl_NumberFormatter('txtTotalWithheld"+i+"',12,2 ); " +
              //      "setInputTextControl_NumberFormatter('txtPrevious2Mo"+i+"',12,2 ); " +
              //      "setInputTextControl_NumberFormatter('txtAppliedCurr"+i+"',12,2 );",100);
            }
    }	
	
    function addlistSched6()
    {
        if(checkifEmptyFieldSched6()) {
            var size = sched6ToCommit.length;
            for(var i = 0 ; i < size ; i++)
            {
                sched6ToCommit[i].txtPeriodCovered = d.getElementById('txtPeriodCovered'+i).value;
                sched6ToCommit[i].txtNameAgent = d.getElementById('txtNameAgent'+i).value;
                sched6ToCommit[i].txtIncomePayment = d.getElementById('txtIncomePayment'+i).value;
                sched6ToCommit[i].txtTotalWithheld = d.getElementById('txtTotalWithheld'+i).value;
                sched6ToCommit[i].txtPrevious2Mo = d.getElementById('txtPrevious2Mo'+i).value;
                sched6ToCommit[i].txtAppliedCurrMo = d.getElementById('txtAppliedCurr'+i).value;
            }
            i = sched6ToCommit.length;
            sched6ToCommit[i] = new Schedule6and8();

            //d.getElementById("tbodyllistSched6").innerHTML = "";
			$('#tbodyllistSched6').html("");
			
            for(i = 0; i < sched6ToCommit.length; i++) {

                //d.getElementById("tbodyllistSched6").innerHTML += "<tr>" +
				$('#tbodyllistSched6').html(  d.getElementById('tbodyllistSched6').innerHTML + "<tr>" +
                    "<td> <input type='checkbox' id='chxSched6"+i+"' /> </td>" +
                    "<td> <input type='text'  id='txtPeriodCovered"+i+"' style='width: 150px' value='"+ sched6ToCommit[i].txtPeriodCovered  +"' maxlength='10' onkeypress='return dateOnly(this, event)'  > </td>" +
                    "<td> <input type='text'  id='txtNameAgent"+i+"' style='width: 190px' value='"+ sched6ToCommit[i].txtNameAgent +"'  maxlength='50' > </td> " +
                    "<td><input type='text' id='txtIncomePayment"+i+"' style='width: 150px' value='"+ sched6ToCommit[i].txtIncomePayment +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2)' maxlength='17' /> </td> " +
                    "<td><input type='text' id='txtTotalWithheld"+i+"' style='width: 150px'  value='"+ sched6ToCommit[i].txtTotalWithheld +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2)' maxlength='17' /> </td>" +
                    "<td><input type='text' id='txtPrevious2Mo"+i+"' style='width: 150px'  value='"+ sched6ToCommit[i].txtPrevious2Mo +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2);computeSumWithheldApp()' maxlength='17' /> </td>" +
                    "<td><input type='text' id='txtAppliedCurr"+i+"' style='width: 150px'  value='"+ sched6ToCommit[i].txtAppliedCurrMo +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2);computeSumWithheldApp()' maxlength='17' /> </td>");



                setTimeout("setInputTextControl_HorizontalAlignment('txtIncomePayment"+i+"',4 );" +
                    "setInputTextControl_HorizontalAlignment('txtTotalWithheld"+i+"',4 ); " +
                    "setInputTextControl_HorizontalAlignment('txtPrevious2Mo"+i+"',4 ); " +
                    "setInputTextControl_HorizontalAlignment('txtAppliedCurr"+i+"',4 );",100);

              //  setTimeout("setInputTextControl_NumberFormatter('txtIncomePayment"+i+"',12,2 );" +
              //      "setInputTextControl_NumberFormatter('txtTotalWithheld"+i+"',12,2 ); " +
              //      "setInputTextControl_NumberFormatter('txtPrevious2Mo"+i+"',12,2 ); " +
              //      "setInputTextControl_NumberFormatter('txtAppliedCurr"+i+"',12,2 );",100);
            }
        }
    }

    function deletelistSched6()
    {
        var sched6Temp = new Array();
        var i = 0;
        var size = sched6ToCommit.length;
        for(i = 0 ; i < size ; i++)
        {
            sched6ToCommit[i].txtPeriodCovered = d.getElementById('txtPeriodCovered'+i).value;
            sched6ToCommit[i].txtNameAgent = d.getElementById('txtNameAgent'+i).value;
            sched6ToCommit[i].txtIncomePayment = d.getElementById('txtIncomePayment'+i).value;
            sched6ToCommit[i].txtTotalWithheld = d.getElementById('txtTotalWithheld'+i).value;
            sched6ToCommit[i].txtPrevious2Mo = d.getElementById('txtPrevious2Mo'+i).value;
            sched6ToCommit[i].txtAppliedCurrMo = d.getElementById('txtAppliedCurr'+i).value;
        }
        i = 0;
        for(var j = 0; j < size ; j++) {
            if(!d.getElementById("chxSched6" + j).checked) {
                sched6Temp[i++] = sched6ToCommit[j];
            }
        }

        if(sched6Temp.length > 0) {
            sched6ToCommit = new Array();
            sched6ToCommit = sched6Temp;
            //d.getElementById("tbodyllistSched6").innerHTML = "";
			$('#tbodyllistSched6').html("");
			
            for(i = 0; i < sched6Temp.length; i++) {
                sched6ToCommit[i] = sched6Temp[i];
                //d.getElementById("tbodyllistSched6").innerHTML += "<tr>" +
				$('#tbodyllistSched6').html(  d.getElementById('tbodyllistSched6').innerHTML + "<tr>" +
                    "<td> <input type='checkbox' id='chxSched6"+i+"' /> </td>" +
                    "<td> <input type='text'  id='txtPeriodCovered"+i+"' style='width: 150px' value='"+ sched6ToCommit[i].txtPeriodCovered  +"' maxlength='10' onkeypress='return dateOnly(this, event)'  > </td>" +
                    "<td> <input type='text'  id='txtNameAgent"+i+"' style='width: 190px' value='"+ sched6ToCommit[i].txtNameAgent +"'  maxlength='50' > </td> " +
                    "<td><input type='text' id='txtIncomePayment"+i+"' style='width: 150px' value='"+ sched6ToCommit[i].txtIncomePayment +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2)' maxlength='17' /> </td> " +
                    "<td><input type='text' id='txtTotalWithheld"+i+"' style='width: 150px'  value='"+ sched6ToCommit[i].txtTotalWithheld +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2)' maxlength='17' /> </td>" +
                    "<td><input type='text' id='txtPrevious2Mo"+i+"' style='width: 150px'  value='"+ sched6ToCommit[i].txtPrevious2Mo +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2);computeSumWithheldApp()' maxlength='17' /> </td>" +
                    "<td><input type='text' id='txtAppliedCurr"+i+"' style='width: 150px'  value='"+ sched6ToCommit[i].txtAppliedCurrMo +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2);computeSumWithheldApp()' maxlength='17' /> </td>");

                setTimeout("setInputTextControl_HorizontalAlignment('txtIncomePayment"+i+"',4 );" +
                    "setInputTextControl_HorizontalAlignment('txtTotalWithheld"+i+"',4 ); " +
                    "setInputTextControl_HorizontalAlignment('txtPrevious2Mo"+i+"',4 ); " +
                    "setInputTextControl_HorizontalAlignment('txtAppliedCurr"+i+"',4 );",100);
            //    setTimeout("setInputTextControl_NumberFormatter('txtIncomePayment"+i+"',12,2 );" +
            //        "setInputTextControl_NumberFormatter('txtTotalWithheld"+i+"',12,2 ); " +
            //        "setInputTextControl_NumberFormatter('txtPrevious2Mo"+i+"',12,2 ); " +
            //        "setInputTextControl_NumberFormatter('txtAppliedCurr"+i+"',12,2 );",100);
            }
        } else {
            sched6ToCommit = new Array();
            //d.getElementById("tbodyllistSched6").innerHTML = "";
			$('#tbodyllistSched6').html("");
        }
        computeSumWithheldApp();
    }

    function showSched6(){
        saveTempSched6Data();
        
		if (prevalidateReturnPeriod()) {
			if(d.getElementById('frm2550q:txtYear').value <= 2000 || d.getElementById('frm2550q:txtYear').value >= 2020 ) {
				alert("Please  enter a valid year for the Return Period. Only values 2000 and beyond will be accepted.") 
			} else {
				//d.getElementById('mainContent').style.display = "inline";
				//d.getElementById('modalSched6').style.display = "block";
				d.getElementById('mainContent').style.display = "none";
				$('#modalSched6').show('blind');	
				
				for(var x = 0; x < d.getElementById("tblSched6").rows.length; x++) {
					setTimeout("setInputTextControl_HorizontalAlignment('txtIncomePayment" + x + "', 4);", 100);
					setTimeout("setInputTextControl_HorizontalAlignment('txtTotalWithheld" + x + "', 4);", 100);
					setTimeout("setInputTextControl_HorizontalAlignment('txtPrevious2Mo" + x + "', 4);", 100);
					setTimeout("setInputTextControl_HorizontalAlignment('txtAppliedCurr" + x + "', 4);", 100);
				 //   setTimeout("setInputTextControl_NumberFormatter('txtIncomePayment" + x + "', 12,2);", 100);
				 //   setTimeout("setInputTextControl_NumberFormatter('txtTotalWithheld" + x + "', 12,2);", 100);
				 //   setTimeout("setInputTextControl_NumberFormatter('txtPrevious2Mo" + x + "', 12,2);", 100);
				 //   setTimeout("setInputTextControl_NumberFormatter('txtAppliedCurr" + x + "', 12,2);", 100);
				}

				setTimeout("d.getElementById('txtmodalTotal23A').disabled = true; setInputTextControl_HorizontalAlignment('txtmodalTotal23A', 4);" +
					"d.getElementById('txtmodalTotalSched6AppliedCurrent').disabled = true; setInputTextControl_HorizontalAlignment('txtmodalTotalSched6AppliedCurrent', 4);" , 100);

			 //   setTimeout("setInputTextControl_NumberFormatter('txtmodalTotal23A', 12,2);" +
			   //     "setInputTextControl_NumberFormatter('txtmodalTotalSched6AppliedCurrent', 12,2);" , 100);
			}

			if(viewUploadFlag) {
				setTimeout("d.getElementById('btnAdd4').disabled = true;", 100);
				setTimeout("d.getElementById('btnDelete4').disabled = true;", 100);
				setTimeout("d.getElementById('btnClearPop6').disabled = true;", 100);
				setTimeout("d.getElementById('btnCancelPop6').disabled = true;", 100);
				setTimeout("toggleAllDisabled();", 100);
				setTimeout("d.getElementById('btnOkPop6').disabled = false;", 100);
			}
		} else { alert("Please enter a valid date for Item 1."); return; }

    }

    function saveTempSched6Data() {
        var x;
        tempRowSizeSched6 = d.getElementById("tblSched6").rows.length - 1;

        for(x = 0; x < tempRowSizeSched6; x++){
            tempTempPeriodCovered[x] = d.getElementById("txtPeriodCovered" + x).value;
            tempAgentNm[x] = d.getElementById("txtNameAgent" + x).value;
            tempIncPaymnt[x] = d.getElementById("txtIncomePayment" + x).value;
            totalTaxWithld[x] = d.getElementById("txtTotalWithheld" + x).value;
            appPrev[x] = d.getElementById("txtPrevious2Mo" + x).value;
            appCurr[x] = d.getElementById("txtAppliedCurr" + x).value;
            sched7TotalPrev[x] = d.getElementById("txtmodalTotal23A").value;
            sched7TotalCurr[x] = d.getElementById("txtmodalTotalSched6AppliedCurrent").value;
        }
    }

    function restoreTempSched6Data() {
        if(tempRowSizeSched6 > 0) {
            sched6ToCommit = new Array();
            //d.getElementById("tbodyllistSched6").innerHTML = "";
			$('#tbodyllistSched6').html("");
			
            var x = 0;

            x = 0;
            var initCount = 0;

            for(x = 0; x < tempRowSizeSched6; x++){
                addlistSched6();

                d.getElementById("txtPeriodCovered" + x).value = tempTempPeriodCovered[x];
                d.getElementById("txtNameAgent" + x).value = tempAgentNm[x];
                d.getElementById("txtIncomePayment" + x).value = tempIncPaymnt[x];
                d.getElementById("txtTotalWithheld" + x).value = totalTaxWithld[x];
                d.getElementById("txtPrevious2Mo" + x).value = appPrev[x];
                d.getElementById("txtAppliedCurr" + x).value = appCurr[x];

                if(initCount == (tempRowSizeSched6 - 1)){
                    d.getElementById("txtmodalTotal23A").value = sched7TotalPrev[x];
                    d.getElementById("txtmodalTotalSched6AppliedCurrent").value = sched7TotalCurr[x];
                }

                initCount++;
                computeSumWithheldApp();
            }
        }
    }

    function clearSched6Modal() {
        var x;
        var rowSizeSched6 = d.getElementById("tblSched6").rows.length - 1;
        
        for(x = 0; x < rowSizeSched6; x++){
            d.getElementById("txtPeriodCovered" + x).value = "";
            d.getElementById("txtNameAgent" + x).value = "";
            d.getElementById("txtIncomePayment" + x).value = "0.00";
            d.getElementById("txtTotalWithheld" + x).value = "0.00";
            d.getElementById("txtPrevious2Mo" + x).value = "0.00";
            d.getElementById("txtAppliedCurr" + x).value = "0.00";
            d.getElementById("txtmodalTotal23A").value = "0.00";
            d.getElementById("txtmodalTotalSched6AppliedCurrent").value = "0.00";
        }
    }

    function cancelSched6Modal() {
        restoreTempSched6Data();

        //d.getElementById('mainContent').style.display = 'block';
        //d.getElementById('modalSched6').style.display = 'none';
        //d.getElementById('DummyTxt').innerHTML = "Creator";
        //d.getElementById('DummyTxt').innerHTML = "";
		d.getElementById('mainContent').style.display = 'block';
		if ( $('#modalSched6').css('display') != 'none' ) {
			$('#modalSched6').hide('blind');
		}
		$('#DummyTxt').html("Creator");
		$('#DummyTxt').html("");
		
        isModalTurnOn = false;
    }

    function getSched6Modal(){
        if (checkifEmptyFieldSched6() )
        {
            //d.getElementById('mainContent').style.display = 'block';
            //d.getElementById('modalSched6').style.display = 'none';
            //d.getElementById('DummyTxt').innerHTML = "Creator";
            //d.getElementById('DummyTxt').innerHTML = "";
			d.getElementById('mainContent').style.display = 'block';
			if ( $('#modalSched6').css('display') != 'none' ) {
				$('#modalSched6').hide('blind');
			}
			$('#DummyTxt').html("Creator");
			$('#DummyTxt').html("");				

			d.getElementById('frm2550q:txtTax26B').value = formatCurrency(NumWithComma(d.getElementById('txtmodalTotalSched6AppliedCurrent').value) + NumWithComma(d.getElementById('txtmodalTotal23A').value));
            compute26H();
        }
    }

    function checkifEmptyFieldSched7() {

        var size = sched7ToCommit.length;
        for(var i = 0 ; i < size ; i++)
        {
            if(d.getElementById('txtPeriodCoveredSch7'+ i).value == "" || d.getElementById('txtNameMillerSch7'+ i).value == "" ||
                d.getElementById('txtNameTaxPayerSch7'+ i).value == "" || d.getElementById('txtORNumSch7'+ i).value == ""  ) {
                alert("Please enter valid row " + (i + 1) + " data for Schedule 7.\n" +
                    "Empty fields are not allowed."); return ;
            } strmmddyyy = d.getElementById('txtPeriodCoveredSch7'+i).value;
 
 
 
 			//--Benjie Manalaysay 11/06/2013
			if(strmmddyyy != ""){
				var result = strmmddyyy.split("/")
				if(result.length == 3 ){
					//Variables
					var month = result[0];
					var day = result[1];
					var year = result[2];
					
					var isLeap = new Date(year, 1, 29).getMonth() == 1;
						
					if(isNaN(month) || isNaN(day) || isNaN(year)){
						alert("Please enter a valid date for Date of Purchase on row "+(i+1)+".\n" +
						"Please enter a date in the MM/DD/YYYY format.");
					return;
					}else{ // Validate of valid Day for the month
						//Check if valid date
						var month31 = (['01', '03', '05', '07', '08', '10', '12']);
						var month30 = (['04', '06', '09', '11']);
						if (month == 2) {
						    //Special Handling for Leap Year
						    if (!isLeap && day == 29) {
						        alert("Invalid entry on row " + (i + 1) + ". Date of Purchase must be within the Return Period only.");
						        return;
						    }
						    if (!isLeap && day > 29) {
						        alert("Invalid entry on row " + (i + 1) + ". Date of Purchase must be within the Return Period only.");
						        return;
						    }
						    if (isLeap && day > 29) {
						        alert("Invalid entry on row " + (i + 1) + ". Date of Purchase must be within the Return Period only.");
						        return;
						    }

						}
						if (month31.contains(month) && day > 31)
						{
							alert("Invalid entry on row " + (i +1) + ". Date of Purchase must be within the Return Period only.");
							return;
						}
						else if (month30.contains(month) && day > 30)
						{
							alert("Invalid entry on row " + (i +1) + ". Date of Purchase must be within the Return Period only.");
							return;
						} 
						else {
						    //Validation if year is within the period
						    //Initialize value
						    var strmmddyyyFrom = d.getElementById('frm2550q:RtnPeriodFrom').value;
						    var strmmddyyyTo = d.getElementById('frm2550q:RtnPeriodTo').value;
						    //var resultFrom = strmmddyyyFrom.split("/");
						    //var resultTo = strmmddyyyTo.split("/");

						    var purchaseDate = new Date(strmmddyyy);

						    if (purchaseDate < new Date(strmmddyyyFrom) || purchaseDate > new Date(strmmddyyyTo)) {
						        alert("Invalid entry on row " + (i + 1) + ". Date of Purchase must be within the Return Period only."); return;
						    }

						}
					}
				}else{
				alert("Please enter a valid date for Date of Purchase on row "+(i+1)+".\n" +
				"Please enter a date in the MM/DD/YYYY format.");
				return;
				}
			}

			
            // check if the string is within the return period
            //  if(result[0] != d.getElementById('frm2550q:RtnMonth').value) {
            //      alert("Invalid entry on row " + (i +1) + ". Date of Purchase must be within the Return Period only."); return;
            //  }
            if( d.getElementById('txtAmountPaidSch7'+ i).value <= 0 ) {
                alert("Please enter a valid amount for Amount Paid on row " + ( i + 1) + ".\n" +
                    "Value must be greater than 0."); return;
            }
            if( d.getElementById('txtAppliedCurrSch7'+ i).value <= 0 ) {
                alert("Please enter a valid amount for Applied Current Month on row " + ( i + 1) + ".\n" +
                    "Value must be greater than 0."); return;
            }
            if( NumWithComma(d.getElementById('txtAppliedCurrSch7'+ i).value) > NumWithComma(d.getElementById('txtAmountPaidSch7'+ i).value)   ) {
                alert("The Applied Current Month on row " + ( i + 1) + " should not be greater than the Total Tax Withheld." ); return;
            }
        }

        return true;
    }

    function addlistSched7Reload()
    {
            var size = sched7ToCommit.length;
            for(var i = 0 ; i < size ; i++)
            {
                sched7ToCommit[i].txtPeriodCovered = d.getElementById('txtPeriodCoveredSch7'+i).value;
                sched7ToCommit[i].txtNameMiller = d.getElementById('txtNameMillerSch7'+i).value;
                sched7ToCommit[i].txtNameTaxPayer = d.getElementById('txtNameTaxPayerSch7'+i).value;
                sched7ToCommit[i].txtORNumber = d.getElementById('txtORNumSch7'+i).value;
                sched7ToCommit[i].txtAmountPaid = d.getElementById('txtAmountPaidSch7'+i).value;
                sched7ToCommit[i].txtPrevious2Mo = d.getElementById('txtPrevious2MoSch7'+i).value;
                sched7ToCommit[i].txtAppliedCurrMo = d.getElementById('txtAppliedCurrSch7'+i).value;
            }
            i = sched7ToCommit.length;
            sched7ToCommit[i] = new Schedule7();

            //d.getElementById("tbodyllistSched7").innerHTML = "";
			$('#tbodyllistSched7').html("");
			
            for(i = 0; i < sched7ToCommit.length; i++) {

                //d.getElementById("tbodyllistSched7").innerHTML += "<tr>" +
				$('#tbodyllistSched7').html(  d.getElementById('tbodyllistSched7').innerHTML + "<tr>" +
                    "<td> <input type='checkbox' id='chxSched7"+i+"' /> </td>" +
                    "<td> <input type='text'  id='txtPeriodCoveredSch7"+i+"' style='width: 150px' value='"+ sched7ToCommit[i].txtPeriodCovered  +"' maxlength='10' onkeypress='return dateOnly(this, event)'  > </td>" +
                    "<td> <input type='text'  id='txtNameMillerSch7"+i+"' style='width: 190px' value='"+ sched7ToCommit[i].txtNameMiller +"'  maxlength='50' > </td> " +
                    "<td><input type='text' id='txtNameTaxPayerSch7"+i+"' style='width: 150px' value='"+ sched7ToCommit[i].txtNameTaxPayer +"'   maxlength='17' /> </td> " +
                    "<td><input type='text' id='txtORNumSch7"+i+"' style='width: 150px'  value='"+ sched7ToCommit[i].txtORNumber +"'  maxlength='20' /> </td>" +
                    "<td><input type='text' id='txtAmountPaidSch7"+i+"' style='width: 150px'  value='"+ sched7ToCommit[i].txtAmountPaid +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2)' maxlength='17' /> </td>" +
                    "<td><input type='text' id='txtPrevious2MoSch7"+i+"' style='width: 150px'  value='"+ sched7ToCommit[i].txtPrevious2Mo +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2);computeSumWithheldAppSch7()' maxlength='17' /> </td>" +
                    "<td><input type='text' id='txtAppliedCurrSch7"+i+"' style='width: 150px'  value='"+ sched7ToCommit[i].txtAppliedCurrMo  +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2);computeSumWithheldAppSch7()' maxlength='17' /> </td>");



                setTimeout("setInputTextControl_HorizontalAlignment('txtAmountPaidSch7"+i+"',4 ); " +
                    "setInputTextControl_HorizontalAlignment('txtPrevious2MoSch7"+i+"',4 ); " +
                    "setInputTextControl_HorizontalAlignment('txtAppliedCurrSch7"+i+"',4 );",100);

           //     setTimeout("setInputTextControl_NumberFormatter('txtAmountPaidSch7"+i+"',12,2 ); " +
           //         "setInputTextControl_NumberFormatter('txtPrevious2MoSch7"+i+"',12,2 ); " +
            //        "setInputTextControl_NumberFormatter('txtAppliedCurrSch7"+i+"',12,2 );",100);
            }
    }	
	
    function addlistSched7()
    {
        if(checkifEmptyFieldSched7()) {
            var size = sched7ToCommit.length;
            for(var i = 0 ; i < size ; i++)
            {
                sched7ToCommit[i].txtPeriodCovered = d.getElementById('txtPeriodCoveredSch7'+i).value;
                sched7ToCommit[i].txtNameMiller = d.getElementById('txtNameMillerSch7'+i).value;
                sched7ToCommit[i].txtNameTaxPayer = d.getElementById('txtNameTaxPayerSch7'+i).value;
                sched7ToCommit[i].txtORNumber = d.getElementById('txtORNumSch7'+i).value;
                sched7ToCommit[i].txtAmountPaid = d.getElementById('txtAmountPaidSch7'+i).value;
                sched7ToCommit[i].txtPrevious2Mo = d.getElementById('txtPrevious2MoSch7'+i).value;
                sched7ToCommit[i].txtAppliedCurrMo = d.getElementById('txtAppliedCurrSch7'+i).value;
            }
            i = sched7ToCommit.length;
            sched7ToCommit[i] = new Schedule7();

            //d.getElementById("tbodyllistSched7").innerHTML = "";
			$('#tbodyllistSched7').html("");
			
            for(i = 0; i < sched7ToCommit.length; i++) {

                //d.getElementById("tbodyllistSched7").innerHTML += "<tr>" +
				$('#tbodyllistSched7').html(  d.getElementById('tbodyllistSched7').innerHTML + "<tr>" +
                    "<td> <input type='checkbox' id='chxSched7"+i+"' /> </td>" +
                    "<td> <input type='text'  id='txtPeriodCoveredSch7"+i+"' style='width: 150px' value='"+ sched7ToCommit[i].txtPeriodCovered  +"' maxlength='10'  onkeypress='return dateOnly(this, event)' > </td>" +
                    "<td> <input type='text'  id='txtNameMillerSch7"+i+"' style='width: 190px' value='"+ sched7ToCommit[i].txtNameMiller +"'  maxlength='50' > </td> " +
                    "<td><input type='text' id='txtNameTaxPayerSch7"+i+"' style='width: 150px' value='"+ sched7ToCommit[i].txtNameTaxPayer +"'   maxlength='17' /> </td> " +
                    "<td><input type='text' id='txtORNumSch7"+i+"' style='width: 150px'  value='"+ sched7ToCommit[i].txtORNumber +"'  maxlength='20' /> </td>" +
                    "<td><input type='text' id='txtAmountPaidSch7"+i+"' style='width: 150px'  value='"+ sched7ToCommit[i].txtAmountPaid +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2)' maxlength='17' /> </td>" +
                    "<td><input type='text' id='txtPrevious2MoSch7"+i+"' style='width: 150px'  value='"+ sched7ToCommit[i].txtPrevious2Mo +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2);computeSumWithheldAppSch7()' maxlength='17' /> </td>" +
                    "<td><input type='text' id='txtAppliedCurrSch7"+i+"' style='width: 150px'  value='"+ sched7ToCommit[i].txtAppliedCurrMo  +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2);computeSumWithheldAppSch7()' maxlength='17' /> </td>");



                setTimeout("setInputTextControl_HorizontalAlignment('txtAmountPaidSch7"+i+"',4 ); " +
                    "setInputTextControl_HorizontalAlignment('txtPrevious2MoSch7"+i+"',4 ); " +
                    "setInputTextControl_HorizontalAlignment('txtAppliedCurrSch7"+i+"',4 );",100);

           //     setTimeout("setInputTextControl_NumberFormatter('txtAmountPaidSch7"+i+"',12,2 ); " +
           //         "setInputTextControl_NumberFormatter('txtPrevious2MoSch7"+i+"',12,2 ); " +
           //         "setInputTextControl_NumberFormatter('txtAppliedCurrSch7"+i+"',12,2 );",100);
            }
        }
    }

    function deletelistSched7()
    {
        var sched7Temp = new Array();
        var i = 0;
        var size = sched7ToCommit.length;
        for(i = 0 ; i < size ; i++)
        {
            sched7ToCommit[i].txtPeriodCovered = d.getElementById('txtPeriodCoveredSch7'+i).value;
            sched7ToCommit[i].txtNameMiller = d.getElementById('txtNameMillerSch7'+i).value;
            sched7ToCommit[i].txtNameTaxPayer = d.getElementById('txtNameTaxPayerSch7'+i).value;
            sched7ToCommit[i].txtORNumber = d.getElementById('txtORNumSch7'+i).value;
            sched7ToCommit[i].txtAmountPaid = d.getElementById('txtAmountPaidSch7'+i).value;
            sched7ToCommit[i].txtPrevious2Mo = d.getElementById('txtPrevious2MoSch7'+i).value;
            sched7ToCommit[i].txtAppliedCurrMo = d.getElementById('txtAppliedCurrSch7'+i).value;
        }
        i = 0;
        for(var j = 0; j < size ; j++) {
            if(!d.getElementById("chxSched7" + j).checked) {
                sched7Temp[i++] = sched7ToCommit[j];
            }
        }

        if(sched7Temp.length > 0) {
            sched7ToCommit = new Array();
            sched7ToCommit = sched7Temp;
            //d.getElementById("tbodyllistSched7").innerHTML = "";
			$('#tbodyllistSched7').html("");
			
            for(i = 0; i < sched7Temp.length; i++) {
                sched7ToCommit[i] = sched7Temp[i];
                //d.getElementById("tbodyllistSched7").innerHTML += "<tr>" +
				$('#tbodyllistSched7').html(  d.getElementById('tbodyllistSched7').innerHTML + 
                    "<td> <input type='checkbox' id='chxSched7"+i+"' /> </td>" +
                    "<td> <input type='text'  id='txtPeriodCoveredSch7"+i+"' style='width: 150px' value='"+ sched7ToCommit[i].txtPeriodCovered  +"' maxlength='10'  onkeypress='return dateOnly(this, event)' > </td>" +
                    "<td> <input type='text'  id='txtNameMillerSch7"+i+"' style='width: 190px' value='"+ sched7ToCommit[i].txtNameMiller +"'  maxlength='50' > </td> " +
                    "<td><input type='text' id='txtNameTaxPayerSch7"+i+"' style='width: 150px' value='"+ sched7ToCommit[i].txtNameTaxPayer +"'   maxlength='17' /> </td> " +
                    "<td><input type='text' id='txtORNumSch7"+i+"' style='width: 150px'  value='"+ sched7ToCommit[i].txtORNumber +"'  maxlength='20' /> </td>" +
                    "<td><input type='text' id='txtAmountPaidSch7"+i+"' style='width: 150px'  value='"+ sched7ToCommit[i].txtAmountPaid +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2)' maxlength='17' /> </td>" +
                    "<td><input type='text' id='txtPrevious2MoSch7"+i+"' style='width: 150px'  value='"+ sched7ToCommit[i].txtPrevious2Mo +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2);computeSumWithheldAppSch7()' maxlength='17' /> </td>" +
                    "<td><input type='text' id='txtAppliedCurrSch7"+i+"' style='width: 150px'  value='"+ sched7ToCommit[i].txtAppliedCurrMo  +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2);computeSumWithheldAppSch7()' maxlength='17' /> </td>");



                setTimeout("setInputTextControl_HorizontalAlignment('txtAmountPaidSch7"+i+"',4 ); " +
                    "setInputTextControl_HorizontalAlignment('txtPrevious2MoSch7"+i+"',4 ); " +
                    "setInputTextControl_HorizontalAlignment('txtAppliedCurrSch7"+i+"',4 );",100);
             //   setTimeout("setInputTextControl_NumberFormatter('txtAmountPaidSch7"+i+"',12,2 ); " +
             //       "setInputTextControl_NumberFormatter('txtPrevious2MoSch7"+i+"',12,2 ); " +
             //       "setInputTextControl_NumberFormatter('txtAppliedCurrSch7"+i+"',12,2 );",100);
            }
        } else {
            sched7ToCommit = new Array();
            //d.getElementById("tbodyllistSched7").innerHTML = "";
			$('#tbodyllistSched7').html("");
        }
        computeSumWithheldAppSch7();
    }

    function showSched7(){
        saveTempSched7Data();

        if(d.getElementById('frm2550q:txtYear').value <= 2000 && d.getElementById('frm2550q:txtYear').value <= 2020 ) {
            alert("Please  enter a valid year for the Return Period. Only values 2000 and beyond will be accepted."); return;
        } else {
            //d.getElementById('mainContent').style.display = "inline";
            //d.getElementById('modalSched7').style.display = "block";
			d.getElementById('mainContent').style.display = "none";
			$('#modalSched7').show('blind');				

            for(var x = 0; x < d.getElementById("tblSched7").rows.length; x++) {
                setTimeout("setInputTextControl_HorizontalAlignment('txtAmountPaidSch7" + x + "', 4);", 100);
                setTimeout("setInputTextControl_HorizontalAlignment('txtPrevious2MoSch7" + x + "', 4);", 100);
                setTimeout("setInputTextControl_HorizontalAlignment('txtAppliedCurrSch7" + x + "', 4);", 100);

          //      setTimeout("setInputTextControl_NumberFormatter('txtAmountPaidSch7" + x + "', 12,2);", 100);
          //      setTimeout("setInputTextControl_NumberFormatter('txtPrevious2MoSch7" + x + "', 12,2);", 100);
          //      setTimeout("setInputTextControl_NumberFormatter('txtAppliedCurrSch7" + x + "', 12,2);", 100);
            }

            setTimeout("d.getElementById('txtmodalTotal23B').disabled = true; setInputTextControl_HorizontalAlignment('txtmodalTotal23B', 4);" +
                "d.getElementById('txtmodalTotalSched7AppliedCurrent').disabled = true; setInputTextControl_HorizontalAlignment('txtmodalTotalSched7AppliedCurrent', 4);" , 100);

         //   setTimeout("setInputTextControl_NumberFormatter('txtmodalTotal23B', 12,2);" +
         //       "setInputTextControl_NumberFormatter('txtmodalTotalSched7AppliedCurrent', 12,2);" , 100);
        }

        if(viewUploadFlag) {
            setTimeout("d.getElementById('btnAdd5').disabled = true;", 100);
            setTimeout("d.getElementById('btnDelete5').disabled = true;", 100);
            setTimeout("d.getElementById('btnClearPop7').disabled = true;", 100);
            setTimeout("d.getElementById('btnCancelPop7').disabled = true;", 100);
            setTimeout("toggleAllDisabled();", 100);
            setTimeout("d.getElementById('btnOkPop7').disabled = false;", 100);
        }
    }

    function saveTempSched7Data() {
        var x;
        tempRowSizeSched7 = d.getElementById("tblSched7").rows.length - 1;

        for(x = 0; x < tempRowSizeSched7; x++){
            tempTempPeriodCovered7[x] = d.getElementById("txtPeriodCoveredSch7" + x).value;
            tempMillerNm7[x] = d.getElementById("txtNameMillerSch7" + x).value;
            tempAgentNm7[x] = d.getElementById("txtNameTaxPayerSch7" + x).value;
            tempOrNumber7[x] = d.getElementById("txtORNumSch7" + x).value;
            tempAmtPaid7[x] = d.getElementById("txtAmountPaidSch7" + x).value;
            tempAppPrev7[x] = d.getElementById("txtPrevious2MoSch7" + x).value;
            tempAppCurr7[x] = d.getElementById("txtAppliedCurrSch7" + x).value;
            tempSched8TotalPrev7[x] = d.getElementById("txtmodalTotal23B").value;
            tempSched8TotalCurr7[x] = d.getElementById("txtmodalTotalSched7AppliedCurrent").value;
        }
    }

    function restoreTempSched7Data() {
        if(tempRowSizeSched7 > 0) {
            sched7ToCommit = new Array();
            //d.getElementById("tbodyllistSched7").innerHTML = "";
			$('#tbodyllistSched7').html("");
            var x = 0;

            x = 0;
            var initCount = 0;

            for(x = 0; x < tempRowSizeSched7; x++){
                addlistSched7();

                d.getElementById("txtPeriodCoveredSch7" + x).value = tempTempPeriodCovered7[x];
                d.getElementById("txtNameMillerSch7" + x).value = tempMillerNm7[x];
                d.getElementById("txtNameTaxPayerSch7" + x).value = tempAgentNm7[x];
                d.getElementById("txtORNumSch7" + x).value = tempOrNumber7[x];
                d.getElementById("txtAmountPaidSch7" + x).value = tempAmtPaid7[x];
                d.getElementById("txtPrevious2MoSch7" + x).value = tempAppPrev7[x];
                d.getElementById("txtAppliedCurrSch7" + x).value = tempAppCurr7[x];

                if(initCount == (tempRowSizeSched7 - 1)){
                    d.getElementById("txtmodalTotal23B").value = tempSched8TotalPrev7[x];
                    d.getElementById("txtmodalTotalSched7AppliedCurrent").value = tempSched8TotalCurr7[x];
                }

                initCount++;
                computeSumWithheldAppSch7();
            }
        }
    }

    function clearSched7Modal() {
        var x;
        var rowSizeSched7 = d.getElementById("tblSched7").rows.length - 1;

        for(x = 0; x < rowSizeSched7; x++){
            d.getElementById("txtPeriodCoveredSch7" + x).value = "";
            d.getElementById("txtNameMillerSch7" + x).value = "";
            d.getElementById("txtNameTaxPayerSch7" + x).value = "";
            d.getElementById("txtORNumSch7" + x).value = "";
            d.getElementById("txtAmountPaidSch7" + x).value = "0.00";
            d.getElementById("txtPrevious2MoSch7" + x).value = "0.00";
            d.getElementById("txtAppliedCurrSch7" + x).value = "0.00";
            d.getElementById("txtmodalTotal23B").value = "0.00";
            d.getElementById("txtmodalTotalSched7AppliedCurrent").value = "0.00";
        }
    }

    function cancelSched7Modal() {
        restoreTempSched7Data();

        //d.getElementById('mainContent').style.display = 'block';
        //d.getElementById('modalSched7').style.display = 'none';
        //d.getElementById('DummyTxt').innerHTML = "Creator";
        //d.getElementById('DummyTxt').innerHTML = "";
		d.getElementById('mainContent').style.display = 'block';
		if ( $('#modalSched7').css('display') != 'none' ) {
			$('#modalSched7').hide('blind');
		}
		$('#DummyTxt').html("Creator");
		$('#DummyTxt').html("");
		
        isModalTurnOn = false;
    }

    function getSched7Modal(){
        if (checkifEmptyFieldSched7() )
        {
            //d.getElementById('mainContent').style.display = 'block';
            //d.getElementById('modalSched7').style.display = 'none';
            //d.getElementById('DummyTxt').innerHTML = "Creator";
            //d.getElementById('DummyTxt').innerHTML = "";
			d.getElementById('mainContent').style.display = 'block';
			if ( $('#modalSched7').css('display') != 'none' ) {
				$('#modalSched7').hide('blind');
			}
			$('#DummyTxt').html("Creator");
			$('#DummyTxt').html("");
			
			d.getElementById('frm2550q:txtTax26C').value = formatCurrency(NumWithComma(d.getElementById('txtmodalTotalSched7AppliedCurrent').value) + NumWithComma(d.getElementById('txtmodalTotal23B').value));
            compute26H();
        }
    }

    function checkifEmptyFieldSched8() {

        var size = sched8ToCommit.length;
        for(var i = 0 ; i < size ; i++)
        {
            if(d.getElementById('txtPeriodCoveredSch8'+ i).value == "" || d.getElementById('txtNameAgentSch8'+ i).value == "") {
                alert("Please enter valid row " + (i + 1) + " data for Schedule 8.\n" +
                    "Empty fields are not allowed."); return ;
            } strmmddyyy = d.getElementById('txtPeriodCoveredSch8'+i).value;

			//--Benjie Manalaysay 11/06/2013
			if(strmmddyyy != ""){
				var result = strmmddyyy.split("/")
				if(result.length == 3 ){
					//Variables
					var month = result[0];
					var day = result[1];
					var year = result[2];
					
					var isLeap = new Date(year, 1, 29).getMonth() == 1;
						
					if(isNaN(month) || isNaN(day) || isNaN(year)){
						alert("Please enter a valid date for Date of Purchase on row "+(i+1)+".\n" +
						"Please enter a date in the MM/DD/YYYY format.");
					return;
					}else{ // Validate of valid Day for the month
						//Check if valid date
						var month31 = (['01', '03', '05', '07', '08', '10', '12']);
						var month30 = (['04', '06', '09', '11']);
						if (month == 2) {
						    //Special Handling for Leap Year
						    if (!isLeap && day == 29) {
						        alert("Invalid entry on row " + (i + 1) + ". Date of Purchase must be within the Return Period only.");
						        return;
						    }
						    if (!isLeap && day > 29) {
						        alert("Invalid entry on row " + (i + 1) + ". Date of Purchase must be within the Return Period only.");
						        return;
						    }
						    if (isLeap && day > 29) {
						        alert("Invalid entry on row " + (i + 1) + ". Date of Purchase must be within the Return Period only.");
						        return;
						    }

						}
						if (month31.contains(month) && day > 31)
						{
							alert("Invalid entry on row " + (i +1) + ". Date of Purchase must be within the Return Period only.");
							return;
						}
						else if (month30.contains(month) && day > 30)
						{
							alert("Invalid entry on row " + (i +1) + ". Date of Purchase must be within the Return Period only.");
							return;
						} 
						else {
						    //Validation if year is within the period
						    //Initialize value
						    var strmmddyyyFrom = d.getElementById('frm2550q:RtnPeriodFrom').value;
						    var strmmddyyyTo = d.getElementById('frm2550q:RtnPeriodTo').value;
						    //var resultFrom = strmmddyyyFrom.split("/");
						    //var resultTo = strmmddyyyTo.split("/");

						    var purchaseDate = new Date(strmmddyyy);

						    if (purchaseDate < new Date(strmmddyyyFrom) || purchaseDate > new Date(strmmddyyyTo)) {
						        alert("Invalid entry on row " + (i + 1) + ". Date of Purchase must be within the Return Period only."); return;
						    }

						}
					}
				}else{
				alert("Please enter a valid date for Date of Purchase on row "+(i+1)+".\n" +
				"Please enter a date in the MM/DD/YYYY format.");
				return;
				}
			}

            // check if the string is within the return period
            //  if(result[0] != d.getElementById('frm2550q:RtnMonth').value) {
            //      alert("Invalid entry on row " + (i +1) + ". Date of Purchase must be within the Return Period only."); return;
            //  }
            if( d.getElementById('txtIncomePaymentSch8'+ i).value <= 0 ) {
                alert("Please enter a valid amount for Income Payment on row " + ( i + 1) + ".\n" +
                    "Value must be greater than 0."); return;
            }
            if( d.getElementById('txtTotalWithheldSch8'+ i).value <= 0 ) {
                alert("Please enter a valid amount for Total Tax Withheld on row " + ( i + 1) + ".\n" +
                    "Value must be greater than 0."); return;
            }
            if( d.getElementById('txtAppliedCurrSch8'+ i).value <= 0 ) {
                alert("Please enter a valid amount for Applied Current Month on row " + ( i + 1) + ".\n" +
                    "Value must be greater than 0."); return;
            }
            if( NumWithComma(d.getElementById('txtAppliedCurrSch8'+ i).value) > NumWithComma(d.getElementById('txtTotalWithheldSch8'+ i).value)   ) {
                alert("The Applied Current Month on row " + ( i + 1) + " should not be greater than the Total Tax Withheld." ); return;
            }
        }

        return true;
    }

    function addlistSched8Reload()
    {
            var size = sched8ToCommit.length;
            for(var i = 0 ; i < size ; i++)
            {
                sched8ToCommit[i].txtPeriodCovered = d.getElementById('txtPeriodCoveredSch8'+i).value;
                sched8ToCommit[i].txtNameAgent = d.getElementById('txtNameAgentSch8'+i).value;
                sched8ToCommit[i].txtIncomePayment = d.getElementById('txtIncomePaymentSch8'+i).value;
                sched8ToCommit[i].txtTotalWithheld = d.getElementById('txtTotalWithheldSch8'+i).value;
                sched8ToCommit[i].txtPrevious2Mo = d.getElementById('txtPrevious2MoSch8'+i).value;
                sched8ToCommit[i].txtAppliedCurrMo = d.getElementById('txtAppliedCurrSch8'+i).value;
            }
            i = sched8ToCommit.length;
            sched8ToCommit[i] = new Schedule6and8();

            //d.getElementById("tbodyllistSched8").innerHTML = "";
			$('#tbodyllistSched8').html("");
			
            for(i = 0; i < sched8ToCommit.length; i++) {

                //d.getElementById("tbodyllistSched8").innerHTML += "<tr>" +
				$('#tbodyllistSched8').html(  d.getElementById('tbodyllistSched8').innerHTML + "<tr>" +
                    "<td> <input type='checkbox' id='chxSched8"+i+"' /> </td>" +
                    "<td> <input type='text'  id='txtPeriodCoveredSch8"+i+"' style='width: 150px' value='"+ sched8ToCommit[i].txtPeriodCovered  +"' maxlength='10'  onkeypress='return dateOnly(this, event)' > </td>" +
                    "<td> <input type='text'  id='txtNameAgentSch8"+i+"' style='width: 190px' value='"+ sched8ToCommit[i].txtNameAgent +"'  maxlength='50' > </td> " +
                    "<td><input type='text' id='txtIncomePaymentSch8"+i+"' style='width: 150px' value='"+ sched8ToCommit[i].txtIncomePayment +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2)' maxlength='17' /> </td> " +
                    "<td><input type='text' id='txtTotalWithheldSch8"+i+"' style='width: 150px'  value='"+ sched8ToCommit[i].txtTotalWithheld +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2)' maxlength='17' /> </td>" +
                    "<td><input type='text' id='txtPrevious2MoSch8"+i+"' style='width: 150px'  value='"+ sched8ToCommit[i].txtPrevious2Mo +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2);computeSumWithheldAppSch8()' maxlength='17' /> </td>" +
                    "<td><input type='text' id='txtAppliedCurrSch8"+i+"' style='width: 150px'  value='"+ sched8ToCommit[i].txtAppliedCurrMo +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2);computeSumWithheldAppSch8()' maxlength='17' /> </td>");



                setTimeout("setInputTextControl_HorizontalAlignment('txtIncomePaymentSch8"+i+"',4 );" +
                    "setInputTextControl_HorizontalAlignment('txtTotalWithheldSch8"+i+"',4 ); " +
                    "setInputTextControl_HorizontalAlignment('txtPrevious2MoSch8"+i+"',4 ); " +
                    "setInputTextControl_HorizontalAlignment('txtAppliedCurrSch8"+i+"',4 );",100);

          //      setTimeout("setInputTextControl_NumberFormatter('txtIncomePaymentSch8"+i+"',12,2 );" +
          //          "setInputTextControl_NumberFormatter('txtTotalWithheldSch8"+i+"',12,2 ); " +
          //          "setInputTextControl_NumberFormatter('txtPrevious2MoSch8"+i+"',12,2 ); " +
          //          "setInputTextControl_NumberFormatter('txtAppliedCurrSch8"+i+"',12,2 );",100);
            }
    }	
	
    function addlistSched8()
    {
        if(checkifEmptyFieldSched8()) {
            var size = sched8ToCommit.length;
            for(var i = 0 ; i < size ; i++)
            {
                sched8ToCommit[i].txtPeriodCovered = d.getElementById('txtPeriodCoveredSch8'+i).value;
                sched8ToCommit[i].txtNameAgent = d.getElementById('txtNameAgentSch8'+i).value;
                sched8ToCommit[i].txtIncomePayment = d.getElementById('txtIncomePaymentSch8'+i).value;
                sched8ToCommit[i].txtTotalWithheld = d.getElementById('txtTotalWithheldSch8'+i).value;
                sched8ToCommit[i].txtPrevious2Mo = d.getElementById('txtPrevious2MoSch8'+i).value;
                sched8ToCommit[i].txtAppliedCurrMo = d.getElementById('txtAppliedCurrSch8'+i).value;
            }
            i = sched8ToCommit.length;
            sched8ToCommit[i] = new Schedule6and8();

            //d.getElementById("tbodyllistSched8").innerHTML = "";
			$('#tbodyllistSched8').html("");
			
            for(i = 0; i < sched8ToCommit.length; i++) {

                //d.getElementById("tbodyllistSched8").innerHTML += "<tr>" +
				$('#tbodyllistSched8').html(  d.getElementById('tbodyllistSched8').innerHTML + "<tr>" +
                    "<td> <input type='checkbox' id='chxSched8"+i+"' /> </td>" +
                    "<td> <input type='text'  id='txtPeriodCoveredSch8"+i+"' style='width: 150px' value='"+ sched8ToCommit[i].txtPeriodCovered  +"' maxlength='10'  onkeypress='return dateOnly(this, event)' > </td>" +
                    "<td> <input type='text'  id='txtNameAgentSch8"+i+"' style='width: 190px' value='"+ sched8ToCommit[i].txtNameAgent +"'  maxlength='50' > </td> " +
                    "<td><input type='text' id='txtIncomePaymentSch8"+i+"' style='width: 150px' value='"+ sched8ToCommit[i].txtIncomePayment +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2)' maxlength='17' /> </td> " +
                    "<td><input type='text' id='txtTotalWithheldSch8"+i+"' style='width: 150px'  value='"+ sched8ToCommit[i].txtTotalWithheld +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2)' maxlength='17' /> </td>" +
                    "<td><input type='text' id='txtPrevious2MoSch8"+i+"' style='width: 150px'  value='"+ sched8ToCommit[i].txtPrevious2Mo +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2);computeSumWithheldAppSch8()' maxlength='17' /> </td>" +
                    "<td><input type='text' id='txtAppliedCurrSch8"+i+"' style='width: 150px'  value='"+ sched8ToCommit[i].txtAppliedCurrMo +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2);computeSumWithheldAppSch8()' maxlength='17' /> </td>");



                setTimeout("setInputTextControl_HorizontalAlignment('txtIncomePaymentSch8"+i+"',4 );" +
                    "setInputTextControl_HorizontalAlignment('txtTotalWithheldSch8"+i+"',4 ); " +
                    "setInputTextControl_HorizontalAlignment('txtPrevious2MoSch8"+i+"',4 ); " +
                    "setInputTextControl_HorizontalAlignment('txtAppliedCurrSch8"+i+"',4 );",100);

             //   setTimeout("setInputTextControl_NumberFormatter('txtIncomePaymentSch8"+i+"',12,2 );" +
             //       "setInputTextControl_NumberFormatter('txtTotalWithheldSch8"+i+"',12,2 ); " +
             //       "setInputTextControl_NumberFormatter('txtPrevious2MoSch8"+i+"',12,2 ); " +
             //       "setInputTextControl_NumberFormatter('txtAppliedCurrSch8"+i+"',12,2 );",100);
            }
        }
    }

    function deletelistSched8()
    {
        var sched8Temp = new Array();
        var i = 0;
        var size = sched8ToCommit.length;
        for(i = 0 ; i < size ; i++)
        {
            sched8ToCommit[i].txtPeriodCovered = d.getElementById('txtPeriodCoveredSch8'+i).value;
            sched8ToCommit[i].txtNameAgent = d.getElementById('txtNameAgentSch8'+i).value;
            sched8ToCommit[i].txtIncomePayment = d.getElementById('txtIncomePaymentSch8'+i).value;
            sched8ToCommit[i].txtTotalWithheld = d.getElementById('txtTotalWithheldSch8'+i).value;
            sched8ToCommit[i].txtPrevious2Mo = d.getElementById('txtPrevious2MoSch8'+i).value;
            sched8ToCommit[i].txtAppliedCurrMo = d.getElementById('txtAppliedCurrSch8'+i).value;
        }
        i = 0;
        for(var j = 0; j < size ; j++) {
            if(!d.getElementById("chxSched8" + j).checked) {
                sched8Temp[i++] = sched8ToCommit[j];
            }
        }

        if(sched8Temp.length > 0) {
            sched8ToCommit = new Array();
            sched8ToCommit = sched8Temp;
            //d.getElementById("tbodyllistSched8").innerHTML = "";
			$('#tbodyllistSched8').html("");
			
            for(i = 0; i < sched8Temp.length; i++) {
                sched8ToCommit[i] = sched8Temp[i];
                //d.getElementById("tbodyllistSched8").innerHTML += "<tr>" +
				$('#tbodyllistSched8').html(  d.getElementById('tbodyllistSched8').innerHTML + "<tr>" +
                    "<td> <input type='checkbox' id='chxSched8"+i+"' /> </td>" +
                    "<td> <input type='text'  id='txtPeriodCoveredSch8"+i+"' style='width: 150px' value='"+ sched8ToCommit[i].txtPeriodCovered  +"' maxlength='10'  onkeypress='return dateOnly(this, event)' > </td>" +
                    "<td> <input type='text'  id='txtNameAgentSch8"+i+"' style='width: 190px' value='"+ sched8ToCommit[i].txtNameAgent +"'  maxlength='50' > </td> " +
                    "<td><input type='text' id='txtIncomePaymentSch8"+i+"' style='width: 150px' value='"+ sched8ToCommit[i].txtIncomePayment +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2)' maxlength='17' /> </td> " +
                    "<td><input type='text' id='txtTotalWithheldSch8"+i+"' style='width: 150px'  value='"+ sched8ToCommit[i].txtTotalWithheld +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2)' maxlength='17' /> </td>" +
                    "<td><input type='text' id='txtPrevious2MoSch8"+i+"' style='width: 150px'  value='"+ sched8ToCommit[i].txtPrevious2Mo +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2);computeSumWithheldAppSch8()' maxlength='17' /> </td>" +
                    "<td><input type='text' id='txtAppliedCurrSch8"+i+"' style='width: 150px'  value='"+ sched8ToCommit[i].txtAppliedCurrMo +"' onkeypress='return numbersonly(this, event)' onblur='round(this,2);computeSumWithheldAppSch8()' maxlength='17' /> </td>");



                setTimeout("setInputTextControl_HorizontalAlignment('txtIncomePaymentSch8"+i+"',4 );" +
                    "setInputTextControl_HorizontalAlignment('txtTotalWithheldSch8"+i+"',4 ); " +
                    "setInputTextControl_HorizontalAlignment('txtPrevious2MoSch8"+i+"',4 ); " +
                    "setInputTextControl_HorizontalAlignment('txtAppliedCurrSch8"+i+"',4 );",100);

          //      setTimeout("setInputTextControl_NumberFormatter('txtIncomePaymentSch8"+i+"',12,2 );" +
          //          "setInputTextControl_NumberFormatter('txtTotalWithheldSch8"+i+"',12,2 ); " +
          //          "setInputTextControl_NumberFormatter('txtPrevious2MoSch8"+i+"',12,2 ); " +
          //          "setInputTextControl_NumberFormatter('txtAppliedCurrSch8"+i+"',12,2 );",100);
            }
        } else {
            sched8ToCommit = new Array();
            //d.getElementById("tbodyllistSched8").innerHTML = "";
			$('#tbodyllistSched8').html("");
        }
        computeSumWithheldAppSch8();
    }

    function showSched8(){
        saveTempSched8Data();

        if(d.getElementById('frm2550q:txtYear').value <= 2000 && d.getElementById('frm2550q:txtYear').value <= 2020 ) {
            alert("Please  enter a valid year for the Return Period. Only values 2000 and beyond will be accepted."); return;
        } else {
            //  if(d.getElementById('frm2550q:txtTax18A').value <= 0) {
            //      alert("Please enter a valid value on Item 18A to be able to load the Schedule 8.");
            //  }else {
            
			//d.getElementById('mainContent').style.display = "inline";
            //d.getElementById('modalSched8').style.display = "block";
			d.getElementById('mainContent').style.display = "none";		
			$('#modalSched8').show('blind');
			
            for(var x = 0; x < d.getElementById("tblSched8").rows.length; x++) {
                setTimeout("setInputTextControl_HorizontalAlignment('txtIncomePaymentSch8" + x + "', 4);", 100);
                setTimeout("setInputTextControl_HorizontalAlignment('txtTotalWithheldSch8" + x + "', 4);", 100);
                setTimeout("setInputTextControl_HorizontalAlignment('txtPrevious2MoSch8" + x + "', 4);", 100);
                setTimeout("setInputTextControl_HorizontalAlignment('txtAppliedCurrSch8" + x + "', 4);", 100);

       //         setTimeout("setInputTextControl_NumberFormatter('txtIncomePaymentSch8" + x + "', 12,2);", 100);
       //         setTimeout("setInputTextControl_NumberFormatter('txtTotalWithheldSch8" + x + "', 12,2);", 100);
       //         setTimeout("setInputTextControl_NumberFormatter('txtPrevious2MoSch8" + x + "', 12,2);", 100);
       //         setTimeout("setInputTextControl_NumberFormatter('txtAppliedCurrSch8" + x + "', 12,2);", 100);
            }

            setTimeout("d.getElementById('txtmodalTotal23C').disabled = true; setInputTextControl_HorizontalAlignment('txtmodalTotal23C', 4);" +
                "d.getElementById('txtmodalTotalSched8AppliedCurrent').disabled = true; setInputTextControl_HorizontalAlignment('txtmodalTotalSched8AppliedCurrent', 4);" , 100);

         //   setTimeout("setInputTextControl_NumberFormatter('txtmodalTotal23C', 12,2);" +
         //       "setInputTextControl_NumberFormatter('txtmodalTotalSched8AppliedCurrent', 12,2);" , 100);
            //  }
        }

        if(viewUploadFlag) {
            setTimeout("d.getElementById('btnAdd6').disabled = true;", 100);
            setTimeout("d.getElementById('btnDelete6').disabled = true;", 100);
            setTimeout("d.getElementById('btnClearPop8').disabled = true;", 100);
            setTimeout("d.getElementById('btnCancelPop8').disabled = true;", 100);
            setTimeout("toggleAllDisabled();", 100);
            setTimeout("d.getElementById('btnOkPop8').disabled = false;", 100);
        }
    }

    function saveTempSched8Data() {
        var x;
        tempRowSizeSched8 = d.getElementById("tblSched8").rows.length - 1;

        for(x = 0; x < tempRowSizeSched8; x++){
            tempTempPeriodCovered8[x] = d.getElementById("txtPeriodCoveredSch8" + x).value;
            tempAgentNm8[x] = d.getElementById("txtNameAgentSch8" + x).value;
            tempIncPaymnt8[x] = d.getElementById("txtIncomePaymentSch8" + x).value;
            tempTotalTaxWithld8[x] = d.getElementById("txtTotalWithheldSch8" + x).value;
            tempAppPrev8[x] = d.getElementById("txtPrevious2MoSch8" + x).value;
            tempAppCurr8[x] = d.getElementById("txtAppliedCurrSch8" + x).value;
            tempSched9TotalPrev8[x] = d.getElementById("txtmodalTotal23C").value;
            tempSched9TotalCurr8[x] = d.getElementById("txtmodalTotalSched8AppliedCurrent").value;
        }
    }

    function restoreTempSched8Data() {
        if(tempRowSizeSched8 > 0) {
            sched8ToCommit = new Array();
            //d.getElementById("tbodyllistSched8").innerHTML = "";
			$('#tbodyllistSched8').html("");
			
            var x = 0;

            x = 0;
            var initCount = 0;

            for(x = 0; x < tempRowSizeSched8; x++){
                addlistSched8();

                d.getElementById("txtPeriodCoveredSch8" + x).value = tempTempPeriodCovered8[x];
                d.getElementById("txtNameAgentSch8" + x).value = tempAgentNm8[x];
                d.getElementById("txtIncomePaymentSch8" + x).value = tempIncPaymnt8[x];
                d.getElementById("txtTotalWithheldSch8" + x).value = tempTotalTaxWithld8[x];
                d.getElementById("txtPrevious2MoSch8" + x).value = tempAppPrev8[x];
                d.getElementById("txtAppliedCurrSch8" + x).value = tempAppCurr8[x];

                if(initCount == (tempRowSizeSched8 - 1)){
                    d.getElementById("txtmodalTotal23C").value = tempSched9TotalPrev8[x];
                    d.getElementById("txtmodalTotalSched8AppliedCurrent").value = tempSched9TotalCurr8[x];
                }

                initCount++;
                computeSumWithheldAppSch8();
            }
        }
    }

    function clearSched8Modal() {
        var x;
        var rowSizeSched8 = d.getElementById("tblSched8").rows.length - 1;
        for(x = 0; x < rowSizeSched8; x++){
            d.getElementById("txtPeriodCoveredSch8" + x).value = "";
            d.getElementById("txtNameAgentSch8" + x).value = "";
            d.getElementById("txtIncomePaymentSch8" + x).value = "0.00";
            d.getElementById("txtTotalWithheldSch8" + x).value = "0.00";
            d.getElementById("txtPrevious2MoSch8" + x).value = "0.00";
            d.getElementById("txtAppliedCurrSch8" + x).value = "0.00";
            d.getElementById("txtmodalTotal23C").value = "0.00";
            d.getElementById("txtmodalTotalSched8AppliedCurrent").value = "0.00";
        }
    }

    function cancelSched8Modal() {
        restoreTempSched8Data();

        //d.getElementById('mainContent').style.display = 'block';
        //d.getElementById('modalSched8').style.display = 'none';
        //d.getElementById('DummyTxt').innerHTML = "Creator";
        //d.getElementById('DummyTxt').innerHTML = "";
		d.getElementById('mainContent').style.display = 'block';
		if ( $('#modalSched8').css('display') != 'none' ) {
			$('#modalSched8').hide('blind');
		}
		$('#DummyTxt').html("Creator");
		$('#DummyTxt').html("");	
		
        isModalTurnOn = false;
    }

    function getSched8Modal(){
        if (checkifEmptyFieldSched8() )
        {
            //d.getElementById('mainContent').style.display = 'block';
            //d.getElementById('modalSched8').style.display = 'none';
            //d.getElementById('DummyTxt').innerHTML = "Creator";
            //d.getElementById('DummyTxt').innerHTML = "";
			d.getElementById('mainContent').style.display = 'block';
			if ( $('#modalSched8').css('display') != 'none' ) {
				$('#modalSched8').hide('blind');
			}
			$('#DummyTxt').html("Creator");
			$('#DummyTxt').html("");
			
			d.getElementById('frm2550q:txtTax26D').value = formatCurrency(NumWithComma(d.getElementById('txtmodalTotalSched8AppliedCurrent').value) + NumWithComma(d.getElementById('txtmodalTotal23C').value));
            compute26H();
        }
    }

    function getInputTaxCompute(index) {

        d.getElementById('txtInputTax' + index).value = formatCurrency( NumWithComma(d.getElementById('txtAmt' + index).value) * 0.12 );
        computeSumTax();
    }

    function computeSumTax(){
        var size = sched2ToCommit.length;
        var totalAmountTax = 0;
        var totalInputTax = 0;
        for(var i = 0 ; i < size ; i++){
            totalAmountTax = totalAmountTax*1 + NumWithComma(d.getElementById('txtAmt' + i).value)*1 ;
            totalInputTax = totalInputTax*1  + NumWithComma(d.getElementById('txtInputTax' + i).value)*1;
        }
        d.getElementById('txtmodalTotalAmt').value = formatCurrency(totalAmountTax);
        d.getElementById('txtmodalTotalInputTax').value = formatCurrency(totalInputTax);
    }
    function getInputTaxCompute3A(index) {

        d.getElementById('txtInputTax3A' + index).value = formatCurrency( NumWithComma(d.getElementById('txtAmt3A' + index).value) * 0.12 );
        computeSumTax3A();
    }

    function computeSumTax3A(){
        var size = sched3AToCommit.length;
        var totalAmountTax = 0;
        var totalInputTax = 0;
        var totalBalanceSched = 0;

        for(var i = 0 ; i < size ; i++){
            totalAmountTax = totalAmountTax*1 + NumWithComma(d.getElementById('txtAmt3A' + i).value)*1 ;
            totalInputTax = totalInputTax*1  + NumWithComma(d.getElementById('txtInputTax3A' + i).value)*1;

            //d.getElementById('txtAllowInputTax3A' + i).value = formatCurrency( NumWithComma(d.getElementById('txtInputTax3A' + i).value) / NumWithComma(d.getElementById('txtRecogLife3A' + i).value) );
            d.getElementById('txtBalInputTax3A' + i).value = formatCurrency( NumWithComma(d.getElementById('txtInputTax3A' + i).value) - NumWithComma(d.getElementById('txtAllowInputTax3A' + i).value) );
            totalBalanceSched = totalBalanceSched*1 + (NumWithComma(d.getElementById('txtBalInputTax3A' + i).value)*1);
		}
        d.getElementById('txtmodalTotalAmountSched3').value = formatCurrency(totalAmountTax);
        d.getElementById('txtmodalTotalInputTaxSched3').value = formatCurrency(totalInputTax);
        d.getElementById('txtmodalTotalBalanceSched3A').value = formatCurrency(totalBalanceSched);
        computeSumModal20A();
    }

    function computeSumModal20A() {
        d.getElementById('txtmodalTotalInputTax20ASched3').value = formatCurrency( NumWithComma(d.getElementById('txtmodalTotalBalanceSched3A').value) + NumWithComma(d.getElementById('txtmodalTotalBalanceSched3B').value) );
    }
    
    function computeSumTax3B(){
        var size = sched3BToCommit.length;
        var totalBalanceSched = 0;
        for(var i = 0 ; i < size ; i++){

            //d.getElementById('txtAllowInputTax3B' + i).value = formatCurrency( NumWithComma(d.getElementById('txtBalInputTaxPrevious3B' + i).value) / NumWithComma(d.getElementById('txtRecogLife3B' + i).value) );
            d.getElementById('txtBalInputTax3B' + i).value = formatCurrency( NumWithComma(d.getElementById('txtBalInputTaxPrevious3B' + i).value) - NumWithComma(d.getElementById('txtAllowInputTax3B' + i).value) );
            totalBalanceSched = totalBalanceSched*1 + (NumWithComma(d.getElementById('txtBalInputTax3B' + i).value)*1);
        }
        d.getElementById('txtmodalTotalBalanceSched3B').value = formatCurrency(totalBalanceSched);
        computeSumModal20A();
    }

    function computeInputTaxSched4() {
        // d.getElementById('txtlessStdTaxSched4').value = formatCurrency(NumWithComma(d.getElementById('frm2550q:txtTax16A').value) * 5 / 100);
        d.getElementById('txtTotalInputTaxnotDirectSched4').value = formatCurrency( NumWithComma(d.getElementById('txtTaxableSaleSched4').value) / NumWithComma(d.getElementById('txtTotalSaleSched4').value) * NumWithComma(d.getElementById('txtInputTaxnotDirectSched4').value)  );
        d.getElementById('txtTotalInputSaletoGovernmentSched4').value = formatCurrency( NumWithComma(d.getElementById('txtinputtaxSched4').value) + NumWithComma(d.getElementById('txtTotalInputTaxnotDirectSched4').value)  );
        d.getElementById('txtTotal20BSched4').value = formatCurrency( NumWithComma(d.getElementById('txtTotalInputSaletoGovernmentSched4').value) - NumWithComma(d.getElementById('txtlessStdTaxSched4').value)  );
    }
	
	function changedTxtTax16A() {
		d.getElementById('txtlessStdTaxSched4').value = formatCurrency((NumWithComma(d.getElementById('frm2550q:txtTax16A').value)) * 7 / 100);
	}

    function computeInputTaxSched5() {
        d.getElementById('txtProductnotDirectSched5').value = formatCurrency( NumWithComma(d.getElementById('txtTotSaleSched5').value) / NumWithComma(d.getElementById('txtSumTotalSaleSched5').value) * NumWithComma(d.getElementById('txtAmountInputnotDirectSched5').value)  );
        d.getElementById('txtTotal20CSched5').value = formatCurrency( NumWithComma(d.getElementById('txtinputtaxSched5').value) + NumWithComma(d.getElementById('txtProductnotDirectSched5').value)  );
    }

    function computeSumWithheldApp() {
        var size = sched6ToCommit.length;
        var totalWithheld = 0;
        var totalApplied = 0;
        for(var i = 0 ; i < size ; i++){
            totalWithheld = totalWithheld*1 + NumWithComma(d.getElementById('txtPrevious2Mo'+i).value)*1;
            totalApplied = totalApplied*1 + NumWithComma(d.getElementById('txtAppliedCurr'+i).value)*1;
        }
        d.getElementById('txtmodalTotal23A').value =  formatCurrency(totalWithheld) ;
        d.getElementById('txtmodalTotalSched6AppliedCurrent').value = formatCurrency(totalApplied);
    }

    function computeSumWithheldAppSch7() {
        var size = sched7ToCommit.length;
        var totalAmountPaid = 0;
        var totalApplied = 0;
        for(var i = 0 ; i < size ; i++){
            totalAmountPaid = totalAmountPaid*1 + NumWithComma(d.getElementById('txtPrevious2MoSch7'+i).value)*1;
            totalApplied = totalApplied*1 + NumWithComma(d.getElementById('txtAppliedCurrSch7'+i).value)*1;
        }
        d.getElementById('txtmodalTotal23B').value =  formatCurrency(totalAmountPaid) ;
        d.getElementById('txtmodalTotalSched7AppliedCurrent').value = formatCurrency(totalApplied);
    }

    function computeSumWithheldAppSch8() {
        var size = sched8ToCommit.length;
        var totalWithheld = 0;
        var totalApplied = 0;
        for(var i = 0 ; i < size ; i++){
            totalWithheld = totalWithheld*1 + NumWithComma(d.getElementById('txtPrevious2MoSch8'+i).value)*1;
            totalApplied = totalApplied*1 + NumWithComma(d.getElementById('txtAppliedCurrSch8'+i).value)*1;
        }
        d.getElementById('txtmodalTotal23C').value =  formatCurrency(totalWithheld) ;
        d.getElementById('txtmodalTotalSched8AppliedCurrent').value = formatCurrency(totalApplied);
    }

    function computePenalties() {
        d.getElementById('frm2550q:txtTax28D').value = formatCurrency(NumWithComma(d.getElementById('frm2550q:txtTax28A').value) + NumWithComma(d.getElementById('frm2550q:txtTax28B').value) + NumWithComma(d.getElementById('frm2550q:txtTax28C').value));
        compute29();
    }

    function compute16B(){
        d.getElementById('frm2550q:txtTax16B').value = formatCurrency(NumWithComma(d.getElementById('frm2550q:txtTax16A').value) * 0.12 );
        compute19AB();
    }

    function compute20F() {
        d.getElementById('frm2550q:txtTax20F').value = formatCurrency( NumWithComma(d.getElementById('frm2550q:txtTax20A').value) + NumWithComma(d.getElementById('frm2550q:txtTax20B').value) +  NumWithComma(d.getElementById('frm2550q:txtTax20C').value) +
            NumWithComma(d.getElementById('frm2550q:txtTax20D').value) + NumWithComma(d.getElementById('frm2550q:txtTax20E').value) );

        compute22();
    }

    function compute21TransactionbyRow(letter) {
        var indexAlpha = '';
        if(letter =="E"){
            indexAlpha = "F";
        }else if(letter == "G"){
            indexAlpha = "H";
        }else if(letter == "I"){
            indexAlpha = "J";
        }else if(letter == "K"){
            indexAlpha = "L";
        }else if(letter == "N"){
            indexAlpha = "O";
        }
        d.getElementById('frm2550q:txtTax21'+indexAlpha).value = formatCurrency( NumWithComma(d.getElementById('frm2550q:txtTax21'+letter).value) * 0.12 );
        compute22();
    }
    
    function compute19AB(){
        d.getElementById('frm2550q:txtTax19A').value = formatCurrency( NumWithComma(d.getElementById('frm2550q:txtTax15A').value) + NumWithComma(d.getElementById('frm2550q:txtTax16A').value) +
            NumWithComma(d.getElementById('frm2550q:txtTax17').value) + NumWithComma(d.getElementById('frm2550q:txtTax18').value));

        d.getElementById('frm2550q:txtTax19B').value = formatCurrency( NumWithComma(d.getElementById('frm2550q:txtTax15B').value) + NumWithComma(d.getElementById('frm2550q:txtTax16B').value) );
        compute25();
    }

    function compute21P() {
        d.getElementById('frm2550q:txtTax21P').value = formatCurrency( NumWithComma(d.getElementById('frm2550q:txtTax21A').value) + NumWithComma(d.getElementById('frm2550q:txtTax21C').value) +
            NumWithComma(d.getElementById('frm2550q:txtTax21E').value) + NumWithComma(d.getElementById('frm2550q:txtTax21G').value) + NumWithComma(d.getElementById('frm2550q:txtTax21I').value) +
            NumWithComma(d.getElementById('frm2550q:txtTax21K').value) + NumWithComma(d.getElementById('frm2550q:txtTax21M').value) + NumWithComma(d.getElementById('frm2550q:txtTax21N').value));
    }

    function compute22() {
        d.getElementById('frm2550q:txtTax22').value = formatCurrency( NumWithComma(d.getElementById('frm2550q:txtTax20F').value) + NumWithComma(d.getElementById('frm2550q:txtTax21B').value) +
            NumWithComma(d.getElementById('frm2550q:txtTax21D').value) + NumWithComma(d.getElementById('frm2550q:txtTax21F').value) + NumWithComma(d.getElementById('frm2550q:txtTax21H').value) +
            NumWithComma(d.getElementById('frm2550q:txtTax21J').value) + NumWithComma(d.getElementById('frm2550q:txtTax21L').value) + NumWithComma(d.getElementById('frm2550q:txtTax21O').value));
        compute24();
    }
    function compute23F() {
        d.getElementById('frm2550q:txtTax23F').value = formatCurrency( NumWithComma(d.getElementById('frm2550q:txtTax23A').value) + NumWithComma(d.getElementById('frm2550q:txtTax23B').value)  +
            NumWithComma(d.getElementById('frm2550q:txtTax23C').value) + NumWithComma(d.getElementById('frm2550q:txtTax23D').value)  + NumWithComma(d.getElementById('frm2550q:txtTax23E').value)  );
        compute24()
    }
    function compute24() {
        d.getElementById('frm2550q:txtTax24').value   = formatCurrency( NumWithComma(d.getElementById('frm2550q:txtTax22').value) - NumWithComma(d.getElementById('frm2550q:txtTax23F').value) );
        compute25();
    }
    function compute25() {
        d.getElementById('frm2550q:txtTax25').value   = formatCurrency( NumWithComma(d.getElementById('frm2550q:txtTax19B').value) - NumWithComma(d.getElementById('frm2550q:txtTax24').value) );
        compute27();
    }
    function compute26H() {
        d.getElementById('frm2550q:txtTax26H').value = formatCurrency( NumWithComma(d.getElementById('frm2550q:txtTax26A').value) + NumWithComma(d.getElementById('frm2550q:txtTax26B').value) +
            NumWithComma(d.getElementById('frm2550q:txtTax26C').value) + NumWithComma(d.getElementById('frm2550q:txtTax26D').value) + NumWithComma(d.getElementById('frm2550q:txtTax26E').value) +
            NumWithComma(d.getElementById('frm2550q:txtTax26G').value) + NumWithComma(d.getElementById('frm2550q:txtTax26F').value) );
        compute27();
    }

    function compute27() {
        d.getElementById('frm2550q:txtTax27').value = formatCurrency( NumWithComma(d.getElementById('frm2550q:txtTax25').value) - NumWithComma(d.getElementById('frm2550q:txtTax26H').value) );
        compute29();
    }
    
    function compute29(){
        d.getElementById('frm2550q:txtTax29').value = formatCurrency( NumWithComma(d.getElementById('frm2550q:txtTax27').value) + NumWithComma(d.getElementById('frm2550q:txtTax28D').value) );
		capital();
	}
	
    function enableShortPeriod(answer) { 
        if(answer == "yes") {
            if(confirm("Choosing Yes means you are filing for a short-period \n" +
                "return. You are required to change the Month field to \n" +
                "correspond with your New quarter period. Please \n" +
                "update your Registration details by filing BIR \n"+
                "Form 1905 at the RDO where you are registered.")) {
                d.getElementById('frm2550q:RtnMonth').disabled = false;
                d.getElementById('frm2550q:OptQuarter1').disabled = true;
                d.getElementById('frm2550q:OptQuarter2').disabled = true;
                d.getElementById('frm2550q:OptQuarter3').disabled = true;
                d.getElementById('frm2550q:OptQuarter4').disabled = true;
            }else {
                d.getElementById('frm2550q:OptShortPrd2').checked = true;
            }
        }else {
            d.getElementById('frm2550q:RtnMonth').disabled = true;
            d.getElementById('frm2550q:OptQuarter1').disabled = false;
            d.getElementById('frm2550q:OptQuarter2').disabled = false;
            d.getElementById('frm2550q:OptQuarter3').disabled = false;
            d.getElementById('frm2550q:OptQuarter4').disabled = false;
        }
    }

    function validate(){
		if(!d.getElementById('frm2550q:optAmend:_1').checked && !d.getElementById('frm2550q:optAmend:_2').checked){
			alert("Please choose a year type on Item 1.");
			return;
		}
		
        var dt = new Date();
		if(d.getElementById('frm2550q:RtnMonth').value == "0"){
			alert("Please enter a valid Month."); return;
		}
		if(d.getElementById('frm2550q:RtnMonth').value == "12" && d.getElementById('frm2550q:optAmend:_2').checked ){
			alert("Fiscal Month cannot be equal to December."); return;
		}
        if(d.getElementById('frm2550q:txtYear').value == "" )
        {
            alert("Please indicate a valid Year."); return;
        }
        /*if( d.getElementById('frm2550q:txtYear').value*1 > dt.getFullYear()*1   )
        {
            alert("Invalid date entry on Item no.1. Entry should not be later than Current Date.")
            return;
        }*/
        if( d.getElementById('frm2550q:txtYear').value*1 < 2000   )
        {
            alert("Invalid date entry on Item no.1. Entry should not be lower than 2000.")
            return;
        }
		
        if( (d.getElementById('frm2550q:txtTIN1').value == "" || d.getElementById('frm2550q:txtTIN2').value == "" || d.getElementById('frm2550q:txtTIN3').value == "" || d.getElementById('frm2550q:txtBranchCode').value == "")  )
        {
            alert("Please enter a valid TIN number on Item 6.");
            return;
        }		
        //if( (d.getElementById('frm2550q:txtRDOCode').value == "")  )
		if( (d.getElementById('frm2550q:txtRDOCode').selectedIndex == 0)  )
        {
            alert("Please enter a valid RDO Code on Item 7.");
            return;
        }			
        if( (d.getElementById('frm2550q:txtLineBus').value == "")  )
        {
            alert("Please enter a valid Line of Business/Occupation on Item 9.");
            return;
        }			
		if( (d.getElementById('frm2550q:TaxPayer').value == "")  )
        {
            alert("Please enter a valid Taxpayer Name on Item 10.");
            return;
        }	
		if( (d.getElementById('frm2550q:txtTelNum').value == "")  )
        {
            alert("Please enter a valid Telephone Number on Item 11.");
            return;
        }			
		if( (d.getElementById('frm2550q:txtAddress').value == "")  )
        {
            alert("Please enter Taxpayer's Registered Address on Item 12.");
            return;
        }	
		if( (d.getElementById('frm2550q:txtZipCode').value == "")  )
        {
            alert("Please enter Taxpayer's Zip Code on Item 13.");
            return;
        }
		
        if( d.getElementById('frm2550q:OptTreaty1').checked ) {
            if(d.getElementById('frm2550q:lstTaxTreaty').value == 0) {
                alert("Please select an option from item no. 14. Entry must not be empty."); return;
            }
        }
        AllControlDisabled(true);
		disableAmendedReturn();

        alert("Validation successful. Click on Edit if you wish to modify your entries."); return;
    }

	var disableElem = true;
	var enableElem = false;

    function AllControlDisabled(state){

        d.getElementById('frm2550q:btnFinalCopy').disabled = false;
		d.getElementById('frm2550q:cmdValidate').disabled = state;
		d.getElementById('frm2550q:optAmend:_1').disabled = state;
		d.getElementById('frm2550q:optAmend:_2').disabled = state;
		d.getElementById('frm2550q:RtnMonth').disabled = state;
		d.getElementById('frm2550q:txtSheets').disabled = state;
        d.getElementById('btnPrint').disabled = !state;
        d.getElementById('frm2550q:cmdEdit').disabled = !state;
		d.getElementById('frm2550q:txtTIN1').disabled = state;
		d.getElementById('frm2550q:txtTIN2').disabled = state;
		d.getElementById('frm2550q:txtTIN3').disabled = state;
		d.getElementById('frm2550q:txtBranchCode').disabled = state;
		d.getElementById('frm2550q:txtRDOCode').disabled = state;
		d.getElementById('frm2550q:txtLineBus').disabled = state;
		d.getElementById('frm2550q:TaxPayer').disabled = state;
		d.getElementById('frm2550q:txtTelNum').disabled = state;
		d.getElementById('frm2550q:txtAddress').disabled = state;
		d.getElementById('frm2550q:txtZipCode').disabled = state;
        d.getElementById('btnUpload').disabled = !state;

        d.getElementById('frm2550q:txtYear').disabled = state;
        if ( d.getElementById('frm2550q:OptShortPrd1').checked ) {
            d.getElementById('frm2550q:RtnMonth').disabled = state;
        }else {
            d.getElementById('frm2550q:OptQuarter1').disabled = state;
            d.getElementById('frm2550q:OptQuarter2').disabled = state;
            d.getElementById('frm2550q:OptQuarter3').disabled = state;
            d.getElementById('frm2550q:OptQuarter4').disabled = state;
        }

        d.getElementById('frm2550q:txtYear').disabled = state;
        d.getElementById('frm2550q:OptShortPrd1').disabled = state;
        d.getElementById('frm2550q:OptShortPrd2').disabled = state;

        d.getElementById('frm2550q:OptTreaty1').disabled = state;
        d.getElementById('frm2550q:OptTreaty2').disabled = state;
        if( d.getElementById('frm2550q:OptTreaty1').checked ) {
            d.getElementById('frm2550q:lstTaxTreaty').disabled = state;
        }
        d.getElementById('btnSched1').disabled = state;
        d.getElementById('frm2550q:txtTax16A').disabled = state;
        d.getElementById('frm2550q:txtTax16B').disabled = state;
        d.getElementById('frm2550q:txtTax17').disabled = state;
        d.getElementById('frm2550q:txtTax18').disabled = state;
        d.getElementById('frm2550q:txtTax20A').disabled = state;
        d.getElementById('frm2550q:txtTax20B').disabled = state;
        d.getElementById('frm2550q:txtTax20C').disabled = state;
        d.getElementById('frm2550q:txtTax20D').disabled = state;
        d.getElementById('frm2550q:txtTax20E').disabled = state;
        d.getElementById('frm2550q:txtTax21E').disabled = state;
        d.getElementById('frm2550q:txtTax21F').disabled = state;
        d.getElementById('frm2550q:txtTax21G').disabled = state;
        d.getElementById('frm2550q:txtTax21H').disabled = state;
        d.getElementById('frm2550q:txtTax21I').disabled = state;
        d.getElementById('frm2550q:txtTax21J').disabled = state;
        d.getElementById('frm2550q:txtTax21K').disabled = state;
        d.getElementById('frm2550q:txtTax21L').disabled = state;
        d.getElementById('frm2550q:txtTax21M').disabled = state;
        d.getElementById('frm2550q:txtTax21N').disabled = state;
        d.getElementById('frm2550q:txtTax21O').disabled = state;
        d.getElementById('frm2550q:txtTax23D').disabled = state;
        d.getElementById('frm2550q:txtTax23E').disabled = state;
        d.getElementById('frm2550q:txtTax23F').disabled = state;
        d.getElementById('frm2550q:txtTax26A').disabled = state;
        d.getElementById('frm2550q:txtTax26F').disabled = state;
        d.getElementById('frm2550q:txtTax26G').disabled = state;
        d.getElementById('btnSched2').disabled = state;
        d.getElementById('btnSched3A').disabled = state;
        d.getElementById('btnSched3B').disabled = state;
        d.getElementById('btnSched4').disabled = state;
        d.getElementById('btnSched5').disabled = state;
        d.getElementById('btnSched6').disabled = state;
        d.getElementById('btnSched7').disabled = state;
        d.getElementById('btnSched8').disabled = state;

        d.getElementById('frm2550q:AmendedRtnY').disabled = state;
        d.getElementById('frm2550q:AmendedRtnN').disabled = state;
		d.getElementById('frm2550q:txtTax28A').disabled = state;
		d.getElementById('frm2550q:txtTax28B').disabled = state;
        d.getElementById('frm2550q:txtTax28C').disabled = state;
		if (qs('xmlFileName') != null && qs('xmlFileName').indexOf('.xml') > -1) {
			d.getElementById('frm2550q:RtnMonth').disabled = true;
			d.getElementById('frm2550q:txtYear').disabled = true;	
		}
		disableElem;
		enableElem;
		document.getElementById('frm2550q:txtTIN1').disabled = true; document.getElementById('frm2550q:txtTIN2').disabled = true; document.getElementById('frm2550q:txtTIN3').disabled = true; document.getElementById('frm2550q:txtBranchCode').disabled = true;
    }
	function disableAmendedReturn(){
		d.getElementById('frm2550q:txtTax26E').disabled = true;
	}
	function enableAmendedReturn(){
		if(d.getElementById('frm2550q:AmendedRtnY').checked)
			d.getElementById('frm2550q:txtTax26E').disabled = false;
		else
			d.getElementById('frm2550q:txtTax26E').disabled = true;
	}
    function changeMonth(){
        var month = d.getElementById('frm2550q:RtnMonth');

        if(parseInt(month.value) >= 1 && parseInt(month.value) <= 3){
            d.getElementById('frm2550q:OptQuarter1').checked = true;
        }else if(parseInt(month.value) >= 4 && parseInt(month.value) <= 6){
            d.getElementById('frm2550q:OptQuarter2').checked = true;
        }else if(parseInt(month.value) >= 7 && parseInt(month.value) <= 9){
            d.getElementById('frm2550q:OptQuarter3').checked = true;
        }else if(parseInt(month.value) >= 10 && parseInt(month.value) <= 12){
            d.getElementById('frm2550q:OptQuarter4').checked = true;
        }

        changeYear();
    }
	
	function enableMonth(elem){
		var month = d.getElementById('frm2550q:RtnMonth');
		
		if(elem.id == "frm2550q:optAmend:_1"){
			month.value = "12";
			month.disabled = true;
		} else {
			month.value = "0";
			month.disabled = false;
		}
	}
    
    function changeYear(){
        var month = d.getElementById('frm2550q:RtnMonth');
        var year = d.getElementById('frm2550q:txtYear');
        var days = daysInMonth((month.value - 1), year.value);
        if( year.value != "" ) {
            //alert(daysInMonth((month.value - 1), year.value))

            //AC Corp. 1/11/2012
            if(d.getElementById('frm2550q:optAmend:_1').checked){
                if(d.getElementById('frm2550q:OptQuarter1').checked) {
                    d.getElementById('frm2550q:RtnPeriodFrom').value = "01/01/" + (d.getElementById('frm2550q:txtYear').value) ;
                    d.getElementById('frm2550q:RtnPeriodTo').value = "03/" + 31 + "/" + (d.getElementById('frm2550q:txtYear').value) ;
                }else if(d.getElementById('frm2550q:OptQuarter2').checked) {
                    d.getElementById('frm2550q:RtnPeriodFrom').value = "04/01/" + (d.getElementById('frm2550q:txtYear').value) ;
                    d.getElementById('frm2550q:RtnPeriodTo').value = "06/" + 30 + "/" + (d.getElementById('frm2550q:txtYear').value) ;
                }else if(d.getElementById('frm2550q:OptQuarter3').checked) {
                    d.getElementById('frm2550q:RtnPeriodFrom').value = "07/01/" + (d.getElementById('frm2550q:txtYear').value) ;
                    d.getElementById('frm2550q:RtnPeriodTo').value = "09/" + 30 + "/" + (d.getElementById('frm2550q:txtYear').value ) ;
                }else if(d.getElementById('frm2550q:OptQuarter4').checked) {
                    d.getElementById('frm2550q:RtnPeriodFrom').value = "10/01/" + (d.getElementById('frm2550q:txtYear').value) ;
                    d.getElementById('frm2550q:RtnPeriodTo').value = "12/" + 31 + "/" + (d.getElementById('frm2550q:txtYear').value) ;
                }
            }else if(d.getElementById('frm2550q:optAmend:_2').checked){
                var monthFrom = parseInt(month.value);
                var yearFrom = parseInt(year.value) - 1;
                var monthTo;
                var yearTo;
                var tempMonthDay;


                if(d.getElementById('frm2550q:OptQuarter1').checked) {
                    monthFrom = monthFrom + 1;
                    if(monthFrom > 12){
                        monthFrom = (monthFrom - 12);
                        monthTo = monthFrom + 2;
                        yearFrom = yearFrom + 1;
                    }

                    if(monthFrom == 11){
                        monthTo = 1;
                    }else if(monthFrom == 12){
                        monthTo = 2;
                    }else {
                        monthTo = monthFrom + 2;
                    }

                    if(monthFrom > monthTo){
                        yearTo = yearFrom + 1;
                    }else {
                        yearTo = yearFrom;
                    }

                    monthFrom = addzero(monthFrom);
                    monthTo = addzero(monthTo);

                    tempMonthDay = monthTo - 1;

                    d.getElementById('frm2550q:RtnPeriodFrom').value = monthFrom + "/01/" + yearFrom;
                    d.getElementById('frm2550q:RtnPeriodTo').value = monthTo + "/" + daysInMonth(tempMonthDay, yearTo) + "/" + yearTo;
                }else if(d.getElementById('frm2550q:OptQuarter2').checked) {
                    monthFrom = monthFrom + 4;
                    if(monthFrom > 12){
                        monthFrom = (monthFrom - 12);
                        monthTo = monthFrom + 2;
                        yearFrom = yearFrom + 1;
                    }

                    if(monthFrom == 11){
                        monthTo = 1;
                    }else if(monthFrom == 12){
                        monthTo = 2;
                    }else {
                        monthTo = monthFrom + 2;
                    }

                    if(monthFrom > monthTo){
                        yearTo = yearFrom + 1;
                    }else {
                        yearTo = yearFrom;
                    }

                    monthFrom = addzero(monthFrom);
                    monthTo = addzero(monthTo);

                    tempMonthDay = monthTo - 1;

                    d.getElementById('frm2550q:RtnPeriodFrom').value = monthFrom + "/01/" + yearFrom;
                    d.getElementById('frm2550q:RtnPeriodTo').value = monthTo + "/" + daysInMonth(tempMonthDay, yearTo) + "/" + yearTo;
                }else if(d.getElementById('frm2550q:OptQuarter3').checked) {
                    monthFrom = monthFrom + 7;
                    if(monthFrom > 12){
                        monthFrom = (monthFrom - 12);
                        monthTo = monthFrom + 2;
                        yearFrom = yearFrom + 1;
                    }

                    if(monthFrom == 11){
                        monthTo = 1;
                    }else if(monthFrom == 12){
                        monthTo = 2;
                    }else {
                        monthTo = monthFrom + 2;
                    }

                    if(monthFrom > monthTo){
                        yearTo = yearFrom + 1;
                    }else {
                        yearTo = yearFrom;
                    }

                    monthFrom = addzero(monthFrom);
                    monthTo = addzero(monthTo);

                    tempMonthDay = monthTo - 1;

                    d.getElementById('frm2550q:RtnPeriodFrom').value = monthFrom + "/01/" + yearFrom;
                    d.getElementById('frm2550q:RtnPeriodTo').value = monthTo + "/" + daysInMonth(tempMonthDay, yearTo) + "/" + yearTo;
                }else if(d.getElementById('frm2550q:OptQuarter4').checked) {
                    monthFrom = monthFrom + 10;
                    if(monthFrom > 12){
                        monthFrom = (monthFrom - 12);
                        monthTo = monthFrom + 2;
                        yearFrom = yearFrom + 1;
                    }

                    if(monthFrom == 11){
                        monthTo = 1;
                    }else if(monthFrom == 12){
                        monthTo = 2;
                    }else {
                        monthTo = monthFrom + 2;
                    }

                    if(monthFrom > monthTo){
                        yearTo = yearFrom + 1;
                    }else {
                        yearTo = yearFrom;
                    }

                    monthFrom = addzero(monthFrom);
                    monthTo = addzero(monthTo);

                    tempMonthDay = monthTo - 1;

                    d.getElementById('frm2550q:RtnPeriodFrom').value = monthFrom + "/01/" + yearFrom;
                    d.getElementById('frm2550q:RtnPeriodTo').value = monthTo + "/" + daysInMonth(tempMonthDay, yearTo) + "/" + yearTo;
                }
            }

        }
    }

    function addzero(num){
        if(parseInt(num) < 10){
            num = "0" + num;
        }
        return num;
    }

    function daysInMonth(iMonth, iYear)
    {
        return 32 - new Date(iYear, iMonth, 32).getDate();
    }
	function initialValidateBeforeSave() {
			if( (d.getElementById('frm2550q:txtTIN1').value == "" || d.getElementById('frm2550q:txtTIN2').value == "" || d.getElementById('frm2550q:txtTIN3').value == "" || d.getElementById('frm2550q:txtBranchCode').value == "")  )
			{
				alert("Please enter a valid TIN number on Item 6.");
				return false;
			}	
			if ((d.getElementById('frm2550q:txtRDOCode').value == "000")) {
			    alert("Please enter a valid RDO Code on Item 7.");
			    return false;
			}
			if( (d.getElementById('frm2550q:TaxPayer').value == "")  )
			{
				alert("Please enter a valid Taxpayer Name on Item 10.");
				return false;
			}		
			return true;
	}	
	//topNav
	$(document).ready(function(){    
		$("ul.subnav").parent().append("<span></span>"); //Only shows drop down trigger when js is enabled (Adds empty span tag after ul.subnav*)  
		$("ul.topnav li span").click(function() { //When trigger is clicked...            
			//Following events are applied to the subnav itself (moving subnav up and down)  
			$(this).parent().find("ul.subnav").slideDown('fast').show(); //Drop down the subnav on click    
			$(this).parent().hover(function() {  
			}, function(){    
				$(this).parent().find("ul.subnav").slideUp('slow'); //When the mouse hovers out of the subnav, move it back up  
			});  
			//Following events are applied to the trigger (Hover events for the trigger)  
			}).hover(function() {   
				$(this).addClass("subhover"); //On hover over, add class "subhover"  
			}, function(){  //On Hover Out  
				$(this).removeClass("subhover"); //On hover out, remove class "subhover"  
		});
		$("ul.topnav .toplevel").click(function() { //When trigger is clicked...            
			//Following events are applied to the subnav itself (moving subnav up and down)  
			$(this).parent().find("ul.subnav").slideDown('fast').show(); //Drop down the subnav on click    
			$(this).parent().hover(function() {  
			}, function(){    
				$(this).parent().find("ul.subnav").slideUp('slow'); //When the mouse hovers out of the subnav, move it back up  
			});  
			//Following events are applied to the trigger (Hover events for the trigger)  
			}).hover(function() {   
				$(this).addClass("subhover"); //On hover over, add class "subhover"  
			}, function(){  //On Hover Out  
				$(this).removeClass("subhover"); //On hover out, remove class "subhover"  
			});

	    //added 07/25/2015
		$('#ebirOnlineConfirmUsername, #ebirOnlineConfirmPassword, #ebirOnlinePassword, #ebirOnlineUsername').bind('paste drag drop', function (e) {
		    e.preventDefault();
		});
	});		
function loadBGXML(loadWhere) {
		try {
			//This will load the file with filename loadWhere if it exists
			var fsoXML = new ActiveXObject("Scripting.FileSystemObject");	
			XMLBGFile = fsoXML.OpenTextFile(loadWhere,1);	
			if (XMLBGFile.AtEndOfStream) {
				data = "";			
			} else {
				var responseBG = d.getElementById('responseBG'); //render file and write to hidden div
				responseBG.innerHTML = XMLBGFile.ReadAll(); //remove XML tag			
			}		
			XMLBGFile.Close(); 		
			//alert( responseBG.innerHTML ); //Debug				
			loadBGData();	/*This will load data onto fields*/			
		} catch(e) {
			msg.innerHTML = ""; 
		} 
}
	
function loadBGData() { 
		/*This will load data onto Background Information fields*/
		var responseBG = d.getElementById("responseBG");

		var formTypeVal = String(responseBG.innerHTML).split('formType='); //form_type

		if (formTypeVal[1] == '2550Q') {
		
			var fnVal = String(responseBG.innerHTML).split('fn=');				
			d.getElementById('frm2550q:TaxPayer').value = 	unescape(fnVal[1]);	
		
			var tin1Val = String(responseBG.innerHTML).split('tin1=');				
			d.getElementById('frm2550q:txtTIN1').value = 	tin1Val[1];	
			
			var tin2Val = String(responseBG.innerHTML).split('tin2=');					
			d.getElementById('frm2550q:txtTIN2').value = 	tin2Val[1];	
			
			var tin3Val = String(responseBG.innerHTML).split('tin3=');					
			d.getElementById('frm2550q:txtTIN3').value = 	tin3Val[1];	
			
			var tin4Val = String(responseBG.innerHTML).split('tin4=');					
			d.getElementById('frm2550q:txtBranchCode').value = 	tin4Val[1];			

			var rdoVal = String(responseBG.innerHTML).split('rdo=');				
			d.getElementById('frm2550q:txtRDOCode').value = 	rdoVal[1];	 
			
			var lobVal = String(responseBG.innerHTML).split('lob=');				
			d.getElementById('frm2550q:txtLineBus').value = 	unescape(lobVal[1]);	

			var regAddrVal = String(responseBG.innerHTML).split('regAddr=');			
			d.getElementById('frm2550q:txtAddress').value = 	unescape(regAddrVal[1]);	
			
			var zipVal = String(responseBG.innerHTML).split('zip=');				
			d.getElementById('frm2550q:txtZipCode').value = 	zipVal[1];				
			
			var telNoVal = String(responseBG.innerHTML).split('telNo=');				
			d.getElementById('frm2550q:txtTelNum').value = 	telNoVal[1];		

			
		}		
		var emailVal = String(responseBG.innerHTML).split('email=');
			if(emailVal[1] === undefined)
			{
			    document.getElementById('txtEmail').value = "";
			}
			else
			{
			    document.getElementById('txtEmail').value = emailVal[1];
				globalEmail = emailVal[1];
			}
}		
function createXMLProfileName() {
	try {
	    var xmlFileName = "";
		
	    var titleTin1 = d.getElementById('frm2550q:txtTIN1');
	    var titleTin2 = d.getElementById('frm2550q:txtTIN2');
		var titleTin3 = d.getElementById('frm2550q:txtTIN3');
		var titleBranchCode = d.getElementById('frm2550q:txtBranchCode');	
		var titleTPName = d.getElementById('frm2550q:TaxPayer');	
		var formType = "2550Q";		
		
		xmlFileName = "profile/" + titleTin1.value + titleTin2.value + titleTin3.value + titleBranchCode.value + ".xml";		
	
		return xmlFileName;
	} catch(e) {
		alert('Exception : '+e.description);
	}	
}	
	
function saveXMLProfile(isFinalCopy) {	
    if (gIsReadOnly == false) {
		var xmlFileName = createXMLProfileName();
	
		msg.innerHTML='Generating File...';
		var fileSys = new ActiveXObject("Scripting.FileSystemObject");
		var xmlFile=fileSys.CreateTextFile(xmlFileName); //(saveWhere);

		var allXML = "<?xml version='1.0'?>",tab=d.getElementById('xmlFormat').innerHTML;
		allXML += tab; //adds line break			
		
		allXML += "<div>fn="+escape(d.getElementById('frm2550q:TaxPayer').value)+"fn=</div>"+tab;
		allXML += "<div>tin1="+d.getElementById('frm2550q:txtTIN1').value+"tin1=</div>"+tab;
		allXML += "<div>tin2="+d.getElementById('frm2550q:txtTIN2').value+"tin2=</div>"+tab;
		allXML += "<div>tin3="+d.getElementById('frm2550q:txtTIN3').value+"tin3=</div>"+tab;
		allXML += "<div>tin4="+d.getElementById('frm2550q:txtBranchCode').value+"tin4=</div>"+tab;	
		allXML += "<div>rdo="+d.getElementById('frm2550q:txtRDOCode').value+"rdo=</div>"+tab;		
		allXML += "<div>lob="+escape(d.getElementById('frm2550q:txtLineBus').value)+"lob=</div>"+tab;		
		allXML += "<div>regAddr="+escape(d.getElementById('frm2550q:txtAddress').value)+"regAddr=</div>"+tab;	
		allXML += "<div>zip="+d.getElementById('frm2550q:txtZipCode').value+"zip=</div>"+tab;				
		allXML += "<div>telNo="+d.getElementById('frm2550q:txtTelNum').value+"telNo=</div>"+tab;	
		allXML += "<div>email="+document.getElementById('txtEmail').value+"email=</div>"+tab;allXML += "<div>confirmemail="+document.getElementById('txtEmail').value+"confirmemail=</div>"+tab;
		allXML += "<div>confirmtin1=" + d.getElementById('frm2550q:txtTIN1').value + "confirmtin1=</div>" + tab;
            allXML += "<div>confirmtin2=" + d.getElementById('frm2550q:txtTIN2').value + "confirmtin2=</div>" + tab;
            allXML += "<div>confirmtin3=" + d.getElementById('frm2550q:txtTIN3').value + "confirmtin3=</div>" + tab;
            allXML += "<div>confirmtin4=" + d.getElementById('frm2550q:txtBranchCode').value + "confirmtin4=</div>" + tab;
		allXML += "<div>formType=2550Q=</div>"+tab;			
		
		allXML += tab+d.getElementById('xmlClose').innerHTML;
		
		xmlFile.write(allXML);
		xmlFile.close();
		msg.innerHTML = '';
		
		if (isFinalCopy == false) {
		alert('Background information saved/updated successfully as : '+xmlFileName);
		}	
	}
}
function cancel() {
	$('#bg').show();
	$('.printSignFooterClass').css({ 'width':'900px', 'background':'#e2e2e2' });
	$('.printSignFooterClass').hide();
	$('.imgClass').hide();
	$('body').css('background','#FFF');
	
	$('#formPaper').css({'width':'741px', 'border':'#CCC 1px solid', 'margin':'0 auto', 'background':'#FFF' });
	$('#wrapper').css({'width':'741px', 'padding':'1%', 'margin':'0 auto', 'font-size': '100% !important'});
	$('#container').css({'width':'741px', 'padding':'1%', 'margin':'0 auto', 'font-size': '100% !important'});		
	$('.labels').remove();
	
    var elem = document.getElementById('frmMain').elements;
    for(var i = 0; i < elem.length; i++) {			
		if (elem[i].type != 'hidden') { // && elem[i].type != 'undefined' 
			if (elem[i].type == 'text') {
			    document.getElementById(elem[i].id).style.height="14px";
				document.getElementById(elem[i].id).style.fontSize="11px";			
				document.getElementById(elem[i].id).readOnly = false;
				if(d.getElementById('frm2550q:cmdValidate').disabled == false){
					if (disabledItems.contains(elem[i].id)){
						document.getElementById(elem[i].id).disabled = true;}
					else{
						document.getElementById(elem[i].id).disabled = false;}
				}
				else{
					if (disabledItems.contains(elem[i].id)){
						document.getElementById(elem[i].id).disabled = true;}
					else{
						document.getElementById(elem[i].id).disabled = false;}
				}
			}				
			if (elem[i].type == 'radio' || elem[i].type == 'checkbox') { 
				if(d.getElementById('frm2550q:cmdValidate').disabled == false){
					if (disabledItems.contains(elem[i].id)){
						document.getElementById(elem[i].id).disabled = true;}
					else{
						document.getElementById(elem[i].id).disabled = false;}
				}
				else{
					if (disabledItems.contains(elem[i].id)){
						document.getElementById(elem[i].id).disabled = true;}
					else{
						document.getElementById(elem[i].id).disabled = false;}
				}
				document.getElementById(elem[i].id).style.height="15px";
				document.getElementById(elem[i].id).style.fontSize="11px";		
			}
			if ( elem[i].type == 'select-one'){
				$( elem[i] ).show();
			}	
		}
    }	
	
	$('input').each(function(){
	  if (this.type == 'button') {
		if (this.id != 'test') {
			$(this).removeClass('previewButtonClass');
		}	
	  }	
	});	
	
	$('a').each(function(){
		if (this.id.length > 1) {
			if(d.getElementById('frm2550q:cmdValidate').disabled == false){
				if (enableElem){
				d.getElementById(this.id).disabled = true;}
				else if(disableElem){
				d.getElementById(this.id).disabled = false;}
			}
			else{
				if (disableElem){
				d.getElementById(this.id).disabled = true;}
				else if(enableElem){
				d.getElementById(this.id).disabled = false;}
				}
		}
	});		

	$('#formMenu').show('blind');		
	if ( $('#printMenu').css('display') != 'none' ) {	
		$('#printMenu').hide('blind');
	}	
	
	if (qs('xmlFileName') != null && qs('xmlFileName').indexOf('.xml') > -1) {
		d.getElementById('frm2550q:RtnMonth').disabled = true;
		d.getElementById('frm2550q:txtYear').disabled = true;	
	}
	
}
Array.prototype.contains = Array.prototype.indexOf ?
    function(val) {
        return this.indexOf(val) > -1;
    } :
    function(val) {
        var i = this.length;
        while (i--) {
            if (this[i] === val) {
                return true;
            }
        }
        return false;
    };

var disabledItems = new Array();
function printme() {

	$('#bg').hide(); 
	$('.printSignFooterClass').css({ 'width':'94%','margin':'auto','margin-top':'15px','display':'block','position':'relative','overflow':'visible','page-break-before':'always', 'background':'#ffffff' });	
	$('.imgClass').css({ 'margin':'auto','display':'block','position':'relative','overflow':'visible' });
	$('body').css('background','#FFF');
	
	$('#formPaper').css({'max-width':'8.3in !important', 'border':'#000 3px solid' });
	$('#wrapper').css({'max-width':'8.3in !important', 'font-size': '75% !important'});
	$('#container').css({'max-width':'8.3in !important', 'font-size': '75% !important'});	
	
    var elem = document.getElementById('frmMain').elements;
	var x=0;
	disabledItems = new Array();
    for(var i = 0; i < elem.length; i++) {			
		if (elem[i].type != 'hidden') { // && elem[i].type != 'undefined' 
			if (elem[i].type == 'text') {
				if (document.getElementById(elem[i].id).disabled) {
					disabledItems[x] = elem[i].id;
					x++;
				}
			    document.getElementById(elem[i].id).style.height="9px";
				document.getElementById(elem[i].id).style.fontSize="8px";			
				document.getElementById(elem[i].id).disabled = false;
				document.getElementById(elem[i].id).readOnly = true;
				document.getElementById(elem[i].id).style.backgroundColor = '#FFFFFF';
				document.getElementById(elem[i].id).style.color = '#000000';
			}				
			if (elem[i].type == 'radio' || elem[i].type == 'checkbox') { 
				if (document.getElementById(elem[i].id).disabled) {
					disabledItems[x] = elem[i].id;
					x++;
				}
				document.getElementById(elem[i].id).disabled = true;
				document.getElementById(elem[i].id).style.height="10px";
				document.getElementById(elem[i].id).style.fontSize="8px";
			}	
			if(elem[i].type == 'select-one'){
				$( elem[i] ).hide();
				var label = "<div class='labels'>".concat(elem[i].options[elem[i].selectedIndex].innerHTML).concat("&nbsp;</div>");
				$( elem[i] ).after(label);
			}
		}
    }	
	
	$('input').each(function(){
	  if (this.type == 'button') {
		if (this.id != 'test') {
			$(this).addClass('previewButtonClass');
		}	
	  }	
	});	
	
	$('a').each(function(){
		if (this.id.length > 1) {
			d.getElementById(this.id).disabled = true;
		}
	});	

	$('#printMenu').show('blind');
	if ( $('#formMenu').css('display') != 'none' ) {	
		$('#formMenu').hide('blind');
	}	
}	

$(document).ready(function(){    
    $("ul.subnav").parent().append("<span></span>"); //Only shows drop down trigger when js is enabled (Adds empty span tag after ul.subnav*)  
    $("ul.topnav li span").click(function() { //When trigger is clicked...            
        //Following events are applied to the subnav itself (moving subnav up and down)  
        $(this).parent().find("ul.subnav").slideDown('fast').show(); //Drop down the subnav on click    
        $(this).parent().hover(function() {  
        }, function(){    
            $(this).parent().find("ul.subnav").slideUp('slow'); //When the mouse hovers out of the subnav, move it back up  
        });  
        //Following events are applied to the trigger (Hover events for the trigger)  
        }).hover(function() {   
            $(this).addClass("subhover"); //On hover over, add class "subhover"  
        }, function(){  //On Hover Out  
            $(this).removeClass("subhover"); //On hover out, remove class "subhover"  
    });
	$("ul.topnav .toplevel").click(function() { //When trigger is clicked...            
        //Following events are applied to the subnav itself (moving subnav up and down)  
        $(this).parent().find("ul.subnav").slideDown('fast').show(); //Drop down the subnav on click    
        $(this).parent().hover(function() {  
        }, function(){    
            $(this).parent().find("ul.subnav").slideUp('slow'); //When the mouse hovers out of the subnav, move it back up  
        });  
        //Following events are applied to the trigger (Hover events for the trigger)  
        }).hover(function() {   
            $(this).addClass("subhover"); //On hover over, add class "subhover"  
        }, function(){  //On Hover Out  
            $(this).removeClass("subhover"); //On hover out, remove class "subhover"  
    });
	
	$("ul.asubnav").parent().append("<span style='display:none;'></span>"); //Only shows drop down trigger when js is enabled (Adds empty span tag after ul.subnav*)  
    $("ul.atopnav li span").click(function() { //When trigger is clicked...            
        //Following events are applied to the subnav itself (moving subnav up and down)  
        $(this).parent().find("ul.asubnav").slideDown('fast').show(); //Drop down the subnav on click    
        $(this).parent().hover(function() {  
        }, function(){    
            $(this).parent().find("ul.asubnav").slideUp('slow'); //When the mouse hovers out of the subnav, move it back up  
        });  
        //Following events are applied to the trigger (Hover events for the trigger)  
        }).hover(function() {   
            $(this).addClass("subhover"); //On hover over, add class "subhover"  
        }, function(){  //On Hover Out  
            $(this).removeClass("subhover"); //On hover out, remove class "subhover"  
    });
	$("ul.atopnav .atoplevel").click(function() { //When trigger is clicked...            
        //Following events are applied to the subnav itself (moving subnav up and down)  
        $(this).parent().find("ul.asubnav").slideDown('fast').show(); //Drop down the subnav on click    
        $(this).parent().hover(function() {  
        }, function(){    
            $(this).parent().find("ul.asubnav").slideUp('slow'); //When the mouse hovers out of the subnav, move it back up  
        });  
        //Following events are applied to the trigger (Hover events for the trigger)  
        }).hover(function() {   
            $(this).addClass("subhover"); //On hover over, add class "subhover"  
        }, function(){  //On Hover Out  
            $(this).removeClass("subhover"); //On hover out, remove class "subhover"  
    }); 
});

function encrypt(val) {

	//var bf = new Blowfish('i@f0ffl1n3F0rm$');
	//var ciphertext = bf.encrypt(val);

	var ciphertext = Aes.Ctr.encrypt(val, aesPW, 256);
	return ciphertext;
}

function showModalExport() {
		document.getElementById('container').style.display = "none"; //mainContent
		
		document.getElementById('driveSelectTPExport').disabled = false;
		document.getElementById('btnOkExport').disabled = false;
		document.getElementById('btnCancelExport').disabled = false;
		
        $('#modalExport').show('blind');		
}

function cancelExportModal() {  
		if ( $('#modalExport').css('display') != 'none' ) {
			
			document.getElementById('container').style.display = 'block';		
			$('#modalExport').hide('blind');
		}
		
		//refresh HTA page here. to address: 
		//Issue#380: A return tagged as final copy should not be edited by tp, rdo, rdc. Currently, user can still modify entries.
		//document.location.reload(true);
		disableAllElementIDs();
		d.getElementById('btnUpload').disabled = false;
    }
	
function showModalImport() {
        $('#modalImport').show('blind');		
}

function cancelImportModal() {
		if ( $('#modalImport').css('display') != 'none' ) {
			$('#modalImport').hide('blind');
		}
}
function exportTPFiles(fnToExport) {
	try {
        var drive = d.getElementById('driveSelectTPExport').value;
		if (drive=='0') {
		alert("Please select the drive name of your USB flash drive or CD-RW."); return;
		}

		var fso, fldr;
		var sourceDir = "IAF_RDO_Copy/";
		var destDir   = "IAF_RDO_Copy";
		fso = new ActiveXObject("Scripting.FileSystemObject");
		if (fso.FolderExists(sourceDir)) {
			  if (fso.FolderExists(drive+destDir)) {
				   //do nothing here...
			  } else {
				   fso.CreateFolder(drive+destDir); 
			  }	 		  
			  fso.CopyFile(sourceDir+fnToExport, drive+destDir+"/");	 	
		} else {
			  alert("Please insert a recordable media [diskette/universal serial bus (USB) flash drive, compact disc (cd), digital video disc (dvd)] in drive "+drive); return;
		}
	 
		alert("Successfully copied files to "+drive+destDir);
		cancelExportModal();

    } catch(e) {
        alert("There is not enough space in drive "+drive); return;
    }
	 
}
function exportTPFileInC() {
	try {
        var drive = "C:/";
		if (drive=='0') {
			alert("Please select the drive name of your USB flash drive or CD-RW."); return;
		}

		var fso, fldr;
		var sourceDir = "IAF_RDO_Copy/";
		var destDir   = "IAF_RDO_Copy";
		fso = new ActiveXObject("Scripting.FileSystemObject");
		if (fso.FolderExists(sourceDir)) { //TODO: need to trap non-existing drive to avoid : "Error: Path not found"
			  if (fso.FolderExists(drive+destDir)) {
				   //do nothing here...
			  } else {
				   fso.CreateFolder(drive+destDir); //TODO: need to trap non-existing drive to avoid : "Error: Path not found"
			  }	 		  
			  fso.CopyFile(sourceDir+"*", drive+destDir+"/");	 	
		} else {
			  alert("Copy Failed. No such directory: "+sourceDir); return;
		}
	 
		cancelExportModal();

    } catch(e) {
        alert("No such drive or directory."); return;
    }
	 

}
var onExit = false;
function isOnExit() {
	onExit = true;
}
function saveBeforeExit() {
	var y=confirm( "Are you sure you want to exit?" );
	if (y) {
		saveXML(false);
	    // saveXMLProfile(false);
	    try {
	        deleteTemp();
	        window.close(); self.close();
	    }
	    catch (err) {
	        window.close(); self.close();
	    }
	}
}
function ShowContainer(param) {
        $('#' + param ).show();
        //$('#container').hide();
    }

function HideContainer(param) {
        if ($('#' + param).css('display') != 'none') {
            $('#' + param).hide();
        }
    }
		
//Final Copy Button:
function openAlertEmail() {       
	var tinNumber = $('#frm2550q\\:txtTIN1').val() + $('#frm2550q\\:txtTIN2').val() + $('#frm2550q\\:txtTIN3').val();
	conService.initConConfig(tinNumber, '2550Q');
	/*
	if (conService.canSendToEFPS()) {
		//Only '1700', '1701', '1702EX', '1702MX', '1702RT', '2200A', '2200T' are allowed to submit through eFPS
		//this block will never get executed.
		submitEbir();
	} else {
	*/
		//Added 10/21/2016
		var fileSys = new ActiveXObject("Scripting.FileSystemObject");
		var xmlFileNameValidate = "";

		if(document.getElementById('txtFinalFlag').value == '2'){   reSendEmail();  return;  }		
	    var xmlFileName = createXMLFileName("savefile/");
	    var isFileExists = doesFileExists(xmlFileName);
	    var isAmendedReturn = isItAnAmendedReturn();

				//as of 10/21/2016
				//if there is already amended filed and will file a not amended,
				//it will restrict it
				if (isAmendedReturn == false) {
					
					if (xmlFileName.indexOf('V') == -1) {
						xmlFileNameValidate = xmlFileName.substring(xmlFileName.indexOf('/')+1,xmlFileName.indexOf('.xml'));			
					} else {
						xmlFileNameValidate = xmlFileName.substring(xmlFileName.indexOf('/')+1,xmlFileName.indexOf('V'));			
					}
					
					var hasVersion = false;
					var objEnum = new Enumerator(fileSys.GetFolder("savefile/").Files);
					for(i=0;!objEnum.atEnd();objEnum.moveNext()) {
						if (objEnum.item().name.indexOf(xmlFileNameValidate) > -1 && objEnum.item().name.indexOf("V") > -1) {
							hasVersion = true;
						}
					}	
                    			if (hasVersion) {
						if (!onExit)
						alert("If your intention is to make an amended return, kindly tick Amended Return to 'Yes' before hitting 'Save'or 'Final Copy' or 'Submit'.");
						return false;
					}
              			  }
		
	    if (isFileExists) {
	        isAFinalCopy = isItAFinalCopy(xmlFileName);  if(document.getElementById('txtFinalFlag').value == '2'){isAFinalCopy = false;}
	    }

	    if (isFileExists && isAFinalCopy && isAmendedReturn == false && document.getElementById('txtFinalFlag').value != '3') {
	         alert("If your intention is to make an amended return, kindly tick Amended Return to 'Yes' before hitting 'Save' or 'Final Copy' or 'Submit'."); ShowContainer('container');
	        return false;
	    }
		else{
		    if (confirm("Please ensure that you have INTERNET access and a VALID email address is indicated in your tax return.\n\n" +
			       "Are you sure you want to submit?") === true) {
				
				    if (checkNetConnection() === true) {    HideContainer("container");  if(document.getElementById('txtFinalFlag').value == "3"){document.getElementById('txtFinalFlag').value = "2"}else{document.getElementById('txtFinalFlag').value = "0"};    initializeOnOpenAlertEmail();
					    ShowContainer("ebirEnroll");
				    }
				    else {
					    alert("The system detected that you have no internet connection.\nPlease contact your internet service provider."); document.getElementById('txtFinalFlag').value = "3";  saveEncryptedProfile(); checkFinalCopyBtn('2550Q');
					    ShowContainer('container');//alert("There is no internet connection, please make sure that an internet connection is available before making a final copy.");
				    }
		    }
	    }
	//}
}


	
	
	
	function sendEmail(sourceElement) {
	
		var isRegisteredTP = (sourceElement.id !== "ebirOnlineConfirmSubmit") ? "N" : "Y";  if(isRegisteredTP == "Y" && (ValidateConfirm() == false)){return;}
		var isAutoEnroll = (sourceElement.id == "ebirEnrollYes") ? "Y" : "N";
		if(isAutoEnroll == "Y"){
			document.getElementById("txtEnroll").value = "Y";
		}

		document.getElementById("ebirOnlineSecret").value = document.getElementById("ebirOnlinePassword").value;  initializeOnSendEmail();
		
		
		
		
		
		
		
		
	     
		
		var emailFilePath = saveEncryptedProfile(true);
		
		var dateSubmitted = new Date();
		
		var tpRDOCode = document.getElementById('frm2550q:txtRDOCode').value;
		var formType = "2550Q";
		var tpTIN = document.getElementById('frm2550q:txtTIN1').value + document.getElementById('frm2550q:txtTIN2').value + document.getElementById('frm2550q:txtTIN3').value + document.getElementById('frm2550q:txtBranchCode').value;
		var qtr = "";
		if (document.getElementById('frm2550q:OptQuarter1').checked == true) {
			qtr = "Q1";
		}
		if (document.getElementById('frm2550q:OptQuarter2').checked == true) {
			qtr = "Q2";
		}
		if (document.getElementById('frm2550q:OptQuarter3').checked == true) {
			qtr = "Q3";
		}
		if (document.getElementById('frm2550q:OptQuarter4').checked == true) {
			qtr = "Q4";
		}
		var tpMonth = document.getElementById('frm2550q:RtnMonth').value;
		var tpYear = document.getElementById('frm2550q:txtYear').value + qtr;
		
		var fileNameEmail = emailFilePath.substring(emailFilePath.lastIndexOf("\\") + 1, emailFilePath.length);
		var versionNumber = fileNameEmail.lastIndexOf("V") > -1 ? fileNameEmail.substring(fileNameEmail.lastIndexOf("V"), fileNameEmail.lastIndexOf(".")) : "";
		
		//var emailTaxPayer = document.getElementById('frm1702MX:txtPg1Pt1I12Email').value;
		var emailTaxPayer =  document.getElementById('txtEmail').value;
		var emailSubject = tpRDOCode + "_" + formType + "_" + tpTIN + "_" + tpMonth + tpYear + versionNumber;
		
		var emailBody = "Received Email subject to validation of BIR. <br> With attachment '" + fileNameEmail + "' <br> Date and time submitted: " + dateSubmitted +
						" <br><br> TIN: " + tpTIN +
						" <br> Name: " + document.getElementById("frm2550q:TaxPayer").value +
						" <br> Tax Type: Income Tax" +
						" <br> Form Type: " + formType +
						" <br> Return Period: " + tpMonth + "/" + tpYear +
						" <br> <br> Penalties may be imposed for any violation to the provisions of the NIRC and issuances thereof." +
						" <br> <br> FOR RETURNS WITH PAYMENT" +
						" <br> Please print the said email together with the Income Tax Return and then Proceed to Pay in the Authorized Agent Bank / Collection Agent under RDO where registered following existing issuances.";
		
		//alert("BIRSendEmail Initiated");
	
		// Display loader to show that an email is being sent
		$('#loader').css('background', 'transparent'); disableDropDown("before");
		$('#loader').show('blind');
		
			try
			{
				//BIRSendEmail('2550Q@birgovph.org', '2550Q@bir.gov.ph', emailTaxPayer, emailSubject, emailBody, emailFilePath, '2550Q', 'smtp1.birgovph.org', '25', isRegisteredTP);
				var ftpFolder = enviService.getFtpFolder('2550Q');
				var wsData = conService.getConConfig();
				var returnCode = RenameAndSendFile(emailFilePath, emailTaxPayer, ftpFolder, wsData.mode, wsData.srv, wsData.sslport, wsData.port, wsData.usr, wsData.pass); clearFileNameWOemail();
				$('#container').hide();
				if (returnCode == 0) {
					document.getElementById('txtFinalFlag').value = "1";  updateFinalFlagOnSaveFile(fileNameEmail);    alert("Submit Successful. Subject to validation by BIR. \n\n A notification will be sent to your email ("+ emailTaxPayer +"). Please print or save the email as an evidence of efiled return.");
					$('#paymentOption').show();
                    $('#paymentOptionCloseBtn').on('click', function () {
                        $('#paymentOption').hide();
                        $('#container').show();
                    });
				}
				else {
                    document.getElementById('txtFinalFlag').value = "2";  updateFinalFlagOnSaveFile(fileNameEmail);   alert('Your Tax Return was not submitted online due to any of the \n following reasons that may interrupt the submission process: \n - No internet connection \n - Slow internet connection \n - Overly restrictive firewall');
                    $('#container').show();
				}
			}
			catch(e)
			{
					document.getElementById('txtFinalFlag').value = "2";  updateFinalFlagOnSaveFile(fileNameEmail);   alert('Your Tax Return was not submitted online due to any of the \n following reasons that may interrupt the submission process: \n - No internet connection \n - Slow internet connection \n - Overly restrictive firewall');
                    $('#container').show();
			}
			finally
			{
			}
			// Hide loader
		$('#loader').hide('blind');
		 $('#loader').css('background', '#FFF'); checkFinalCopyBtn(formType); disableDropDown("after");
		HideContainer('ebirConfirmOnline');
		ShowContainer('container');
	}
//--------------------------START:  Rollbase REST API using 'create2' and 'setBinaryData' --------------------------
var sessionId;
var respMsg;
var create2Id;

xmlHttp = new XMLHttpRequest(), loginXML = new XMLHttpRequest(), binReturnsUploadXML = new XMLHttpRequest();
/*
var gAdminUser = "";
var gAdminPass = "";

function getAdminUser(val) {
	gAdminUser = val;
}
function getAdminPass(val) {
	gAdminPass = val;
}
function validateAdminLogon() {

	if (gAdminUser.length > 0 && gAdminPass.length > 0) {

		var login = "https://ebirforms.bir.gov.ph:443/rest/api/login?loginName="+gAdminUser+"&password="+gAdminPass;		
		loginXML.open( "GET", login, true);		
		loginXML.send(null); 		

	} else {
		alert("Please provide Username and Password.");
		return;
	}	
}

function gotoAdmin() {
	showModalRollbaseLogin();	
}
function showModalRollbaseLogin() {
		document.getElementById('container').style.display = "none";
        $('#modalRollbaseLogin').show('blind');		
} 
        
function cancelModalRollbaseLogin() {
		if ( $('#modalRollbaseLogin').css('display') != 'none' ) {
			document.getElementById('container').style.display = 'block';	
			$('#modalRollbaseLogin').hide('blind');
		}
}*/

var api,x, gRBSessionId;
	function openLogin() {  document.getElementById('txtFinalFlag').value = '3'
		isSubmit = true;
		isSubmitFinal = true;
		if (gIsReadOnly) { 
			isSubmitFinal = false;
		}
		var hasSavedReturn = saveXMLsubmit(true);
		if (hasSavedReturn) {	
		    var loginURL = geteBIRFormsOnlineLoginURL();
		    x = window.open(loginURL, 'Login_Screen', 'resizable=1,scrollbars=1,height=850,width=900');
		    api = window.setInterval(getAPI, 500);
		}
	}
	function getAPI() {
		try {
			if (x.closed) {
				if (api) {
					if(isSubmitFinal){
						window.clearInterval(api);
						api = null;
						saveXMLsubmit(false);
					}
					else{
						window.clearInterval(api);
						api = null;
						saveXMLsubmit(true);
					}
				}
				return;
			}
			
			if ( $("#response",x.document).length > 0 )
				$("#responsetext").val( $("#response",x.document).val() );
			else return;
			var response = String( $("#responsetext").val() );
			gRBSessionId = response; 
			
			sessionId = gRBSessionId.split('<sessionId>');
			sessionId = String(sessionId[1]);
			sessionId = sessionId.split('</sessionId>');
			sessionId = String(sessionId[0]);				
			//alert('sessionId = '+sessionId);

			if (response.length != 0 && (sessionId != 'undefined' || sessionId != '<?xml ver')) {
				createRecord(); 						
				window.clearInterval(api);
			}
		}
		catch (e) {
			return;
		}
	}
	
/* Commented for logon IAF 
function uploadMe() {	
	saveXML(true);
	gotoAdmin();
}
function uploadMe() {	
	saveXML(true);
	//dgarfin TODO: username/password should not be hard-coded here.  It should verify first if there's an IAF session.  
	//If it has, then supply it with 'loginName' and 'password'.  
	//Otherwise, popup a new window asking user to login to IAF then if logged in successfully, supply credentials to params
	var login = "https://ebirforms.bir.gov.ph:443/rest/api/login?loginName=dgarfin_tester@bir_dev&password=142857";
	loginXML.open( "GET", login, true);
	loginXML.send(null); 
}

loginXML.onreadystatechange = function() { 
    if ( loginXML.readyState == 4 && loginXML.status==200 ) { //Request Complete	
		sessionId = String(loginXML.responseText).split('sessionId');
		sessionId = String(sessionId[1]);
		sessionId = sessionId.substring(1,sessionId.length-2);		
		

		// Commented for logon IAF
		if ( $('#modalRollbaseLogin').css('display') != 'none' ) {
			document.getElementById('container').style.display = 'block';	
			$('#modalRollbaseLogin').hide('blind');
		}///		
		alert("Session ID : '"+sessionId+"' successfully created!");
		createRecord();
	 
	}
	else if ( loginXML.readyState == 3 && loginXML.status!=200 ) {
		//alert('readyState = '+loginXML.readyState+' status = '+loginXML.status);  //2/403;3/403;
		alert('Wrong credentials provided.  Pls try again.');
		return;
	}	
}*/

	xmlFileForCreate2X = new Date();
	//getURL() is defined in string-util.js
	var rbURL = getURL();
function createRecord () {

	createURL = rbURL + "/rest/api/create2?sessionId="+sessionId+"&objName=upload1&tax_due="+p3BasicTax+"&total_penalties="+p3TotalPenalties+"&total_amount_payable="+p3TotalAmountPayable+"&tp_zip="+p3TPZip+"&tp_addr="+p3TPAddress+"&tp_telnum="+p3TPTelNum+"&tp_name="+p3TPName+"&tp_lob="+p3TPLineBus+"&tp_rdo_code="+p3TPRDOCode+"&tp_branch_code="+p3TPBranchCode+"&tp_tin="+p3TPTIN+"&surcharge="+p3Surcharge+"&compromise="+p3Compromise+"&interest="+p3Interest+"&is_amended_return="+p3IsAmended+"&return_period="+p3ReturnPeriod+"&return_period_end="+p3ReturnPeriodEnd+"&useIds=false&form_type_text=2550Q-Feb2007&load="+xmlFileForCreate2X; //FOR create2
 
	xmlHttp.open( "POST", createURL, false);
	xmlHttp.send();

	var respXMLMsg = xmlHttp.responseText; 

	create2Id = respXMLMsg;
	create2Id = create2Id.split('id=');
	create2Id = String(create2Id[1]).replace(/"/gi,'');
	create2Id = String( parseInt(create2Id) ).replace(/ /,'');
	
	//alert("Form ID : '"+create2Id+"' successfully created!");
	x.document.theForm.submit();
	uploadXMLFile(); 

} 

/*xmlHttp.onreadystatechange = function() {
	if ( xmlHttp.readyState == 4 && xmlHttp.status==200 ) { //Request Complete

		var respXMLMsg = xmlHttp.responseText;
		//Get ID of response from Create2
		create2Id = respXMLMsg.substring(respXMLMsg.indexOf('data  id=')+10, respXMLMsg.indexOf(' objName=')-1); //should be at least 8-digit ID here		
		//alert("Form ID : '"+create2Id+"' successfully created!");	

		if (isNaN(create2Id)) {
				//alert('Tax return filing is unsuccessful!');
				x.close();
				openLogin();
		} else {
				//alert("Form ID : '"+create2Id+"' successfully created!");     
				uploadXMLFile();                
		}

	}
}*/

function uploadXMLFile () { 
    var binDataURL;
	
	//Dev Note: frmMainSrc contains the HTML and content of the form
	//frmMainSrc should get the print preview version
	// $('#frmMain').html(); //content of the loop
	printme();

    if (savedReturn != null && savedReturn.length > 0) {
		var intervalCnt = 1000;
	
		var xmlFileForUpload = savedReturn.replace(/&nbsp;/g,"<span style='padding-left:0.25em'> </span>"); 
		xmlFileForUpload = xmlFileForUpload.replace(/&amp;/g,"AND");
		xmlFileForUpload = xmlFileForUpload.replace(/&/g,"_AND_");
		xmlFileForUpload = xmlFileForUpload.replace(/\+/g,"_PLUS_");		
		var savedReturnLen = xmlFileForUpload.length;	

		//Loop Begin - create submit_return_data records, related to Created Upload File - 		
		var numOfSRLoops = Math.ceil(savedReturnLen*1 / intervalCnt);	
		var loopSRCnt = numOfSRLoops+1;
		var startSRPost = 0;
		var endSRPost = intervalCnt;
		var partSRCnt = 1;
		
		for(var i = 0; i < numOfSRLoops; i++) {	
			
			binDataURL = rbURL + "/rest/api/create2?sessionId="+sessionId+"&objName=submit_return_data&useIds=false&index_="+partSRCnt+"&name=2550Q_part"+partSRCnt+"&R95607586="+create2Id+"&content="+xmlFileForUpload.substring(startSRPost, endSRPost);
			var binDataUploadXML = new XMLHttpRequest();
			binDataUploadXML.open( "POST", encodeURI(binDataURL) , false); 
			binDataUploadXML.send();
			
			//xmlFn.writeLine(xmlFileInBase64.substring(startSRPost, endSRPost)+"\n\ncompleted\n\n");			
			//alert('i = '+i+' startSRPost = '+startSRPost+' endSRPost = '+endSRPost);	
			
			startSRPost = startSRPost + intervalCnt;
			if (i == numOfSRLoops-1) {
				endSRPost = savedReturnLen;			
			} else {
				endSRPost = endSRPost + intervalCnt;
			}	
			partSRCnt++;
		}
		//alert("A total of "+loopSRCnt+" iterations are uploaded in 'submit_return_data' object for this form!");	
		cancel();
		disableAllElementIDs();
		 //Open a new page, displaying the created form
		//alert("Finished Loading REST 'create2' request for FORMS object.");
        
        //getDisplayPageURL() is defined in string-util2014.js
		var redirectURL = x.window.location.href;
		var formURL = getDisplayPageURL(redirectURL, create2Id);
		if( parseInt(create2Id) > 0 ) window.open(formURL,'Login_Screen','resizable=1,scrollbars=1,height=850,width=900');
	} else {
		alert("Tax Return file does not exists.  Cannot proceed with submission.");		
		return;
	}
	
//xmlFn.close();		

} 
//--------------------------END:  Rollbase REST API using 'create2' and 'setBinaryData' --------------------------

</script>
