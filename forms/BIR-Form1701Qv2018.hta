<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <HTA:APPLICATION ID="Form1701Qv2018"
        APPLICATIONNAME="1701Qv2018" 
        VERSION="1.0" 
        CAPTION="yes"
        SHOWINTASKBAR="yes"
        ICON="../img/bir_icon.ico"
        SINGLEINSTANCE="YES"
        SYSMENU="NO"
        NAVIGABLE="YES"
        CONTEXTMENU="NO"
        WINDOWSTATE="maximize"
        SCROLLFLAT="YES">	
		<script src='../jq/jquery-1.7.1.min.js'></script>
		<script src='../jq/jquery-ui-1.8.18.custom.min.js'></script>		        
        <link href="../css/styles.css" rel="stylesheet" type="text/css" />
		<link href="../css/print.css" rel="stylesheet" type="text/css" media="print" />		
        <script src='../js/environment.js'></script>
        <script src='../js/string-util.js'></script>
		<script src='../js/string-util2014.js'></script>
		<script src='../js/aes.js'></script>
		<script src='../js/rijndael.js'></script>
		<script src='../js/lz-string-1.0.2.js'></script>
		<script language="VBScript" src="../js/eBIRTools.vbs"></script>	
		
        <title>BIR Form No. 1701Qv2018</title>
    </head>
	<style media="print">
		#printer { display:inline !important; }
	</style>
    <body>

	<ul id="printMenu" class="topnav printButtonClass">  
        <li>
        	<a href="#" class='toplevel printButtonClass' >File</a>
        	<ul class="subnav printButtonClass">  
				<li><a href="#" onclick="window.print();">Print</a></li> 				
				<li><a href="#" onclick="cancel();">Cancel Print</a></li>  
            </ul> 
        </li>  
    </ul>	
    <ul id="formMenu" class="topnav printButtonClass">  
        <li>
        	<a href="#" class='toplevel printButtonClass' >File</a>
        	<ul class="subnav printButtonClass">  
                <li><a href="#" onclick="window.location='../BIRForms.hta?xmlReloadProfile=' + createXMLProfileName() + '&formTyp=1701Qv2018'">Main Screen</a></li>  
                <li><a href="#" onclick="saveXML(false);">Save</a></li>  
				<li><a href="#" onclick="printme();">Print Preview</a></li> 
				<li><a href="#" onclick="isOnExit(); saveBeforeExit();">Exit</a></li>  
            </ul> 
        </li>  
		<li>  
            <a href="#" class='toplevel printButtonClass' >Help</a>
            <style> .asubnav { text-indent:20px; list-style-type:none } </style>
            <ul class="subnav printButtonClass">  
                <li>
                    <ul class="atopnav"> <!--l3--> 
                        <li>
                            <a href="#" class='atoplevel'>Documentary Stamp</a>
                            <ul class="asubnav" style="display:none;">  
                                <li><a href="#" onclick="goToHelpPage('2000');return false">BIR Form 2000</a></li> 
								<li><a href="#" onclick="goToHelpPage('2000v2018');return false">BIR Form 2000v2018</a></li> 
                            </ul> 
                        </li>
                    </ul> <!--l3-->
                    <ul class="atopnav"> <!--l3--> 
                        <li>
                            <a href="#" class='atoplevel'>Excise</a>
                            <ul class="asubnav" style="display:none;">  
                                <li><a href="#" onclick="goToHelpPage('2200A');return false">BIR Form 2200A</a></li> 
                                <li><a href="#" onclick="goToHelpPage('2200P');return false">BIR Form 2200P</a></li> 
                                <li><a href="#" onclick="goToHelpPage('2200S');return false">BIR Form 2200S</a></li> 
                                <li><a href="#" onclick="goToHelpPage('2200T');return false">BIR Form 2200T</a></li> 
                                <li><a href="#" onclick="goToHelpPage('2200AN');return false">BIR Form 2200AN</a></li> 
                                <li><a href="#" onclick="goToHelpPage('2200M');return false">BIR Form 2200M</a></li> 								
                            </ul> 
                        </li>
                    </ul> <!--l3-->
                    <ul class="atopnav"> <!--l3--> 
                        <li>
                            <a href="#" class='atoplevel'>Income</a>
                            <ul class="asubnav" style="display:none;">  
                                <li><a href="#" onclick="goToHelpPage('1701Q');return false">BIR Form 1701Q</a></li> 
                                <li><a href="#" onclick="goToHelpPage('1701Qv2018');return false">BIR Form 1701Qv2018</a></li> 
                                <li><a href="#" onclick="goToHelpPage('1704');return false">BIR Form 1704</a></li> 
                                <li><a href="#" onclick="goToHelpPage('1702Q');return false">BIR Form 1702Q</a></li> 
                            </ul> 
                        </li>
                    </ul> <!--l3-->
                    <ul class="atopnav"> <!--l3--> 
                        <li>
                            <a href="#" class='atoplevel'>ONETT</a>
                            <ul class="asubnav" style="display:none;">  
                                <li><a href="#" onclick="goToHelpPage('1606');return false">BIR Form 1606</a></li> 
                                <li><a href="#" onclick="goToHelpPage('1706');return false">BIR Form 1706</a></li> 
                                <li><a href="#" onclick="goToHelpPage('1707');return false">BIR Form 1707</a></li> 
                                <li><a href="#" onclick="goToHelpPage('1800');return false">BIR Form 1800</a></li> 
                                <li><a href="#" onclick="goToHelpPage('1801');return false">BIR Form 1801</a></li> 
                                <li><a href="#" onclick="goToHelpPage('2000-OT');return false">BIR Form 2000-OT</a></li> 								
                            </ul> 
                        </li>
                    </ul> <!--l3-->
                    <ul class="atopnav"> <!--l3--> 
                        <li>
                            <a href="#" class='atoplevel'>Payment</a>
                            <ul class="asubnav" style="display:none;">  
                                <li><a href="#" onclick="goToHelpPage('0605');return false">BIR Form 0605</a></li> 
                            </ul> 
                        </li>
                    </ul> <!--l3-->
                    <ul class="atopnav"> <!--l3--> 
                        <li>
                            <a href="#" class='atoplevel'>Percentage</a>
                            <ul class="asubnav" style="display:none;">  
                                <li><a href="#" onclick="goToHelpPage('2551');return false">BIR Form 2551Q</a></li> 
								<li><a href="#" onclick="goToHelpPage('2551Qv2018');return false">BIR Form 2551Qv2018</a></li> 
                                <li><a href="#" onclick="goToHelpPage('2551M');return false">BIR Form 2551M</a></li> 
                                <li><a href="#" onclick="goToHelpPage('2552');return false">BIR Form 2552</a></li> 
                                <li><a href="#" onclick="goToHelpPage('2553');return false">BIR Form 2553</a></li> 
                            </ul> 
                        </li>
                    </ul> <!--l3-->
                    <ul class="atopnav"> <!--l3--> 
                        <li>
                            <a href="#" class='atoplevel'>Value Added Tax</a>
                            <ul class="asubnav" style="display:none;">  
                                <li><a href="#" onclick="goToHelpPage('2550M');return false">BIR Form 2550M</a></li> 
                                <li><a href="#" onclick="goToHelpPage('2550Q');return false">BIR Form 2550Q</a></li> 
                            </ul> 
                        </li>
                    </ul> <!--l3-->			
                    <ul class="atopnav"> <!--l3--> 
                        <li>
                            <a href="#" class='atoplevel'>Withholding</a>
                            <ul class="asubnav" style="display:none;">
                                <li><a href="#" onclick="goToHelpPage('0619E');return false">BIR Form 0619E</a></li>
                                <li><a href="#" onclick="goToHelpPage('0619F');return false">BIR Form 0619F</a></li>  
                                <li><a href="#" onclick="goToHelpPage('1601C');return false">BIR Form 1601C</a></li> 
								<li><a href="#" onclick="goToHelpPage('1601Cv2018');return false">BIR Form 1601Cv2018</a></li> 
                                <li><a href="#" onclick="goToHelpPage('1601E');return false">BIR Form 1601E</a></li>
                                <li><a href="#" onclick="goToHelpPage('1601EQ');return false">BIR Form 1601EQ</a></li>
                                <li><a href="#" onclick="goToHelpPage('1601F');return false">BIR Form 1601F</a></li>
                                <li><a href="#" onclick="goToHelpPage('1601FQ');return false">BIR Form 1601FQ</a></li> 
                                <li><a href="#" onclick="goToHelpPage('1602');return false">BIR Form 1602</a></li> 
								<li><a href="#" onclick="goToHelpPage('1602Q');return false">BIR Form 1602Qv2018</a></li> 
                                <li><a href="#" onclick="goToHelpPage('1603');return false">BIR Form 1603</a></li> 
								<li><a href="#" onclick="goToHelpPage('1603Q');return false">BIR Form 1603Qv2018</a></li> 
                                <li><a href="#" onclick="goToHelpPage('1600');return false">BIR Form 1600</a></li> 								
                                <li><a href="#" onclick="goToHelpPage('1600WP');return false">BIR Form 1600WP</a></li> 
                                <li><a href="#" onclick="goToHelpPage('1604CF');return false">BIR Form 1604CF</a></li> 
                                <li><a href="#" onclick="goToHelpPage('1604E');return false">BIR Form 1604E</a></li> 								
                            </ul> 
                        </li>
                    </ul> <!--l3-->						
                </li>
            </ul>  
        </li>
    </ul>
    <!--topnav-->
	<div class="printButtonClass" style="position:fixed; top:10px; font-size:11px; z-index:1000000000000000; right:5px; width:auto;">Government Property Not For Sale</div>
    
    <!--title-->
	<img class="printButtonClass" id="bg" src="../img/bg_n.png" height="100%" align="top"/> <!--watermark-->
		
    <div id='loader'>
		<div id='text'>
			<img src="../img/ajax-loader-1.gif" width="440" height="30" alt="loader" />
		</div>
	</div>
    <style>
		#loader,#text {width:100%; height:100%; top:0;left:0; position:fixed; background:#FFF; z-index:5000; }
		#text { background:none; top:50%; left:50%; right:68%; left:32%; width:440px; overflow:hidden;}
	</style>
	<style>
	.atcNames { font-weight:bold; }
	tr.atc td { border-bottom: 1px #e1e1e1 solid; }
	tr.atc:hover td { background:#FFC; }
	td.atc { padding:4px; }
	.labels { background: #FFF; font-size:9px; width:auto !important; display:inline; height:10px; border:2px inset #FFF; padding:0 2px 0 2px; }
	
	#container {
		margin-top:40px;
	}
	</style>
	<div class='printButtonClass menu'></div>
	<div class='printButtonClass' id='header'>
		<input type='button' class='printButtonClass' value='Main Menu' onclick="window.location = '../BIRForms.hta'; "/>
		<input type='button' class='printButtonClass' value='Save' onclick='saveXML(false);' />
		<input type='button' class='printButtonClass' value='Print' onclick='window.print();' />
		<input type='button' class='printButtonClass' value='Exit' onclick='window.close(); self.close();' />
    </div>	
    <!-- MODAL - Payment Option  -->
    <div id="paymentOption" class="payment-option">
        <div align="center">
            <img src="../img/bir_broadcast_logo.png" alt="bir logo" class="payment-option-content"/>
            <img src="../img/epay_logo.png" alt="bir logo" class="payment-option-content" />
            <br/><br/>
            <span class="payment-option-content">You can now pay electronically through the following channels</span>
            <br/><br/>
            <span class="payment-option-content">
                <a href="https://www.bir.gov.ph/index.php/eservices/epay.html" target="_blank">https://www.bir.gov.ph/index.php/eservices/epay.html</a>
            </span>
            <br/><br/>
        </div>
        <div id="paymentOptionFooter" class="payment-option-footer">
            <input id="paymentOptionCloseBtn" type="button" style="width:120px; height:30px;" value="Close" />
        </div>
    </div>
	<form id="frmMain" name="frmMain">	
        <div id="container">
            <div id="wrapper" style="margin: 0 auto; position: relative; width: 800px; ">
				<table border="0" width="800" cellspacing="0" cellpadding="0" align="center" style="background-image: url(../img/frmbg.png); background-repeat: repeat-x;">
				<tr><td>
                <div id="formPaper">
                    <div id="Page1Content">
                        <table width="800" border="0" cellspacing="0" cellpadding="0">
                            <tr>
                                <td>
                                    <table width="800" border="0" cellspacing="0" cellpadding="0">
                                        <tr>
                                            <td width="300" valign="bottom">
                                                <p><img src="../img/bcs_new.png" width="80" /> </p>
                                            </td>
                                            <td>
                                                <p><img src="../img/header_logo.png" width="210" height="50px" /> </p>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table width="800" border="1" cellspacing="0" cellpadding="0">
                                        <tr>
                                            <td width="120" valign="middle" style="text-align: center;">
                                                <font face="Arial" size="1px">BIR Form No.</font>
                                                <br/><font size="5px" style="font-weight:bold;">1701Q</font>
                                                <br/><font face="Arial" size="1px">January 2018 (ENCS)</font>
                                                <br/><font face="Arial" size="1px" style="font-weight:bold;">Page 1</font>
                                            </td>
                                            <td width="0" valign="center" style="text-align: center;">
                                                <font size="5px" style="font-weight:bold;">Quarterly Income Tax Return</font>
                                                <br/><font size="4px" style="font-weight:bold;">for Individuals, Estates and Trusts</font>
                                                <br><font face="Arial" size="1px">Enter all required information in CAPITAL LETTERS using BLACK ink. Mark all applicable boxes with an "X". Two copies MUST be filed with the BIR and one held by the Tax Filer.</font>
                                            </td>
                                            <td width="200" valign="center">
                                                    <p><img src="../img/1701Q_BarCode/1701Q_p1.png" width="220" height="75px" /> </p>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table width="800" border="0" cellspacing="0" cellpadding="0" class="tblForm">
                                        <tr>
                                            <td width="152" valign="top" class="tblFormTd">
                                                <table width="150" border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td width="11"><font size="2" style="font-weight:bold;">&nbsp;1&nbsp;&nbsp;&nbsp;</font></td>
                                                        <td width="60"><font size="1">For the Year</font></td>
                                                        <td width="60">
                                                            <input type="text" value="" size="4" name="frm1701q:txtYear" maxlength="4" id="frm1701q:txtYear" onblur="blockletterWithout2Decimal(this);computetxt46('taxpayer');validateYear();computetxt46('taxspouse');" onkeypress="return wholenumber(this, event)" />
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                            <td width="260" valign="top" class="tblFormTd">
                                                <table width="249" border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td width="11"><font size="2" style="font-weight:bold;">&nbsp;2&nbsp;&nbsp;&nbsp;</font></td>
                                                        <td width="40"><font size="1">Quarter</font></td>
                                                        <td width="180">
                                                            <fieldset style="font-family: Verdana,Arial,Helvetica; font-size: 8pt;" id="frm1701q:j_id217">
                                                                <table cellspacing="0" cellpadding="0" border="0">
                                                                    <tbody>
                                                                        <tr>
                                                                            <td><input type="radio" value="1" name="frm1701q:DateQuarter" id="frm1701q:DateQuarter_1"/>
                                                                                <label for="frm1701q:DateQuarter_1" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:10px;" >First</label>&nbsp;
                                                                            </td>
                                                                            <td><input type="radio" value="2"  name="frm1701q:DateQuarter" id="frm1701q:DateQuarter_2"  />
                                                                                <label for="frm1701q:DateQuarter_2" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:10px;" >Second</label>&nbsp;
                                                                            </td>
                                                                            <td><input type="radio" value="3"  name="frm1701q:DateQuarter" id="frm1701q:DateQuarter_3" />
                                                                                <label for="frm1701q:DateQuarter_3" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:10px;" >Third</label>&nbsp;
                                                                            </td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </fieldset>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                            <td width="181" valign="top" class="tblFormTd">
                                                <table width="176" border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td width="11"><font size="2" style="font-weight:bold;">&nbsp;3&nbsp;&nbsp;&nbsp;</font></td>
                                                        <td width="60"><font size="1">Amended Return?</font></td>
                                                        <td width="100">
                                                            <fieldset style="font-family: Verdana,Arial,Helvetica; font-size: 8pt;" id="frm1701q:j_id217">
                                                                <table cellspacing="0" cellpadding="0" border="0">
                                                                    <tr>
                                                                        <td><input type="radio" value="Y" name="frm1701q:AmendedRtn" id="frm1701q:AmendedRtn_1" onclick="processAmend();" disabled="disabled" />
                                                                            <label for="frm1701q:AmendedRtn_1" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:10px;" >Yes</label>&nbsp;
                                                                        </td>
                                                                        <td><input type="radio" value="N"  name="frm1701q:AmendedRtn" id="frm1701q:AmendedRtn_2" onclick="processAmend();" disabled="disabled" checked="checked" />
                                                                            <label for="frm1701q:AmendedRtn_2" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:10px;" >No</label>
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </fieldset>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                            <td width="168" valign="top" class="tblFormTd">
                                                <table width="152" border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td width="11"><font size="2" style="font-weight:bold;">&nbsp;4&nbsp;&nbsp;&nbsp;</font></td>
                                                        <td width="80"><font size="1"> Number of Sheet/s Attached</font></td>
                                                        <td width="50" rowspan="2"><input type="text" value="0" style="text-align: right;" size="2" name="frm1701q:txtSheets" maxlength="2" id="frm1701q:txtSheets"  class="iceInpTxt-dis" onkeypress="return wholenumber(this, event)" /></td>
                                                        
                                                    </tr>
                                                </table>
                                            </td>

                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table width="800" border="0" cellspacing="0" cellpadding="0" class="tblForm">
                                        <tr>
                                            <td class="tblFormTdPart" style="border-bottom: #000000 2px solid; border-top: #000000 2px solid;">
                                                <table width="" border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td width="100%">
                                                            <div align="center"><font size="2" style="font-weight:bold;">PART I - BACKGROUND INFORMATION ON TAXPAYER/FILER</font></div>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table width="800" border="0" cellspacing="0" cellpadding="0" class="tblForm">
                                        <tr>
                                            <td width="600" valign="top" class="tblFormTd">
                                                <table width="500" border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td width="11"><font size="2" style="font-weight:bold">&nbsp;5&nbsp;&nbsp;</font></td>
                                                        <td width="180">
                                                            <font size="1">Taxpayer Identification Number (TIN)&nbsp;</font>
                                                        </td>
                                                        <td width="300">
                                                            <font size="2" face="Arial">
                                                                <input type="text" value="" size="3" name="frm1701q:txtTIN1" maxlength="3" id="frm1701q:txtTIN1" onkeypress="return wholenumber(this, event)" />-
                                                                <input type="text" value="" size="3" name="frm1701q:txtTIN2" maxlength="3" id="frm1701q:txtTIN2" onkeypress="return wholenumber(this, event)" />-
                                                                <input type="text" value="" size="3" name="frm1701q:txtTIN3" maxlength="3" id="frm1701q:txtTIN3" onkeypress="return wholenumber(this, event)" />-
                                                                <input type="text" value="" size="5" name="frm1701q:txtBranchCode" maxlength="3" id="frm1701q:txtBranchCode" onkeypress="return letternumber(event)"/>
                                                            </font>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                            <td width="200" valign="top" class="tblFormTd">
                                                <table border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td width="11"><font size="2" style="font-weight:bold">&nbsp;6&nbsp;</font>
                                                        <td width="60"><font size="1">RDO Code</font></td></td>
                                                        <td width="70" nowrap id="rdoSelect">

                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table width="800" border="0" cellspacing="0" cellpadding="0" class="tblForm">
                                        <tr>
                                            <td width="100%" class="tblFormTd">
                                                <table border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td width="11"><font size="2" style="font-weight:bold;">&nbsp;7&nbsp;&nbsp;</font></td>
                                                        <td width="100"><font size="1">Taxpayer/Filer Type</font></td>
                                                        <td width="500">
                                                            <fieldset style="font-family: Verdana,Arial,Helvetica; font-size: 8pt;" id="frm1701q:j_id217">
                                                                <table cellspacing="0" cellpadding="0" border="0" class="iceSelOneRb-dis fieldText1-dis">
                                                                    <tbody>
                                                                        <tr>
                                                                            <td><input type="radio" value="Single" name="frm1701q:optTaxpayerType" id="frm1701q:optType_1" onclick="processTaxType('taxpayer')" />
                                                                                <label for="frm1701q:optType_1" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:10px;" >Single Proprietor</label>&nbsp;
                                                                            </td>
                                                                            <td><input type="radio" value="Professional"  name="frm1701q:optTaxpayerType" id="frm1701q:optType_2" onclick="processTaxType('taxpayer')" />
                                                                                <label for="frm1701q:optType_2" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:10px;" >Professional</label>&nbsp;
                                                                            </td>
                                                                            <td><input type="radio" value="Estate"  name="frm1701q:optTaxpayerType" id="frm1701q:optType_3" onclick="processTaxType('taxpayer')" />
                                                                                <label for="frm1701q:optType_3" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:10px;" >Estate</label>&nbsp;
                                                                            </td>
                                                                            <td><input type="radio" value="Trust"  name="frm1701q:optTaxpayerType" id="frm1701q:optType_4" onclick="processTaxType('taxpayer')" />
                                                                                <label for="frm1701q:optType_4" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:10px;" >Trust</label>&nbsp;
                                                                            </td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </fieldset>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table width="800" border="0" cellspacing="0" cellpadding="0" class="tblForm">
                                        <tr>
                                            <td width="100%" valign="top" class="tblFormTd">
                                                <table border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td width="11"><font size="2" style="font-weight:bold;">&nbsp;8&nbsp;&nbsp;&nbsp;</font></td>
                                                        <td width="149"><font size="1">Alphanumeric Tax Code (ATC)</font></td>
                                                        <td width="213"><input type="radio" value="II012"  name="frm1701q:optATC" id="frm1701q:optATC_1" onclick="processATC('taxpayer')" />
                                                            <label for="frm1701q:optATC_1" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:8px;" >II012 Business Income-Graduated IT Rates</label>&nbsp;
                                                        </td>
                                                        <td width="213"><input type="radio" value="II014"  name="frm1701q:optATC" id="frm1701q:optATC_2" onclick="processATC('taxpayer')" />
                                                            <label for="frm1701q:optATC_2" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:8px;" >II014 Income from Profession-Graduated IT Rates</label>&nbsp;
                                                        </td>
                                                        <td width="213"><input type="radio" value="II013"  name="frm1701q:optATC" id="frm1701q:optATC_3" onclick="processATC('taxpayer')" />
                                                            <label for="frm1701q:optATC_3" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:8px;" >II013 Mixed Income-Graduated IT Rates</label>&nbsp;
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>&nbsp;</td>
                                                        <td>&nbsp;</td>
                                                        <td><input type="radio" value="II015"  name="frm1701q:optATC" id="frm1701q:optATC_4" onclick="processATC('taxpayer')" />
                                                            <label for="frm1701q:optATC_4" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:8px;" >II015 Business Income-8% IT Rate</label>&nbsp;
                                                        </td>
                                                        <td><input type="radio" value="II017"  name="frm1701q:optATC" id="frm1701q:optATC_5" onclick="processATC('taxpayer')" />
                                                            <label for="frm1701q:optATC_5" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:8px;" >II017 Income from Profession-8% IT Rate</label>&nbsp;
                                                        </td>
                                                        <td><input type="radio" value="II016"  name="frm1701q:optATC" id="frm1701q:optATC_6" onclick="processATC('taxpayer')" />
                                                            <label for="frm1701q:optATC_6" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:8px;" >II016 Mixed Income-8% IT Rate</label>&nbsp;
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table width="800" border="0" cellspacing="0" cellpadding="0" class="tblForm">
                                        <tr>
                                            <td width="100%" valign="top" class="tblFormTd">
                                                <table border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td width="11"><font size="2" style="font-weight:bold;">&nbsp;9&nbsp;</font></td>
                                                        <td><font size="1">Taxpayer/Filer's Name </font><font style="font-size:8px">(Last Name, First Name, Middle Name for Individual)/ESTATE of (First Name, Middle Name, Last Name)/TRUST FAO:(First Name, Middle Name, Last Name)</font></td>
                                                    </tr>
                                                    <tr>
                                                        <td width="25">&nbsp;</td>
                                                        <td><input type="text" value="" size="120" name="frm1701q:txtTaxpayerName" maxlength="50" id="frm1701q:txtTaxpayerName" onblur="return capital(this, event)" disabled /></td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table width="800" border="0" cellspacing="0" cellpadding="0" class="tblForm">
                                        <tr>
                                            <td width="100%" valign="top" class="tblFormTd" colspan="2">
                                                <table border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td>
                                                            <table border="0" cellspacing="0" cellpadding="0">
                                                                <tr>
                                                                    <td width="11"><font size="2" style="font-weight:bold;">&nbsp;10&nbsp;&nbsp;</font></td>
                                                                    <td><font size="1">Registered Address </font><font style="font-size:8px">(Indicate complete address. If branch, indicate the branch address. If the registered address is different from the current address, go to the RDO to update registered address by using BIR Form No. 1905)</font></td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <table border="0" cellspacing="0" cellpadding="0">
                                                                <tr>
                                                                    <td width="25">&nbsp;</td>
                                                                    <td><input type="text" value="" size="120" maxlength="100" id="frm1701q:txtAddress" onblur = "return capital(this, event)" disabled /></td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td width="600" valign="top" class="tblFormTd">
                                                <table border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                            <td width="25">&nbsp;</td>
                                                        <td>
                                                                <input type="text" value="" size="85" maxlength="50" id="frm1701q:txtAddress2" onblur = "return capital(this, event)" disabled />
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                            <td width="198" class="tblFormTd">
                                                <table border="0" cellpadding="0" cellspacing="0">
                                                    <tr>
                                                        <td width="11"><font size="2" style="font-weight:bold;">&nbsp;10A&nbsp;</font></td>
                                                        <td width="60">
                                                            <font size="1">Zip Code</font>
                                                        </td>
                                                        <td>
                                                            <div align="center">
                                                                <input type="text" value="" size="4" name="frm1701q:txtZipCode" maxlength="4" id="frm1701q:txtZipCode" onkeypress="return wholenumber(this, event)" disabled />
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table width="800" border="0" cellspacing="0" cellpadding="0" class="tblForm">
                                        <tr>
                                            <td width="200" valign="top" class="tblFormTd">
                                                <table border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td width="11"><font size="2" style="font-weight:bold;">&nbsp;11&nbsp;</font></td>
                                                        <td width="142"><font size="1">Date of Birth (MM/DD/YYYY)</font></td>
                                                    </tr>
                                                    <tr>
                                                        <td width="25">&nbsp;</td>
                                                        <td width="153" nowrap>
                                                            <div align="left">&nbsp;<font size="2" face="Arial, Helvetica, sans-serif">
                                                                    <input id="frm1701q:txtBirthMonth" maxlength="2" name="frm1701:txt121"  size="1"  type="text" onkeypress="return wholenumber(this, event)" />
                                                                    <input maxlength="2" id="frm1701q:txtBirthDay" size="1"  type="text" onkeypress="return wholenumber(this, event)" />
                                                                    <input id="frm1701q:txtBirthYear" maxlength="4" name="frm1701:txt123"  size="2"  type="text" onkeypress="return wholenumber(this, event)" />
                                                            </font></div>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                            <td width="600" valign="top" class="tblFormTd">
                                                <table border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td width="11"><font size="2" style="font-weight:bold;">&nbsp;12&nbsp;</font></td>
                                                        <td width="142"><font size="1">Email Address</font></td>
                                                    </tr>
                                                    <tr>
                                                        <td width="25">&nbsp;</td>
                                                        <td>
                                                            <input type="text" value="" size="87" name="txtEmail" maxlength="60" id="txtEmail" disabled="true" />
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table width="800" border="0" cellspacing="0" cellpadding="0" class="tblForm">
                                        <tr>
                                            <td width="200" valign="top" class="tblFormTd">
                                                <table border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td width="11"><font size="2" style="font-weight:bold;">&nbsp;13&nbsp;</font></td>
                                                        <td width="142"><font size="1">Citizenship</font></td>
                                                    </tr>
                                                    <tr>
                                                        <td width="25">&nbsp;</td>
                                                        <td width="153">
                                                            <input type="text" value="" id="frm1701q:txtCitizenship" maxlength="20" onkeypress="" onblur="return capital(this, event)" />
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                            <td width="200" valign="top" class="tblFormTd">
                                                <table border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td width="11"><font size="2" style="font-weight:bold;">&nbsp;14&nbsp;</font></td>
                                                        <td width="182"><font size="1">Foreign Tax Number (if applicable)</font></td>
                                                    </tr>
                                                    <tr>
                                                        <td width="25">&nbsp;</td>
                                                        <td width="153">
                                                            <input type="text" value="" id="frm1701q:txtForeignTaxNumber" maxlength="20" onkeypress="return letternumber(event)" onblur="" />
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                            <td width="200" valign="top" class="tblFormTd">
                                                <table border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td width="11"><font size="2" style="font-weight:bold;">&nbsp;15&nbsp;</font></td>
                                                        <td width="152"><font size="1">Claiming Foreign Tax Credits?</font></td>
                                                    </tr>
                                                    <tr>
                                                        <td width="25">&nbsp;</td>
                                                        <td width="153">
                                                            <fieldset style="font-family: Verdana,Arial,Helvetica; font-size: 8pt;" id="frm1701q:j_id217">
                                                                <table cellspacing="0" cellpadding="0" border="0">
                                                                    <tr>
                                                                        <td><input type="radio" value="Y" name="frm1701q:optForeignTaxCredits" id="frm1701q:optForeignTaxCredits_1" onclick="" />
                                                                            <label for="frm1701q:optForeignTaxCredits_1" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:10px;" >Yes</label>&nbsp;
                                                                        </td>
                                                                        <td><input type="radio" value="N"  name="frm1701q:optForeignTaxCredits" id="frm1701q:optForeignTaxCredits_2" onclick="" />
                                                                            <label for="frm1701q:optForeignTaxCredits_2" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:10px;" >No</label>
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </fieldset>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table width="800" border="0" cellspacing="0" cellpadding="0" class="tblForm">
                                        <tr>
                                            <td class="tblFormTd">
                                                <table>
                                                    <tr>
                                                        <td width="50" rowspan="2">
                                                                <font size="2" style="font-weight:bold;">&nbsp;16&nbsp;&nbsp;&nbsp;</font>
                                                                <font size="1">Tax Rate* (choose one, for income from business/ profession)</font>
                                                        </td>
                                                        <td width="750">
                                                            <table border="0" cellspacing="0" cellpadding="0">
                                                                <tr>
                                                                    <td width="250">
                                                                        <input type="radio" value="Graduated"  name="frm1701q:optTaxRate" id="frm1701q:optTaxRate_1" onclick="enableSchedule1('taxpayer');ItemizedDeduct();" />
                                                                        <label for="frm1701q:optTaxRate_1" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:10px;" >Graduated Rates per Tax Table -page 2 (Choose Method of Deduction in Item 16A)</label>
                                                                    </td>
                                                                    <td  width="500" valign="top" style="border-bottom: #AAAAAA 1px solid; border-left: #AAAAAA 1px solid;">
                                                                        <table>
                                                                            <tr>
                                                                                <td width="11"><font size="2" style="font-weight:bold;">&nbsp;16A&nbsp;</font></td>
                                                                                <td width="489" colspan="2"><font size="1">Method of Deduction</font></td>
                                                                            </tr>
                                                                            <tr valign="top">
                                                                                <td>&nbsp;</td>
                                                                                <td width="239">
                                                                                    <input type="radio" value="I"  name="frm1701q:optMethodOfDeduction" id="frm1701q:optMethodOfDeduction:_1" onclick="ItemizedDeduct()" />
                                                                                    <label for="frm1701q:optMethodOfDeduction:_1" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:10px;" >Itemized Deduction [Sec. 34(A-J), NIRC]</label>
                                                                                </td>
                                                                                <td width="250">
                                                                                    <input type="radio" value="O"  name="frm1701q:optMethodOfDeduction" id="frm1701q:optMethodOfDeduction:_2" onclick="OptionalDeduct()" />
                                                                                    <label for="frm1701q:optMethodOfDeduction:_2" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:10px;" >Optional Standard Deduction (OSD) [40% of Gross Sales/Receipts/Revenues/Fees [Sec. 34(L), NIRC]]</label>
                                                                                </td>
                                                                            </tr>
                                                                        </table>
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td width="750">
                                                                <input type="radio" value="Percentage"  name="frm1701q:optTaxRate" id="frm1701q:optTaxRate_2" onclick="enableSchedule2('taxpayer')" />
                                                                <label for="frm1701q:optTaxRate_2" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:10px;" >8% on gross sales/receipts & other non-operating income in lieu of Graduated Rates under Sec. 24(A)(2)(a) & Percentage Tax under Sec. 116 of the NIRC, 
                                                                    as amended [available if gross sales/receipts and other non-operating income do not exceed Three million pesos (P3M)]</label>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table width="800" border="0" cellspacing="0" cellpadding="0" class="tblForm">
                                        <tr>
                                            <td class="tblFormTdPart" style="border-bottom: #000000 2px solid; border-top: #000000 2px solid;">
                                                <table width="" border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td width="100%">
                                                            <div align="center"><font size="2" style="font-weight:bold;">PART II - BACKGROUND INFORMATION ON SPOUSE</font><font size="1">(if applicable)</font></div>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table width="800" border="0" cellspacing="0" cellpadding="0" class="tblForm">
                                        <tr>
                                            <td width="600" valign="top" class="tblFormTd">
                                                <table width="500" border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td width="10"><font size="2" style="font-weight:bold">&nbsp;17&nbsp;&nbsp;</font></td>
                                                        <td width="180">
                                                            <font size="1">Spouse's TIN </font>
                                                        </td>
                                                        <td width="300">
                                                            <font size="2" face="Arial">
                                                                <input type="text" value="" size="2" name="frm1701q:txtSpouseTIN1" maxlength="3" id="frm1701q:txtSpouseTIN1" onkeypress="return wholenumber(this, event)" />-
                                                                <input type="text" value="" size="2" name="frm1701q:txtSpouseTIN2" maxlength="3" id="frm1701q:txtSpouseTIN2" onkeypress="return wholenumber(this, event)" />-
                                                                <input type="text" value="" size="2" name="frm1701q:txtSpouseTIN3" maxlength="3" id="frm1701q:txtSpouseTIN3" onkeypress="return wholenumber(this, event)" />-
                                                                <input type="text" value="" size="5" name="frm1701q:txtSpouseBranchCode" maxlength="3" id="frm1701q:txtSpouseBranchCode" onkeypress="return letternumber(event)"/>
                                                            </font>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                            <td width="198" valign="top" class="tblFormTd">
                                                <table border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td width="11"><font size="2" style="font-weight:bold">&nbsp;18&nbsp;</font>
                                                        <td width="60"><font size="1">RDO Code</font></td></td>
                                                        <td width="70" nowrap id="rdoSelect2">

                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table width="800" border="0" cellspacing="0" cellpadding="0" class="tblForm">
                                        <tr>
                                            <td width="100%" class="tblFormTd">
                                                <table border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td width="11"><font size="2" style="font-weight:bold;">&nbsp;19&nbsp;&nbsp;</font></td>
                                                        <td width="100"><font size="1">Filer's Spouse Type</font></td>
                                                        <td width="500">
                                                            <fieldset style="font-family: Verdana,Arial,Helvetica; font-size: 8pt;" id="frm1701q:j_id217">
                                                                <table cellspacing="0" cellpadding="0" border="0" class="iceSelOneRb-dis fieldText1-dis">
                                                                    <tbody>
                                                                        <tr>
                                                                            <td><input type="radio" value="Single" name="frm1701q:optSpouseType_1" id="frm1701q:optSpouseType_1" onclick="clearCheck('frm1701q:optSpouseType_1');processTaxType('taxspouse');" waschecked="true" />
                                                                                <label for="frm1701q:optSpouseType_1" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:10px;" >Single Proprietor</label>&nbsp;
                                                                            </td>
                                                                            <td><input type="radio" value="Professional"  name="frm1701q:optSpouseType_2" id="frm1701q:optSpouseType_2" onclick="clearCheck('frm1701q:optSpouseType_2');processTaxType('taxspouse');" waschecked="true" />
                                                                                <label for="frm1701q:optSpouseType_2" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:10px;" >Professional</label>&nbsp;
                                                                            </td>
                                                                            <td><input type="radio" value="Compensation"  name="frm1701q:optSpouseType_3" id="frm1701q:optSpouseType_3" onclick="clearCheck('frm1701q:optSpouseType_3');processTaxType('taxspouse');" waschecked="true" />
                                                                                <label for="frm1701q:optSpouseType_3" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:10px;" >Compensation Earner</label>&nbsp;
                                                                            </td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </fieldset>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table width="800" border="0" cellspacing="0" cellpadding="0" class="tblForm">
                                        <tr>
                                            <td width="100%" valign="top" class="tblFormTd">
                                                <table border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td width="11"><font size="2" style="font-weight:bold;">&nbsp;20&nbsp;&nbsp;&nbsp;</font></td>
                                                        <td width="19"><font size="1">ATC</font></td>
                                                        <td width="213"><input type="radio" value="II012"  name="frm1701q:optSpouseATC" id="frm1701q:optSpouseATC_1" onclick="processATC('taxspouse')" />
                                                            <label for="frm1701q:optSpouseATC_1" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:8px;" >II012 Business Income-Graduated IT Rates</label>&nbsp;
                                                        </td>
                                                        <td width="213"><input type="radio" value="II014"  name="frm1701q:optSpouseATC" id="frm1701q:optSpouseATC_2" onclick="processATC('taxspouse')" />
                                                            <label for="frm1701q:optSpouseATC_2" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:8px;" >II014 Income from Profession-Graduated IT Rates</label>&nbsp;
                                                        </td>
                                                        <td width="213"><input type="radio" value="II013"  name="frm1701q:optSpouseATC" id="frm1701q:optSpouseATC_3" onclick="processATC('taxspouse')" />
                                                            <label for="frm1701q:optSpouseATC_3" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:8px;" >II013 Mixed Income-Graduated IT Rates</label>&nbsp;
                                                        </td>
                                                        <td width="130"><input type="radio" value="II011"  name="frm1701q:optSpouseATC" id="frm1701q:optSpouseATC_4" onclick="processATC('taxspouse')" />
                                                            <label for="frm1701q:optSpouseATC_4" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:8px;" >II011 Compensation Income</label>&nbsp;
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>&nbsp;</td>
                                                        <td>&nbsp;</td>
                                                        <td><input type="radio" value="II015"  name="frm1701q:optSpouseATC" id="frm1701q:optSpouseATC_5" onclick="processATC('taxspouse')" />
                                                            <label for="frm1701q:optSpouseATC_5" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:8px;" >II015 Business Income-8% IT Rate</label>&nbsp;
                                                        </td>
                                                        <td><input type="radio" value="II017"  name="frm1701q:optSpouseATC" id="frm1701q:optSpouseATC_6" onclick="processATC('taxspouse')" />
                                                            <label for="frm1701q:optSpouseATC_6" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:8px;" >II017 Income from Profession-8% IT Rate</label>&nbsp;
                                                        </td>
                                                        <td><input type="radio" value="II016"  name="frm1701q:optSpouseATC" id="frm1701q:optSpouseATC_7" onclick="processATC('taxspouse')" />
                                                            <label for="frm1701q:optSpouseATC_7" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:8px;" >II016 Mixed Income-8% IT Rate</label>&nbsp;
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table width="800" border="0" cellspacing="0" cellpadding="0" class="tblForm">
                                        <tr>
                                            <td width="100%" valign="top" class="tblFormTd">
                                                <table border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td width="11"><font size="2" style="font-weight:bold;">&nbsp;21&nbsp;</font></td>
                                                        <td><font size="1">Spouse's Name </font><font style="font-size:8px">(Last Name, First Name, Middle Name)</font></td>
                                                    </tr>
                                                    <tr>
                                                        <td width="25">&nbsp;</td>
                                                        <td><input type="text" value="" size="120" name="frm1701q:txtSpouseName" maxlength="50" id="frm1701q:txtSpouseName" onblur="return capital(this, event)" /></td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table width="800" border="0" cellspacing="0" cellpadding="0" class="tblForm">
                                        <tr>
                                            <td width="200" valign="top" class="tblFormTd">
                                                <table border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td width="11"><font size="2" style="font-weight:bold;">&nbsp;22&nbsp;</font></td>
                                                        <td width="142"><font size="1">Citizenship</font></td>
                                                    </tr>
                                                    <tr>
                                                        <td width="25">&nbsp;</td>
                                                        <td width="153">
                                                            <input type="text" value="" id="frm1701q:txtSpouseCitizenship" maxlength="20" onkeypress="" onblur="return capital(this, event)" />
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                            <td width="200" valign="top" class="tblFormTd">
                                                <table border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td width="11"><font size="2" style="font-weight:bold;">&nbsp;23&nbsp;</font></td>
                                                        <td width="182"><font size="1">Foreign Tax Number, if applicable </font></td>
                                                    </tr>
                                                    <tr>
                                                        <td width="25">&nbsp;</td>
                                                        <td width="153">
                                                            <input type="text" value="" id="frm1701q:txtSpouseForeignTaxNum" maxlength="20" onkeypress="return letternumber(event)" onblur="" />
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                            <td width="200" valign="top" class="tblFormTd">
                                                <table border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td width="11"><font size="2" style="font-weight:bold;">&nbsp;24&nbsp;</font></td>
                                                        <td width="152"><font size="1">Claiming Foreign Tax Credits?</font></td>
                                                    </tr>
                                                    <tr>
                                                        <td width="25">&nbsp;</td>
                                                        <td width="153">
                                                            <fieldset style="font-family: Verdana,Arial,Helvetica; font-size: 8pt;" id="frm1701q:j_id217">
                                                                <table cellspacing="0" cellpadding="0" border="0">
                                                                    <tr>
                                                                        <td><input type="radio" value="Y" name="frm1701q:optSpouseForeignTaxCred" id="frm1701q:optSpouseForeignTaxCred_1" onclick="" />
                                                                            <label for="frm1701q:optSpouseForeignTaxCred_1" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:10px;" >Yes</label>&nbsp;
                                                                        </td>
                                                                        <td><input type="radio" value="N"  name="frm1701q:optSpouseForeignTaxCred" id="frm1701q:optSpouseForeignTaxCred_2" onclick="" />
                                                                            <label for="frm1701q:optSpouseForeignTaxCred_2" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:10px;" >No</label>
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </fieldset>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table width="800" border="0" cellspacing="0" cellpadding="0" class="tblForm">
                                        <tr>
                                            <td class="tblFormTd">
                                                <table>
                                                    <tr>
                                                        <td width="50" rowspan="2">
                                                                <font size="2" style="font-weight:bold;">&nbsp;25&nbsp;&nbsp;&nbsp;</font>
                                                                <font size="1">Tax Rate* (choose one, for income from business/ profession)</font>
                                                        </td>
                                                        <td width="750">
                                                            <table border="0" cellspacing="0" cellpadding="0">
                                                                <tr>
                                                                    <td width="250">
                                                                        <input type="radio" value="Graduated"  name="frm1701q:optSpouseTaxRate" id="frm1701q:optSpouseTaxRate_1" onclick="enableSchedule1('taxspouse');ItemizedDeductSpouse();" />
                                                                        <label for="frm1701q:optSpouseTaxRate_1" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:10px;" >Graduated Rates per Tax Table -page 2 (Choose Method of Deduction in Item 25A)</label>
                                                                    </td>
                                                                    <td  width="500" valign="top" style="border-bottom: #AAAAAA 1px solid; border-left: #AAAAAA 1px solid;">
                                                                        <table>
                                                                            <tr>
                                                                                <td width="11"><font size="2" style="font-weight:bold;">&nbsp;25A&nbsp;</font></td>
                                                                                <td width="489" colspan="2"><font size="1">Method of Deduction</font></td>
                                                                            </tr>
                                                                            <tr valign="top">
                                                                                <td>&nbsp;</td>
                                                                                <td width="239">
                                                                                    <input type="radio" value="I"  name="frm1701q:optSpouseMethod" id="frm1701q:optSpouseMethod:_1" onclick="ItemizedDeductSpouse()" />
                                                                                    <label for="frm1701q:optSpouseMethod:_1" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:10px;" >Itemized Deduction [Sec. 34(A-J), NIRC]</label>
                                                                                </td>
                                                                                <td width="250">
                                                                                    <input type="radio" value="O"  name="frm1701q:optSpouseMethod" id="frm1701q:optSpouseMethod:_2" onclick="OptionalDeductSpouse()" />
                                                                                    <label for="frm1701q:optSpouseMethod:_2" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:10px;" >Optional Standard Deduction (OSD) [40% of Gross Sales/Receipts/Revenues/Fees [Sec. 34(L), NIRC]]</label>
                                                                                </td>
                                                                            </tr>
                                                                        </table>
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td width="750">
                                                                <input type="radio" value="Percentage"  name="frm1701q:optSpouseTaxRate" id="frm1701q:optSpouseTaxRate_2" onclick="enableSchedule2('taxspouse')" />
                                                                <label for="frm1701q:optSpouseTaxRate_2" class="iceSelOneRb-dis fieldText1-dis-dis" style="font-size:10px;" >8% on gross sales/receipts & other non-operating income in lieu of Graduated Rates under Sec. 24(A)(2)(a) & Percentage Tax under Sec. 116 of the NIRC, 
                                                                    as amended [available if gross sales/receipts and other non-operating income do not exceed Three million pesos (P3M)]</label>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table width="800" border="0" cellspacing="0" cellpadding="0" class="tblForm">
                                        <tr>
                                            <td class="tblFormTdPart" style="border-bottom: #000000 2px solid; border-top: #000000 2px solid;">
                                                <table width="" border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td width="100%">
                                                            <div align="center"><font size="2" style="font-weight:bold;">PART III - TOTAL TAX PAYABLE </font><font style="font-size:8px;">(DO NOT enter Centavos; 49 Centavos or less drop down; 50 or more round up)</font></div>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table width="800" border="0" cellspacing="0" cellpadding="0" class="tblForm">
                                        <tr>
                                            <td class="tblFormTd">
                                                <table width="100%" border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td width="26">&nbsp;</td>
                                                        <td width="324" align="center"><font size="2" style="font-weight:bold; text-align: right;">Particulars</font></td>
                                                        <td width="195" align="center"><font size="2" style="font-weight:bold; text-align: right;">A) Taxpayer/Filer</font></td>
                                                        <td width="194" align="center"><font size="2" style="font-weight:bold; text-align: right;">B) Spouse</font></td>
                                                    </tr>											
                                                    <tr>
                                                        <td width="26"><font size="2" style="font-weight:bold;">&nbsp;26&nbsp;&nbsp;</font></td>
                                                        <td width="324"><font size="1" face="Arial, Helvetica, sans-serif">Tax Due </font><font style="font-size: 8px;"><a href="javascript:void(0)" id="btnNavigatePage2_1" class="xsmallItalic"  onclick="processNext()">(From Part V, Schedule 1-Item 46 OR Schedule II-Item 54)</a></font></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">26A</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm1701q:txt26A" onkeypress="return wholenumber(this, event)" disabled />
                                                            </span></td>

                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">26B</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20"  maxlength="25" id="frm1701q:txt26B" onkeypress="return wholenumber(this, event)" disabled />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td><font size="2" style="font-weight:bold;">&nbsp;27&nbsp;</font></td>
                                                        <td class="padder"><font size="1" face="Arial, Helvetica, sans-serif">Less: Tax Credits/Payments </font><font style="font-size: 8px;"><a href="javascript:void(0)" id="btnNavigatePage2_2" class="xsmallItalic"  onclick="processNext()">(From Part V, Schedule III-Item 62)</a></font></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">27A</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20"  maxlength="25" id="frm1701q:txt27A" onkeypress="return wholenumber(this, event)" disabled />
                                                            </span></td>
                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">27B</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm1701q:txt27B" onkeypress="return wholenumber(this, event)" disabled />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td><font size="2" style="font-weight:bold;">&nbsp;28</font></td>
                                                        <td><font size="1" face="Arial, Helvetica, sans-serif">Tax Payable/(Overpayment) </font><font style="font-size: 8px;">(Item 26 Less Item 27)<a href="javascript:void(0)" id="btnNavigatePage2_3" class="xsmallItalic"  onclick="processNext()">(From Part V, Item 63) </a></font></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">28A</font>&nbsp;
                                                                <input type="text" value="0.00" style="text-align: right;" size="20" maxlength="25" id="frm1701q:txt28A" disabled />
                                                            </span></td>
                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">28B</font>&nbsp;
                                                                <input type="text" value="0.00" style="text-align: right;" size="20" maxlength="25" id="frm1701q:txt28B" disabled />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td><font size="2" style="font-weight:bold;">&nbsp;29</font></td>
                                                        <td class="padder"><font size="1" face="Arial, Helvetica, sans-serif">Add: Total Penalties </font><font style="font-size: 8px;"><a href="javascript:void(0)" id="btnNavigatePage2_4" class="xsmallItalic"  onclick="processNext()">(From Part V, Schedule IV-Item 67)</a></font></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">29A</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20"  maxlength="25" id="frm1701q:txt29A" onkeypress="return wholenumber(this, event)" disabled />
                                                            </span></td>
                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">29B</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm1701q:txt29B" onkeypress="return wholenumber(this, event)" disabled />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td><font size="2" style="font-weight:bold;">&nbsp;30</font></td>
                                                        <td><font size="1" face="Arial, Helvetica, sans-serif">Total Amount Payable/(Overpayment) </font><font style="font-size: 8px;">(Sum of Items 28 and 29)<a href="javascript:void(0)" id="btnNavigatePage2_5" class="xsmallItalic"  onclick="processNext()">(From Part V, Item 68)</a></font></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">30A</font>&nbsp; 
                                                                <input type="text" value="0.00" style="text-align: right;" size="20"  maxlength="25" id="frm1701q:txt30A" disabled />
                                                            </span></td>
                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">30B</font>&nbsp;
                                                                <input type="text" value="0.00" style="text-align: right;" size="20"  maxlength="25" id="frm1701q:txt30B" disabled />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td><font size="2" style="font-weight:bold;">&nbsp;31&nbsp;</font></td>
                                                        <td class="padder"><font size="1" face="Arial, Helvetica, sans-serif">Aggregate Amount Payable/(Overpayment) </font><font style="font-size: 8px;">(Sum of Items 30A and 30B)</font></td>
                                                        <td colspan="2" align="center"><span class="spacePadder"><font size="2" style="font-weight:bold;">&nbsp;</font>
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20"  maxlength="25" id="frm1701q:txt31" onkeypress="return wholenumber(this, event)" disabled />
                                                            </span></td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table width="800" border="1" cellspacing="0" cellpadding="0" style="font-family:arial; font-size:10px; text-align: center; vertical-align: top; table-layout: fixed;">
                                        <col width="25%" />
                                        <col width="25%" />
                                        <col width="25%" />
                                        <col width="25%" />
                                        <tr>
                                            <td colspan="4" style="text-align: left; ">&nbsp;&nbsp;&nbsp;&nbsp;I declare under the penalties of perjury that this remittance return, and all its attachments, have been made in good faith, verified by me, and to the best of my knowledge and belief, are 
                                                true and correct, pursuant to the provisions of the National Internal Revenue Code, as amended, and the regulations issued under authority thereof. Further, I give my consent to the processing of my information as contemplated under the *Data Privacy 
                                                Act of 2012 (R.A. No. 10173) for legitimate and lawful purposes. (If Authorized Representative, attach authorization letter and indicate TIN)<br></td>
                                            </tr>
                                            <tr>
                                            <td colspan="4" style="text-align: center; ">
                                                <br><br><br>__________________________________________________________________
                                                <br>Signature and Printed Name of Taxpayer/Authorized Representative/Tax Agent
                                                <br>(Indicate Title/Designation and TIN)
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table width="800" border="0" cellspacing="0" cellpadding="0" class="tblForm">
                                        <tr>
                                            <td class="tblFormTdPart" style="border-bottom: #000000 2px solid; border-top: #000000 2px solid;">
                                                <table width="" border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td width="100%">
                                                            <div align="center"><font size="2" style="font-weight:bold;">PART IV - DETAILS OF PAYMENT</font></div>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table width="800" border="0" cellspacing="0" cellpadding="0" class="tblForm">
                                        <tr>
                                            <td valign="top" class="tblFormTd">
                                                <table border="1" cellpadding="0" cellspacing="0" width="100%" class="tblForm">
                                                    <tr>
                                                        <td width="20%"><div align="center"><font size="1" style="font-weight:bold;">Particulars </font></div></td>
                                                        <td width="15%"><div align="center"><font size="1" style="font-weight:bold;">Drawee Bank/Agency </font></div></td>
                                                        <td width="20%"><div align="center"><font size="1" style="font-weight:bold;">Number </font></div></td>
                                                        <td width="20%"><div align="center"><font size="1" style="font-weight:bold;">Date (MM/DD/YYYY) </font></div></td>
                                                        <td width="25%"><div align="center"><font size="1" style="font-weight:bold;">Amount </font></div></td>
                                                    </tr>
                                                    <tr>
                                                        <td><font size="2" style="font-weight:bold;">&nbsp;32&nbsp;&nbsp;&nbsp;</font><font size="1">Cash/Bank Debit Memo </font></td>
                                                        <td align="center"><input type="text" value="" size="20" name="frm1701q:txtAgency32" maxlength="50" id="frm1701q:txtAgency32" disabled="true"  /></td>
                                                        <td align="center"><input type="text" value="" size="20" name="frm1701q:txtNumber32" maxlength="50" id="frm1701q:txtNumber32" disabled="true"  /></td>
                                                        <td align="center"><input type="text" value="" size="20" name="frm1701q:txtDate32" maxlength="10" id="frm1701q:txtDate32" onkeypress="return dateOnly(event, false);" onkeydown="dateMasking(this);" onblur="validateDate(this);" disabled="true" /></td>
                                                        <td align="center"><input type="text" value="" style="text-align: right" size="20" name="frm1701q:txtAmount32" maxlength="50" id="frm1701q:txtAmount32" onkeypress="return numbersonly(this, event)" onblur="round(this,2);" disabled="true" /></td>
                                                    </tr>
                                                    <tr>
                                                        <td><font size="2" style="font-weight:bold;">&nbsp;33&nbsp;&nbsp;&nbsp;</font><font size="1">Check </font></td>
                                                        <td align="center"><input type="text" value="" size="20" name="frm1701q:txtAgency33" maxlength="50" id="frm1701q:txtAgency33" disabled="true" /></td>
                                                        <td align="center"><input type="text" value="" size="20" name="frm1701q:txtNumber33" maxlength="50" id="frm1701q:txtNumber33" disabled="true" /></td>
                                                        <td align="center"><input type="text" value="" size="20" name="frm1701q:txtDate33" maxlength="10" id="frm1701q:txtDate33" onkeypress="return dateOnly(event, false);" onkeydown="dateMasking(this);" onblur="validateDate(this);" disabled="true" /></td>
                                                        <td align="center"><input type="text" value="" style="text-align: right" size="20" name="frm1701q:txtAmount33" maxlength="50" id="frm1701q:txtAmount33" onkeypress="return numbersonly(this, event)" onblur="round(this,2);" disabled="true" /></td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="2"><font size="2" style="font-weight:bold;">&nbsp;34&nbsp;&nbsp;&nbsp;</font><font size="1">Tax Debit Memo </font></td>
                                                        <td align="center"><input type="text" value="" size="20" name="frm1701q:txtNumber34" maxlength="50" id="frm1701q:txtNumber34" disabled="true" /></td>
                                                        <td align="center"><input type="text" value="" size="20" name="frm1701q:txtDate34" maxlength="10" id="frm1701q:txtDate34" onkeypress="return dateOnly(event, false);" onkeydown="dateMasking(this);" onblur="validateDate(this);" disabled="true" /></td>
                                                        <td align="center"><input type="text" value="" style="text-align: right" size="20" name="frm1701q:txtAmount34" maxlength="50" id="frm1701q:txtAmount34" onkeypress="return numbersonly(this, event)" onblur="round(this,2);" disabled="true" /></td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="5"><font size="2" style="font-weight:bold;">&nbsp;35&nbsp;&nbsp;&nbsp;</font><font size="1">Others (specify) </font></td>
                                                    </tr>
                                                    <tr>
                                                        <td><input type="text" value="" size="20" name="frm1701q:txtParticular35" maxlength="50" id="frm1701q:txtParticular35" disabled="true" /></td>
                                                        <td align="center"><input type="text" value="" size="20" name="frm1701q:txtAgency35" maxlength="50" id="frm1701q:txtAgency35" disabled="true" /></td>
                                                        <td align="center"><input type="text" value="" size="20" name="frm1701q:txtNumber35" maxlength="50" id="frm1701q:txtNumber35" disabled="true" /></td>
                                                        <td align="center"><input type="text" value="" size="20" name="frm1701q:txtDate35" maxlength="10" id="frm1701q:txtDate35" onkeypress="return dateOnly(event, false);" onkeydown="dateMasking(this);" onblur="validateDate(this);" disabled="true" /></td>
                                                        <td align="center"><input type="text" value="" style="text-align: right" size="20" name="frm1701q:txtAmount35" maxlength="50" id="frm1701q:txtAmount35" onkeypress="return numbersonly(this, event)" onblur="round(this,2);" disabled="true" /></td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <!--<div class="imgClass" align='center' style="width:800px !important;">-->
                                    <table border="1" width="800" cellspacing="0" cellpadding="0" style="font-size:10px; text-align: left; vertical-align: top;">
                                    <tr>
                                        <td width="57%">Machine Validation/Revenue Official Receipt Details (If not filed with an Authorized Agent Bank)<br /><br /><br /><br /><br /><br /><br /></td>
                                        <td width="43%">Stamp of Receiving Office/AAB and Date of Receipt (RO's Signature/Bank Teller's Initial)<br /><br /><br /><br /><br /><br /><br /></td>
                                    </tr>
                                    </table>
                                    <!--</div>-->
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <p>
                                        <font style="font-size:8px;">* I understand that this choice is irrevocable for this taxable year. However, the 8% Income Tax (IT) Rate option if initially selected shall automatically be changed to graduated IT rates 
                                        when taxpayer's gross sales/receipts and other non-operating income exceed Three million pesos (P3M) <br>
                                    </font>
                                    </p>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div id="Page2Content" style="display:none;">
                        <table width="800" border="0" cellspacing="0" cellpadding="0">
                            <tr>
                                <td>
                                    <table width="800" border="0" cellspacing="0" cellpadding="0">
                                        <tr>
                                            <td width="300" valign="bottom">
                                                <p><img src="../img/bcs_new.png" width="80" /> </p>
                                            </td>
                                            <td>
                                                <p><img src="../img/header_logo.png" width="210" height="50px" /> </p>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table width="800" border="1" cellspacing="0" cellpadding="0">
                                        <tr>
                                            <td width="120" valign="middle" style="text-align: center;">
                                                <font face="Arial" size="1px">BIR Form No.</font>
                                                <br/><font size="5px" style="font-weight:bold;">1701Q</font>
                                                <br/><font face="Arial" size="1px">January 2018 (ENCS)</font>
                                                <br/><font face="Arial" size="1px" style="font-weight:bold;">Page 2</font>
                                            </td>
                                            <td width="0" valign="center" style="text-align: center;">
                                                <font size="5px" style="font-weight:bold;">Quarterly Income Tax Return</font>
                                                <br/><font size="4px" style="font-weight:bold;">for Individuals, Estates and Trusts</font>
                                            </td>
                                            <td width="200" valign="center">
                                                    <p><img src="../img/1701Q_BarCode/1701Q_p2.png" width="220" height="75px" /> </p>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table width="800" border="1" cellspacing="0" cellpadding="0" class="tblForm">
                                        <tr>
                                            <td width="40%"><font size="1" face="Arial, Helvetica, sans-serif">TIN</font></td>
                                            <td width="60%"><font size="1" face="Arial, Helvetica, sans-serif">Taxpayer/Filer's Last Name</font></td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <font size="2" face="Arial">
                                                    <input type="text" value="" size="3" name="frm1701q:txtPg2TIN1" maxlength="3" id="frm1701q:txtPg2TIN1" onkeypress="return wholenumber(this, event)" disabled />
                                                    <input type="text" value="" size="3" name="frm1701q:txtPg2TIN2" maxlength="3" id="frm1701q:txtPg2TIN2" onkeypress="return wholenumber(this, event)" disabled />
                                                    <input type="text" value="" size="3" name="frm1701q:txtPg2TIN3" maxlength="3" id="frm1701q:txtPg2TIN3" onkeypress="return wholenumber(this, event)" disabled />
                                                    <input type="text" value="" size="5" name="frm1701q:txtPg2BranchCode" maxlength="5" id="frm1701q:txtPg2BranchCode" onkeypress="return letternumber(event)" disabled />
                                                </font>
                                            </td>
                                            <td><input type="text" value="" size="80" name="frm1701q:txtPg2TaxpayerName" maxlength="50" id="frm1701q:txtPg2TaxpayerName" onblur="return capital(this, event)" disabled /></td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table width="800" border="0" cellspacing="0" cellpadding="0" class="tblForm">
                                        <tr>
                                            <td class="tblFormTdPart" style="border-bottom: #000000 2px solid; border-top: #000000 2px solid;">
                                                <table width="" border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td width="100%">
                                                            <div align="center"><font size="2" style="font-weight:bold;">PART V - COMPUTATION OF TAX DUE </font><font style="font-size:8px;">(DO NOT enter Centavos; 49 Centavos or less drop down; 50 or more round up)</font></div>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table width="800" border="0" cellspacing="0" cellpadding="0" class="tblForm">
                                        <tr>
                                            <td class="tblFormTd">
                                                <table width="100%" border="0" cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td colspan="4">
                                                            <table width="100%" border="0" cellspacing="0" cellpadding="0">
                                                                <tr>
                                                                    <td width="350" align="center"><font size="2" style="font-weight:bold; text-align: right;">Declaration this Quarter</font></td>
                                                                    <td width="195" align="center"><font size="2" style="font-weight:bold; text-align: right;">A) Taxpayer/Filer</font></td>
                                                                    <td width="194" align="center"><font size="2" style="font-weight:bold; text-align: right;">B) Spouse</font></td>
                                                                </tr>
                                                                <tr>
                                                                    <td colspan="3" class="tblFormTd"><font size="1" style="font-weight:bold; text-align: right;">If graduated rate, fill in items 36 to 46; if 8%, fill in items 47 to 54</font></td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="4" class="tblFormTdPart" style="border-bottom: #000000 2px solid; border-top: #000000 2px solid;">
                                                            <div><font size="1" style="font-weight:bold;">Schedule I </font><font size= "1">- For Graduated IT Rate</font></div>
                                                        </td>
                                                    </tr>											
                                                    <tr>
                                                        <td width="26"><font size="2" style="font-weight:bold;">&nbsp;36&nbsp;&nbsp;</font></td>
                                                        <td width="324"><font size="1" face="Arial, Helvetica, sans-serif">Sales/Revenues/Receipts/Fees </font><font style="font-size: 8px;">(net of sales returns, allowances and discounts)</font></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">36A</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm1701q:txt36A" onblur="round(this,2);computetxt38('taxpayer');computetxt40('taxpayer');" onkeypress="return wholenumber(this, event)" disabled />
                                                            </span></td>

                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">36B</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20"  maxlength="25" id="frm1701q:txt36B" onblur="round(this,2);computetxt38('taxspouse');computetxt40('taxspouse');" onkeypress="return wholenumber(this, event)" disabled />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td><font size="2" style="font-weight:bold;">&nbsp;37&nbsp;&nbsp;</font></td>
                                                        <td class="padder"><font size="1" face="Arial, Helvetica, sans-serif">Less: Cost of Sales/Services </font><font style="font-size: 8px;">(applicable only if availing Itemized Deductions)</font></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">37A</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20"  maxlength="25" id="frm1701q:txt37A" onblur="round(this,2);computetxt38('taxpayer');" onkeypress="return wholenumber(this, event)" disabled />
                                                            </span></td>
                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">37B</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm1701q:txt37B" onblur="round(this,2);computetxt38('taxspouse');" onkeypress="return wholenumber(this, event)" disabled />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td><font size="2" style="font-weight:bold;">&nbsp;38&nbsp;&nbsp;</font></td>
                                                        <td><font size="1" face="Arial, Helvetica, sans-serif">Gross Income/(Loss) from Operation </font><font style="font-size: 8px;">(Item 36 Less Item 37) </font></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">38A</font>&nbsp;
                                                                <input type="text" value="0.00" style="text-align: right;" size="20" maxlength="25" id="frm1701q:txt38A" disabled />
                                                            </span></td>
                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">38B</font>&nbsp;
                                                                <input type="text" value="0.00" style="text-align: right;" size="20" maxlength="25" id="frm1701q:txt38B" disabled />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td class="spacePadder">&nbsp;</td>
                                                        <td colspan="3"><font size="1" face="Arial, Helvetica, sans-serif">Less: Allowable Deductions </font></td>
                                                    </tr>
                                                    <tr>
                                                        <td class="spacePadder">&nbsp;</td>
                                                        <td class="padder"><font size="2" style="font-weight:bold;">&nbsp;39&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Total Allowable Itemized Deductions </font></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">39A</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20"  maxlength="25" id="frm1701q:txt39A" onblur="round(this,2);computetxt41('taxpayer');" onkeypress="return wholenumber(this, event)" disabled />
                                                            </span></td>
                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">39B</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm1701q:txt39B"  onblur="round(this,2);computetxt41('taxspouse');" onkeypress="return wholenumber(this, event)" disabled />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td class="spacePadder">&nbsp;</td>
                                                        <td colspan="3" align>
                                                            <div style="padding-left: 75px;">
                                                                <font size="1" face="Arial, Helvetica, sans-serif" style="font-weight:bold;"> OR </font>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td class="spacePadder">&nbsp;</td>
                                                        <td class="padder"><font size="2" style="font-weight:bold;">&nbsp;40&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Optional Standard Deduction (OSD) </font><font style="font-size: 8px;">(40% of Item 36) </font></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">40A</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20"  maxlength="25" id="frm1701q:txt40A" onblur="round(this,2);" onkeypress="return wholenumber(this, event)" disabled />
                                                            </span></td>
                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">40B</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm1701q:txt40B"  onblur="round(this,2);" onkeypress="return wholenumber(this, event)" disabled />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td><font size="2" style="font-weight:bold;">&nbsp;41</font></td>
                                                        <td><font size="1" face="Arial, Helvetica, sans-serif">Net Income/(Loss) This Quarter </font><font style="font-size: 8px;">(Item 38 Less Either Item 39 OR 40) </font></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">41A</font>&nbsp; 
                                                                <input type="text" value="0.00" style="text-align: right;" size="20"  maxlength="25" id="frm1701q:txt41A" disabled />
                                                            </span></td>
                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">41B</font>&nbsp;
                                                                <input type="text" value="0.00" style="text-align: right;" size="20"  maxlength="25" id="frm1701q:txt41B" disabled />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td class="spacePadder">&nbsp;</td>
                                                        <td class="padder"><font size="1" face="Arial, Helvetica, sans-serif">Add: </font><font size="2" style="font-weight:bold;">&nbsp;42&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Taxable Income/(Loss) Previous Quarter/s </font></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">42A</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20"  maxlength="25" id="frm1701q:txt42A" onblur="round(this,2);computetxt45('taxpayer');" onkeypress="return numbersWithNegative(this, event)" disabled />
                                                            </span></td>
                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">42B</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm1701q:txt42B"  onblur="round(this,2);computetxt45('taxspouse');" onkeypress="return numbersWithNegative(this, event)" disabled />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td class="spacePadder">&nbsp;</td>
                                                        <td class="padder">
                                                            <table border="0" cellspacing="0" cellpadding="0">
                                                                <tr>
                                                                    <td class="spacePadder">&nbsp;</td>
                                                                    <td><font size="1" face="Arial, Helvetica, sans-serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font size="2" style="font-weight:bold;">&nbsp;43&nbsp;&nbsp;</font><font size="1" face="Arial, Helvetica, sans-serif">Non-Operating Income </font><font style="font-size: 8px;">(specify) </font>
                                                                    <input type="text" value="" maxlength="25" size="20" id="frm1701q:txt43Desc" disabled />
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">43A</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20"  maxlength="25" id="frm1701q:txt43A" onblur="round(this,2);computetxt45('taxpayer');" onkeypress="return wholenumber(this, event)" disabled />
                                                            </span></td>
                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">43B</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm1701q:txt43B"  onblur="round(this,2);computetxt45('taxspouse');" onkeypress="return wholenumber(this, event)" disabled />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td class="spacePadder">&nbsp;</td>
                                                        <td class="padder">
                                                            <table border="0" cellspacing="0" cellpadding="0">
                                                                <tr>
                                                                    <td class="spacePadder">&nbsp;</td>
                                                                    <td><font size="1" face="Arial, Helvetica, sans-serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font size="2" style="font-weight:bold;">&nbsp;44&nbsp;&nbsp;</font><font face="Arial, Helvetica, sans-serif" style="font-size:8px;">Amount Received/Share in Income by a Partner from General Professional Partnership (GPP) </font></td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">44A</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20"  maxlength="25" id="frm1701q:txt44A" onblur="round(this,2);computetxt45('taxpayer');" onkeypress="return wholenumber(this, event)" disabled />
                                                            </span></td>
                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">44B</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm1701q:txt44B"  onblur="round(this,2);computetxt45('taxspouse');" onkeypress="return wholenumber(this, event)" disabled />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td><font size="2" style="font-weight:bold;">&nbsp;45</font></td>
                                                        <td><font size="1" face="Arial, Helvetica, sans-serif" style="font-weight:bold;">Total Taxable Income/(Loss) To Date </font><font style="font-size: 8px;">(Sum of Items 41 to 44) </font></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">45A</font>&nbsp; 
                                                                <input type="text" value="0.00" style="text-align: right;" size="20"  maxlength="25" id="frm1701q:txt45A" disabled />
                                                            </span></td>
                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">45B</font>&nbsp;
                                                                <input type="text" value="0.00" style="text-align: right;" size="20"  maxlength="25" id="frm1701q:txt45B" disabled />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td><font size="2" style="font-weight:bold;">&nbsp;46</font></td>
                                                        <td><font size="1" face="Arial, Helvetica, sans-serif" style="font-weight:bold;">Tax Due </font><font style="font-size: 8px;">(Item 45 x Applicable Tax Rate based on Tax Table below)<a href="javascript:void(0)" id="btnNavigatePage1_1" class="xsmallItalic"  onclick="processPrev()">(To Part III, Item 26) </a></font></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">46A</font>&nbsp; 
                                                                <input type="text" value="0.00" style="text-align: right;" size="20"  maxlength="25" id="frm1701q:txt46A" disabled />
                                                            </span></td>
                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">46B</font>&nbsp;
                                                                <input type="text" value="0.00" style="text-align: right;" size="20"  maxlength="25" id="frm1701q:txt46B" disabled />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="4" class="tblFormTdPart" style="border-bottom: #000000 2px solid; border-top: #000000 2px solid;">
                                                            <div><font size="1" style="font-weight:bold;">Schedule II </font><font size= "1">- For 8% IT Rate</font></div>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td width="26"><font size="2" style="font-weight:bold;">&nbsp;47&nbsp;&nbsp;</font></td>
                                                        <td width="324"><font size="1" face="Arial, Helvetica, sans-serif">Sales/Revenues/Receipts/Fees </font><font style="font-size: 8px;">(net of sales returns, allowances and discounts)</font></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">47A</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm1701q:txt47A" onblur="round(this,2);computetxt49('taxpayer');" onkeypress="return wholenumber(this, event)" disabled />
                                                            </span></td>

                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">47B</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20"  maxlength="25" id="frm1701q:txt47B" onblur="round(this,2);computetxt49('taxspouse');" onkeypress="return wholenumber(this, event)" disabled />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td width="26"><font size="2" style="font-weight:bold;">&nbsp;48&nbsp;&nbsp;</font></td>
                                                        <td class="padder"><font size="1" face="Arial, Helvetica, sans-serif">Add: Non-Operating Income </font><font style="font-size: 8px;">(specify) </font>
                                                            <input type="text" value="" maxlength="25" size="20" id="frm1701q:txt48Desc" disabled />
                                                        </td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">48A</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20"  maxlength="25" id="frm1701q:txt48A" onblur="round(this,2);computetxt49('taxpayer');" onkeypress="return wholenumber(this, event)" disabled />
                                                            </span></td>
                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">48B</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm1701q:txt48B"  onblur="round(this,2);computetxt49('taxspouse');" onkeypress="return wholenumber(this, event)" disabled />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td><font size="2" style="font-weight:bold;">&nbsp;49</font></td>
                                                        <td><font size="1" face="Arial, Helvetica, sans-serif">Total Income for the quarter </font><font style="font-size: 8px;">(Sum of Items 47 and 48) </font></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">49A</font>&nbsp; 
                                                                <input type="text" value="0.00" style="text-align: right;" size="20"  maxlength="25" id="frm1701q:txt49A" disabled />
                                                            </span></td>
                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">49B</font>&nbsp;
                                                                <input type="text" value="0.00" style="text-align: right;" size="20"  maxlength="25" id="frm1701q:txt49B" disabled />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td width="26"><font size="2" style="font-weight:bold;">&nbsp;50&nbsp;&nbsp;</font></td>
                                                        <td width="324"><font size="1" face="Arial, Helvetica, sans-serif">Add: Total Taxable Income/(Loss) Previous Quarter </font><font style="font-size: 8px;">(Item 51 of previous quarter)</font></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">50A</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm1701q:txt50A" onblur="round(this,2);computetxt51('taxpayer');" onkeypress="return numbersWithNegative(this, event)" disabled />
                                                            </span></td>

                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">50B</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20"  maxlength="25" id="frm1701q:txt50B" onblur="round(this,2);computetxt51('taxspouse');" onkeypress="return numbersWithNegative(this, event)" disabled />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td><font size="2" style="font-weight:bold;">&nbsp;51</font></td>
                                                        <td><font size="1" face="Arial, Helvetica, sans-serif">Cumulative Taxable Income/(Loss) as of This Quarter </font><font style="font-size: 8px;">(Sum of Items 49 and 50) </font></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">51A</font>&nbsp; 
                                                                <input type="text" value="0.00" style="text-align: right;" size="20"  maxlength="25" id="frm1701q:txt51A" disabled />
                                                            </span></td>
                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">51B</font>&nbsp;
                                                                <input type="text" value="0.00" style="text-align: right;" size="20"  maxlength="25" id="frm1701q:txt51B" disabled />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td width="26"><font size="2" style="font-weight:bold;">&nbsp;52&nbsp;&nbsp;</font></td>
                                                        <td width="324">
                                                            <table width="324" border="0" cellspacing="0" cellpadding="0">
                                                                <tr>
                                                                    <td width="24"><font size="1" face="Arial, Helvetica, sans-serif">Less: </font></td>
                                                                    <td width="300"><font style="font-size:8px;"> Allowable reduction from gross sales/receipts and other non-operating income of purely self-employed individuals and/or professionals in the amount of P250,000 </font></td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">52A</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm1701q:txt52A" onblur="round(this,2);item52Validate('taxpayer');computetxt53('taxpayer');" onkeypress="return wholenumber(this, event)" disabled />
                                                            </span></td>

                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">52B</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20"  maxlength="25" id="frm1701q:txt52B" onblur="round(this,2);item52Validate('taxspouse');computetxt53('taxspouse');" onkeypress="return wholenumber(this, event)" disabled />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td><font size="2" style="font-weight:bold;">&nbsp;53</font></td>
                                                        <td><font size="1" face="Arial, Helvetica, sans-serif" style="font-weight:bold;">Taxable Income/(Loss) To Date </font><font style="font-size: 8px;">(Items 51 Less Item 52) </font></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">53A</font>&nbsp; 
                                                                <input type="text" value="0.00" style="text-align: right;" size="20"  maxlength="25" id="frm1701q:txt53A" disabled />
                                                            </span></td>
                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">53B</font>&nbsp;
                                                                <input type="text" value="0.00" style="text-align: right;" size="20"  maxlength="25" id="frm1701q:txt53B" disabled />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td><font size="2" style="font-weight:bold;">&nbsp;54</font></td>
                                                        <td><font size="1" face="Arial, Helvetica, sans-serif" style="font-weight:bold;">Tax Due </font><font style="font-size: 8px;">(Item 53 x 8% Tax Rate)<a href="javascript:void(0)" id="btnNavigatePage1_2" class="xsmallItalic"  onclick="processPrev()">(To Part III, Item 26) </a></font></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">54A</font>&nbsp; 
                                                                <input type="text" value="0.00" style="text-align: right;" size="20"  maxlength="25" id="frm1701q:txt54A" disabled />
                                                            </span></td>
                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">54B</font>&nbsp;
                                                                <input type="text" value="0.00" style="text-align: right;" size="20"  maxlength="25" id="frm1701q:txt54B" disabled />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="4" class="tblFormTdPart" style="border-bottom: #000000 2px solid; border-top: #000000 2px solid;">
                                                            <div><font size="1" style="font-weight:bold;">Schedule III </font><font size= "1">- Tax Credits/Payments </font></div>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td width="26"><font size="2" style="font-weight:bold;">&nbsp;55&nbsp;&nbsp;</font></td>
                                                        <td width="324"><font size="1" face="Arial, Helvetica, sans-serif">Prior Year's Excess Credits </font></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">55A</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm1701q:txt55A" onblur="round(this,2);computetxt62('taxpayer');" onkeypress="return wholenumber(this, event)" />
                                                            </span></td>

                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">55B</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20"  maxlength="25" id="frm1701q:txt55B" onblur="round(this,2);computetxt62('taxspouse');" onkeypress="return wholenumber(this, event)" />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td width="26"><font size="2" style="font-weight:bold;">&nbsp;56&nbsp;&nbsp;</font></td>
                                                        <td width="324"><font size="1" face="Arial, Helvetica, sans-serif">Tax Payment/s for the Previous Quarter/s </font></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">56A</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm1701q:txt56A" onblur="round(this,2);computetxt62('taxpayer');" onkeypress="return wholenumber(this, event)" />
                                                            </span></td>

                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">56B</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20"  maxlength="25" id="frm1701q:txt56B" onblur="round(this,2);computetxt62('taxspouse');" onkeypress="return wholenumber(this, event)" />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td width="26"><font size="2" style="font-weight:bold;">&nbsp;57&nbsp;&nbsp;</font></td>
                                                        <td width="324"><font size="1" face="Arial, Helvetica, sans-serif">Creditable Tax Withheld for the Previous Quarter/s </font></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">57A</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm1701q:txt57A" onblur="round(this,2);computetxt62('taxpayer');" onkeypress="return wholenumber(this, event)" />
                                                            </span></td>

                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">57B</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20"  maxlength="25" id="frm1701q:txt57B" onblur="round(this,2);computetxt62('taxspouse');" onkeypress="return wholenumber(this, event)" />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td width="26"><font size="2" style="font-weight:bold;">&nbsp;58&nbsp;&nbsp;</font></td>
                                                        <td width="324"><font size="1" face="Arial, Helvetica, sans-serif">Creditable Tax Withheld per BIR Form No. 2307 for this Quarter </font></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">58A</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm1701q:txt58A" onblur="round(this,2);computetxt62('taxpayer');" onkeypress="return wholenumber(this, event)" />
                                                            </span></td>

                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">58B</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20"  maxlength="25" id="frm1701q:txt58B" onblur="round(this,2);computetxt62('taxspouse');" onkeypress="return wholenumber(this, event)" />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td width="26"><font size="2" style="font-weight:bold;">&nbsp;59&nbsp;&nbsp;</font></td>
                                                        <td width="324"><font size="1" face="Arial, Helvetica, sans-serif">Tax Paid in Return Previously Filed, if this is an Amended Return </font></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">59A</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm1701q:txt59A" onblur="round(this,2);computetxt62('taxpayer');" onkeypress="return wholenumber(this, event)" />
                                                            </span></td>

                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">59B</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20"  maxlength="25" id="frm1701q:txt59B" onblur="round(this,2);computetxt62('taxspouse');" onkeypress="return wholenumber(this, event)" />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td width="26"><font size="2" style="font-weight:bold;">&nbsp;60&nbsp;&nbsp;</font></td>
                                                        <td width="324"><font size="1" face="Arial, Helvetica, sans-serif">Foreign Tax Credits, if applicable </font></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">60A</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm1701q:txt60A" onblur="round(this,2);computetxt62('taxpayer');" onkeypress="return wholenumber(this, event)" />
                                                            </span></td>

                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">60B</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20"  maxlength="25" id="frm1701q:txt60B" onblur="round(this,2);computetxt62('taxspouse');" onkeypress="return wholenumber(this, event)" />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td width="26"><font size="2" style="font-weight:bold;">&nbsp;61&nbsp;&nbsp;</font></td>
                                                        <td width="324"><font size="1" face="Arial, Helvetica, sans-serif">Other Tax Credits/Payments </font><font style="font-size:8px;">(specify) </font><input type="text" value="" maxlength="25" size="20" id="frm1701q:txt61Desc"></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">61A</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm1701q:txt61A" onblur="round(this,2);computetxt62('taxpayer');" onkeypress="return wholenumber(this, event)" />
                                                            </span></td>

                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">61B</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20"  maxlength="25" id="frm1701q:txt61B" onblur="round(this,2);computetxt62('taxspouse');" onkeypress="return wholenumber(this, event)" />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td><font size="2" style="font-weight:bold;">&nbsp;62</font></td>
                                                        <td><font size="1" face="Arial, Helvetica, sans-serif">Total Tax Credits/Payments </font><font style="font-size: 8px;">(Sum of Items 55 to 61)<a href="javascript:void(0)" id="btnNavigatePage1_3" class="xsmallItalic"  onclick="processPrev()">(To Part III, Item 27) </a></font></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">62A</font>&nbsp; 
                                                                <input type="text" value="0.00" style="text-align: right;" size="20"  maxlength="25" id="frm1701q:txt62A" disabled />
                                                            </span></td>
                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">62B</font>&nbsp;
                                                                <input type="text" value="0.00" style="text-align: right;" size="20"  maxlength="25" id="frm1701q:txt62B" disabled />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="4" class="tblFormTdPart" style="border-top: #000000 2px solid;">
                                                            <table width="800" cellspacing="0" cellpadding="0">
                                                                <tr>
                                                                    <td><font size="2" style="font-weight:bold;">&nbsp;63</font></td>
                                                                    <td><font size="1" face="Arial, Helvetica, sans-serif" style="font-weight:bold;">Tax Payable/(Overpayment) </font><font style="font-size: 8px;">(Item 46 or 54, Less Item 62)<a href="javascript:void(0)" id="btnNavigatePage1_4" class="xsmallItalic"  onclick="processPrev()">(To Part III, Item 28) </a></font></td>
                                                                    <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">63A</font>&nbsp; 
                                                                            <input type="text" value="0.00" style="text-align: right;" size="20"  maxlength="25" id="frm1701q:txt63A" disabled />
                                                                        </span></td>
                                                                    <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">63B</font>&nbsp;
                                                                            <input type="text" value="0.00" style="text-align: right;" size="20"  maxlength="25" id="frm1701q:txt63B" disabled />
                                                                        </span></td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="4" class="tblFormTdPart" style="border-bottom: #000000 2px solid; border-top: #000000 2px solid;">
                                                            <div><font size="1" style="font-weight:bold;">Schedule IV </font><font size= "1">- Penalties </font></div>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td width="26"><font size="2" style="font-weight:bold;">&nbsp;64&nbsp;&nbsp;</font></td>
                                                        <td width="324"><font size="1" face="Arial, Helvetica, sans-serif">Surcharge </font></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">64A</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm1701q:txt64A" onblur="round(this,2);computetxt67('taxpayer');" onkeypress="return wholenumber(this, event)" />
                                                            </span></td>

                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">64B</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20"  maxlength="25" id="frm1701q:txt64B" onblur="round(this,2);computetxt67('taxspouse');" onkeypress="return wholenumber(this, event)" />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td width="26"><font size="2" style="font-weight:bold;">&nbsp;65&nbsp;&nbsp;</font></td>
                                                        <td width="324"><font size="1" face="Arial, Helvetica, sans-serif">Interest </font></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">65A</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm1701q:txt65A" onblur="round(this,2);computetxt67('taxpayer');" onkeypress="return wholenumber(this, event)" />
                                                            </span></td>

                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">65B</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20"  maxlength="25" id="frm1701q:txt65B" onblur="round(this,2);computetxt67('taxspouse');" onkeypress="return wholenumber(this, event)" />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td width="26"><font size="2" style="font-weight:bold;">&nbsp;66&nbsp;&nbsp;</font></td>
                                                        <td width="324"><font size="1" face="Arial, Helvetica, sans-serif">Compromise </font></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">66A</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20" maxlength="25" id="frm1701q:txt66A" onblur="round(this,2);computetxt67('taxpayer');" onkeypress="return wholenumber(this, event)" />
                                                            </span></td>

                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">66B</font>&nbsp;
                                                                <input type="text" value="0.00" style="color: black; text-align: right;" size="20"  maxlength="25" id="frm1701q:txt66B" onblur="round(this,2);computetxt67('taxspouse');" onkeypress="return wholenumber(this, event)" />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td><font size="2" style="font-weight:bold;">&nbsp;67</font></td>
                                                        <td><font size="1" face="Arial, Helvetica, sans-serif">Total Penalties </font><font style="font-size: 8px;">(Sum of Items 64 to 66)<a href="javascript:void(0)" id="btnNavigatePage1_5" class="xsmallItalic"  onclick="processPrev()">(To Part III, Item 29) </a></font></td>
                                                        <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">67A</font>&nbsp; 
                                                                <input type="text" value="0.00" style="text-align: right;" size="20"  maxlength="25" id="frm1701q:txt67A" disabled />
                                                            </span></td>
                                                        <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">67B</font>&nbsp;
                                                                <input type="text" value="0.00" style="text-align: right;" size="20"  maxlength="25" id="frm1701q:txt67B" disabled />
                                                            </span></td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="4" class="tblFormTdPart" style="border-bottom: #000000 2px solid; border-top: #000000 2px solid;">
                                                            <table width="800" cellspacing="0" cellpadding="0">
                                                                <tr>
                                                                    <td width="26"><font size="2" style="font-weight:bold;">&nbsp;68</font></td>
                                                                    <td><font size="1" face="Arial, Helvetica, sans-serif" style="font-weight:bold;">Total Amount Payable/(Overpayment) </font><font style="font-size: 8px;">(Sum of Items 63 and 67)<a href="javascript:void(0)" id="btnNavigatePage1_6" class="xsmallItalic"  onclick="processPrev()">(To Part III, Item 30) </a></font></td>
                                                                    <td width="195"><span class="spacePadder"><font size="2" style="font-weight:bold;">68A</font>&nbsp; 
                                                                            <input type="text" value="0.00" style="text-align: right;" size="20"  maxlength="25" id="frm1701q:txt68A" disabled />
                                                                        </span></td>
                                                                    <td width="194"><span class="spacePadder"><font size="2" style="font-weight:bold;">68B</font>&nbsp;
                                                                            <input type="text" value="0.00" style="text-align: right;" size="20"  maxlength="25" id="frm1701q:txt68B" disabled />
                                                                        </span></td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                        <tr>
                                                            <td colspan="4">
                                                                <br>
                                                                <table width="800" cellspacing="0" cellpadding="0">
                                                                    <tr>
                                                                        <td width="395">
                                                                            <table width="395" border="1" cellspacing="0" cellpadding="0" style="background-color:white; border: #000 1px solid;">
                                                                                <tr>
                                                                                    <td colspan="2" align="center"><font style="font-weight:bold; font-size:8px;">TABLE 1 - Tax Rates (effective January 1, 2018 to December 31, 2022)</font></td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td width="50%" align="center"><font style="font-weight:bold; font-size:8px;">If Taxable Income is: </font></td>
                                                                                    <td width="50%" align="center"><font style="font-weight:bold; font-size:8px;">Tax Due is: </font></td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td align="center"><font style="font-size:8px;">Not over P250,000 </font></td>
                                                                                    <td align="center"><font style="font-size:8px;">0% </font></td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td align="center"><font style="font-size:8px;">Over P250,000 but not over P400,000 </font></td>
                                                                                    <td align="center"><font style="font-size:8px;">20% of the excess over P250,000 </font></td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td align="center"><font style="font-size:8px;">Over P400,000 but not over P800,000 </font></td>
                                                                                    <td align="center"><font style="font-size:8px;">P30,000 + 25% of the excess over P400,000 </font></td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td align="center"><font style="font-size:8px;">Over P800,000 but not over P2,000,000 </font></td>
                                                                                    <td align="center"><font style="font-size:8px;">P130,000 + 30% of the excess over P800,000 </font></td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td align="center"><font style="font-size:8px;">Over P2,000,000 but not over P8,000,000 </font></td>
                                                                                    <td align="center"><font style="font-size:8px;">P490,000 + 32% of the excess over P2,000,000 </font></td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td align="center"><font style="font-size:8px;">Over P8,000,000 </font></td>
                                                                                    <td align="center"><font style="font-size:8px;">P2,410,000 + 35% of the excess over P8,000,000 </font></td>
                                                                                </tr>
                                                                            </table>
                                                                        </td>
                                                                        <td class="spacePadder">&nbsp;</td>
                                                                        <td width="395">
                                                                            <table width="395" border="1" cellspacing="0" cellpadding="0" style="background-color:white; border: #000 1px solid;">
                                                                                <tr>
                                                                                    <td colspan="2" align="center"><font style="font-weight:bold; font-size:8px;">TABLE 2 - Tax Rates (effective January 1, 2023 and onwards)</font></td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td width="50%" align="center"><font style="font-weight:bold; font-size:8px;">If Taxable Income is: </font></td>
                                                                                    <td width="50%" align="center"><font style="font-weight:bold; font-size:8px;">Tax Due is: </font></td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td align="center"><font style="font-size:8px;">Not over P250,000 </font></td>
                                                                                    <td align="center"><font style="font-size:8px;">0% </font></td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td align="center"><font style="font-size:8px;">Over P250,000 but not over P400,000 </font></td>
                                                                                    <td align="center"><font style="font-size:8px;">15% of the excess over P250,000 </font></td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td align="center"><font style="font-size:8px;">Over P400,000 but not over P800,000 </font></td>
                                                                                    <td align="center"><font style="font-size:8px;">22,500 + 20% of the excess over P400,000 </font></td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td align="center"><font style="font-size:8px;">Over P800,000 but not over P2,000,000 </font></td>
                                                                                    <td align="center"><font style="font-size:8px;">102,500 + 25% of the excess over P800,000 </font></td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td align="center"><font style="font-size:8px;">Over P2,000,000 but not over P8,000,000 </font></td>
                                                                                    <td align="center"><font style="font-size:8px;">402,500 + 30% of the excess over P2,000,000 </font></td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td align="center"><font style="font-size:8px;">Over P8,000,000 </font></td>
                                                                                    <td align="center"><font style="font-size:8px;">P2,202,500 + 35% of the excess over P8,000,000 </font></td>
                                                                                </tr>
                                                                            </table>
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
                    <table width="800" border="0" cellspacing="0" cellpadding="0" class="tblForm printButtonClass">
                        <tr align="center">
                            <td class="tblFormTdPart">
                                <table width="800" cellspacing="0" cellpadding="0" border="0">
                                    <tr align="center">
                                        <td width="100%" colspan="2">
                                            <div align="center">
                                                <br />
                                                <input class="printButtonClass" type="button" value="Prev" style="width: 100px;"
                                                    name="frm1701q:btnPrevPage" id="frm1701q:btnPrevPage" onclick="processPrev();" />
                                                <input id="frm1701q:txtCurrentPage" name="frm1701q:txtCurrentPage" size="1" type="text" style="text-align:center;" onkeyup="goToPage();" />
                                                <span class=large>/&nbsp;</span><input type="text" id="frm1701q:txtMaxPage" readonly="true" size="2"  value="2" style="text-align:center;" disabled />&nbsp;
                                                <input class="printButtonClass" type="button" value="Next" style="width: 100px;"
                                                    name="frm1701q:btnNextPage" id="frm1701q:btnNextPage"  onclick="processNext();" />
                                                <br /><br />
                                            </div>
                                        </td>
                                    </tr>
                                    <tr valign="middle" align="center">
                                        <td>
                                            <div align="center">
                                                <input class="printButtonClass" type="button" value="Validate" style="width: 100px;" name="frm1701q:cmdValidate" id="frm1701q:cmdValidate" onclick="validate()" />
                                                <input class="printButtonClass" type="button" value="Edit" style="width: 100px;" name="frm1701q:cmdEdit" id="frm1701q:cmdEdit" onclick="enableAllControl()"/>
                                                <!--<input class="printButtonClass" type="button" value="Submit" style="width: 100px;" name="btnUpload" id="btnUpload" />-->
                                                <input class="printButtonClass" type="hidden" value="Submit" style="width: 100px;" name="btnUpload" id="btnUpload" />
                                                <input class="printButtonClass" type="button" value="Save" style="width: 100px;" name="btnSave" id="btnSave" onclick="saveXML(false);" />
                                                <!--<input class="printButtonClass" type="button" value="Print" style="width: 100px;" name="btnPrint" id="btnPrint" onclick="window.print()" />-->
                                                <input class="printButtonClass" type="button" value="Print" style="width: 100px;" name="btnPrint" id="btnPrint" onclick="printme();" />
                                                <input class="printButtonClass" type="button" value="Submit / Final Copy" style="width: 200px;" name="frm1701q:btnFinalCopy" id="frm1701q:btnFinalCopy" onclick="openAlertEmail();" />
                                                <div id="msg" class="printButtonClass" style="display:none;"></div>																		
                                            </div>
                                            <br />
                                        </td>
                                        <div id="DummyTxt" style='display:none;'>  </div>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
				</td>
            </tr>
		</table>
				
        </div>
        </div>
		<!-- import modal -->
        <div id="modalImport" style="width:50%; display:none; height:40%; position:fixed; top:3%; left:25%; right:auto; overflow-y:auto; overflow-x:hidden; background:#e2e2e2;" align="center">
            <br/>
            <br/>
			<table border="0" width="60%" align="center">
				<tr class="modalHeader">
					<td>Import</td>
				</tr>
			</table>
            <table border="0" cellspacing="3" cellpadding="3" width="60%">
                <tr><td>&nbsp;</td></tr>
            </table>
			<div align="center">
				<br />
				<br />
				<input type="button" class="printButtonClass" name="btnOkImport" id="btnOkImport" style="width:120px; height:30px;" value="OK" onclick="importFiles()"  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				<input type="button" class="printButtonClass" name="btnCancelImport" id="btnCancelImport" style="width:120px; height:30px;" value="CANCEL"  onclick="cancelImportModal()" />
			</div>
            <br />
            <br />
        </div>
		<!-- Send Email -->
		<div id="hiddenEnroll" style="display:none;"  > <input id="txtFinalFlag" class="FinalFlag" name="txtFinalFlag" type="text" onblur="" onkeypress="" value="0" maxlength="60"   />
					<input id="txtEnroll" name="txtEnroll" type="text" onblur="" onkeypress="" value="N" maxlength="60"   />
		</div>
		<div id="ebirConfirmOnline" style="display: none; position: fixed; top:  20%; left: 32%;
        right: auto; overflow-y: auto; overflow-x: hidden; background: #e2e2e2; padding: 20px; border:2px solid blue;">
            <div style="position: relative; width: 100%;">
                
                       <span style="font-weight: bold; font-size: largerBold;">Please Re - enter your eBIRForms Online Username and Password.</span>
                       
            </div>
            <div class="modalInner" style="width: 98%;">
				<table>
					<tr>
							<td>
									Confirm USERNAME:
							</td>
							<td>
									
									<input type="text" id="ebirOnlineConfirmUsername" maxlength="50" />
							</td>
					</tr>
					<tr>
							<td>
									Confirm	PASSWORD:
							</td>
							<td>
										<input type="password" id="ebirOnlineConfirmPassword" maxlength="50" />
							</td>
					</tr>
					
					<tr>
							<td>
										<input type="button" id="ebirOnlineConfirmSubmit" value="Submit" onclick="sendEmail(this);" />
							</td>
							<td>
										<input type="button" id="ebirOnlineConfirmCancel" value="Cancel" onclick="SetFinalFlagTo0();HideContainer('ebirConfirmOnline'); ShowContainer('container'); " />
							</td>
					</tr>
				</table>
            </div>
    </div>
	 <div id="tosa" style="display: none;">
        <h2>Terms of Service Agreement</h2>
        <p class="indentTosa">
            Thank you for visiting the eBIRForms webpage. By accessing and/or using any part of this website and eBIRForms System (including the online and offline services), herein collectively called the "Service", you shall be deemed to have accepted to be legally bound by these Terms of Service.
        </p>
        <p class="indentTosa">
            Please review the following terms carefully. The terms "Bureau", "we", "us" and "our" refer to the Bureau of Internal Revenue or BIR, the legal name of the owner of the website. The term "you" refers to the taxpayer, tax agent, tax software provider or any user or viewer of our site. The Bureau reserves the right to modify these terms or provide additional terms from time to time. The continued use of the Service following the posting of any changes to the Terms of Service constitutes your acceptance of such changes.
        </p>

        <h2>Description of Service</h2>

        <p class="indentTosa">The Service provides you with the facility to file/submit returns and pay taxes due thereon using the eBIRForms System. It also receives returns generated by the third party software and filed by the taxpayer or tax agent.</p>
        <p class="indentTosa">The Service provides you with the following services:</p>
        <ul class="indentTosa">
            <li class="indentTosa">downloadable tax preparation software package</li>
            <li class="indentTosa">taxpayer, tax agent and tax software provider enrollment</li>
            <li class="indentTosa">file/submit tax returns, and attachments (upon system’s update)</li>
            <li class="indentTosa">access to payment facility to make payments</li>
            <li class="indentTosa">access to the taxpayer’s record</li>
            <li class="indentTosa">access to tax records of tax agent including client/s who authorized such tax agent for electronic  filing and/or payment</li>
            <li class="indentTosa">update user record</li>
            <li class="indentTosa">assign tax agent by taxpayer and correspondingly, tax agent to represent a taxpayer</li>
            <li class="indentTosa">third party data lay-out requirements publication</li>
            <li class="indentTosa">third party software compliance testing</li>
        </ul>


        <h2>General User's Obligations</h2>

        <h4>Filing/Submitting Tax Returns</h4>
        <p class="indentTosa">In filing or submitting tax returns, you may either use the eBIRForms software package or the system’s upload facility for the returns generated by an accredited third party software.</p>
        <p class="indentTosa">It is your responsibility to file your return and pay the correct taxes on time, failure to do so may result to the imposition of corresponding penalties (e.g., surcharge and interest) and to civil and criminal liability as provided by law and regulations.</p>

        <h4>Use of eBIRForms Software Package</h4>
        <p class="indentTosa">The eBIRForms software package is for your personal, non-commercial use only. The downloaded software package is used for filling up of tax returns, and there is a facility for its electronic submission.  It is designed with automatic population of selected taxpayer information and automatic mathematical computation of tax due based on encoded taxable amounts.</p>
        <p class="indentTosa">It may be used by accredited tax agents/practitioners enrolled in the system in providing services for their clients who have authorized them to file tax returns on said taxpayers’ behalf.</p>
        <p class="indentTosa">The Service ensures the preservation of data transmitted and includes safeguards against efforts to tamper with, manipulate, alter, or subvert the data. Tampering or any attempt to tamper the eBIRForms application software package or data will be dealt with in accordance with the applicable laws.</p>
        <p class="indentTosa">You are responsible for using the eBIRForms software package only on computers and telephone or other lines that you have permission to use, and you are responsible for all related charges, if applicable, such as cable, ISP, and telephone charges.</p>
        <p class="indentTosa">You are strictly prohibited from modifying, copying, distributing, transmitting, displaying, performing, reproducing, publishing, licensing, creating derivative works, transferring or selling any information contained in the package, for a fee or otherwise.</p>

        <h4>Updates of eBIRForms software package</h4>
        <p class="indentTosa">You are required to download updated eBIRForms software package when notified of new versions of the said package.</p>

        <h4>Use of third party software for filing</h4>
        <p class="indentTosa">You are only allowed to use the accredited third party software to generate tax returns for filing.</p>

        <h4>Inactive Accounts</h4>
        <p class="indentTosa">To ensure efficiency in the Service, dormant accounts or those with prolonged period of inactivity shall be suspended and shall be archived and cleaned-up from the system. The system shall notify you through email in case of any account suspension.</p>

        <h4>Session Log-out</h4>
        <p class="indentTosa">Your eBIRForms session shall automatically log-out after a predefined duration of no keyboard activity.</p>

        <h2>Taxpayer's Obligations</h2>

        <h4>Enrollment Obligation</h4>
        <p class="indentTosa">In consideration of your use of the Service, you undertake to provide true, accurate, current and complete information about yourself or your organization as required by the eBIRForms enrollment process. You shall maintain and update the data to keep it true, accurate, current and complete.</p>
        <p class="indentTosa">BIR reserves the right to terminate or suspend your account and to refuse current or future use of the eBIRForms in case any information you provided is found to be untrue, inaccurate, obsolete or incomplete.</p>

        <h4>Security Obligation</h4>
        <p class="indentTosa">You undertake to use the Service in a manner that protects your privacy and the data/information you provide.</p>
        <p class="indentTosa">As part of the enrollment process, you will be provided with an account username and password. You agree not to disclose your account password to anyone and you are fully responsible for all activities that occur under your account username.</p>
        <p class="indentTosa">You are advised to use a strong password consisting of at least eight (8) characters, with numeric as well as alphabetic characters, and with a mix of upper and lower case alphabetic characters and at least one special character (for example, !,@,#).</p>
        <p class="indentTosa">You agree to log-out or lock your computer if unattended to ensure that unauthorized users do not gain access to your account and the data you provided and were provided to you through the Service. You should ensure that you exit from your account at the end of every session.</p>
        <p class="indentTosa">To ensure adequate security in the system, note that the maximum limit set for unsuccessful log-on attempts is three (3) within a sixty-minute period. In the event of account lock, you should request your Revenue District Office (RDO) in writing to unlock your account so you may resume access thereto.</p>
        <p class="indentTosa">You are responsible for the protection of your computer where eBIRForms system is installed against viruses, worms or malwares.</p>
        <p class="indentTosa">You shall immediately notify the BIR Helpdesk at telephone number (02) 981-7050 or (02) 981-7051 of any unauthorized use of your password or account, or any other breach of security.</p>

        <h4>Legal Obligation</h4>
        <p class="indentTosa">The Service provides you various email notifications that may require response or confirmation relative to your use of the system. You must promptly respond to or confirm the email notifications when required.</p>
        <p class="indentTosa">In filing tax returns using the eBIRForms software package or third party software generated return, you may only file your own or your organization's tax returns. You are not allowed to file tax returns of other persons/parties, unless you are a tax agent  duly authorized by your client to file such tax returns.</p>

        <h4>Payment Obligation</h4>
        <p class="indentTosa">It is your obligation to ensure that payment shall be received by the BIR and be cleared on the BIR account on or before the due dates.</p>


        <h2>Accredited Tax Agent's Obligations</h2>

        <h4>Enrollment Obligation</h4>
        <p class="indentTosa">In consideration of your use of the Service, you undertake to provide true, accurate, current and complete information about yourself and the taxpayer you are duly authorized to represent as required by the eBIRForms enrollment process. You shall maintain and update the data to keep it true, accurate, current and complete.</p>
        <p class="indentTosa">BIR reserves the right to terminate or suspend your account and to refuse current or future use of the eBIRForms in case any information you provided is found to be untrue, inaccurate, obsolete or incomplete.</p>

        <h4>Security Obligation</h4>
        <p class="indentTosa">You undertake to use the Service in a manner that protects your privacy and the privacy of the taxpayer you are duly authorized to represent and the data/information you provide.</p>
        <p class="indentTosa">As part of the enrollment process, you will be provided with an account username and password. You agree not to disclose your account password to anyone and you are fully responsible for all activities that occur under your account username.</p>
        <p class="indentTosa">You are advised to use a strong password consisting of at least eight (8) characters, with numeric as well as alphabetic characters, and with a mix of upper and lower case alphabetic characters and at least one special character (for example, !,@,#).</p>
        <p class="indentTosa">You are advised to change your password periodically (i.e., monthly or as may be deemed necessary).</p>
        <p class="indentTosa">You agree to log-out or lock your computer if unattended to ensure that unauthorized users do not gain access to your account and the data you provided and were provided to you through the Service. You should ensure that you exit from your account at the end of every session.</p>
        <p class="indentTosa">To ensure adequate security in the system, note that the maximum limit set for unsuccessful log-on attempts is three (3) within a sixty-minute period. In the event of account lock, you should request your RDO in writing to unlock your account so you may resume access thereto.</p>
        <p class="indentTosa">You are responsible for the protection of your computer where eBIRForms system is installed against viruses, worms or malwares.</p>
        <p class="indentTosa">You shall immediately notify the BIR Helpdesk at telephone number (02) 981-7050 or (02) 981-7051 of any unauthorized use of your password or account, or any other breach of security.</p>

        <h4>Legal Obligation</h4>
        <p class="indentTosa">To be able use this website to access data or perform activities as agent of another person/taxpayer, you should have been duly authorized/appointed/designated as the taxpayer's agent, which authority continues to be effective or must not have been revoked.</p>
        <p class="indentTosa">For purposes of using the Service as a tax agent of another person/taxpayer, you should be an accredited tax agent/practitioner before the BIR pursuant to Revenue Regulations No. 11-2006, as amended by Revenue Regulations No. 4-2010.</p>
        <p class="indentTosa">You may only act as an agent and represent another person/taxpayer after receiving an email confirmation from the BIR allowing you to do so.</p>
        <p class="indentTosa">The Service provides you various email notifications that may require response or confirmation relative to your use of the system. You must promptly respond to or confirm the email notifications when required.</p>
        <p class="indentTosa">You shall not upload files other than the tax returns of taxpayers you are duly authorized to represent and the corresponding attachments. Any violation of this condition shall constitute a ground for the Bureau to terminate or suspend your account and refuse current or future use of the Service.</p>

        <h4>Payment Obligation</h4>
        <p class="indentTosa">It is your obligation to ensure that payment shall be received by the BIR and be cleared on the BIR account on or before the due dates.</p>

        <h2>Tax Software Provider's Obligations</h2>

        <h4>Enrollment Obligation</h4>
        <p class="indentTosa">In consideration of your use of the Service, you undertake to provide true, accurate, current and complete information about yourself or your organization as required by the eBIRForms enrollment process. You shall maintain and update the data to keep it true, accurate, current and complete.</p>
        <p class="indentTosa">BIR reserves the right to terminate or suspend your account and to refuse current or future use of the eBIRForms in case any information you provided is found to be untrue, inaccurate, obsolete or incomplete.</p>

        <h4>Security Obligation</h4>
        <p class="indentTosa">You undertake to use the Service in a manner that protects your privacy and the privacy of any other person/taxpayer and the data/information you provide.</p>
        <p class="indentTosa">As part of the enrollment process, you will be provided with an account username and password. You agree not to disclose your account password to anyone and you are fully responsible for all activities that occur under your account username.</p>
        <p class="indentTosa">You are advised to use a strong password consisting of at least eight (8) characters, with numeric as well as alphabetic characters, and with a mix of upper and lower case alphabetic characters and at least one special character (for example, !,@,#).</p>
        <p class="indentTosa">You are advised to change your password periodically (i.e., monthly or as may be deemed necessary).</p>
        <p class="indentTosa">You agree to log-out or lock your computer if unattended to ensure that unauthorized users do not gain access to your account and the data you provided and were provided to you through the Service. You should ensure that you exit from your account at the end of every session.</p>
        <p class="indentTosa">To ensure adequate security in the system, note that the maximum limit set for unsuccessful log-on attempts is three (3) within a sixty-minute period. In the event of account lock, you should request your RDO in writing to unlock your account so you may resume access thereto.</p>
        <p class="indentTosa">You are responsible for the protection of your computer where eBIRForms system is installed against viruses, worms or malwares.</p>
        <p class="indentTosa">You shall immediately notify the BIR Helpdesk at telephone number (02) 981-7050 or (02) 981-7051 of any unauthorized use of your password or account, or any other breach of security.</p>

        <h4>Legal Obligation</h4>
        <p class="indentTosa">The Service provides you various email notifications that may require response or confirmation relative to your use of the system. You must promptly respond to or confirm the email notifications when required.</p>
        <p class="indentTosa">You are strictly prohibited from sharing your certification number and access credentials to a third party software provider not accredited by the eBIRForms system.</p>
        <p class="indentTosa">You undertake to strictly follow the instructions and guidelines for tax software providers as issued by BIR.</p>
        <p class="indentTosa">You agree to provide software with an electronic export facility that will generate the tax returns.</p>
        <p class="indentTosa">It must be understood that the accreditation issued by the BIR to the tax software provider does not constitute endorsement, sponsorship or approval of the software used to generate the tax returns.</p>

        <h2>Disclaimer</h2>
        <p class="indentTosa">The BIR is providing the eBIRForms website as an alternative mode of filing tax returns. The content of the website is provided in an "as is basis" and without any express or implied warranties.</p>
        <p class="indentTosa">The BIR does not warrant that the Service will be uninterrupted; be free from inaccuracies, errors, viruses or other harmful components; operate in the configuration or with the hardware or software you use.</p>
        <p class="indentTosa">The BIR is not liable or responsible for any damages, expenses, costs or loss of any kind (including, but not limited to, any direct, indirect, special, incidental, or consequential damages, financial losses, loss of profits, loss of any data or loss of any opportunity) caused as a result (directly or indirectly) of, or in connection with, your use of the Service (including the downloads and/or use of the services) or reliance on any information, materials, tools, provided in or available from this site.</p>

        <h5>Last update: June 1, 2015 </h5>
        <div class="centerButton">
            <input type=button id="btnAgree" value="Agree"onclick="hideTosa(); disableDropDown('after');" />
        </div>
    </div>
	<div id="ebirEnroll" style="display: none; position: fixed; top:  20%; left: 20%;
        right: auto; overflow-y: auto; overflow-x: hidden; background: #e2e2e2; padding: 20px; border:2px solid blue;">
            <div style="position: relative; width: 100%;">
                
                       <span style="font-weight:bold;">eBIRForms Terms of Service Agreement (TOSA)</span><br><br />
                       <span>Thank you for using eBIRForms. By clicking Agree, you confirm that you have read, understood and agreed to the TOSA.</span><br /><br/>
                        
                        <span>The full eBIRForms TOSA can be accessed <a href="#" onclick="openTermsandAgreement();disableDropDown('before');">here</a>.</span><br />
                        <span> </span> <br /><br />
                       
            </div>
            <div class="modalInner" style="width: 98%;">
				<table>
					</tr>
							<td>
										<input type="button" id="ebirEnrollYes" value="  Ok  " onclick="sendEmail(this); HideContainer('ebirEnroll');" />
							</td>
							<td>
										<input type="button" id="ebirEnrollNo" value="Cancel" onclick="SetFinalFlagTo0(); HideContainer('ebirEnroll'); ShowContainer('container'); " />
							</td>
					<tr>
					</tr>
				</table>
            </div>
	</div>
	<div id="isRegister" style="display: none; position: fixed; top:  40%; left: 35%;
        right: auto; overflow-y: auto; overflow-x: hidden; background: #e2e2e2; padding: 20px; border:2px solid blue;">
            <div style="position: relative; width: 100%;">
                
                       <span style="font-weight: bold; font-size: largerBold;">Are you a registered eBIRForms Online User?</span>
                       
            </div>
            <div class="modalInner" style="width: 98%;">
				<table>
			
					</tr>
							<td>
										<input type="button" id="isregistered" value="YES" onclick="HideContainer('isRegister'); ShowContainer('ebirOnline') " />
							</td>
							<td>
										<input type="button" id="notregistered" value="NO" onclick="HideContainer('isRegister'); ShowContainer('ebirEnroll'); " />
							</td>
					<tr>
					</tr>
				</table>
            </div>
	</div>
	
	<div id="ebirOnline" style="display: none; position: fixed; top:  20%; left: 32%;
        right: auto; overflow-y: auto; overflow-x: hidden; background: #e2e2e2; padding: 20px; border:2px solid blue;">
            <div style="position: relative; width: 100%;">
                
                       <span style="font-weight: bold; font-size: largerBold;">Please enter your eBIRForms Online Username and Password.</span>
                       
            </div>
            <div class="modalInner" style="width: 98%;">
				<table>
					<tr>
							<td>
									USERNAME:
							</td>
							<td>
									
									<input type="text" id="ebirOnlineUsername" maxlength="50" />
							</td>
					</tr>
					<tr>
							<td>
										PASSWORD:
							</td>
							<td>
										<input type="password" id="ebirOnlinePassword" maxlength="50" />
										<input type="text" id="ebirOnlineSecret" maxlength="50" style="display: none;" />
							</td>
					</tr>
					
					<tr>
							<td>
										<input type="button" id="ebirOnlineSubmit" value="Submit" onclick="ValidateUserPass();" />
							</td>
							<td>
										<input type="button" id="ebirOnlineCancel" value="Cancel" onclick="SetFinalFlagTo0();HideContainer('ebirOnline'); ShowContainer('container'); " />
							</td>
					</tr>
				</table>
            </div>
    </div>
	<div id="hiddenProfile" style="display:none;"  > 
        <input type="text" value="" size="15" maxlength="50" id="frm1701q:txtLOB" onblur = "return capital(this, event)" /><br>
        <input id="frm1701q:txtTelno" maxlength="7"  size="7"  type="text" onkeypress="return wholenumber(this, event)" />
	</div>
	<!-- Send Email -->
		<!-- export modal -->
        <div id="modalExport" style="width:50%; display:none; height:43%; position:fixed; top:3%; left:25%; right:auto; overflow-y:auto; overflow-x:hidden; background:#e2e2e2;" align="center">
            <br/>
            <br/>
			<table border="0" width="60%" align="center">
				<tr class="modalHeader">
					<td>Have Disk</td>
				</tr>
			</table>
            <table border="0" cellspacing="3" cellpadding="3" width="60%">
                <tr><td>&nbsp;</td></tr>
				<tr><td>&nbsp;</td></tr>
				<tr> 
                    <td class="modalColumnHeader">Make sure that a recordable media [diskette/universal serial bus (USB) flash drive, compact disc (cd), digital video disc (dvd)] is already inserted.</td>
                </tr>
				<tr><td>&nbsp;</td></tr>
				<tr><td>&nbsp;</td></tr>
				<tr>
                    <td class="modalColumnHeader">Drive: 
						<select class="driveSelect" id="driveSelectTPExport" name="driveSelectTPExport" size="1" class="modalContent">
							
						</select>
					</td>
                </tr>
            </table>
			<div align="center">
				<br />
				<br />
				<input type="button" class="printButtonClass" name="btnOk" id="btnOkExport" style="width:120px; height:30px;" value="OK" onclick="exportTPFiles(fileNameToExport); checkFinalCopyBtn('1701Qv2018');"  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				<input type="button" class="printButtonClass" name="btnCancel" id="btnCancelExport" style="width:120px; height:30px;" value="CANCEL"  onclick="cancelExportModal(); checkFinalCopyBtn('1701Qv2018');" />
			</div>
            <br />
            <br />
        </div>
	</form>                       	
	<textarea id='responsetext' style="display:none;"></textarea>
        <!-- XML retrieval -->
        <div style="display:none;">
            <xmp id='xmlFormat'>	
            </xmp> <!--format the doc -->
            <span id='xmlClose'>All Rights Reserved BIR 2012.</span>
        </div>
		<div id="responseBG" style="display:none;"><!--loaded files render here--></div>
        <div id="response" style="display:none;"><!--loaded files render here--></div>			
		<div id="responseRdo" style="display:none;"><!--loaded files render here--></div>	
    </body>
</html>

<script type="text/javascript">
    var isSubmitFinal = false;
    var isSubmit = false;

    var gIsReadOnly = false;
    var fileName = "";
    var existingXMLFileName = "";
    var fileNameToExport = "";

    var savedReturn = "";
    var p3Compromise = "";
    var p3Surcharge = "";
    var p3Interest = "";
    var p3IsAmended = "";
    var p3FilingDate = "";
    var p3ReturnPeriod = "";
    var p3ReturnPeriodEnd = "";

    var p3BasicTax = "";
    var p3TotalPenalties = "";
    var p3TotalAmountPayable = "";

    var p3TPTIN1 = "";
    var p3TPTIN2 = "";
    var p3TPTIN3 = "";
    var p3TPTIN = "";
    var p3TPBranchCode = "";
    var p3TPRDOCode = "";
    var p3TPLineBus = "";
    var p3TPName = "";
    var p3TPTelNum = "";
    var p3TPAddress = "";
    var p3TPZip = "";

    var currentPage;
	var MaxPage = 2;


    /*----------------------------------*/
    var d = document, XMLBGFile = '', data = '', XMLFile = '', XMLATCFile = '', msg = d.getElementById('msg');
    var loader = d.getElementById('loader');
    /*----------------------------------*/
    var globalEmail = "";
    setTimeout("sleeptime()", 200);
    function sleeptime() {
        init();

        var bgFileName = qs('xmlBGInfoFileName');
        if (bgFileName != null && bgFileName.indexOf('.xml') > -1) {
            loadBGXML(bgFileName);
        }

        fileName = qs('xmlFileName');
        if (fileName != null && fileName.indexOf('.xml') > -1) {
            var tin = fileName.split("/")[1].split("-");
            loadBGXML("profile/" + tin[0] + ".xml");
            loadXML(fileName);
            existingXMLFileName = fileName;
            
            d.getElementById('frm1701q:txtYear').disabled = true;
            d.getElementById('frm1701q:DateQuarter_1').disabled = true;
            d.getElementById('frm1701q:DateQuarter_2').disabled = true;
            d.getElementById('frm1701q:DateQuarter_3').disabled = true;

            //Dev Note: This new function will be used for processing well-formed XML for Tax Software Provider (TSP)
            //XML file processing.  The parameter 'savefile/1602_wellformed.xml' should be replaced by RB with 
            //the xml file that came from the upload xml portal page.
            //loadXMLWellFormed("savefile/1701Q_wellformed.xml");	
            if (gIsReadOnly) {
                window.setTimeout("disableAllElementIDs(); d.getElementById('btnUpload').disabled = false; d.getElementById('frm1701q:txtCurrentPage').disabled = false; d.getElementById('frm1701q:btnPrevPage').disabled = false; d.getElementById('frm1701q:btnNextPage').disabled = false;", 1000);
            }
        } else {
            window.setTimeout("$('#loader').hide('blind');", 100);
        }
        if ($('#printMenu').css('display') != 'none') {
            $('#printMenu').hide('blind');
        }
		document.getElementById('frm1701q:txtTIN1').disabled = true; document.getElementById('frm1701q:txtTIN2').disabled = true; document.getElementById('frm1701q:txtTIN3').disabled = true; document.getElementById('frm1701q:txtBranchCode').disabled = true;
         window.setTimeout("checkFinalCopyBtn('1701Qv2018')", 2000);
         
         // Disable pasting
        $(document).ready(function () {
            $('input').bind('paste', function (e) {
                e.preventDefault();
            });
        });
	}

    function rdoPropertyJS(rdoCode, description) {
        this.rdoCode = rdoCode;
        this.description = description;
    }

    var rdoList = new Array();

    function init() {
        getDrives();
        loadXMLrdo('xml/rdo.xml');
        getRdo();
        var year = new Date();
        d.getElementById('frm1701q:txtYear').value = year.getFullYear();
        
        currentPage = 1;
		d.getElementById('frm1701q:txtCurrentPage').value = currentPage;

        d.getElementById('frm1701q:AmendedRtn_1').disabled = false;
        d.getElementById('frm1701q:AmendedRtn_2').disabled = false;

        d.getElementById('frm1701q:txt28A').disabled = true;
        d.getElementById('frm1701q:txt28B').disabled = true;
        d.getElementById('frm1701q:txt30A').disabled = true;
        d.getElementById('frm1701q:txt30B').disabled = true;

        d.getElementById('frm1701q:cmdEdit').disabled = true;
        d.getElementById('btnPrint').disabled = true;
        d.getElementById('frm1701q:btnFinalCopy').disabled = true;
        d.getElementById('btnUpload').disabled = true;

        //d.getElementById("frm1701q:txt41C").disabled = true;
        processAmend();
    }

    function loadXMLWellFormed(loadWhere) {
        try {

            //This will load the file with filename loadWhere if it exists
            var fsoXML = new ActiveXObject("Scripting.FileSystemObject");
            XMLFile = fsoXML.OpenTextFile(loadWhere, 1);
            if (XMLFile.AtEndOfStream)
                data = "";
            else {
                var response = d.getElementById('response'); //render file and write to hidden div
                response.innerHTML = XMLFile.ReadAll(); //remove XML tag
            }
            XMLFile.Close(); //alert( response.innerHTML ); //Debug				
            loadWFData();	/*This will load data onto fields*/
            if (response.innerHTML.indexOf("All Rights Reserved BIR 2012.0") >= 0) {
                gIsReadOnly = true;
            }

            if (gIsReadOnly) {
                d.getElementById('frm1701q:cmdValidate').disabled = true;
                d.getElementById('btnSave').disabled = true;
            }
            window.setTimeout("$('#loader').hide('blind');", 2000);
        } catch (e) {
            //msg.innerHTML = "Save File not Found.";
        } //this will Alert File not Found if it doesn't exist
    }

    function loadWFData() {
        /*This will load data onto fields*/
        var response = d.getElementById("response");
        var elem = d.getElementById('frmMain').elements;
        var fieldVal = "";
        for (var i = 0; i < elem.length; i++) {

            if (elem[i].type != 'hidden' && elem[i].type != 'undefined') {	//elem[i].type != 'button' &&  			
                if (elem[i].type == 'text' || elem[i].type == 'select-one') {
                    if(elem[i].id != 'frm1701q:txtAddress2'){
						fieldVal = String(response.innerHTML).split(elem[i].id + '>');
					}
					else{
						fieldVal = String(response.innerHTML).split("frm1701q:txtAddress>");
					}
                    // elem[i].value = fieldVal[1]; //all select-one and text values		 
                    if (fieldVal != null && fieldVal.length > 1) {
                        if(elem[i].id == 'frm1701q:txtAddress'){
                            if(fieldVal[1].length <= 100){
                                elem[i].value = fieldVal[1].substring(0, fieldVal[1].indexOf("</"));
                            }
                            else {
                                elem[i].value = unescape(fieldVal[1].substring(0, 100));
                            }
                        }
                        else if(elem[i].id == 'frm1701q:txtAddress2'){
                            if(fieldVal[1].length <= 100){
                                elem[i].value = '';
                            }
                            else {
                                elem[i].value = unescape(fieldVal[1].substring(100, fieldVal[1].indexOf("</")));
                            }
                        }
                        else {
                            elem[i].value = fieldVal[1].substring(0, fieldVal[1].indexOf("</"));
                        }
                    }
                }
                if (elem[i].type == 'radio') {
                    var rdoVal = String(response.innerHTML).split(elem[i].id + '>');
                    if (rdoVal[1] == 'true') {
                        // elem[i].checked = rdoVal[1];
                        if (rdoVal != null && rdoVal.length > 1) {
                            elem[i].value = rdoVal[1].substring(0, rdoVal[1].indexOf("</"));
                        }
                        //elem[i].onclick(); dgarfin: commented since it hinders the rest of the elements to load its values 
                    }
                }
                if (elem[i].type == 'checkbox') {
                    var chkboxVal = String(response.innerHTML).split(elem[i].id + '>');
                    if (chkboxVal[1] == 'true') {
                        // elem[i].checked = chkboxVal[1];
                        if (chkboxVal != null && chkboxVal.length > 1) {
                            elem[i].value = chkboxVal[1].substring(0, chkboxVal[1].indexOf("</"));
                        }
                    }
                }
                //dgarfin: temporarily commented until modalAtc popup show/hide	
                //if (elem[i].type == 'button' && elem[i].id == 'btnOkPop') {
                //	elem[i].onclick();				
                //}					
            }

        }
    }

    /*--------------------------------------------------------------*/
    function loadXML(loadWhere) {
        try {

            //This will load the file with filename loadWhere if it exists
            var fsoXML = new ActiveXObject("Scripting.FileSystemObject");
            XMLFile = fsoXML.OpenTextFile(loadWhere, 1);
            if (XMLFile.AtEndOfStream)
                data = "";
            else {
                var response = d.getElementById('response'); //render file and write to hidden div
                response.innerHTML = XMLFile.ReadAll(); //remove XML tag
            }
            XMLFile.Close(); //alert( response.innerHTML ); //Debug				
            loadData();	/*This will load data onto fields*/
            if (response.innerHTML.indexOf("All Rights Reserved BIR 2012.0") >= 0) {
                gIsReadOnly = true;
            }

            if (gIsReadOnly) {
                d.getElementById('frm1701q:cmdValidate').disabled = true;
                d.getElementById('btnSave').disabled = true;
            }
            window.setTimeout("$('#loader').hide('blind');", 2000);
        } catch (e) {
            //msg.innerHTML = "Save File not Found.";
        } //this will Alert File not Found if it doesn't exist
    }

    function loadData() {
        /*This will load data onto fields*/
        var response = d.getElementById("response");
        var elem = d.getElementById('frmMain').elements;
        var fieldVal = "";
        for (var i = 0; i < elem.length; i++) {

            if (elem[i].type != 'hidden' && elem[i].type != 'undefined') {	//elem[i].type != 'button' &&  			
                if (elem[i].type == 'text' || elem[i].type == 'select-one') {

                    if(elem[i].id != 'frm1701q:txtAddress2'){
						fieldVal = String( $("#response").html() ).split(elem[i].id+'=');
					}
					else{
						fieldVal = String( $("#response").html() ).split("frm1701q:txtAddress=");
					}

                    if (elem[i].id == 'frm1701q:txtTaxpayerName' || elem[i].id == 'frm1701q:txtLOB') {
                        elem[i].value = unescape(fieldVal[1]);
                    }
                    else if(elem[i].id == 'frm1701q:txtAddress'){
                        if(fieldVal[1].length <= 100){
                            elem[i].value = unescape(fieldVal[1]);
                        }
                        else {
                            elem[i].value = unescape(fieldVal[1].substring(0, 100));
                        }
                    }
                    else if(elem[i].id == 'frm1701q:txtAddress2'){
                        if(fieldVal[1].length <= 100){
                            elem[i].value = '';
                        }
                        else {
                            elem[i].value = unescape(fieldVal[1].substring(100, fieldVal[1].length));
                        }
                    }
					else if (elem[i].className.indexOf("FinalFlag") > -1) {
                        elem[i].value = typeof (fieldVal[1]) === "undefined" ? "3" : fieldVal[1];
                    }
                    else {
                        elem[i].value = fieldVal[1]; //all select-one and text values		 		
                    }
                }
                if (elem[i].type == 'radio') {
                    var rdoVal = String($("#response").html()).split(elem[i].id + '=');
                    if (rdoVal[1] == 'true') {
                        elem[i].checked = rdoVal[1];
                        //elem[i].onclick(); dgarfin: commented since it hinders the rest of the elements to load its values 
                    }
                }
                if (elem[i].type == 'checkbox') {
                    var chkboxVal = String($("#response").html()).split(elem[i].id + '=');
                    if (chkboxVal[1] == 'true') {
                        elem[i].checked = chkboxVal[1];
                    }
                }
                //dgarfin: temporarily commented until modalAtc popup show/hide	
                //if (elem[i].type == 'button' && elem[i].id == 'btnOkPop') {
                //	elem[i].onclick();				
                //}					
            }

        }
        if (d.getElementById('frm1701q:txtTIN1').value != "") {
            d.getElementById('frm1701q:txtSpouseRDOCode').disabled = false;
            d.getElementById('frm1701q:txtSpouseName').disabled = false;
            d.getElementById('frm1701q:optSpouseATC_1').disabled = false;
            d.getElementById('frm1701q:optSpouseATC_2').disabled = false;
            d.getElementById('frm1701q:optSpouseATC_3').disabled = false;
            d.getElementById('frm1701q:optSpouseATC_4').disabled = false;
            d.getElementById('frm1701q:optSpouseATC_5').disabled = false;
            d.getElementById('frm1701q:optSpouseATC_6').disabled = false;
            d.getElementById('frm1701q:optSpouseATC_7').disabled = false;
            d.getElementById('frm1701q:optSpouseMethod:_1').disabled = false;
            d.getElementById('frm1701q:optSpouseMethod:_2').disabled = false;
        }

        document.getElementById('txtEmail').value = globalEmail;
    }
    function createEncXMLFileName(subFolder) {
        var xmlFileName = "";
        var titleTin1 = d.getElementById('frm1701q:txtTIN1');
        var titleTin2 = d.getElementById('frm1701q:txtTIN2');
        var titleTin3 = d.getElementById('frm1701q:txtTIN3');
        var titleBranchCode = d.getElementById('frm1701q:txtBranchCode');
        var titleTPName = d.getElementById('frm1701q:txtTaxpayerName');

        var qtr = "";
        if (d.getElementById('frm1701q:DateQuarter_1').checked == true) {
            qtr = "Q1";
        }
        if (d.getElementById('frm1701q:DateQuarter_2').checked == true) {
            qtr = "Q2";
        }
        if (d.getElementById('frm1701q:DateQuarter_3').checked == true) {
            qtr = "Q3";
        }
        var returnPeriod = d.getElementById('frm1701q:txtYear').value + qtr;

        //xmlFileName = "profile/1701q-" + titleTin1.value + titleTin2.value + titleTin3.value + titleBranchCode.value + "-" +
        //( (titleTPName.value.replace(/[ ,\^;\)'\(]+/g, '').length > 12) ? titleTPName.value.replace(/[ ,\^;\)'\(]+/g, '').substring(0,12).toLowerCase() : titleTPName.value.replace(/[ ,\^;\)'\(]+/g, '').toLowerCase() ) + 
        //"-" + dtFormatted +
        //".xml";	



        xmlFileName = subFolder + titleTin1.value + titleTin2.value + titleTin3.value + titleBranchCode.value +
        "-1701Qv2018-" +
        returnPeriod +
        ".xml";


        fileName = titleTin1.value + titleTin2.value + titleTin3.value + titleBranchCode.value +
		"-1701Qv2018-" +
		returnPeriod +
		".xml";

        return xmlFileName;
    }
    function createXMLFileName(subFolder) {
		var isAmendedReturn = isItAnAmendedReturn(); //check name of function if correct
        var xmlFileName = "";
        var titleTin1 = d.getElementById('frm1701q:txtTIN1');
        var titleTin2 = d.getElementById('frm1701q:txtTIN2');
        var titleTin3 = d.getElementById('frm1701q:txtTIN3');
        var titleBranchCode = d.getElementById('frm1701q:txtBranchCode');
        var titleTPName = d.getElementById('frm1701q:txtTaxpayerName');

        var qtr = "";
        if (d.getElementById('frm1701q:DateQuarter_1').checked == true) {
            qtr = "Q1";
        }
        if (d.getElementById('frm1701q:DateQuarter_2').checked == true) {
            qtr = "Q2";
        }
        if (d.getElementById('frm1701q:DateQuarter_3').checked == true) {
            qtr = "Q3";
        }
        var returnPeriod = d.getElementById('frm1701q:txtYear').value + qtr;

        //xmlFileName = "profile/1701q-" + titleTin1.value + titleTin2.value + titleTin3.value + titleBranchCode.value + "-" +
        //( (titleTPName.value.replace(/[ ,\^;\)'\(]+/g, '').length > 12) ? titleTPName.value.replace(/[ ,\^;\)'\(]+/g, '').substring(0,12).toLowerCase() : titleTPName.value.replace(/[ ,\^;\)'\(]+/g, '').toLowerCase() ) + 
        //"-" + dtFormatted +
        //".xml";	

        if (existingXMLFileName != null && existingXMLFileName.length > 0) {
            xmlFileName = existingXMLFileName;

        } else {

           
				xmlFileName = subFolder + titleTin1.value + titleTin2.value + titleTin3.value + titleBranchCode.value +
				"-1701Qv2018-" +
				returnPeriod +
				".xml";	
			}
        

      
			fileName = titleTin1.value + titleTin2.value + titleTin3.value + titleBranchCode.value +
			"-1701Qv2018-" +
			returnPeriod +
			".xml";	
		

        return xmlFileName;
    }

    function saveEncryptedProfile(isFromSubmit) {
        var isSaveSuccessful = saveXML(true);
        //saveXMLProfile(true);	
        var fnNew = "";

        if (isSaveSuccessful) {

            if (existingXMLFileName.indexOf('/') > -1) { //Means existingXMLFileName is the same as the preloaded file yyy
                fnNew = existingXMLFileName.substring(existingXMLFileName.indexOf('/') + 1, existingXMLFileName.length);
            } else {
                if (fileName.indexOf('/') > -1) { //Means fileName is the same as the preloaded file
                    fnNew = fileName.substring(fileName.indexOf('/') + 1, fileName.length);
                } else {
                    fnNew = fileName;
                }
            }
        } else {
            return;
        }

        if(document.getElementById('txtFinalFlag').value == "3"){ fnNew = fnNew.split(".xml")[0] + "#" + globalEmail + "#.xml"; }      var xmlFileName =  "IAF_RDO_Copy/" + fnNew; //createXMLFileName("IAF_RDO_Copy/");//
        msg.innerHTML = 'Generating File...';
        var fileSys = new ActiveXObject("Scripting.FileSystemObject");

        var xmlFile = "";
        //dgarfin todo: alert user that it will overwrite existing zzz
        if (doesFileExists(xmlFileName)) {
            //alert("File '" + xmlFileName + "' already exists!\n\nThis will overwrite existing data.");
        }
        xmlFile = fileSys.CreateTextFile(xmlFileName);
        fileNameToExport = fnNew;
        var allXML = "<?xml version='1.0'?>", tab = d.getElementById('xmlFormat').innerHTML;
        allXML += tab; //adds line break

        /*--------------------- follow this format for parsing --------------------------- */
        var elem = document.getElementById('frmMain').elements;
        for (var i = 0; i < elem.length; i++) {
            if (elem[i].type != 'button' && elem[i].type != 'hidden' && elem[i].type != 'undefined') {
                if (elem[i].type == 'text' || elem[i].type == 'select-one') {
                    allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab; //all select-one and text values
                }
                if (elem[i].type == 'radio' || elem[i].type == 'checkbox') {
                    allXML += "<div>" + elem[i].id + "=" + elem[i].checked + elem[i].id + "=</div>" + tab; //all radio and checkbox values			
                }

            }
        }
        /*--------------------- follow this format for parsing --------------------------- */

        allXML += tab + d.getElementById('xmlClose').innerHTML + "0";

        //Encryption of data content 'allXML' 
        //allXML = LZString.compress(allXML);
        //var encryptedAllXML = encrypt(allXML);

        xmlFile.write(allXML);
        xmlFile.close();
        // External compression and encryption
        var succ = EncryptFile(xmlFileName);

        msg.innerHTML = '';
        if (typeof (isFromSubmit) === "undefined") {
            if (confirm('File saved and encrypted.\nDo you want to save this in USB flash drive or CD-RW?')) {
                //alert("Make sure you already inserted your USB flash drive or CD-RW before proceeding.");		
                //show modal "Have Disk"...
                showModalExport();
                //window.history.go(0);
            } else { // return; //cancel finalcopy
                //exportTPFileInC();
                //alert("You have not saved the file to either your USB flash drive or CD-RW.\n\n In case you want to submit it via email,\nyou may locate it under : 'C:\\IAF_RDO_Copy'");
                //window.history.go(0);

                //refresh HTA page here. to address: 
                //Issue#380: A return tagged as final copy should not be edited by tp, rdo, rdc. Currently, user can still modify entries.
                //document.location.reload(true);
                disableAllElementIDs();
                d.getElementById('btnUpload').disabled = false;
                d.getElementById('frm1701q:txtCurrentPage').disabled = false;
                d.getElementById('frm1701q:btnPrevPage').disabled = false;
                d.getElementById('frm1701q:btnNextPage').disabled = false;

            }
        }
        else {
            disableAllElementIDs();
            d.getElementById('btnUpload').disabled = false;
            d.getElementById('frm1701q:txtCurrentPage').disabled = false;
            d.getElementById('frm1701q:btnPrevPage').disabled = false;
            d.getElementById('frm1701q:btnNextPage').disabled = false;
        }
        return fileSys.GetAbsolutePathName(xmlFileName);

    }

    function doesFileExists(xmlFile) {
        var fileSysObj = new ActiveXObject("Scripting.FileSystemObject");
        if (fileSysObj.FileExists(xmlFile)) {
            return true;
        } else {
            return false;
        }
    }

    function isItAnAmendedReturn(xmlFile) {
        if (d.getElementById('frm1701q:AmendedRtn_1').checked) {
            return true;
        } else {
            return false;
        }
    }

    function isItAFinalCopy(xmlFile) {
        var fsoXML = new ActiveXObject("Scripting.FileSystemObject");
        fn = fsoXML.OpenTextFile(xmlFile, 1);
        var fnContent = fn.ReadAll();
        fn.Close();

        if (fnContent.indexOf("All Rights Reserved BIR 2012.0") >= 0) {
            return true;
        } else {
            return false;
        }
    }

    function createNewXMLFileName(subFolder, xmlFileName) {
        //Conditions met here: (isFileExists && isFinalCopy && isAmendedReturn) 
        var fso = new ActiveXObject("Scripting.FileSystemObject");
        var fileNm = "";
        var newFileNm = "";
		var subFileName = "";
		var version = 0;

        if (xmlFileName.indexOf('V') == -1) {
            fileNm = xmlFileName.substring(xmlFileName.indexOf('/') + 1, xmlFileName.indexOf('.xml'));
        } else {
            fileNm = xmlFileName.substring(xmlFileName.indexOf('/') + 1, xmlFileName.indexOf('V'));
        }

        var sameFileNameCtr = 0;
       // if (fso.FileExists(xmlFileName)) {
            if (subFolder.length > 0 && fso.FolderExists(subFolder)) {
                var objEnum = new Enumerator(fso.GetFolder(subFolder).Files);
                for (i = 0; !objEnum.atEnd() ; objEnum.moveNext()) {
                    if (objEnum.item().name.indexOf(fileNm) > -1 && objEnum.item().name.indexOf('V') > -1) {
                        //sameFileNameCtr++;
						//as of 10/21/2016
						//no longer counts the file but gets the highest version number and add plus 1
						var isAFinalCopy = isItAFinalCopy(subFolder+objEnum.item().name);
						//if (isAFinalCopy) {
						subFileName = objEnum.item().name.substring(objEnum.item().name.indexOf('V')+1,objEnum.item().name.indexOf('.xml'));
							version = parseInt(subFileName);
						if (version >= sameFileNameCtr) {
							sameFileNameCtr = version+1;
						}
//}
                    }
                }

                if (sameFileNameCtr > 0) {
                    newFileNm = subFolder + fileNm + "V" + sameFileNameCtr + ".xml";
                    
                } else {
				//amended default
					newFileNm = subFolder + fileNm + "V1.xml";
                    //unlikely to happend since saveXML() altered filtered out the scenario that will call this function
                }
				return newFileNm;
            }
      //  } else {
            //unlikely to happend since saveXML() altered filtered out the scenario that will call this function
      //  }
    }

    function saveXML(isFinalCopy) {
        var isFileExists = false;
        var isAmendedReturn = false;
        var isAFinalCopy = false;

        if (gIsReadOnly && document.getElementById("txtFinalFlag").value != "2") {
            if (confirm('You will no longer be allowed to modify since this is already the final copy.\nDo you want to save this in USB flash drive or CD-RW instead?')) {
                var xmlFileName = createEncXMLFileName("IAF_RDO_Copy/");
                msg.innerHTML = 'Generating File...';
                var fileSys = new ActiveXObject("Scripting.FileSystemObject");
                var xmlFile = fileSys.CreateTextFile(xmlFileName); //(saveWhere);
                //
                fileNameToExport = fileName;
                var allXML = "<?xml version='1.0'?>", tab = d.getElementById('xmlFormat').innerHTML;
                allXML += tab; //adds line break

                /*--------------------- follow this format for parsing --------------------------- */
                var elem = document.getElementById('frmMain').elements;
                for (var i = 0; i < elem.length; i++) {
                    if (elem[i].type != 'button' && elem[i].type != 'hidden' && elem[i].type != 'undefined') {
                        if (elem[i].type == 'text' || elem[i].type == 'select-one') {
                            if (elem[i].id == 'frm1701q:txtTaxpayerName' || elem[i].id == 'frm1701q:txtLOB') {
                                allXML += "<div>" + elem[i].id + "=" + escape(elem[i].value) + elem[i].id + "=</div>" + tab;
                            }
                            else if (elem[i].id == 'frm1701q:txtAddress') {
								allXML += "<div>"+elem[i].id+"=" +escape(elem[i].value);
							}
							else if (elem[i].id == 'frm1701q:txtAddress2') {
								allXML += escape(elem[i].value)+"frm1701q:txtAddress=</div>"+tab;
							}
                            else {
                                allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab; //all select-one and text values
                            }
                        }
                        if (elem[i].type == 'radio' || elem[i].type == 'checkbox') {
                            allXML += "<div>" + elem[i].id + "=" + elem[i].checked + elem[i].id + "=</div>" + tab; //all radio and checkbox values			
                        }

                    }
                }
                /*--------------------- follow this format for parsing --------------------------- */

                allXML += tab + d.getElementById('xmlClose').innerHTML + "0";

                //Encryption of data content 'allXML' 
                //allXML = LZString.compress(allXML);
                //var encryptedAllXML = encrypt(allXML);

                xmlFile.write(allXML);
                xmlFile.close();
                // External compression and encryption
                var succ = EncryptFile(xmlFileName);

                msg.innerHTML = '';

                showModalExport();

                saveXMLProfile(true);
                // saveXML(true); 
            } else {
                return false;
            }
        } else {
            var valid = initialValidateBeforeSave();

            if (valid == true) {
				var xmlFileNameValidate = "";
				var isFinalFlag2 = false; 
                var xmlFileName = createXMLFileName("savefile/");
                msg.innerHTML = 'Generating File...';
                var fileSys = new ActiveXObject("Scripting.FileSystemObject");
                var xmlFile = "";

                //---------------------------------------------------------------
                //START:  New logic in handling amended returns			
                isFileExists = doesFileExists(xmlFileName);
                isAmendedReturn = isItAnAmendedReturn();
				//as of 10/21/2016
				//if there is already amended filed and will file a not amended,
				//it will restrict it
				if (isAmendedReturn == false) {
					
					if (xmlFileName.indexOf('V') == -1) {
						xmlFileNameValidate = xmlFileName.substring(xmlFileName.indexOf('/')+1,xmlFileName.indexOf('.xml'));			
					} else {
						xmlFileNameValidate = xmlFileName.substring(xmlFileName.indexOf('/')+1,xmlFileName.indexOf('V'));			
					}
					
					var hasVersion = false;
					var objEnum = new Enumerator(fileSys.GetFolder("savefile/").Files);
					for(i=0;!objEnum.atEnd();objEnum.moveNext()) {
						if (objEnum.item().name.indexOf(xmlFileNameValidate) > -1 && objEnum.item().name.indexOf("V") > -1) {
							hasVersion = true;
						}
					}	
                    			if (hasVersion) {
						if (!onExit)
							alert("If your intention is to make an amended return, kindly tick Amended Return to 'Yes' before hitting 'Save'or'Final Copy' or 'Submit'.");
						return false;
					}
              			  }
                if (isFileExists) {
                    isAFinalCopy = isItAFinalCopy(xmlFileName);  if(document.getElementById('txtFinalFlag').value == '2'){isAFinalCopy = false;
					isFinalFlag2 = true;}
                }

                //1) check if fileExists, if not regular routine
                if (isFileExists == false) {
				//as of 10/21/2016
						if (isAmendedReturn) {
							var fn = createNewXMLFileName("savefile/", xmlFileName);
							xmlFile = fileSys.CreateTextFile(fn);
							xmlFileName = fn;
							existingXMLFileName = fn;
						}
						else

                    xmlFile = fileSys.CreateTextFile(xmlFileName); //xmlFileName should be the newly created xml filename here.
                }
                    //2) if (fileExists && FinalCopy  && Amended) {versionFile} 
                else if (isFileExists && isAFinalCopy && isAmendedReturn) {
				//as of 10/21/2016
					if (existingXMLFileName != null && existingXMLFileName.length > 0) {
						xmlFile = fileSys.CreateTextFile(xmlFileName); 
						//xmlFileName should be the preloaded xml filename here.
						}
						else {
                    //versionFile xxx

                    var fn = createNewXMLFileName("savefile/", xmlFileName);
                    xmlFile = fileSys.CreateTextFile(fn);
                    xmlFileName = fn;
                    existingXMLFileName = fn;
                }
				}
                    //3)if (fileExists && FinalCopy  && Not Amended) {throw error message: "If your intention is to make an amended return, kindly tick Amended Return to 'Yes'".} 
                else if (isFileExists && isAFinalCopy && isAmendedReturn == false && document.getElementById('txtFinalFlag').value != '3') {
                    if (!onExit)
                         alert("If your intention is to make an amended return, kindly tick Amended Return to 'Yes' before hitting 'Save' or 'Final Copy' or 'Submit'.");
                    return false;
                }
                    //4) if (fileExists && Not FinalCopy  && Not Amended/Amended) {regular routine} 				
                else if (isFileExists && isAFinalCopy == false) {
				//as of 10/21/2016
					if (existingXMLFileName != null && existingXMLFileName.length > 0) {
						xmlFile = fileSys.CreateTextFile(xmlFileName); //xmlFileName should be the preloaded xml filename here.
						}
						else {
					if (isAmendedReturn && isFinalFlag2 == false) {
						var fn = createNewXMLFileName("savefile/", xmlFileName);
						xmlFile = fileSys.CreateTextFile(fn);
						xmlFileName = fn;
						existingXMLFileName = fn;
					}
					else

                    xmlFile = fileSys.CreateTextFile(xmlFileName); //xmlFileName should be the preloaded xml filename here.
                }
				}
                else {
                    xmlFile = fileSys.CreateTextFile(xmlFileName);
                }
                //END:  New logic in handling amended returns						
                //---------------------------------------------------------------

                //
                var allXML = "<?xml version='1.0'?>", tab = d.getElementById('xmlFormat').innerHTML;
                allXML += tab; //adds line break

                /*--------------------- follow this format for parsing --------------------------- */
                var elem = document.getElementById('frmMain').elements;
                //var elemVal = "";
                //Dev Note: This is only a utility so we can generate well-formed XML sample test data
                //Real requirement here are: 
                //loadXMLWellFormed() to mimic loadXML()
                //loadWFData()  to mimic loadData()
                //This is the original XML formatter per row with <div> </div> separator					
                for (var i = 0; i < elem.length; i++)
                    /*{
					if (elem[i].type != 'button' && elem[i].type != 'hidden' && elem[i].type != 'undefined') {		
						if (elem[i].type == 'text' || elem[i].type == 'select-one') {
						
							//With this well-formed XML, we need to validate field content if it has '>'  and '<'
							//if so, then replace it with : '&gt;' and '&lt;' respectively.							
							if (elem[i].value.indexOf('>') >= 0 && elem[i].value.indexOf('<') < 0) {
								elemVal = elem[i].value.replace(/[>]+/g, '&gt;');
							} 
							if (elem[i].value.indexOf('<') >= 0 && elem[i].value.indexOf('>') < 0) {
								elemVal = elem[i].value.replace(/[<]+/g, '&lt;');
							} 
							if (elem[i].value.indexOf('<') >= 0 && elem[i].value.indexOf('>') >= 0) {
								elemVal = elem[i].value.replace(/[<]+/g, '&lt;');
								elemVal = elemVal.replace(/[>]+/g, '&gt;');
							} 							
							else {
								elemVal = elem[i].value;
							}						
							
							allXML += "<"+elem[i].id+">"+elemVal+"</"+elem[i].id+">"+tab; //all select-one and text values
						}
						if (elem[i].type == 'radio' || elem[i].type == 'checkbox') {
							allXML += "<"+elem[i].id+">"+elem[i].checked+"</"+elem[i].id+">"+tab; //all radio and checkbox values			
						}							
					}
					//END: Dev Note			
				}*/ {
                    if (elem[i].type != 'button' && elem[i].type != 'hidden' && elem[i].type != 'undefined') {
                        if (elem[i].type == 'text' || elem[i].type == 'select-one') {
                            if (elem[i].id == 'frm1701q:txtTaxpayerName') {
                                allXML += "<div>" + elem[i].id + "=" + escape(elem[i].value) + elem[i].id + "=</div>" + tab;
                                p3TPName = escape(elem[i].value);
                            }
                            else if (elem[i].id == 'frm1701q:txtLOB') {
                                allXML += "<div>" + elem[i].id + "=" + escape(elem[i].value) + elem[i].id + "=</div>" + tab;
                                p3TPLineBus = escape(elem[i].value);
                            }
                            else if (elem[i].id == 'frm1701q:txtAddress') {
								allXML += "<div>"+elem[i].id+"=" +escape(elem[i].value);
								p3TPAddress = escape(elem[i].value);
							}
							else if (elem[i].id == 'frm1701q:txtAddress2') {
								allXML += escape(elem[i].value)+"frm1701q:txtAddress=</div>"+tab;
								p3TPAddress += escape(elem[i].value);
							}

                                //Get surcharge, compromise, interest, returnPeriod, filingDate
                                //basicTax, total penalties, total amount payable
                                //TIN, branchCode, rdoCode, TPClass, LOB, TPName, TelNo, Addr, Zip
                            else if (elem[i].id == 'frm1701q:txt64A') { //surcharge
                                allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
                                p3Surcharge = elem[i].value;
                            } else if (elem[i].id == 'frm1701q:txt65A') {   //interest
                                allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
                                p3Interest = elem[i].value;
                            } else if (elem[i].id == 'frm1701q:txt66A') {   //compromise
                                allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
                                p3Compromise = elem[i].value;
                            } else if (elem[i].id == 'frm1701q:txt63A') {   //tax payable/overpayment
                                allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
                                p3BasicTax = elem[i].value;
                            } else if (elem[i].id == 'frm1701q:txt67A') {   //total penalties
                                allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
                                p3TotalPenalties = elem[i].value;
                            } else if (elem[i].id == 'frm1701q:txt68A') {   //total amount payable/overpayment
                                allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
                                p3TotalAmountPayable = elem[i].value;
                            } else if (elem[i].id == 'frm1701q:txtTIN1') {
                                allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
                                p3TPTIN1 = elem[i].value;
                            } else if (elem[i].id == 'frm1701q:txtTIN2') {
                                allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
                                p3TPTIN2 = elem[i].value;
                            } else if (elem[i].id == 'frm1701q:txtTIN3') {
                                allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
                                p3TPTIN3 = elem[i].value;
                            } else if (elem[i].id == 'frm1701q:txtBranchCode') {
                                allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
                                p3TPBranchCode = elem[i].value;
                            } else if (elem[i].id == 'frm1701q:txtRDOCode') {
                                allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
                                p3TPRDOCode = elem[i].value;
                            }
                                /*else if (elem[i].id == 'frm1701q:txtLOB') {
                                    p3TPLineBus = escape(elem[i].value);
                                } else if (elem[i].id == 'frm1701q:txtTaxPayername') {
                                    p3TPName = escape(elem[i].value);
                                }*/
                            else if (elem[i].id == 'frm1701q:txtTelno') {
                                allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
                                p3TPTelNum = elem[i].value;
                            }
                                /*else if (elem[i].id == 'frm1701q:txtAddress') {
                                    p3TPAddress = escape(elem[i].value);
                                }*/
                            else if (elem[i].id == 'frm1701q:txtZipCode') {
                                allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
                                p3TPZip = elem[i].value;
                            }
                            //set page to 1
                            else if (elem[i].id == 'frm1701q:txtCurrentPage') {
                                allXML += "<div>" + elem[i].id + "=" + "1" + elem[i].id + "=</div>" + tab;
                            }
                            else {
                                allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab; //all select-one and text values
                            }
                        }
                        if (elem[i].type == 'radio' || elem[i].type == 'checkbox') {
                            allXML += "<div>" + elem[i].id + "=" + elem[i].checked + elem[i].id + "=</div>" + tab; //all radio and checkbox values			
                        }

                    }
                }
                p3TPTIN = p3TPTIN1 + p3TPTIN2 + p3TPTIN3;
                /*--------------------- follow this format for parsing --------------------------- */

                if (isFinalCopy) {
                    allXML += tab + d.getElementById('xmlClose').innerHTML + "0";
                    gIsReadOnly = true;
                } else {
                    allXML += tab + d.getElementById('xmlClose').innerHTML;
                }

                //Phase 3: This 'savefile' will be uploaded to IAF Infra for DI processing
                savedReturn = allXML;

                xmlFile.write(allXML);
                xmlFile.close();
                msg.innerHTML = '';

                if (isFinalCopy == false) {
                    alert('BIR Form saved successfully as : ' + xmlFileName);
                }
                saveXMLProfile(false);
                return true;
            }
        }
        return true;
    }

    function saveXMLsubmit(submit) {
        var valid = initialValidateBeforeSave();
        var isBFinalCopy = false;
        if (valid == true) {
			var xmlFileNameValidate = "";
            var xmlFileName = createXMLFileName("savefile/");
            msg.innerHTML = 'Generating File...';
            var fileSys = new ActiveXObject("Scripting.FileSystemObject");
            var xmlFile = "";

            //---------------------------------------------------------------
            //START:  New logic in handling amended returns			
            isFileExists = doesFileExists(xmlFileName);
            isAmendedReturn = isItAnAmendedReturn();
			//as of 10/21/2016
			//if there is already amended filed and will file a not amended,
			//it will restrict it
			if (isAmendedReturn == false) {
					if (xmlFileName.indexOf('V') == -1) {
						xmlFileNameValidate = xmlFileName.substring(xmlFileName.indexOf('/')+1, xmlFileName.indexOf('.xml'));			
					} else {
						xmlFileNameValidate = xmlFileName.substring(xmlFileName.indexOf('/')+1, xmlFileName.indexOf('V'));			
					}
					
				var hasVersion = false;
				var objEnum = new Enumerator(fileSys.GetFolder("savefile/").Files);
				for(i=0;!objEnum.atEnd();objEnum.moveNext()) {
					if (objEnum.item().name.indexOf(xmlFileName) > -1 && objEnum.item().name.indexOf("V") > -1) {
						hasVersion = true;
					}
				}	
                 		  if (hasVersion) {
					if (!onExit && !isSubmit)
						alert("If your intention is to make an amended return, kindly tick Amended Return to 'Yes' before hitting 'Save' or 'Final Copy'or 'Submit'.");
					return false;
				}
           			 }
            if (isFileExists) {
                if(document.getElementById('txtFinalFlag').value == '2'){isAFinalCopy = false;}
            }

            //1) check if fileExists, if not regular routine
            if (isFileExists == false) {

                xmlFile = fileSys.CreateTextFile(xmlFileName); //xmlFileName should be the newly created xml filename here.
            }
                //2) if (fileExists && FinalCopy  && Amended) {versionFile} 
            else if (isFileExists && isBFinalCopy && isAmendedReturn) {
                //versionFile xxx

                var fn = createNewXMLFileName("savefile/", xmlFileName);
                xmlFile = fileSys.CreateTextFile(fn);
                xmlFileName = fn;
                existingXMLFileName = fn;
            }
                //3)if (fileExists && FinalCopy  && Not Amended) {throw error message: "If your intention is to make an amended return, kindly tick Amended Return to 'Yes'".} 
            else if (isFileExists && isBFinalCopy && isAmendedReturn == false && document.getElementById('txtFinalFlag').value != '3') {
                if (!onExit && !isSubmit) {
                     alert("If your intention is to make an amended return, kindly tick Amended Return to 'Yes' before hitting 'Save' or 'Final Copy' or 'Submit'.");
                    return false;
                }
                else {
                    xmlFile = fileSys.CreateTextFile(xmlFileName);
                }
            }
                //4) if (fileExists && Not FinalCopy  && Not Amended/Amended) {regular routine} 				
            else if (isFileExists && isBFinalCopy == false) {

                xmlFile = fileSys.CreateTextFile(xmlFileName); //xmlFileName should be the preloaded xml filename here.
            }
            else {
                xmlFile = fileSys.CreateTextFile(xmlFileName);
            }
            //END:  New logic in handling amended returns						
            //---------------------------------------------------------------

            //
            var allXML = "<?xml version='1.0'?>", tab = d.getElementById('xmlFormat').innerHTML;
            allXML += tab; //adds line break

            /*--------------------- follow this format for parsing --------------------------- */
            var elem = document.getElementById('frmMain').elements;
            //var elemVal = "";
            //Dev Note: This is only a utility so we can generate well-formed XML sample test data
            //Real requirement here are: 
            //loadXMLWellFormed() to mimic loadXML()
            //loadWFData()  to mimic loadData()
            //This is the original XML formatter per row with <div> </div> separator					
            for (var i = 0; i < elem.length; i++)
                /*{
				if (elem[i].type != 'button' && elem[i].type != 'hidden' && elem[i].type != 'undefined') {		
					if (elem[i].type == 'text' || elem[i].type == 'select-one') {
					
						//With this well-formed XML, we need to validate field content if it has '>'  and '<'
						//if so, then replace it with : '&gt;' and '&lt;' respectively.							
						if (elem[i].value.indexOf('>') >= 0 && elem[i].value.indexOf('<') < 0) {
							elemVal = elem[i].value.replace(/[>]+/g, '&gt;');
						} 
						if (elem[i].value.indexOf('<') >= 0 && elem[i].value.indexOf('>') < 0) {
							elemVal = elem[i].value.replace(/[<]+/g, '&lt;');
						} 
						if (elem[i].value.indexOf('<') >= 0 && elem[i].value.indexOf('>') >= 0) {
							elemVal = elem[i].value.replace(/[<]+/g, '&lt;');
							elemVal = elemVal.replace(/[>]+/g, '&gt;');
						} 							
						else {
							elemVal = elem[i].value;
						}						
						
						allXML += "<"+elem[i].id+">"+elemVal+"</"+elem[i].id+">"+tab; //all select-one and text values
					}
					if (elem[i].type == 'radio' || elem[i].type == 'checkbox') {
						allXML += "<"+elem[i].id+">"+elem[i].checked+"</"+elem[i].id+">"+tab; //all radio and checkbox values			
					}							
				}
				//END: Dev Note			
			}*/ {
                if (elem[i].type != 'button' && elem[i].type != 'hidden' && elem[i].type != 'undefined') {
                    if (elem[i].type == 'text' || elem[i].type == 'select-one') {
                        if (elem[i].id == 'frm1701q:txtTaxpayerName') {
                            allXML += "<div>" + elem[i].id + "=" + escape(elem[i].value) + elem[i].id + "=</div>" + tab;
                            p3TPName = escape(elem[i].value);
                        }
                        else if (elem[i].id == 'frm1701q:txtLOB') {
                            allXML += "<div>" + elem[i].id + "=" + escape(elem[i].value) + elem[i].id + "=</div>" + tab;
                            p3TPLineBus = escape(elem[i].value);
                        }
                        else if (elem[i].id == 'frm1701q:txtAddress') {
							allXML += "<div>"+elem[i].id+"=" +escape(elem[i].value);
							p3TPAddress = escape(elem[i].value);
						}
						else if (elem[i].id == 'frm1701q:txtAddress2') {
							allXML += escape(elem[i].value)+"frm1701q:txtAddress=</div>"+tab;
							p3TPAddress += escape(elem[i].value);
						}

                            //Get surcharge, compromise, interest, returnPeriod, filingDate
                            //basicTax, total penalties, total amount payable
                            //TIN, branchCode, rdoCode, TPClass, LOB, TPName, TelNo, Addr, Zip
                        else if (elem[i].id == 'frm1701q:txt64A') { //surcharge
                            allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
                            p3Surcharge = elem[i].value;
                        } else if (elem[i].id == 'frm1701q:txt65A') {   //interest
                            allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
                            p3Interest = elem[i].value;
                        } else if (elem[i].id == 'frm1701q:txt66A') {   //compromise
                            allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
                            p3Compromise = elem[i].value;
                        } else if (elem[i].id == 'frm1701q:txt63A') {   //tax payable/overpayment
                            allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
                            p3BasicTax = elem[i].value;
                        } else if (elem[i].id == 'frm1701q:txt67A') {   //total penalties
                            allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
                            p3TotalPenalties = elem[i].value;
                        } else if (elem[i].id == 'frm1701q:txt68A') {   //total amount payable/overpayment
                            allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
                            p3TotalAmountPayable = elem[i].value;
                        } else if (elem[i].id == 'frm1701q:txtTIN1') {
                            allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
                            p3TPTIN1 = elem[i].value;
                        } else if (elem[i].id == 'frm1701q:txtTIN2') {
                            allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
                            p3TPTIN2 = elem[i].value;
                        } else if (elem[i].id == 'frm1701q:txtTIN3') {
                            allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
                            p3TPTIN3 = elem[i].value;
                        } else if (elem[i].id == 'frm1701q:txtBranchCode') {
                            allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
                            p3TPBranchCode = elem[i].value;
                        } else if (elem[i].id == 'frm1701q:txtRDOCode') {
                            allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
                            p3TPRDOCode = elem[i].value;
                        }
                            /*else if (elem[i].id == 'frm1701q:txtLOB') {
                                p3TPLineBus = escape(elem[i].value);
                            } else if (elem[i].id == 'frm1701q:txtTaxPayername') {
                                p3TPName = escape(elem[i].value);
                            }*/
                        else if (elem[i].id == 'frm1701q:txtTelno') {
                            allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
                            p3TPTelNum = elem[i].value;
                        }
                            /*else if (elem[i].id == 'frm1701q:txt11Address') {
                                p3TPAddress = escape(elem[i].value);
                            }*/
                        else if (elem[i].id == 'frm1701q:txtZipCode') {
                            allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab;
                            p3TPZip = elem[i].value;
                        }
                        //set page to 1
                        else if (elem[i].id == 'frm1701q:txtCurrentPage') {
                            allXML += "<div>" + elem[i].id + "=" + "1" + elem[i].id + "=</div>" + tab;
                        }
                        else {
                            allXML += "<div>" + elem[i].id + "=" + elem[i].value + elem[i].id + "=</div>" + tab; //all select-one and text values
                        }
                    }
                    if (elem[i].type == 'radio' || elem[i].type == 'checkbox') {
                        allXML += "<div>" + elem[i].id + "=" + elem[i].checked + elem[i].id + "=</div>" + tab; //all radio and checkbox values			
                    }

                }
            }
            p3TPTIN = p3TPTIN1 + p3TPTIN2 + p3TPTIN3;
            /*--------------------- follow this format for parsing --------------------------- */

            if (submit) {
                allXML += tab + d.getElementById('xmlClose').innerHTML + "0";
            } else {
                allXML += tab + d.getElementById('xmlClose').innerHTML;
            }

            //Phase 3: This 'savefile' will be uploaded to IAF Infra for DI processing
            savedReturn = allXML;

            xmlFile.write(allXML);
            xmlFile.close();
            msg.innerHTML = '';

            if (submit == false) {
                alert('BIR Form saved successfully as : ' + xmlFileName);
            }
        }
        return true;
    }
    var XMLrdoFile = '';

    function loadXMLrdo(fileLocation) {
        try {
            //This will load the Region file with filename 'fileLocation' if it exists
            var fsoXML = new ActiveXObject("Scripting.FileSystemObject");
            XMLrdoFile = fsoXML.OpenTextFile(fileLocation, 1);

            if (XMLrdoFile.AtEndOfStream)
                data = "";
            else {
                var responseRdo = d.getElementById('responseRdo'); //render file and write to hidden div
                responseRdo.innerHTML = XMLrdoFile.ReadAll(); //remove XML tag
                //responseRdo = replaceHtml(responseRdo, XMLrdoFile.ReadAll()); //Pattern:  el = replaceHtml(el, newHtml)
            }
            XMLrdoFile.Close(); //alert( responseRdo.innerHTML ); //Debug			
            loadRdo();	/*This will load ATC onto an array*/
        } catch (e) {
            msg.innerHTML = ""; //"Region File not Found.";
        } //this will Alert File not Found if it doesn't exist
    }

    var rdoCount = 0;

    function loadRdo() {
        /*This will load data onto an array*/
        var response = d.getElementById("responseRdo");

        var rdoCnt = String(response.innerHTML).split('rdoCount=');
        rdoCount = rdoCnt[1];

        var k = 0;
        //loads rdoList from xml
        for (var i = 1; i <= rdoCount; i++) {

            var rdo = String(response.innerHTML).split('rdo' + i + ':');
            var rdoStr = rdo[1];

            //Ensure that before writing to rdoPropertyJS the formType 1701Q is traceable in rdoStr
            if (rdoStr.indexOf('1701Q') >= 0) {
                var rdoValues = rdoStr.split('~');
                var rdoCode = rdoValues[0];
                var description = rdoValues[1];

                var objRdo = new rdoPropertyJS(rdoCode, description);
                rdoList[k] = objRdo;
                k++;
                //alert('1701Q successfully created array #'+i);

            } else {
                //alert('1701Q not found in array #'+i);
                continue;
            }
        }
    }

    /*--------------------------------------------------------------*/

    function blockletter(e) {
        var number = parseFloat(e.value).toFixed(2);
        if (isNaN(number)) {
            var zero = 0;
            e.value = parseFloat(zero).toFixed(2);
            //e.value = "";
        } else {
            e.value = '' + number;
            if (e.value < 0) {
                var zero = 0;
                e.value = parseFloat(zero).toFixed(2);
            }

        }
    }

    function blockletterWithout2Decimal(e) {
        var number = parseFloat(e.value);
        if (isNaN(number)) {
            //var zero = 0;
            //e.value = parseFloat(zero).toFixed(2);
            e.value = "";
        } else {
            e.value = '' + number.toFixed(0);
        }
    }

    //validate date
    function validateDate(element) {
        var strmmddyyyy = element.value;
        var isValid = true;
        var currentDate = new Date();
        var inputDate = new Date();

        if (strmmddyyyy != "") {
            var result = strmmddyyyy.split("/");
            var isLeap = new Date(result[2], 1, 29).getMonth() === 1;
            var month31 = (['01', '03', '05', '07', '08', '10', '12']);
            var month30 = (['04', '06', '09', '11']);
            var month = result[0];
            var day = result[1];
            if (result.length === 3) {
                if (isNaN(result[0] || result[1] || result[2])) {
                    isValid = false;
                }
                else if ((result[0].length != 2 || (result[0] > 12 || result[0] < 1))) {
                    // numeric check if greater not than 31 - Month.
                    isValid = false;
                }
                else if (result[1].length != 2 || (result[1] > 31 || result[1] < 1)) {
                    // numeric check if Date.
                    isValid = false;
                }
                else if (result[2].length != 4) {
                    isValid = false;
                }
                else if (month == 2) {
                    if (!isLeap && day == 29) {
                        isValid = false;
                    }
                    else if (!isLeap && day > 29) {
                        isValid = false;
                    }
                    else if (isLeap && day > 29) {
                        isValid = false;
                    }
                }
                else if (month31.contains(month) && day > 31) {
                    isValid = false;
                }
                else if (month30.contains(month) && day > 30) {
                    isValid = false;
                }

                inputDate = new Date(result[2], month - 1, day);
            }
            else {
                isValid = false;
            }
        }

        if (!isValid) {
            alert('Please provide a valid date. (MM/DD/YYYY format)');
            element.value = '';
            element.focus();
        }
        else if (inputDate > currentDate) {
            alert('This date cannot be a future date.');
            element.value = '';
            element.focus();
        }

        return isValid;
	}

    function item52Validate(person) {
        if (person == "taxpayer") {
            if (NumWithComma(d.getElementById("frm1701q:txt52A").value) > 250000) {
                alert ("Item 52A cannot be more than P250,000.");
                d.getElementById("frm1701q:txt52A").value = (0).toFixed(2);
            }
        }
        else {
            if (NumWithComma(d.getElementById("frm1701q:txt52B").value) > 250000) {
                alert ("Item 52A cannot be more than P250,000.");
                d.getElementById("frm1701q:txt52B").value = (0).toFixed(2);
            }
        }
    }

    function validateYear() {
        var dt = new Date();
        if( d.getElementById('frm1701q:txtYear').value*1 > dt.getFullYear()*1   )
        {
            alert("Year (Item 1) cannot be greater than or equal to current year.")
            d.getElementById('frm1701q:txtYear').value = "";
            return;
        }
    }

    function validate() {
        var dt = new Date();
        if (d.getElementById('frm1701q:txtYear').value == "") {
            alert("Please enter a valid year in Item 1."); return;
        }
        if( d.getElementById('frm1701q:txtYear').value*1 > dt.getFullYear()*1   )
        {
            alert("Invalid date entry on Item no.1. Entry should not be later than Current Date.")
            return;
        }
        if (d.getElementById('frm1701q:txtYear').value * 1 < 1900) {
            alert("Invalid date entry on Item no.1. Entry should not be lower than 1900.")
            return;
        }
        if (d.getElementById('frm1701q:DateQuarter_1').checked == false && d.getElementById('frm1701q:DateQuarter_2').checked == false && d.getElementById('frm1701q:DateQuarter_3').checked == false) {
            alert("Please select quarter in Item 2."); return;
        }// can be optional

        //--- dgarfin : Added 'Background Information' field validation for Phase 2
        if ((d.getElementById('frm1701q:txtTIN1').value == "" || d.getElementById('frm1701q:txtTIN2').value == "" || d.getElementById('frm1701q:txtTIN3').value == "" || d.getElementById('frm1701q:txtBranchCode').value == "")) {
            alert("Please enter a valid TIN number on Item 5.");
            return;
        }

        if ((d.getElementById('frm1701q:txtTIN1').value.length != 3 || d.getElementById('frm1701q:txtTIN2').value.length != 3 || d.getElementById('frm1701q:txtTIN3').value.length != 3 || d.getElementById('frm1701q:txtBranchCode').value.length < 3)) {
            alert("Please enter a valid TIN number on Item 5.");
            return;
        }
        if ((d.getElementById('frm1701q:txtRDOCode').selectedIndex == 0)) {
            alert("Please enter a valid RDO Code on Item 6.");
            return;
        }
        if ((d.getElementById('frm1701q:txtTaxpayerName').value == "")) {
            alert("Please enter a valid Taxpayer Name on Item 9.");
            return;
        }
        if ((d.getElementById('frm1701q:txtAddress').value == "")) {
            alert("Please enter Taxpayer's Registered Address on Item 10.");
            return;
        }
        /* if (d.getElementById('frm1701q:txtBirthDate').value == "") {
            alert("Please indicate Birth Date of Taxpayer on item 11.");
            return true;
        } 
        if (document.getElementById('frm1701q:txtBirthDate').value.split('/')[2] > dt.getFullYear() * 1) {
            alert("Birth Year on Item 11 should not be later than current year.");
            return false;
        } */
        if (d.getElementById('frm1701q:txtBirthMonth').value != "" || d.getElementById('frm1701q:txtBirthDay').value != "" || d.getElementById('frm1701q:txtBirthYear').value != "") {
            if (validateMonthDayYearDate(d.getElementById('frm1701q:txtBirthMonth').value + "/" + d.getElementById('frm1701q:txtBirthDay').value + "/" + d.getElementById('frm1701q:txtBirthYear').value)) {
                alert("Invalid birth date on item 11 of Taxpayer.  Please check date format.");
                return true;
            }
        } else {
            alert("Please indicate Birth Date of Taxpayer on item 11.");
            return true;
        }
        if (document.getElementById('frm1701q:txtBirthYear').value * 1 > dt.getFullYear() * 1) {
            alert("Birth Year on Item 11 should not be later than current year.");
            return false;
        }
        if (document.getElementById('frm1701q:txtZipCode').value == "") {
            alert("Please enter Zip Code on Item 10A.");
            return;
        }

        //Spouse	
        if ((d.getElementById('frm1701q:txtSpouseTIN1').value != "" || d.getElementById('frm1701q:txtSpouseTIN2').value != "" || d.getElementById('frm1701q:txtSpouseTIN3').value != "")) {
            if ((d.getElementById('frm1701q:txtSpouseTIN1').value.length != 3 || d.getElementById('frm1701q:txtSpouseTIN2').value.length != 3 || d.getElementById('frm1701q:txtSpouseTIN3').value.length != 3 || d.getElementById('frm1701q:txtSpouseBranchCode').value.length != 3)) {
                alert("Please enter a valid TIN number on Item 17.");
                return;
            }
            var tinChkCode = getTinChkCode($('#frm1701q\\:txtSpouseTIN1').val(),$('#frm1701q\\:txtSpouseTIN2').val(),$('#frm1701q\\:txtSpouseTIN3').val());
            if ( tinChkCode !== 0) {
            	alert(getChkTinErrDesc(tinChkCode) + " on Item 17.");
            	return;
            } 
            if ((d.getElementById('frm1701q:txtSpouseRDOCode').selectedIndex == 0)) {
                alert("Please enter a valid RDO Code on Item 18.");
                return;
            }
            if ((d.getElementById('frm1701q:txtSpouseName').value == "")) {
                alert("Please enter Spouse Name on Item 21.");
                return;
            }
            if (d.getElementById('frm1701q:optSpouseATC_1').checked == false && d.getElementById('frm1701q:optSpouseATC_2').checked == false && d.getElementById('frm1701q:optSpouseATC_3').checked == false && d.getElementById('frm1701q:optSpouseATC_4').checked == false && d.getElementById('frm1701q:optSpouseATC_5').checked == false && d.getElementById('frm1701q:optSpouseATC_6').checked == false && d.getElementById('frm1701q:optSpouseATC_7').checked == false) {
                alert("Please select an option for Item 20."); return;
            }
        }

        //--- dgarfin : Added 'Background Information' field validation for Phase 2		

        if (d.getElementById('frm1701q:optType_1').checked == false && d.getElementById('frm1701q:optType_2').checked == false && d.getElementById('frm1701q:optType_3').checked == false && d.getElementById('frm1701q:optType_4').checked == false) {
            alert("Please select an option for Item 7."); return;
        }
        if (d.getElementById('frm1701q:optATC_1').checked == false && d.getElementById('frm1701q:optATC_2').checked == false && d.getElementById('frm1701q:optATC_3').checked == false && d.getElementById('frm1701q:optATC_4').checked == false && d.getElementById('frm1701q:optATC_5').checked == false && d.getElementById('frm1701q:optATC_6').checked == false) {
            alert("Please select an option for Item 8."); return;
        }// can
        if (d.getElementById('frm1701q:optTaxRate_1').checked == false && d.getElementById('frm1701q:optTaxRate_2').checked == false) {
            alert("Please select an option for Item 16."); return;
        }
        if (d.getElementById('frm1701q:optTaxRate_1').checked == true && d.getElementById('frm1701q:optMethodOfDeduction:_1').checked == false && d.getElementById('frm1701q:optMethodOfDeduction:_2').checked == false) {
            alert("Please select an option for Item 16A."); return;
        }
        if (d.getElementById("frm1701q:txtSpouseName").value != "") {
            if (d.getElementById('frm1701q:optSpouseType_1').checked == false && d.getElementById('frm1701q:optSpouseType_2').checked == false && d.getElementById('frm1701q:optSpouseType_3').checked == false) {
                alert("Please select an option for Item 19."); return;
            }
            if (d.getElementById('frm1701q:optSpouseATC_1').checked == false && d.getElementById('frm1701q:optSpouseATC_2').checked == false && d.getElementById('frm1701q:optSpouseATC_3').checked == false && d.getElementById('frm1701q:optSpouseATC_4').checked == false && d.getElementById('frm1701q:optSpouseATC_5').checked == false && d.getElementById('frm1701q:optSpouseATC_6').checked == false && d.getElementById('frm1701q:optSpouseATC_7').checked == false) {
                alert("Please select an option for Item 20."); return;
            }
            if (d.getElementById('frm1701q:optSpouseTaxRate_1').checked == false && d.getElementById('frm1701q:optSpouseTaxRate_2').checked == false) {
                if (d.getElementById('frm1701q:optSpouseType_3').checked == false) {
                    alert("Please select an option for Item 25."); return;
                }
            }
        }

        disableAllControl();
        alert("Validation successful. Click on Edit if you wish to modify your entries.");
        return;
    }

    var disableElem = true;
    var enableElem = false;
    function disableAllControl() {
        d.getElementById('frm1701q:txtSheets').disabled = true;
        d.getElementById('frm1701q:txtTIN1').disabled = true;
        d.getElementById('frm1701q:txtTIN2').disabled = true;
        d.getElementById('frm1701q:txtTIN3').disabled = true;
        d.getElementById('frm1701q:txtBranchCode').disabled = true;
        d.getElementById('frm1701q:txtRDOCode').disabled = true;
        d.getElementById('frm1701q:txtSpouseTIN1').disabled = true;
        d.getElementById('frm1701q:txtSpouseTIN2').disabled = true;
        d.getElementById('frm1701q:txtSpouseTIN3').disabled = true;
        d.getElementById('frm1701q:txtSpouseBranchCode').disabled = true;
        d.getElementById('frm1701q:txtSpouseRDOCode').disabled = true;
        d.getElementById('frm1701q:txtTaxpayerName').disabled = true;
        d.getElementById('frm1701q:txtSpouseName').disabled = true;
        d.getElementById('frm1701q:txtAddress').disabled = true;
        //d.getElementById('frm1701q:txtBirthDate').disabled = true;
        d.getElementById('frm1701q:txtBirthMonth').disabled = true;
        d.getElementById('frm1701q:txtBirthDay').disabled = true;
        d.getElementById('frm1701q:txtBirthYear').disabled = true;
        d.getElementById('frm1701q:txtZipCode').disabled = true;
        d.getElementById('txtEmail').disabled = true;
        d.getElementById('frm1701q:txtCitizenship').disabled = true;
        d.getElementById('frm1701q:txtForeignTaxNumber').disabled = true;
        d.getElementById('frm1701q:optForeignTaxCredits_1').disabled = true;
        d.getElementById('frm1701q:optForeignTaxCredits_2').disabled = true;
        d.getElementById('frm1701q:optTaxRate_1').disabled = true;
        d.getElementById('frm1701q:optTaxRate_2').disabled = true;
        d.getElementById("frm1701q:txt59A").disabled = true;
        d.getElementById("frm1701q:txt59B").disabled = true;
        d.getElementById('frm1701q:AmendedRtn_1').disabled = true;
        d.getElementById('frm1701q:AmendedRtn_2').disabled = true;
        d.getElementById('frm1701q:txtYear').disabled = true;
        d.getElementById('frm1701q:DateQuarter_1').disabled = true;
        d.getElementById('frm1701q:DateQuarter_2').disabled = true;
        d.getElementById('frm1701q:DateQuarter_3').disabled = true;
        d.getElementById('frm1701q:optType_1').disabled = true;
        d.getElementById('frm1701q:optType_2').disabled = true;
        d.getElementById('frm1701q:optType_3').disabled = true;
        d.getElementById('frm1701q:optType_4').disabled = true;
        d.getElementById('frm1701q:optATC_1').disabled = true;
        d.getElementById('frm1701q:optATC_2').disabled = true;
        d.getElementById('frm1701q:optATC_3').disabled = true;
        d.getElementById('frm1701q:optATC_4').disabled = true;
        d.getElementById('frm1701q:optATC_5').disabled = true;
        d.getElementById('frm1701q:optATC_6').disabled = true;
        d.getElementById('frm1701q:optMethodOfDeduction:_1').disabled = true;
        d.getElementById('frm1701q:optMethodOfDeduction:_2').disabled = true;
        
        d.getElementById('frm1701q:optSpouseType_1').disabled = true;
        d.getElementById('frm1701q:optSpouseType_2').disabled = true;
        d.getElementById('frm1701q:optSpouseType_3').disabled = true;
        d.getElementById('frm1701q:txtSpouseCitizenship').disabled = true;
        d.getElementById('frm1701q:txtSpouseForeignTaxNum').disabled = true;
        d.getElementById('frm1701q:optSpouseForeignTaxCred_1').disabled = true;
        d.getElementById('frm1701q:optSpouseForeignTaxCred_2').disabled = true;
        d.getElementById('frm1701q:optSpouseATC_1').disabled = true;
        d.getElementById('frm1701q:optSpouseATC_2').disabled = true;
        d.getElementById('frm1701q:optSpouseATC_3').disabled = true;
        d.getElementById('frm1701q:optSpouseATC_4').disabled = true;
        d.getElementById('frm1701q:optSpouseATC_5').disabled = true;
        d.getElementById('frm1701q:optSpouseATC_6').disabled = true;
        d.getElementById('frm1701q:optSpouseATC_7').disabled = true;
        d.getElementById('frm1701q:optSpouseMethod:_1').disabled = true;
        d.getElementById('frm1701q:optSpouseMethod:_2').disabled = true;
        d.getElementById('frm1701q:optSpouseTaxRate_1').disabled = true;
        d.getElementById('frm1701q:optSpouseTaxRate_2').disabled = true;

        d.getElementById('frm1701q:txt43Desc').disabled = true;
        d.getElementById('frm1701q:txt48Desc').disabled = true;
        d.getElementById('frm1701q:txt61Desc').disabled = true;

        for (index = 36; index < 69 ; index++) {
            d.getElementById("frm1701q:txt" + index + "A").disabled = true;
        }
        for (index = 36; index < 69 ; index++) {
        d.getElementById("frm1701q:txt" + index + "B").disabled = true;
        }

        d.getElementById('frm1701q:txtCurrentPage').disabled = true;
        d.getElementById('frm1701q:cmdValidate').disabled = true;
        d.getElementById('frm1701q:cmdEdit').disabled = false;
        d.getElementById('btnPrint').disabled = false;
        d.getElementById('frm1701q:btnFinalCopy').disabled = false;
        d.getElementById('btnUpload').disabled = false;
        disableElem;
        enableElem;
    }

    function enableAllControl() {
        d.getElementById('frm1701q:txtSheets').disabled = false;
        d.getElementById('frm1701q:txtSpouseTIN1').disabled = false;
        d.getElementById('frm1701q:txtSpouseTIN2').disabled = false;
        d.getElementById('frm1701q:txtSpouseTIN3').disabled = false;
        d.getElementById('frm1701q:txtSpouseBranchCode').disabled = false;
        d.getElementById('frm1701q:txtSpouseRDOCode').disabled = false;
        d.getElementById('frm1701q:txtSpouseName').disabled = false;
        //d.getElementById('frm1701q:txtBirthDate').disabled = false;
        d.getElementById('frm1701q:txtBirthMonth').disabled = false;
        d.getElementById('frm1701q:txtBirthDay').disabled = false;
        d.getElementById('frm1701q:txtBirthYear').disabled = false;
        d.getElementById('frm1701q:AmendedRtn_1').disabled = false;
        d.getElementById('frm1701q:AmendedRtn_2').disabled = false;
        d.getElementById('frm1701q:txtYear').disabled = false;
        d.getElementById('frm1701q:DateQuarter_1').disabled = false;
        d.getElementById('frm1701q:DateQuarter_2').disabled = false;
        d.getElementById('frm1701q:DateQuarter_3').disabled = false;
        d.getElementById('frm1701q:txtCitizenship').disabled = false;
        d.getElementById('frm1701q:txtForeignTaxNumber').disabled = false;
        d.getElementById('frm1701q:optForeignTaxCredits_1').disabled = false;
        d.getElementById('frm1701q:optForeignTaxCredits_2').disabled = false;
        d.getElementById('frm1701q:optTaxRate_1').disabled = false;
        d.getElementById('frm1701q:optTaxRate_2').disabled = false;
        d.getElementById('frm1701q:optType_1').disabled = false;
        d.getElementById('frm1701q:optType_2').disabled = false;
        d.getElementById('frm1701q:optType_3').disabled = false;
        d.getElementById('frm1701q:optType_4').disabled = false;
        d.getElementById('frm1701q:optATC_1').disabled = false;
        d.getElementById('frm1701q:optATC_2').disabled = false;
        d.getElementById('frm1701q:optATC_3').disabled = false;
        d.getElementById('frm1701q:optATC_4').disabled = false;
        d.getElementById('frm1701q:optATC_5').disabled = false;
        d.getElementById('frm1701q:optATC_6').disabled = false;
        d.getElementById('frm1701q:optMethodOfDeduction:_1').disabled = false;
        d.getElementById('frm1701q:optMethodOfDeduction:_2').disabled = false;
        
        d.getElementById('frm1701q:optSpouseType_1').disabled = false;
        d.getElementById('frm1701q:optSpouseType_2').disabled = false;
        d.getElementById('frm1701q:optSpouseType_3').disabled = false;
        d.getElementById('frm1701q:txtSpouseCitizenship').disabled = false;
        d.getElementById('frm1701q:txtSpouseForeignTaxNum').disabled = false;
        d.getElementById('frm1701q:optSpouseForeignTaxCred_1').disabled = false;
        d.getElementById('frm1701q:optSpouseForeignTaxCred_2').disabled = false;
        d.getElementById('frm1701q:optSpouseATC_1').disabled = false;
        d.getElementById('frm1701q:optSpouseATC_2').disabled = false;
        d.getElementById('frm1701q:optSpouseATC_3').disabled = false;
        d.getElementById('frm1701q:optSpouseATC_4').disabled = false;
        d.getElementById('frm1701q:optSpouseATC_5').disabled = false;
        d.getElementById('frm1701q:optSpouseATC_6').disabled = false;
        d.getElementById('frm1701q:optSpouseATC_7').disabled = false;
        d.getElementById('frm1701q:optSpouseMethod:_1').disabled = false;
        d.getElementById('frm1701q:optSpouseMethod:_2').disabled = false;
        d.getElementById('frm1701q:optSpouseTaxRate_1').disabled = false;
        d.getElementById('frm1701q:optSpouseTaxRate_2').disabled = false;
        
        
        //schedule 1
        if (d.getElementById("frm1701q:optTaxRate_1").checked == true) {
            for (index = 36; index < 47 ; index++) {
                if (d.getElementById("frm1701q:optMethodOfDeduction:_1").checked == true) {
                    if (index == 37 || index == 39) {
                        d.getElementById("frm1701q:txt" + index + "A").disabled = false;
                    }
                }
                if (index == 36 || index == 42 || index == 43 || index == 44) {
                    d.getElementById("frm1701q:txt" + index + "A").disabled = false;
                }
            }
            d.getElementById("frm1701q:txt43Desc").disabled = false;
        }

        //schedule 2
        if (d.getElementById("frm1701q:optTaxRate_2").checked == true) {
            for (index = 47; index < 55 ; index++) {
                if (index == 47 || index == 48 || index == 50 || index == 52) {
                    d.getElementById("frm1701q:txt" + index + "A").disabled = false;
                }
            }
            d.getElementById("frm1701q:txt48Desc").disabled = false;
        }

        //Spouse
        if (d.getElementById("frm1701q:txtSpouseName").value != "") {
            //schedule 1
            if (d.getElementById("frm1701q:optTaxRate_1").checked == true) {
                for (index = 36; index < 47 ; index++) {
                    if (d.getElementById("frm1701q:optMethodOfDeduction:_1").checked == true) {
                        if (index == 37 || index == 39) {
                            d.getElementById("frm1701q:txt" + index + "B").disabled = false;
                        }
                    }
                    if (index == 36 || index == 42 || index == 43 || index == 44) {
                        d.getElementById("frm1701q:txt" + index + "B").disabled = false;
                    }
                }
            }

            //schedule 2
            if (d.getElementById("frm1701q:optTaxRate_2").checked == true) {
                for (index = 47; index < 55 ; index++) {
                    if (index == 47 || index == 48 || index == 50 || index == 52) {
                        d.getElementById("frm1701q:txt" + index + "B").disabled = false;
                    }
                }
            }
        }

        for (index = 55; index < 69; index++) {
            if (index == 62 || index == 63 || index == 67 || index == 68) {
                d.getElementById("frm1701q:txt" + index + "A").disabled = true;
            d.getElementById("frm1701q:txt" + index + "B").disabled = true;
            }
            else {
            d.getElementById("frm1701q:txt" + index + "A").disabled = false;
            d.getElementById("frm1701q:txt" + index + "B").disabled = false;
            }
        }
        d.getElementById("frm1701q:txt61Desc").disabled = false;

        if (d.getElementById('frm1701q:optMethodOfDeduction:_1').checked == true) {
            ItemizedDeduct();
        } else if (d.getElementById('frm1701q:optMethodOfDeduction:_2').checked == true) {
            OptionalDeduct();
        }

        if (d.getElementById("frm1701q:txtSpouseName").value != "") {
            if (d.getElementById('frm1701q:optSpouseMethod:_1').checked == true) {
                ItemizedDeductSpouse();
            } else if (d.getElementById('frm1701q:optSpouseMethod:_2').checked == true) {
                ItemizedDeductSpouse();
                OptionalDeductSpouse();
            }
        }

        if (d.getElementById('frm1701q:AmendedRtn_1').checked) {
            if (d.getElementById("frm1701q:txtSpouseName").value != "") {
                d.getElementById("frm1701q:txt59A").disabled = false;
                d.getElementById("frm1701q:txt59B").disabled = false;
            } else {
                d.getElementById("frm1701q:txt59A").disabled = false;
                d.getElementById("frm1701q:txt59B").disabled = true;
            }
        } else {
            d.getElementById("frm1701q:txt59A").disabled = true;
            d.getElementById("frm1701q:txt59B").disabled = true;
        }

        d.getElementById('frm1701q:txtCurrentPage').disabled = false;
        d.getElementById('frm1701q:cmdValidate').disabled = false;
        d.getElementById('frm1701q:cmdEdit').disabled = true;
        d.getElementById('btnPrint').disabled = true;
        d.getElementById('frm1701q:btnFinalCopy').disabled = true;
        d.getElementById('btnUpload').disabled = true;

        if (qs('xmlFileName') != null && qs('xmlFileName').indexOf('.xml') > -1) {
            d.getElementById('frm1701q:txtYear').disabled = true;
            d.getElementById('frm1701q:DateQuarter_1').disabled = true;
            d.getElementById('frm1701q:DateQuarter_2').disabled = true;
            d.getElementById('frm1701q:DateQuarter_3').disabled = true;
        }

        disableElem;
        enableElem;
		document.getElementById('frm1701q:txtTIN1').disabled = true; document.getElementById('frm1701q:txtTIN2').disabled = true; document.getElementById('frm1701q:txtTIN3').disabled = true; document.getElementById('frm1701q:txtBranchCode').disabled = true;
    }

    function getRdo() {
        var data = "<select class='iceSelOneMnu' id='frm1701q:txtRDOCode' name='frm1701q:txtRDOCode' size='1' disabled ><option value='000'> </option>";
        var data2 = "<select class='iceSelOneMnu' id='frm1701q:txtSpouseRDOCode' name='frm1701q:txtSpouseRDOCode' size='1'><option value='000'> </option>";
        for (var i = 0; i < rdoList.length; i++) {
            var rdo = rdoList[i];
            data = data + "<option value='" + rdo.rdoCode + "'>" + rdo.description + "</option>";
            data2 = data2 + "<option value='" + rdo.rdoCode + "'>" + rdo.description + "</option>";
        }
        data = data + "</select>"
        data2 = data2 + "</select>"

        $('#rdoSelect').html(data);
        $('#rdoSelect2').html(data2);
    }

    function clearCheck(id) {
        if (d.getElementById(id).waschecked == true) {
            d.getElementById(id).checked = false;
            d.getElementById(id).waschecked = false;
        }
        else {
            d.getElementById(id).waschecked = true;
        }
    }

    function enableSpouse() {
        d.getElementById("frm1701q:txtSpouseTIN1").disabled = false;
        d.getElementById("frm1701q:txtSpouseTIN2").disabled = false;
        d.getElementById("frm1701q:txtSpouseTIN3").disabled = false;
        d.getElementById("frm1701q:txtSpouseBranchCode").disabled = false;
        d.getElementById('frm1701q:txtSpouseRDOCode').disabled = false;
        d.getElementById('frm1701q:txtSpouseName').disabled = false;
        d.getElementById('frm1701q:txtSpouseCitizenship').disabled = false;
        d.getElementById('frm1701q:txtForeignTaxNumber').disabled = false;
        d.getElementById('frm1701q:optSpouseForeignTaxCred_1').disabled = false;
        d.getElementById('frm1701q:optSpouseForeignTaxCred_2').disabled = false;
        d.getElementById("frm1701q:optSpouseType_1").disabled = false;
        d.getElementById("frm1701q:optSpouseType_2").disabled = false;
        d.getElementById("frm1701q:optSpouseType_3").disabled = false;
        d.getElementById('frm1701q:optSpouseATC_1').disabled = false;
        d.getElementById('frm1701q:optSpouseATC_2').disabled = false;
        d.getElementById('frm1701q:optSpouseATC_3').disabled = false;
        d.getElementById('frm1701q:optSpouseATC_4').disabled = false;
        d.getElementById('frm1701q:optSpouseATC_5').disabled = false;
        d.getElementById('frm1701q:optSpouseATC_6').disabled = false;
        d.getElementById('frm1701q:optSpouseATC_7').disabled = false;
        d.getElementById('frm1701q:optSpouseTaxRate_1').disabled = false;
        d.getElementById('frm1701q:optSpouseTaxRate_2').disabled = false;
        d.getElementById('frm1701q:optSpouseMethod:_1').disabled = false;
        d.getElementById('frm1701q:optSpouseMethod:_2').disabled = false;
        
    }

    function disableSpouse() {
        d.getElementById("frm1701q:txtSpouseTIN1").value = "";
        d.getElementById("frm1701q:txtSpouseTIN2").value = "";
        d.getElementById("frm1701q:txtSpouseTIN3").value = "";
        d.getElementById("frm1701q:txtSpouseBranchCode").value = "00000";
        d.getElementById("frm1701q:txtSpouseRDOCode").value = "";
        d.getElementById('frm1701q:txtSpouseName').value = "";
        d.getElementById('frm1701q:txtSpouseCitizenship').value = "";
        d.getElementById('frm1701q:txtSpouseForeignTaxNum').value = "";
        d.getElementById('frm1701q:optSpouseForeignTaxCred_1').checked = false;
        d.getElementById('frm1701q:optSpouseForeignTaxCred_2').checked = false;
        d.getElementById("frm1701q:txtSpouseTIN1").disabled = true;
        d.getElementById("frm1701q:txtSpouseTIN2").disabled = true;
        d.getElementById("frm1701q:txtSpouseTIN3").disabled = true;
        d.getElementById("frm1701q:txtSpouseBranchCode").disabled = true;
        d.getElementById('frm1701q:txtSpouseRDOCode').disabled = true;
        d.getElementById('frm1701q:txtSpouseName').disabled = true;
        d.getElementById('frm1701q:txtSpouseCitizenship').disabled = true;
        d.getElementById('frm1701q:txtSpouseForeignTaxNum').disabled = true;
        d.getElementById('frm1701q:optSpouseForeignTaxCred_1').disabled = true;
        d.getElementById('frm1701q:optSpouseForeignTaxCred_2').disabled = true;

        for (var i= 1; i< 4; i++) {
            d.getElementById("frm1701q:optSpouseType_"+i).checked = false;
            d.getElementById("frm1701q:optSpouseType_"+i).disabled = true;
        }

        for (var j= 1; j< 8; j++) {
            d.getElementById("frm1701q:optSpouseATC_"+j).checked = false;
            d.getElementById("frm1701q:optSpouseATC_"+j).disabled = true;
        }

        d.getElementById('frm1701q:optSpouseTaxRate_1').checked = false;
        d.getElementById('frm1701q:optSpouseTaxRate_2').checked = false;
        d.getElementById('frm1701q:optSpouseTaxRate_1').disabled = true;
        d.getElementById('frm1701q:optSpouseTaxRate_2').disabled = true;

        d.getElementById('frm1701q:optSpouseMethod:_1').checked = false;
        d.getElementById('frm1701q:optSpouseMethod:_2').checked = false;
        d.getElementById('frm1701q:optSpouseMethod:_1').disabled = true;
        d.getElementById('frm1701q:optSpouseMethod:_2').disabled = true;
    }

    function processAmend() {
         if (d.getElementById('frm1701q:AmendedRtn_1').checked) {
            if (d.getElementById("frm1701q:txtSpouseName").value != "") {
                d.getElementById("frm1701q:txt59A").disabled = false;
                d.getElementById("frm1701q:txt59B").disabled = false;
            } else {
                d.getElementById("frm1701q:txt59A").disabled = false;
                d.getElementById("frm1701q:txt59B").disabled = true;
            }
        } else {
            d.getElementById("frm1701q:txt59A").disabled = true;
            d.getElementById("frm1701q:txt59B").disabled = true;
        } 
    }

    function processTaxType(person) {
        if (person == "taxpayer") {
            for (var i= 1; i< 7; i++) {
                d.getElementById("frm1701q:optATC_" + i).checked = false;
            }
            
            d.getElementById("frm1701q:optTaxRate_1").checked = false;
            d.getElementById("frm1701q:optTaxRate_2").checked = false;
            d.getElementById("frm1701q:optMethodOfDeduction:_1").checked = false;
            d.getElementById("frm1701q:optMethodOfDeduction:_2").checked = false;
            d.getElementById("frm1701q:optMethodOfDeduction:_1").disabled = false;
            d.getElementById("frm1701q:optMethodOfDeduction:_2").disabled = false;

            d.getElementById("frm1701q:txt37A").disabled = true;
            d.getElementById("frm1701q:txt39A").disabled = true;
            d.getElementById("frm1701q:txt37A").value = (0).toFixed(2);
            d.getElementById("frm1701q:txt39A").value = (0).toFixed(2);
            d.getElementById("frm1701q:txt40A").value = (0).toFixed(2);

            computetxt38(person);
            computetxt40(person);
            computetxt41(person);

            //if single proprietor or professional
            if (d.getElementById("frm1701q:optType_1").checked == true || d.getElementById("frm1701q:optType_2").checked == true) {   //single proprietor or professional
                for (var j= 2; j< 7; j++) {
                    d.getElementById("frm1701q:optATC_" + j).disabled = false;
                }
                d.getElementById("frm1701q:optTaxRate_2").disabled = false;

                disableSchedule1(person);
                disableSchedule2(person);

                enableSpouse();

            //if estate or trust
            } else if (d.getElementById("frm1701q:optType_3").checked == true || d.getElementById("frm1701q:optType_4").checked == true) {  //estate or trust
                
                d.getElementById("frm1701q:optATC_1").checked = true;
                for (var j= 2; j< 7; j++) {
                    d.getElementById("frm1701q:optATC_" + j).disabled = true;
                }
                d.getElementById("frm1701q:optTaxRate_1").disabled = false;
                d.getElementById("frm1701q:optTaxRate_1").checked = true;
                d.getElementById("frm1701q:optTaxRate_2").disabled = true;

                enableSchedule1(person);

                disableSpouse();
            }
        }
        else {
            //spouse to do
            for (var i= 1; i< 8; i++) {
                d.getElementById("frm1701q:optSpouseATC_" + i).checked = false;
                d.getElementById("frm1701q:optSpouseATC_" + i).disabled = false;
            }
            
            d.getElementById("frm1701q:optSpouseTaxRate_1").checked = false;
            d.getElementById("frm1701q:optSpouseTaxRate_2").checked = false;
            d.getElementById("frm1701q:optSpouseMethod:_1").checked = false;
            d.getElementById("frm1701q:optSpouseMethod:_2").checked = false;
            d.getElementById("frm1701q:optSpouseTaxRate_1").disabled = false;
            d.getElementById("frm1701q:optSpouseTaxRate_2").disabled = false;
            d.getElementById("frm1701q:optSpouseMethod:_1").disabled = false;
            d.getElementById("frm1701q:optSpouseMethod:_2").disabled = false;

            d.getElementById("frm1701q:txt37B").disabled = true;
            d.getElementById("frm1701q:txt39B").disabled = true;
            d.getElementById("frm1701q:txt37B").value = (0).toFixed(2);
            d.getElementById("frm1701q:txt39B").value = (0).toFixed(2);
            d.getElementById("frm1701q:txt40B").value = (0).toFixed(2);

            computetxt38(person);
            computetxt40(person);
            computetxt41(person);

            disableSchedule1(person);
            disableSchedule2(person);

            for (var j = 55; j < 69; j++) {
                if (j != 59 && j != 62 && j != 63 && j != 67 && j != 68) {
                    d.getElementById("frm1701q:txt" + j + "B").disabled = false;
                } else if (j == 59) {
                    if (d.getElementById("frm1701q:AmendedRtn_1").checked == true)
                        d.getElementById("frm1701q:txt" + j + "B").disabled = false;
                    else
                    d.getElementById("frm1701q:txt" + j + "B").disabled = true;
                }
            }
            
            //if compensation earner
            if (d.getElementById("frm1701q:optSpouseType_3").checked == true) {
                d.getElementById("frm1701q:optSpouseATC_4").checked = true; 

                for (var i= 1; i< 8; i++) {
                    if (i != 4) {
                        d.getElementById("frm1701q:optSpouseATC_" + i).disabled = true;
                    }
                }

                d.getElementById("frm1701q:optSpouseTaxRate_1").checked = false;
                d.getElementById("frm1701q:optSpouseTaxRate_2").checked = false;
                d.getElementById("frm1701q:optSpouseMethod:_1").checked = false;
                d.getElementById("frm1701q:optSpouseMethod:_2").checked = false;
                d.getElementById("frm1701q:optSpouseTaxRate_1").disabled = true;
                d.getElementById("frm1701q:optSpouseTaxRate_2").disabled = true;
                d.getElementById("frm1701q:optSpouseMethod:_1").disabled = true;
                d.getElementById("frm1701q:optSpouseMethod:_2").disabled = true;
            
                for (var j = 55; j < 69; j++) {
                    d.getElementById("frm1701q:txt" + j + "B").value = (0).toFixed(2);
                    d.getElementById("frm1701q:txt" + j + "B").disabled = true;
                }

                computetxt62(person);
                computetxt67(person);

            }
            
            var count = 0;
            //check if selected more than 1
            for (var k=1; k< 4; k++) {
                if (d.getElementById("frm1701q:optSpouseType_" + k).checked == true)
                    count++;
            }

            if (count > 1) {
                d.getElementById("frm1701q:optSpouseATC_3").disabled = false;
                d.getElementById("frm1701q:optSpouseATC_7").disabled = false;
                d.getElementById("frm1701q:optSpouseTaxRate_1").disabled = false;
                d.getElementById("frm1701q:optSpouseTaxRate_2").disabled = false;
            }
        }
    }

    function processATC(person) {
        if (person == "taxpayer") {
            //if II012, II014, II013 and single proprietor, professional
            if ((d.getElementById("frm1701q:optATC_1").checked == true || d.getElementById("frm1701q:optATC_2").checked == true || d.getElementById("frm1701q:optATC_3").checked == true) && (d.getElementById("frm1701q:optType_1").checked == true || d.getElementById("frm1701q:optType_2").checked == true)) {
                d.getElementById("frm1701q:optTaxRate_1").disabled = false;
                d.getElementById("frm1701q:optTaxRate_1").checked = true;
                d.getElementById("frm1701q:optTaxRate_2").disabled = true;

                d.getElementById("frm1701q:optMethodOfDeduction:_1").disabled = false;
                d.getElementById("frm1701q:optMethodOfDeduction:_2").disabled = false;

                enableSchedule1(person);
            //if II012, II014, II013
            } else if (d.getElementById("frm1701q:optATC_1").checked == true || d.getElementById("frm1701q:optATC_2").checked == true || d.getElementById("frm1701q:optATC_3").checked == true) {
                d.getElementById("frm1701q:optTaxRate_1").disabled = false;
                d.getElementById("frm1701q:optTaxRate_1").checked = true;
                d.getElementById("frm1701q:optTaxRate_2").disabled = true;

                d.getElementById("frm1701q:optMethodOfDeduction:_1").disabled = false;
                d.getElementById("frm1701q:optMethodOfDeduction:_2").disabled = false;

                enableSchedule1(person);
            }
            else {
                d.getElementById("frm1701q:optTaxRate_2").disabled = false;
                d.getElementById("frm1701q:optTaxRate_2").checked = true;
                d.getElementById("frm1701q:optTaxRate_1").disabled = true;

                d.getElementById("frm1701q:optMethodOfDeduction:_1").checked = false;
                d.getElementById("frm1701q:optMethodOfDeduction:_2").checked = false;
                d.getElementById("frm1701q:optMethodOfDeduction:_1").disabled = true;
                d.getElementById("frm1701q:optMethodOfDeduction:_2").disabled = true;

                enableSchedule2(person);
            }
        }
        else {
            //if II012, II014, II013
            if (d.getElementById("frm1701q:optSpouseATC_1").checked == true || d.getElementById("frm1701q:optSpouseATC_2").checked == true || d.getElementById("frm1701q:optSpouseATC_3").checked == true) {
                d.getElementById("frm1701q:optSpouseTaxRate_1").disabled = false;
                d.getElementById("frm1701q:optSpouseTaxRate_1").checked = true;
                d.getElementById("frm1701q:optSpouseTaxRate_2").disabled = true;

                d.getElementById("frm1701q:optSpouseMethod:_1").disabled = false;
                d.getElementById("frm1701q:optSpouseMethod:_2").disabled = false;

                enableSchedule1(person);

                for (var j = 55; j < 69; j++) {
                    if (j != 59 && j != 62 && j != 63 && j != 67 && j != 68) {
                        d.getElementById("frm1701q:txt" + j + "B").disabled = false;
                    } else if (j == 59) {
                        if (d.getElementById("frm1701q:AmendedRtn_1").checked == true)
                            d.getElementById("frm1701q:txt" + j + "B").disabled = false;
                        else
                        d.getElementById("frm1701q:txt" + j + "B").disabled = true;
                    }
                }
            //if II015, II017, II016
            } else if (d.getElementById("frm1701q:optSpouseATC_5").checked == true || d.getElementById("frm1701q:optSpouseATC_6").checked == true || d.getElementById("frm1701q:optSpouseATC_7").checked == true) {
                d.getElementById("frm1701q:optSpouseTaxRate_2").disabled = false;
                d.getElementById("frm1701q:optSpouseTaxRate_2").checked = true;
                d.getElementById("frm1701q:optSpouseTaxRate_1").disabled = true;

                d.getElementById("frm1701q:optSpouseMethod:_1").checked = false;
                d.getElementById("frm1701q:optSpouseMethod:_2").checked = false;
                d.getElementById("frm1701q:optSpouseMethod:_1").disabled = true;
                d.getElementById("frm1701q:optSpouseMethod:_2").disabled = true;

                enableSchedule2(person);

                for (var j = 55; j < 69; j++) {
                    if (j != 59 && j != 62 && j != 63 && j != 67 && j != 68) {
                        d.getElementById("frm1701q:txt" + j + "B").disabled = false;
                    } else if (j == 59) {
                        if (d.getElementById("frm1701q:AmendedRtn_1").checked == true)
                            d.getElementById("frm1701q:txt" + j + "B").disabled = false;
                        else
                        d.getElementById("frm1701q:txt" + j + "B").disabled = true;
                    }
                }
            }
            else {
                //II011
                d.getElementById("frm1701q:optSpouseTaxRate_1").checked = false;
                d.getElementById("frm1701q:optSpouseTaxRate_2").checked = false;
                d.getElementById("frm1701q:optSpouseTaxRate_1").disabled = true;
                d.getElementById("frm1701q:optSpouseTaxRate_2").disabled = true;

                d.getElementById("frm1701q:optSpouseMethod:_1").disabled = true;
                d.getElementById("frm1701q:optSpouseMethod:_2").disabled = true;

                disableSchedule1(person);
                disableSchedule2(person);

                for (var j = 55; j < 69; j++) {
                    d.getElementById("frm1701q:txt" + j + "B").value = (0).toFixed(2);
                    d.getElementById("frm1701q:txt" + j + "B").disabled = true;
                }

                computetxt62(person);
                computetxt67(person);
            }
        }
    }

    function enableSchedule1(person) {

        d.getElementById("frm1701q:txt43Desc").disabled = false;

        if (person == "taxpayer") {

            d.getElementById("frm1701q:optMethodOfDeduction:_1").checked = false;
            d.getElementById("frm1701q:optMethodOfDeduction:_2").checked = false;
            d.getElementById("frm1701q:optMethodOfDeduction:_1").disabled = false;
            d.getElementById("frm1701q:optMethodOfDeduction:_2").disabled = false;

            for(var i=36; i<45; i++) {
                if (i != 38 && i != 40 && i != 41) {
                    d.getElementById("frm1701q:txt" + i + "A").disabled = false;
                    
                    if ((i == 37 || i == 39) && d.getElementById("frm1701q:optMethodOfDeduction:_1").checked == false) {
                        d.getElementById("frm1701q:txt" + i + "A").disabled = true;
                    }
                }
            }
        }
        else {
            d.getElementById("frm1701q:optSpouseMethod:_1").checked = false;
            d.getElementById("frm1701q:optSpouseMethod:_2").checked = false;
            d.getElementById("frm1701q:optSpouseMethod:_1").disabled = false;
            d.getElementById("frm1701q:optSpouseMethod:_2").disabled = false;

            for(var i=36; i<45; i++) {
                if (i != 38 && i != 40 && i != 41) {
                    d.getElementById("frm1701q:txt" + i + "B").disabled = false;

                    if ((i == 37 || i == 39) && d.getElementById("frm1701q:optMethodOfDeduction:_1").checked == false) {
                        d.getElementById("frm1701q:txt" + i + "B").disabled = true;
                    }
                }
            }
        }

        disableSchedule2(person);
        computetxt63(person);
    }

    function disableSchedule1(person) {
        if (person == "taxpayer") {
            for(var i=36; i<47; i++) {
                if (i != 38 && i != 40 && i != 41 && i != 45 && i != 46) {
                    d.getElementById("frm1701q:txt" + i + "A").disabled = true;
                }
                d.getElementById("frm1701q:txt" + i + "A").value = (0).toFixed(2);
            }
        }
        else {
            for(var i=36; i<47; i++) {
                if (i != 38 && i != 40 && i != 41 && i != 45 && i != 46) {
                    d.getElementById("frm1701q:txt" + i + "B").disabled = true;
                }
                d.getElementById("frm1701q:txt" + i + "B").value = (0).toFixed(2);
            }
        }

        d.getElementById("frm1701q:txt43Desc").disabled = true;
        d.getElementById("frm1701q:txt43Desc").value = "";
    }

    function enableSchedule2(person) {
        d.getElementById("frm1701q:txt48Desc").disabled = false;

        if (person == "taxpayer") {
            d.getElementById("frm1701q:optMethodOfDeduction:_1").checked = false;
            d.getElementById("frm1701q:optMethodOfDeduction:_2").checked = false;
            d.getElementById("frm1701q:optMethodOfDeduction:_1").disabled = true;
            d.getElementById("frm1701q:optMethodOfDeduction:_2").disabled = true;
            
            for(var i=47; i<53; i++) {
                if (i != 49 && i != 51) {
                    d.getElementById("frm1701q:txt" + i + "A").disabled = false;
                }
            }

            if (d.getElementById("frm1701q:optATC_6").checked == true) {
                d.getElementById("frm1701q:txt52A").value = "0.00";
                d.getElementById("frm1701q:txt52A").disabled = true;

                computetxt53(person);
            }
        }
        else {
            d.getElementById("frm1701q:optSpouseMethod:_1").checked = false;
            d.getElementById("frm1701q:optSpouseMethod:_2").checked = false;
            d.getElementById("frm1701q:optSpouseMethod:_1").disabled = true;
            d.getElementById("frm1701q:optSpouseMethod:_2").disabled = true;

            for(var i=47; i<53; i++) {
                if (i != 49 && i != 51) {
                    d.getElementById("frm1701q:txt" + i + "B").disabled = false;
                }
            }

            if (d.getElementById("frm1701q:optSpouseATC_7").checked == true && d.getElementById("frm1701q:optSpouseType_3").checked == false) {
                d.getElementById("frm1701q:txt52B").value = "0.00";
                d.getElementById("frm1701q:txt52B").disabled = true;

                computetxt53(person);
            }
        }

        disableSchedule1(person);
        computetxt63(person);
    }

    function disableSchedule2(person) {
        if (person == "taxpayer") {
            

            for(var i=47; i<55; i++) {
                if (i != 49 && i != 51 && i != 53 && i != 54) {
                    d.getElementById("frm1701q:txt" + i + "A").disabled = true;
                }
                d.getElementById("frm1701q:txt" + i + "A").value = (0).toFixed(2);
            }
        }
        else {
            for(var i=47; i<55; i++) {
                if (i != 49 && i != 51 && i != 53 && i != 54) {
                    d.getElementById("frm1701q:txt" + i + "B").disabled = true;
                }
                d.getElementById("frm1701q:txt" + i + "B").value = (0).toFixed(2);
            }
        }

        d.getElementById("frm1701q:txt48Desc").disabled = true;
        d.getElementById("frm1701q:txt48Desc").value = "";
    }

    function ItemizedDeduct() {
        if (d.getElementById("frm1701q:optMethodOfDeduction:_1").checked == true) {
            if (d.getElementById("frm1701q:optTaxRate_1").checked == true) {
                d.getElementById("frm1701q:txt37A").disabled = false;
                d.getElementById("frm1701q:txt39A").disabled = false;
                d.getElementById("frm1701q:txt40A").value = (0).toFixed(2);

                computetxt41("taxpayer");
            }
        }
    }

    function OptionalDeduct() {
        // disabled then compute less  deduction
        if (d.getElementById("frm1701q:optMethodOfDeduction:_2").checked == true) {
            d.getElementById("frm1701q:txt37A").disabled = true;
            d.getElementById("frm1701q:txt39A").disabled = true;
            d.getElementById("frm1701q:txt37A").value = (0).toFixed(2);
            d.getElementById("frm1701q:txt39A").value = (0).toFixed(2);

            computetxt38("taxpayer");
            computetxt40("taxpayer");
        }
    }

    function ItemizedDeductSpouse() {
        if (d.getElementById("frm1701q:optSpouseMethod:_1").checked == true) {
            if (d.getElementById("frm1701q:optSpouseTaxRate_1").checked == true) {
                d.getElementById("frm1701q:txt37B").disabled = false;
                d.getElementById("frm1701q:txt39B").disabled = false;
                d.getElementById("frm1701q:txt40B").value = (0).toFixed(2);

                computetxt41("taxspouse");
            }
        }
    }

    function OptionalDeductSpouse() {
        // disabled then compute less  deduction
        if (d.getElementById("frm1701q:optSpouseMethod:_2").checked == true) {
            d.getElementById("frm1701q:txt37B").disabled = true;
            d.getElementById("frm1701q:txt39B").disabled = true;
            d.getElementById("frm1701q:txt37B").value = (0).toFixed(2);
            d.getElementById("frm1701q:txt39B").value = (0).toFixed(2);

            computetxt40("taxspouse");
            computetxt38("taxspouse");
        }
    }

    /*-----Computations-----*/
    function computePartIII(person) {
        computetxt26(person);

        if (person == "taxpayer") {
            d.getElementById("frm1701q:txt27A").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt62A").value)).toFixed(2));
            d.getElementById("frm1701q:txt28A").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt26A").value) * 1 - NumWithComma(d.getElementById("frm1701q:txt27A").value) * 1).toFixed(2));
            d.getElementById("frm1701q:txt29A").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt67A").value)).toFixed(2));
            d.getElementById("frm1701q:txt30A").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt28A").value) * 1 + NumWithComma(d.getElementById("frm1701q:txt29A").value) * 1).toFixed(2));
        } else if (person == "taxspouse") {
            d.getElementById("frm1701q:txt27B").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt62B").value)).toFixed(2));
            d.getElementById("frm1701q:txt28B").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt26B").value) * 1 - NumWithComma(d.getElementById("frm1701q:txt27B").value) * 1).toFixed(2));
            d.getElementById("frm1701q:txt29B").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt67B").value)).toFixed(2));
            d.getElementById("frm1701q:txt30B").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt28B").value) * 1 + NumWithComma(d.getElementById("frm1701q:txt29B").value) * 1).toFixed(2));         
        }
        computetxt31(person);
    }

    function computetxt26(person) {
        if (person == "taxpayer") {
            if (d.getElementById("frm1701q:optTaxRate_1").checked == true) {
                d.getElementById("frm1701q:txt26A").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt46A").value)).toFixed(2));
            }
            else {
                d.getElementById("frm1701q:txt26A").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt54A").value)).toFixed(2));
            }
        } else if (person == "taxspouse") {
            if (d.getElementById("frm1701q:optSpouseTaxRate_1").checked == true) {
                d.getElementById("frm1701q:txt26B").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt46B").value)).toFixed(2));
            }
            else {
                d.getElementById("frm1701q:txt26B").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt54B").value)).toFixed(2));
            }
        }
    }

    function computetxt31() {
        d.getElementById("frm1701q:txt31").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt30A").value) * 1 + NumWithComma(d.getElementById("frm1701q:txt30B").value) * 1).toFixed(2));
        capital();
    }

    function computetxt38(person) {
        if (person == "taxpayer") {
            d.getElementById("frm1701q:txt38A").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt36A").value) * 1 - NumWithComma(d.getElementById("frm1701q:txt37A").value) * 1).toFixed(2));
        } else if (person == "taxspouse") {
            d.getElementById("frm1701q:txt38B").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt36B").value) * 1 - NumWithComma(d.getElementById("frm1701q:txt37B").value) * 1).toFixed(2));
        }
        computetxt41(person);
    }

    function computetxt40(person) {
        if (d.getElementById("frm1701q:optMethodOfDeduction:_2").checked == true || d.getElementById("frm1701q:optSpouseMethod:_2").checked == true) {
            if (person == "taxpayer") {
                d.getElementById("frm1701q:txt40A").value = formatCurrency((parseFloat(NumWithComma(d.getElementById("frm1701q:txt36A").value)) * 40 / 100).toFixed(2));
            } else if (person == "taxspouse") {
                d.getElementById("frm1701q:txt40B").value = formatCurrency((parseFloat(NumWithComma(d.getElementById("frm1701q:txt36B").value)) * 40 / 100).toFixed(2));
            }
            computetxt41(person);
        }
    }

    function computetxt41(person) {
        if (person == "taxpayer") {
            if (d.getElementById("frm1701q:optMethodOfDeduction:_1").checked == true) {
                d.getElementById("frm1701q:txt41A").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt38A").value) * 1 - NumWithComma(d.getElementById("frm1701q:txt39A").value) * 1).toFixed(2));
            }
            else {
                d.getElementById("frm1701q:txt41A").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt38A").value) * 1 - NumWithComma(d.getElementById("frm1701q:txt40A").value) * 1).toFixed(2));
            }
        } else if (person == "taxspouse") {
            if (d.getElementById("frm1701q:optSpouseMethod:_1").checked == true) {
                d.getElementById("frm1701q:txt41B").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt38B").value) * 1 - NumWithComma(d.getElementById("frm1701q:txt39B").value) * 1).toFixed(2));
            }
            else {
                d.getElementById("frm1701q:txt41B").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt38B").value) * 1 - NumWithComma(d.getElementById("frm1701q:txt40B").value) * 1).toFixed(2));
            }
        }
        computetxt45(person);
    }

    function computetxt45(person) {
        if (person == "taxpayer") {
            d.getElementById("frm1701q:txt45A").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt41A").value) * 1 + NumWithComma(d.getElementById("frm1701q:txt42A").value) * 1 + NumWithComma(d.getElementById("frm1701q:txt43A").value) * 1 + NumWithComma(d.getElementById("frm1701q:txt44A").value) * 1).toFixed(2));
        } else if (person == "taxspouse") {
            d.getElementById("frm1701q:txt45B").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt41B").value) * 1 + NumWithComma(d.getElementById("frm1701q:txt42B").value) * 1 + NumWithComma(d.getElementById("frm1701q:txt43B").value) * 1 + NumWithComma(d.getElementById("frm1701q:txt44B").value) * 1).toFixed(2));
        }
        computetxt46(person);
    }

    function computetxt46(person) {
        if (d.getElementById("frm1701q:txtYear").value >= 2018 && d.getElementById("frm1701q:txtYear").value <= 2022) {
            if (person == "taxpayer") {
                var v45a = NumWithComma(d.getElementById("frm1701q:txt45A").value) * 1;
                var total = 0.0;
                if (v45a <= 0) {
                    total = 0;
                } else if (v45a <= 250000) {
                    total = (0).toFixed(2);
                } else if (v45a > 250000 && v45a <= 400000) {
                    total = ((v45a - 250000) * (20 / 100)).toFixed(2);
                } else if (v45a > 400000 && v45a <= 800000) {
                    total = ((v45a - 400000) * (25 / 100) + 30000).toFixed(2);
                } else if (v45a > 800000 && v45a <= 2000000) {
                    total = ((v45a - 800000) * (30 / 100) + 130000).toFixed(2);
                } else if (v45a > 2000000 && v45a <= 8000000) {
                    total = ((v45a - 2000000) * (32 / 100) + 490000).toFixed(2);
                } else if (v45a > 8000000) {
                    total = ((v45a - 8000000) * (35 / 100) + 2410000).toFixed(2);
                }

                d.getElementById("frm1701q:txt46A").value = formatCurrency(total);
            } else if (person == "taxspouse") {
                var v45b = NumWithComma(d.getElementById("frm1701q:txt45B").value) * 1;
                var total = 0.0;
                if (v45b <= 0) {
                    total = 0;
                } else if (v45b <= 250000) {
                    total = (0).toFixed(2);
                } else if (v45b > 250000 && v45b <= 400000) {
                    total = ((v45b - 250000) * (20 / 100)).toFixed(2);
                } else if (v45b > 400000 && v45b <= 800000) {
                    total = ((v45b - 400000) * (25 / 100) + 30000).toFixed(2);
                } else if (v45b > 800000 && v45b <= 2000000) {
                    total = ((v45b - 800000) * (30 / 100) + 130000).toFixed(2);
                } else if (v45b > 2000000 && v45b <= 8000000) {
                    total = ((v45b - 2000000) * (32 / 100) + 490000).toFixed(2);
                } else if (v45b > 8000000) {
                    total = ((v45b - 8000000) * (35 / 100) + 2410000).toFixed(2);
                }

                d.getElementById("frm1701q:txt46B").value = formatCurrency(total);
            }
        }
        else if (d.getElementById("frm1701q:txtYear").value > 2022) {
            if (person == "taxpayer") {
                var v45a = NumWithComma(d.getElementById("frm1701q:txt45A").value) * 1;
                var total = 0.0;
                if (v45a <= 0) {
                    total = 0;
                } else if (v45a <= 250000) {
                    total = (0).toFixed(2);
                } else if (v45a > 250000 && v45a <= 400000) {
                    total = ((v45a - 250000) * (15 / 100)).toFixed(2);
                } else if (v45a > 400000 && v45a <= 800000) {
                    total = ((v45a - 400000) * (20 / 100) + 22500).toFixed(2);
                } else if (v45a > 800000 && v45a <= 2000000) {
                    total = ((v45a - 800000) * (25 / 100) + 102500).toFixed(2);
                } else if (v45a > 2000000 && v45a <= 8000000) {
                    total = ((v45a - 2000000) * (30 / 100) + 402500).toFixed(2);
                } else if (v45a > 8000000) {
                    total = ((v45a - 8000000) * (35 / 100) + 2202500).toFixed(2);
                }

                d.getElementById("frm1701q:txt46A").value = formatCurrency(total);
            } else if (person == "taxspouse") {
                var v45b = NumWithComma(d.getElementById("frm1701q:txt45B").value) * 1;
                var total = 0.0;
                if (v45b <= 0) {
                    total = 0;
                } else if (v45b <= 250000) {
                    total = (0).toFixed(2);
                } else if (v45b > 250000 && v45b <= 400000) {
                    total = ((v45b - 250000) * (15 / 100)).toFixed(2);
                } else if (v45b > 400000 && v45b <= 800000) {
                    total = ((v45b - 400000) * (20 / 100) + 22500).toFixed(2);
                } else if (v45b > 800000 && v45b <= 2000000) {
                    total = ((v45b - 800000) * (25 / 100) + 102500).toFixed(2);
                } else if (v45b > 2000000 && v45b <= 8000000) {
                    total = ((v45b - 2000000) * (30 / 100) + 402500).toFixed(2);
                } else if (v45b > 8000000) {
                    total = ((v45b - 8000000) * (35 / 100) + 2202500).toFixed(2);
                }

                d.getElementById("frm1701q:txt46B").value = formatCurrency(total);
            }
        }
        else if (d.getElementById("frm1701q:txtYear").value < 2018) {
            if (person == "taxpayer") {
                var v45a = NumWithComma(d.getElementById("frm1701q:txt45A").value) * 1;
                var total = 0.0;
                if (v45a <= 0) {
                    total = 0;
                } else if (v45a < 10000) {
                    total = (v45a * (5 / 100)).toFixed(2);
                } else if (v45a >= 10000 && v45a < 30000) {
                    total = ((v45a - 10000) * (10 / 100) + 500).toFixed(2);
                } else if (v45a >= 30000 && v45a < 70000) {
                    total = ((v45a - 30000) * (15 / 100) + 2500).toFixed(2);
                } else if (v45a >= 70000 && v45a < 140000) {
                    total = ((v45a - 70000) * (20 / 100) + 8500).toFixed(2);
                } else if (v45a >= 140000 && v45a < 250000) {
                    total = ((v45a - 140000) * (25 / 100) + 22500).toFixed(2);
                } else if (v45a >= 250000 && v45a < 500000) {
                    total = ((v45a - 250000) * (30 / 100) + 50000).toFixed(2);
                } else if (v45a >= 500000) {
                    total = ((v45a - 500000) * (32 / 100) + 125000).toFixed(2);
                }

                d.getElementById("frm1701q:txt46A").value = formatCurrency(total);
            } else if (person == "taxspouse") {
                var v45b = NumWithComma(d.getElementById("frm1701q:txt45B").value) * 1;
                var total = 0.0;
                if (v45b <= 0) {
                    total = 0;
                } else if (v45b < 10000) {
                    total = (v45b * (5 / 100)).toFixed(2);
                } else if (v45b >= 10000 && v45b < 30000) {
                    total = ((v45b - 10000) * (10 / 100) + 500).toFixed(2);
                } else if (v45b >= 30000 && v45b < 70000) {
                    total = ((v45b - 30000) * (15 / 100) + 2500).toFixed(2);
                } else if (v45b >= 70000 && v45b < 140000) {
                    total = ((v45b - 70000) * (20 / 100) + 8500).toFixed(2);
                } else if (v45b >= 140000 && v45b < 250000) {
                    total = ((v45b - 140000) * (25 / 100) + 22500).toFixed(2);
                } else if (v45b >= 250000 && v45b < 500000) {
                    total = ((v45b - 250000) * (30 / 100) + 50000).toFixed(2);
                } else if (v45b >= 500000) {
                    total = ((v45b - 500000) * (32 / 100) + 125000).toFixed(2);
                }
                d.getElementById("frm1701q:txt46B").value = formatCurrency(total);
            }
        }
        
        computetxt63(person);
    }

    function computetxt49(person) {
        if (person == "taxpayer") {
            d.getElementById("frm1701q:txt49A").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt47A").value) * 1 + NumWithComma(d.getElementById("frm1701q:txt48A").value) * 1).toFixed(2));
        } else if (person == "taxspouse") {
            d.getElementById("frm1701q:txt49B").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt47B").value) * 1 + NumWithComma(d.getElementById("frm1701q:txt48B").value) * 1).toFixed(2));
        }
        computetxt51(person);
    }

    function computetxt51(person) {
        if (person == "taxpayer") {
            d.getElementById("frm1701q:txt51A").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt49A").value) * 1 + NumWithComma(d.getElementById("frm1701q:txt50A").value) * 1).toFixed(2));
        } else if (person == "taxspouse") {
            d.getElementById("frm1701q:txt51B").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt49B").value) * 1 + NumWithComma(d.getElementById("frm1701q:txt50B").value) * 1).toFixed(2));
        }
        computetxt53(person);
    }

    function computetxt53(person) {
        if (person == "taxpayer") {
            d.getElementById("frm1701q:txt53A").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt51A").value) * 1 - NumWithComma(d.getElementById("frm1701q:txt52A").value) * 1).toFixed(2));
        } else if (person == "taxspouse") {
            d.getElementById("frm1701q:txt53B").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt51B").value) * 1 - NumWithComma(d.getElementById("frm1701q:txt52B").value) * 1).toFixed(2));
        }
        computetxt54(person);
    }

    function computetxt54(person) {
        if (person == "taxpayer") {
            d.getElementById("frm1701q:txt54A").value = formatCurrency((parseFloat(NumWithComma(d.getElementById("frm1701q:txt53A").value)) * 8 / 100).toFixed(2));

            if (NumWithComma(d.getElementById("frm1701q:txt54A").value) < 0) {
                d.getElementById("frm1701q:txt54A").value = (0).toFixed(2);
            }
        } else if (person == "taxspouse") {
            d.getElementById("frm1701q:txt54B").value = formatCurrency((parseFloat(NumWithComma(d.getElementById("frm1701q:txt53B").value)) * 8 / 100).toFixed(2));

            if (NumWithComma(d.getElementById("frm1701q:txt54B").value) < 0) {
                d.getElementById("frm1701q:txt54B").value = (0).toFixed(2);
            }
        }
        computetxt63(person);
    }

    function computetxt62(person) {
        if (person == "taxpayer") {
            d.getElementById("frm1701q:txt62A").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt55A").value) * 1 + NumWithComma(d.getElementById("frm1701q:txt56A").value) * 1 + NumWithComma(d.getElementById("frm1701q:txt57A").value) * 1 + NumWithComma(d.getElementById("frm1701q:txt58A").value) * 1 + NumWithComma(d.getElementById("frm1701q:txt59A").value) * 1 + NumWithComma(d.getElementById("frm1701q:txt60A").value) * 1 + NumWithComma(d.getElementById("frm1701q:txt61A").value) * 1).toFixed(2));
        } else if (person == "taxspouse") {
            d.getElementById("frm1701q:txt62B").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt55B").value) * 1 + NumWithComma(d.getElementById("frm1701q:txt56B").value) * 1 + NumWithComma(d.getElementById("frm1701q:txt57B").value) * 1 + NumWithComma(d.getElementById("frm1701q:txt58B").value) * 1 + NumWithComma(d.getElementById("frm1701q:txt59B").value) * 1 + NumWithComma(d.getElementById("frm1701q:txt60B").value) * 1 + NumWithComma(d.getElementById("frm1701q:txt61B").value) * 1).toFixed(2));
        }
        computetxt63(person);
    }

    function computetxt63(person) {
        if (person == "taxpayer") {
            if (d.getElementById("frm1701q:optTaxRate_1").checked == true) {
                d.getElementById("frm1701q:txt63A").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt46A").value) * 1 - NumWithComma(d.getElementById("frm1701q:txt62A").value) * 1).toFixed(2));
            }
            else {
                d.getElementById("frm1701q:txt63A").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt54A").value) * 1 - NumWithComma(d.getElementById("frm1701q:txt62A").value) * 1).toFixed(2));
            }
        } else if (person == "taxspouse") {
            if (d.getElementById("frm1701q:optSpouseTaxRate_1").checked == true) {
                d.getElementById("frm1701q:txt63B").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt46B").value) * 1 - NumWithComma(d.getElementById("frm1701q:txt62B").value) * 1).toFixed(2));
            }
            else {
                d.getElementById("frm1701q:txt63B").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt54B").value) * 1 - NumWithComma(d.getElementById("frm1701q:txt62B").value) * 1).toFixed(2));
            }
        }
        computetxt68(person);
    }

    function computetxt67(person) {
        if (person == "taxpayer") {
            d.getElementById("frm1701q:txt67A").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt64A").value) * 1 + NumWithComma(d.getElementById("frm1701q:txt65A").value) * 1 + NumWithComma(d.getElementById("frm1701q:txt66A").value) * 1).toFixed(2));
        } else if (person == "taxspouse") {
            d.getElementById("frm1701q:txt67B").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt64B").value) * 1 + NumWithComma(d.getElementById("frm1701q:txt65B").value) * 1 + NumWithComma(d.getElementById("frm1701q:txt66B").value) * 1).toFixed(2));
        }
        computetxt68(person);
    }

    function computetxt68(person) {
        if (person == "taxpayer") {
            d.getElementById("frm1701q:txt68A").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt63A").value) * 1 + NumWithComma(d.getElementById("frm1701q:txt67A").value) * 1).toFixed(2));
        } else if (person == "taxspouse") {
            d.getElementById("frm1701q:txt68B").value = formatCurrency((NumWithComma(d.getElementById("frm1701q:txt63B").value) * 1 + NumWithComma(d.getElementById("frm1701q:txt67B").value) * 1).toFixed(2));
        }
        computePartIII(person);
    }
    /*-----END-----*/

    function validateMonthDayYearDate(dateID) {
        strmmddyyyy = dateID;

        if (strmmddyyyy != "") {
            var result = strmmddyyyy.split("/");
            var isLeap = new Date(result[2], 1, 29).getMonth() == 1;
            var month31 = (['01', '03', '05', '07', '08', '10', '12']);
            var month30 = (['04', '06', '09', '11']);
            var month = result[0];
            var day = result[1];
            if (result.length == 3) {
                if (isNaN(result[0] || result[1] || result[2])) {
                    return true;
                }
                else if ((result[0].length != 2 || (result[0] > 12 || result[0] < 0))) {
                    // numeric check if greater not than 31 - Month.
                    return true;
                }
                else if (result[1].length != 2 || (result[1] > 31 || result[1] < 1)) {
                    // numeric check if Date.
                    return true;
                }
                else if (result[2].length != 4) {
                    return true;
                }
                else if (month == 2) {
                    if (!isLeap && day == 29) {
                        return true;
                    }
                    else if (!isLeap && day > 29) {
                        return true;
                    }
                    else if (isLeap && day > 29) {
                        return true;
                    }
                }
                else if (month31.contains(month) && day > 31) {
                    return true;
                }
                else if (month30.contains(month) && day > 30) {
                    return true;
                }
            } else {
                return true;
            }
        }
    }

    function initialValidateBeforeSave() {
        if (d.getElementById('frm1701q:DateQuarter_1').checked == false && d.getElementById('frm1701q:DateQuarter_2').checked == false && d.getElementById('frm1701q:DateQuarter_3').checked == false) {
            alert("Please select quarter in Item 2.");
            return false;
        }
        if ((d.getElementById('frm1701q:txtTIN1').value == "" || d.getElementById('frm1701q:txtTIN2').value == "" || d.getElementById('frm1701q:txtTIN3').value == "" || d.getElementById('frm1701q:txtBranchCode').value == "")) {
            alert("Please enter a valid TIN number on Item 5.");
            return false;
        }
        if ((d.getElementById('frm1701q:txtRDOCode').value == "000")) {
            alert("Please enter a valid RDO Code on Item 6.");
            return false;
        }
        if ((d.getElementById('frm1701q:txtTaxpayerName').value == "")) {
            alert("Please enter a valid Taxpayer Name on Item 9.");
            return false;
        }
        return true;
    }

    //topNav
    $(document).ready(function () {
        $("ul.subnav").parent().append("<span></span>"); //Only shows drop down trigger when js is enabled (Adds empty span tag after ul.subnav*)  
        $("ul.topnav li span").click(function () { //When trigger is clicked...            
            //Following events are applied to the subnav itself (moving subnav up and down)  
            $(this).parent().find("ul.subnav").slideDown('fast').show(); //Drop down the subnav on click    
            $(this).parent().hover(function () {
            }, function () {
                $(this).parent().find("ul.subnav").slideUp('slow'); //When the mouse hovers out of the subnav, move it back up  
            });
            //Following events are applied to the trigger (Hover events for the trigger)  
        }).hover(function () {
            $(this).addClass("subhover"); //On hover over, add class "subhover"  
        }, function () {  //On Hover Out  
            $(this).removeClass("subhover"); //On hover out, remove class "subhover"  
        });
        $("ul.topnav .toplevel").click(function () { //When trigger is clicked...            
            //Following events are applied to the subnav itself (moving subnav up and down)  
            $(this).parent().find("ul.subnav").slideDown('fast').show(); //Drop down the subnav on click    
            $(this).parent().hover(function () {
            }, function () {
                $(this).parent().find("ul.subnav").slideUp('slow'); //When the mouse hovers out of the subnav, move it back up  
            });
            //Following events are applied to the trigger (Hover events for the trigger)  
        }).hover(function () {
            $(this).addClass("subhover"); //On hover over, add class "subhover"  
        }, function () {  //On Hover Out  
            $(this).removeClass("subhover"); //On hover out, remove class "subhover"  
        });

        //added 07/25/2015
        $('#ebirOnlineConfirmUsername, #ebirOnlineConfirmPassword, #ebirOnlinePassword, #ebirOnlineUsername').bind('paste drag drop', function (e) {
            e.preventDefault();
        });

        $('.chkTin input').bind('blur', function(){
        	setTimeout(function () {
                var isOnBlur = true;
                $('.chkTin input').each(function () {
                    if (this == document.activeElement) isOnBlur = false;
                });
        		if (isOnBlur) {
        			if ($('#frm1701q\\:txtSpouseTIN1').val() !== '' || $('#frm1701q\\:txtSpouseTIN2').val() !== '' || $('#frm1701q\\:txtSpouseTIN3').val() !=='' ) {
                		var tinChkCode = getTinChkCode($('#frm1701q\\:txtSpouseTIN1').val(),$('#frm1701q\\:txtSpouseTIN2').val(),$('#frm1701q\\:txtSpouseTIN3').val());
                		if (tinChkCode !== 0) {
                			alert(getChkTinErrDesc(tinChkCode));
                		}
                	}
                }
            }, 10);
        });
    });
    function loadBGXML(loadWhere) {
        try {
            //This will load the file with filename loadWhere if it exists
            var fsoXML = new ActiveXObject("Scripting.FileSystemObject");
            XMLBGFile = fsoXML.OpenTextFile(loadWhere, 1);
            if (XMLBGFile.AtEndOfStream) {
                data = "";
            } else {
                var responseBG = d.getElementById('responseBG'); //render file and write to hidden div
                responseBG.innerHTML = XMLBGFile.ReadAll(); //remove XML tag			
            }
            XMLBGFile.Close();
            //alert( responseBG.innerHTML ); //Debug				
            loadBGData();	/*This will load data onto fields*/
        } catch (e) {
            msg.innerHTML = "";
        }
    }

    function loadBGData() {
        /*This will load data onto Background Information fields*/
        var responseBG = d.getElementById("responseBG");

        var formTypeVal = String(responseBG.innerHTML).split('formType='); //form_type

        if (formTypeVal[1] == '1701Qv2018') {
            var fnVal = String(responseBG.innerHTML).split('fn=');
            d.getElementById('frm1701q:txtTaxpayerName').value = unescape(fnVal[1]);
            d.getElementById('frm1701q:txtPg2TaxpayerName').value = unescape(fnVal[1]).split(',')[0];
            
            var tin1Val = String(responseBG.innerHTML).split('tin1=');
            d.getElementById('frm1701q:txtTIN1').value = tin1Val[1];
            d.getElementById('frm1701q:txtPg2TIN1').value = tin1Val[1];

            var tin2Val = String(responseBG.innerHTML).split('tin2=');
            d.getElementById('frm1701q:txtTIN2').value = tin2Val[1];
            d.getElementById('frm1701q:txtPg2TIN2').value = tin2Val[1];

            var tin3Val = String(responseBG.innerHTML).split('tin3=');
            d.getElementById('frm1701q:txtTIN3').value = tin3Val[1];
            d.getElementById('frm1701q:txtPg2TIN3').value = tin3Val[1];

            var tin4Val = String(responseBG.innerHTML).split('tin4=');
            d.getElementById('frm1701q:txtBranchCode').value = tin4Val[1];
            d.getElementById('frm1701q:txtPg2BranchCode').value = tin4Val[1];

            var rdoVal = String(responseBG.innerHTML).split('rdo=');
            d.getElementById('frm1701q:txtRDOCode').value = rdoVal[1];

            var lobVal = String(responseBG.innerHTML).split('lob=');
            d.getElementById('frm1701q:txtLOB').value = unescape(lobVal[1]);

            //address to split
			var regAddrVal = String(responseBG.innerHTML).split('regAddr=');		
			if (regAddrVal[1].length > 100) {
				d.getElementById('frm1701q:txtAddress').value = 	unescape(regAddrVal[1].substring(0, 100));
				d.getElementById('frm1701q:txtAddress2').value = 	unescape(regAddrVal[1].substring(100, regAddrVal[1].length));
			}
			else {
			d.getElementById('frm1701q:txtAddress').value = 	unescape(regAddrVal[1]);	
			d.getElementById('frm1701q:txtAddress2').value = 	"";
			}

            var zipVal = String(responseBG.innerHTML).split('zip=');
            d.getElementById('frm1701q:txtZipCode').value = zipVal[1];

            var telNoVal = String(responseBG.innerHTML).split('telNo=');
            d.getElementById('frm1701q:txtTelno').value = telNoVal[1];


        }
        var emailVal = String(responseBG.innerHTML).split('email=');
        if (emailVal[1] === undefined) {
            document.getElementById('txtEmail').value = "";
        }
        else {
            document.getElementById('txtEmail').value = emailVal[1];
            globalEmail = emailVal[1];
        }
    }
    function createXMLProfileName() {
        try {
            var xmlFileName = "";

            var titleTin1 = d.getElementById('frm1701q:txtTIN1');
            var titleTin2 = d.getElementById('frm1701q:txtTIN2');
            var titleTin3 = d.getElementById('frm1701q:txtTIN3');
            var titleBranchCode = d.getElementById('frm1701q:txtBranchCode');
            var titleTPName = d.getElementById('frm1701q:txtTaxpayerName');
            var formType = "1701Qv2018";

            xmlFileName = "profile/" + titleTin1.value + titleTin2.value + titleTin3.value + titleBranchCode.value + ".xml";

            return xmlFileName;
        } catch (e) {
            alert('Exception : ' + e.description);
        }
    }

    function saveXMLProfile(isFinalCopy) {
        if (gIsReadOnly == false) {
            var xmlFileName = createXMLProfileName();

            msg.innerHTML = 'Generating File...';
            var fileSys = new ActiveXObject("Scripting.FileSystemObject");
            var xmlFile = fileSys.CreateTextFile(xmlFileName); //(saveWhere);

            var allXML = "<?xml version='1.0'?>", tab = d.getElementById('xmlFormat').innerHTML;
            allXML += tab; //adds line break			

            allXML += "<div>fn=" + escape(d.getElementById('frm1701q:txtTaxpayerName').value) + "fn=</div>" + tab;
            allXML += "<div>tin1=" + d.getElementById('frm1701q:txtTIN1').value + "tin1=</div>" + tab;
            allXML += "<div>tin2=" + d.getElementById('frm1701q:txtTIN2').value + "tin2=</div>" + tab;
            allXML += "<div>tin3=" + d.getElementById('frm1701q:txtTIN3').value + "tin3=</div>" + tab;
            allXML += "<div>tin4=" + d.getElementById('frm1701q:txtBranchCode').value + "tin4=</div>" + tab;
            allXML += "<div>rdo=" + d.getElementById('frm1701q:txtRDOCode').value + "rdo=</div>" + tab;
            allXML += "<div>lob=" + escape(d.getElementById('frm1701q:txtLOB').value) + "lob=</div>" + tab;
            allXML += "<div>regAddr="+escape(d.getElementById('frm1701q:txtAddress').value)+escape(d.getElementById('frm1701q:txtAddress2').value)+"regAddr=</div>"+tab;	
            allXML += "<div>zip=" + d.getElementById('frm1701q:txtZipCode').value + "zip=</div>" + tab;
            allXML += "<div>telNo=" + d.getElementById('frm1701q:txtTelno').value + "telNo=</div>" + tab;
            allXML += "<div>email=" + document.getElementById('txtEmail').value + "email=</div>" + tab;allXML += "<div>confirmemail=" + document.getElementById('txtEmail').value + "confirmemail=</div>" + tab;
             allXML += "<div>confirmtin1=" + d.getElementById('frm1701q:txtTIN1').value + "confirmtin1=</div>" + tab;
            allXML += "<div>confirmtin2=" + d.getElementById('frm1701q:txtTIN2').value + "confirmtin2=</div>" + tab;
            allXML += "<div>confirmtin3=" + d.getElementById('frm1701q:txtTIN3').value + "confirmtin3=</div>" + tab;
            allXML += "<div>confirmtin4=" + d.getElementById('frm1701q:txtBranchCode').value + "confirmtin4=</div>" + tab;
			allXML += "<div>formType=1701Qv2018formType=</div>" + tab;

            allXML += tab + d.getElementById('xmlClose').innerHTML;

            xmlFile.write(allXML);
            xmlFile.close();
            msg.innerHTML = '';

            if (isFinalCopy == false) {
                alert('Background information saved/updated successfully as : ' + xmlFileName);
            }
        }
    }

    function goToPage() {

        var newVal = document.getElementById("frm1701q:txtCurrentPage").value;
        //var printType = !isFromPrint ? "Page" : "Print";
        var printType = "Page";

        if ((newVal <= MaxPage) && (newVal > 0) && (newVal !== currentPage.toString())) {
            $('#' + printType + currentPage + 'Content').hide('blind');
            $('#' + printType + newVal + 'Content').show('blind');
            currentPage = (document.getElementById("frm1701q:txtCurrentPage").value) * 1;
        }
        else if ((newVal > MaxPage) || (newVal <= 0)) {
            alert("Invalid page");

            document.getElementById("frm1701q:txtCurrentPage").value = currentPage;
        }

        if (isFromPrint) {
            //printOCR();
        }
    }

    function processPrev() {
        if (currentPage == 1)
            currentPage = 1;
        else {
            currentPage--;
            $('#Page' + currentPage + 'Content').show('blind');
            $('#Page' + (currentPage + 1) + 'Content').hide('blind');
            document.getElementById('frm1701q:txtCurrentPage').value = currentPage;

        }
    }
    function processNext() {
        if (currentPage == MaxPage) {
        //          $('#Page4Content').show('blind');
        //          $('#Page1Content').hide('blind');
        //          $('#Page2Content').hide('blind');
        //          $('#Page3Content').hide('blind');
        }
        else {
        currentPage++;
        $('#Page' + currentPage + 'Content').show('blind');
        $('#Page' + (currentPage - 1) + 'Content').hide('blind');
        document.getElementById('frm1701q:txtCurrentPage').value = currentPage;
        }
    }

    
    function cancel() {
        $('#bg').show();
        $('.printSignFooterClass').hide();
        $('.imgClass').hide();
        $('body').css('background', '#FFF');

        $('#formPaper').css({ 'border': '#CCC 1px solid', 'margin': '0 auto', 'background': '#FFF' });
        $('#wrapper').css({ 'padding': '1%', 'margin': '0 auto' });
        $('#container').css({ 'padding': '1%', 'margin': '0 auto' });
        $('.labels').remove();

        var elem = document.getElementById('frmMain').elements;
        for (var i = 0; i < elem.length; i++) {
            if (elem[i].type != 'hidden') { // && elem[i].type != 'undefined' 
                if (elem[i].type == 'text') {
                    document.getElementById(elem[i].id).readOnly = false;
                    document.getElementById(elem[i].id).style.height = "15px";
                    document.getElementById(elem[i].id).style.fontSize = "13px";
                    if (d.getElementById('frm1701q:cmdValidate').disabled == false) {
                        if (disabledItems.contains(elem[i].id)) {
                            document.getElementById(elem[i].id).disabled = true;
                        }
                        else {
                            document.getElementById(elem[i].id).disabled = false;
                        }
                    }
                    else {
                        if (disabledItems.contains(elem[i].id)) {
                            document.getElementById(elem[i].id).disabled = true;
                        }
                        else {
                            document.getElementById(elem[i].id).disabled = false;
                        }
                    }
                }
                if (elem[i].type == 'radio' || elem[i].type == 'checkbox') {
                    if (d.getElementById('frm1701q:cmdValidate').disabled == false) {
                        if (disabledItems.contains(elem[i].id)) {
                            document.getElementById(elem[i].id).disabled = true;
                        }
                        else {
                            document.getElementById(elem[i].id).disabled = false;
                        }
                    }
                    else {
                        if (disabledItems.contains(elem[i].id)) {
                            document.getElementById(elem[i].id).disabled = true;
                        }
                        else {
                            document.getElementById(elem[i].id).disabled = false;
                        }
                    }
                    document.getElementById(elem[i].id).style.height = "15px";
                    document.getElementById(elem[i].id).style.fontSize = "11px";
                }
                if (elem[i].type == 'select-one') {
                    $(elem[i]).show();
                }
            }
        }

        $('input').each(function () {
            if (this.type == 'button') {
                if (this.id != 'test') {
                    $(this).removeClass('previewButtonClass');
                }
            }
        });

        $('a').each(function () {
            if (this.id.length > 1) {
                if (d.getElementById('frm1701q:cmdValidate').disabled == false) {
                    if (enableElem) {
                        d.getElementById(this.id).disabled = true;
                    }
                    else if (disableElem) {
                        d.getElementById(this.id).disabled = false;
                    }
                }
                else {
                    if (disableElem) {
                        d.getElementById(this.id).disabled = true;
                    }
                    else if (enableElem) {
                        d.getElementById(this.id).disabled = false;
                    }
                }
            }
        });

        $('#formMenu').show('blind');
        if ($('#printMenu').css('display') != 'none') {
            $('#printMenu').hide('blind');
        }

        if (qs('xmlFileName') != null && qs('xmlFileName').indexOf('.xml') > -1) {
            d.getElementById('frm1701q:txtYear').disabled = true;
            d.getElementById('frm1701q:DateQuarter_1').disabled = true;
            d.getElementById('frm1701q:DateQuarter_2').disabled = true;
            d.getElementById('frm1701q:DateQuarter_3').disabled = true;
        }
        isFromPrint = false;
    }
    Array.prototype.contains = Array.prototype.indexOf ?
        function (val) {
            return this.indexOf(val) > -1;
        } :
        function (val) {
            var i = this.length;
            while (i--) {
                if (this[i] === val) {
                    return true;
                }
            }
            return false;
        };

    var disabledItems = new Array();
    var isFromPrint = false;
    function printme() {

        $('#bg').hide();
        $('.printSignFooterClass').css({ 'width': '94%', 'margin': 'auto', 'margin-top': '15px', 'display': 'block', 'position': 'relative', 'overflow': 'visible', 'page-break-before': 'always' });
        $('.imgClass').css({ 'margin': 'auto', 'display': 'block', 'position': 'relative', 'overflow': 'visible' });
        $('body').css('background', '#FFF');

        $('#formPaper').css({ 'max-width': '8.3in !important', 'border': '#000 3px solid' });
        $('#wrapper').css({ 'max-width': '8.3in !important' });
        $('#container').css({ 'max-width': '8.3in !important' });

        var elem = document.getElementById('frmMain').elements;
        var x = 0;
        disabledItems = new Array();
        for (var i = 0; i < elem.length; i++) {
            if (elem[i].type != 'hidden') { // && elem[i].type != 'undefined' 
                if (elem[i].type == 'text') {
                    if (document.getElementById(elem[i].id).disabled) {
                        disabledItems[x] = elem[i].id;
                        x++;
                    }
                    document.getElementById(elem[i].id).disabled = false;
                    document.getElementById(elem[i].id).readOnly = true;
                    document.getElementById(elem[i].id).style.backgroundColor = '#FFFFFF';
                    document.getElementById(elem[i].id).style.color = '#000000';
                    document.getElementById(elem[i].id).style.height = "9px";
                    document.getElementById(elem[i].id).style.fontSize = "8px";
                }
                if (elem[i].type == 'radio' || elem[i].type == 'checkbox') {
                    if (document.getElementById(elem[i].id).disabled) {
                        disabledItems[x] = elem[i].id;
                        x++;
                    }
                    document.getElementById(elem[i].id).disabled = true;
                    document.getElementById(elem[i].id).style.height = "9px";
                    document.getElementById(elem[i].id).style.fontSize = "8px";
                }
                if (elem[i].type == 'select-one') {
                    $(elem[i]).hide();
                    var label = "<div class='labels'>".concat(elem[i].options[elem[i].selectedIndex].innerHTML).concat("&nbsp;</div>");
                    $(elem[i]).after(label);
                }
            }
        }

        $('input').each(function () {
            if (this.type == 'button') {
                if (this.id != 'test') {
                    $(this).addClass('previewButtonClass');
                }
            }
        });

        $('a').each(function () {
            if (this.id.length > 1) {
                d.getElementById(this.id).disabled = true;
            }
        });

        $('#printMenu').show('blind');
        if ($('#formMenu').css('display') != 'none') {
            $('#formMenu').hide('blind');
        }

        isFromPrint = true;
        document.getElementById('frm1701q:txtCurrentPage').disabled = false;
        document.getElementById('frm1701q:txtCurrentPage').readOnly = false;
    }

    $(document).ready(function () {
        $("ul.subnav").parent().append("<span></span>"); //Only shows drop down trigger when js is enabled (Adds empty span tag after ul.subnav*)  
        $("ul.topnav li span").click(function () { //When trigger is clicked...            
            //Following events are applied to the subnav itself (moving subnav up and down)  
            $(this).parent().find("ul.subnav").slideDown('fast').show(); //Drop down the subnav on click    
            $(this).parent().hover(function () {
            }, function () {
                $(this).parent().find("ul.subnav").slideUp('slow'); //When the mouse hovers out of the subnav, move it back up  
            });
            //Following events are applied to the trigger (Hover events for the trigger)  
        }).hover(function () {
            $(this).addClass("subhover"); //On hover over, add class "subhover"  
        }, function () {  //On Hover Out  
            $(this).removeClass("subhover"); //On hover out, remove class "subhover"  
        });
        $("ul.topnav .toplevel").click(function () { //When trigger is clicked...            
            //Following events are applied to the subnav itself (moving subnav up and down)  
            $(this).parent().find("ul.subnav").slideDown('fast').show(); //Drop down the subnav on click    
            $(this).parent().hover(function () {
            }, function () {
                $(this).parent().find("ul.subnav").slideUp('slow'); //When the mouse hovers out of the subnav, move it back up  
            });
            //Following events are applied to the trigger (Hover events for the trigger)  
        }).hover(function () {
            $(this).addClass("subhover"); //On hover over, add class "subhover"  
        }, function () {  //On Hover Out  
            $(this).removeClass("subhover"); //On hover out, remove class "subhover"  
        });

        $("ul.asubnav").parent().append("<span style='display:none;'></span>"); //Only shows drop down trigger when js is enabled (Adds empty span tag after ul.subnav*)  
        $("ul.atopnav li span").click(function () { //When trigger is clicked...            
            //Following events are applied to the subnav itself (moving subnav up and down)  
            $(this).parent().find("ul.asubnav").slideDown('fast').show(); //Drop down the subnav on click    
            $(this).parent().hover(function () {
            }, function () {
                $(this).parent().find("ul.asubnav").slideUp('slow'); //When the mouse hovers out of the subnav, move it back up  
            });
            //Following events are applied to the trigger (Hover events for the trigger)  
        }).hover(function () {
            $(this).addClass("subhover"); //On hover over, add class "subhover"  
        }, function () {  //On Hover Out  
            $(this).removeClass("subhover"); //On hover out, remove class "subhover"  
        });
        $("ul.atopnav .atoplevel").click(function () { //When trigger is clicked...            
            //Following events are applied to the subnav itself (moving subnav up and down)  
            $(this).parent().find("ul.asubnav").slideDown('fast').show(); //Drop down the subnav on click    
            $(this).parent().hover(function () {
            }, function () {
                $(this).parent().find("ul.asubnav").slideUp('slow'); //When the mouse hovers out of the subnav, move it back up  
            });
            //Following events are applied to the trigger (Hover events for the trigger)  
        }).hover(function () {
            $(this).addClass("subhover"); //On hover over, add class "subhover"  
        }, function () {  //On Hover Out  
            $(this).removeClass("subhover"); //On hover out, remove class "subhover"  
        });
    });

    function encrypt(val) {

        //var bf = new Blowfish('i@f0ffl1n3F0rm$');
        //var ciphertext = bf.encrypt(val);

        var ciphertext = Aes.Ctr.encrypt(val, aesPW, 256);
        return ciphertext;
    }

    function showModalExport() {
        document.getElementById('container').style.display = "none"; //mainContent

        document.getElementById('driveSelectTPExport').disabled = false;
        document.getElementById('btnOkExport').disabled = false;
        document.getElementById('btnCancelExport').disabled = false;

        $('#modalExport').show('blind');
    }

    function cancelExportModal() {  
        if ($('#modalExport').css('display') != 'none') {

            document.getElementById('container').style.display = 'block';
            $('#modalExport').hide('blind');
        }

        //refresh HTA page here. to address: 
        //Issue#380: A return tagged as final copy should not be edited by tp, rdo, rdc. Currently, user can still modify entries.
        //document.location.reload(true);
        disableAllElementIDs();
        d.getElementById('btnUpload').disabled = false;
        d.getElementById('frm1701q:txtCurrentPage').disabled = false;
        d.getElementById('frm1701q:btnPrevPage').disabled = false;
        d.getElementById('frm1701q:btnNextPage').disabled = false;
    }

    function showModalImport() {
        $('#modalImport').show('blind');
    }

    function cancelImportModal() {
        if ($('#modalImport').css('display') != 'none') {
            $('#modalImport').hide('blind');
        }
    }
    function exportTPFiles(fnToExport) {
        try {
            var drive = d.getElementById('driveSelectTPExport').value;
            if (drive == '0') {
                alert("Please select the drive name of your USB flash drive or CD-RW."); return;
            }

            var fso, fldr;
            var sourceDir = "IAF_RDO_Copy/";
            var destDir = "IAF_RDO_Copy";
            fso = new ActiveXObject("Scripting.FileSystemObject");
            if (fso.FolderExists(sourceDir)) {
                if (fso.FolderExists(drive + destDir)) {
                    //do nothing here...
                } else {
                    fso.CreateFolder(drive + destDir);
                }
                fso.CopyFile(sourceDir + fnToExport, drive + destDir + "/");
            } else {
                alert("Please insert a recordable media [diskette/universal serial bus (USB) flash drive, compact disc (cd), digital video disc (dvd)] in drive " + drive); return;
            }

            alert("Successfully copied files to " + drive + destDir);
            cancelExportModal();

        } catch (e) {
            alert("There is not enough space in drive " + drive); return;
        }

    }
    function exportTPFileInC() {
        try {
            var drive = "C:/";
            if (drive == '0') {
                alert("Please select the drive name of your USB flash drive or CD-RW."); return;
            }

            var fso, fldr;
            var sourceDir = "IAF_RDO_Copy/";
            var destDir = "IAF_RDO_Copy";
            fso = new ActiveXObject("Scripting.FileSystemObject");
            if (fso.FolderExists(sourceDir)) { //TODO: need to trap non-existing drive to avoid : "Error: Path not found"
                if (fso.FolderExists(drive + destDir)) {
                    //do nothing here...
                } else {
                    fso.CreateFolder(drive + destDir); //TODO: need to trap non-existing drive to avoid : "Error: Path not found"
                }
                fso.CopyFile(sourceDir + "*", drive + destDir + "/");
            } else {
                alert("Copy Failed. No such directory: " + sourceDir); return;
            }

            cancelExportModal();

        } catch (e) {
            alert("No such drive or directory."); return;
        }


    }
    var onExit = false;
    function isOnExit() {
        onExit = true;
    }
    function saveBeforeExit() {
        var y = confirm("Are you sure you want to exit?");
        if (y) {
            saveXML(false);
            //saveXMLProfile(false);
            try {
                deleteTemp();
                window.close(); self.close();
            }
            catch (err) {
                window.close(); self.close();
            }
        }
    }
    function ShowContainer(param) {
        $('#' + param).show();
        //$('#container').hide();
    }

    function HideContainer(param) {
        if ($('#' + param).css('display') != 'none') {
            $('#' + param).hide();
        }
    }

    //Final Copy Button:
    function openAlertEmail() {       
    	var tinNumber = $('#frm1701q\\:txtTIN1').val() + $('#frm1701q\\:txtTIN2').val() + $('#frm1701q\\:txtTIN3').val();
    	conService.initConConfig(tinNumber, '1701Qv2018');
    	/*
    	if (conService.canSendToEFPS()) {
    		//Only '1700', '1701', '1702EX', '1702MX', '1702RT', '2200A', '2200T' are allowed to submit through eFPS
    		//this block will never get executed.
    		submitEbir();
    	} else {
		*/
			var fileSys = new ActiveXObject("Scripting.FileSystemObject");
			var xmlFileNameValidate = "";
	    	if(document.getElementById('txtFinalFlag').value == '2'){   reSendEmail();  return;  }
	        
	        var xmlFileName = createXMLFileName("savefile/");
	        var isFileExists = doesFileExists(xmlFileName);
	        var isAmendedReturn = isItAnAmendedReturn();
			//as of 10/21/2016
				//if there is already amended filed and will file a not amended,
				//it will restrict it
				if (isAmendedReturn == false) {
					
					if (xmlFileName.indexOf('V') == -1) {
						xmlFileNameValidate = xmlFileName.substring(xmlFileName.indexOf('/')+1,xmlFileName.indexOf('.xml'));			
					} else {
						xmlFileNameValidate = xmlFileName.substring(xmlFileName.indexOf('/')+1,xmlFileName.indexOf('V'));			
					}
					
					var hasVersion = false;
					var objEnum = new Enumerator(fileSys.GetFolder("savefile/").Files);
					for(i=0;!objEnum.atEnd();objEnum.moveNext()) {
						if (objEnum.item().name.indexOf(xmlFileNameValidate) > -1 && objEnum.item().name.indexOf("V") > -1) {
							hasVersion = true;
						}
					}	
                    			if (hasVersion) {
						if (!onExit)
							alert("If your intention is to make an amended return, kindly tick Amended Return to 'Yes' before hitting 'Save'or'Final Copy' or 'Submit'.");
						return false;
					}
              			  }
	
	        if (isFileExists) {
	            isAFinalCopy = isItAFinalCopy(xmlFileName);  if(document.getElementById('txtFinalFlag').value == '2'){isAFinalCopy = false;}
	        }
	
	        if (isFileExists && isAFinalCopy && isAmendedReturn == false && document.getElementById('txtFinalFlag').value != '3') {
	             alert("If your intention is to make an amended return, kindly tick Amended Return to 'Yes' before hitting 'Save' or 'Final Copy' or 'Submit'."); ShowContainer('container');
	            return false;
	        }
	        else {
	            if (confirm("Please ensure that you have INTERNET access and a VALID email address is indicated in your tax return.\n\n" +
				       "Are you sure you want to submit?") === true) {
	
	                if (checkNetConnection() === true) {    HideContainer("container");  if(document.getElementById('txtFinalFlag').value == "3"){document.getElementById('txtFinalFlag').value = "2"}else{document.getElementById('txtFinalFlag').value = "0"};    initializeOnOpenAlertEmail();
	                    ShowContainer("ebirEnroll");
	                }
	                else {
	                    alert("The system detected that you have no internet connection.\nPlease contact your internet service provider."); document.getElementById('txtFinalFlag').value = "3";  saveEncryptedProfile(); checkFinalCopyBtn('1701Qv2018');
	                    ShowContainer('container');//alert("There is no internet connection, please make sure that an internet connection is available before making a final copy.");
	                }
	            }
	        //}
    	}
    }





    function sendEmail(sourceElement) {

        var isRegisteredTP = (sourceElement.id !== "ebirOnlineConfirmSubmit") ? "N" : "Y";  if(isRegisteredTP == "Y" && (ValidateConfirm() == false)){return;}
        var isAutoEnroll = (sourceElement.id == "ebirEnrollYes") ? "Y" : "N";
        if (isAutoEnroll == "Y") {
            document.getElementById("txtEnroll").value = "Y";
        }
 
        document.getElementById("ebirOnlineSecret").value = document.getElementById("ebirOnlinePassword").value;  initializeOnSendEmail();

        
        
        
        
        
        
         
        

        var emailFilePath = saveEncryptedProfile(true);

        var dateSubmitted = new Date();

        var tpRDOCode = document.getElementById('frm1701q:txtRDOCode').value;
        var formType = "1701Qv2018";
        var tpTIN = document.getElementById('frm1701q:txtTIN1').value + document.getElementById('frm1701q:txtTIN2').value + document.getElementById('frm1701q:txtTIN3').value + document.getElementById('frm1701q:txtBranchCode').value;
        //var tpMonth = document.getElementById('frm1701q:j_id201').value;
        var qtr = "";
        if (document.getElementById('frm1701q:DateQuarter_1').checked == true) {
            qtr = "Q1";
        }
        if (document.getElementById('frm1701q:DateQuarter_2').checked == true) {
            qtr = "Q2";
        }
        if (document.getElementById('frm1701q:DateQuarter_3').checked == true) {
            qtr = "Q3";
        }
        var tpYear = document.getElementById('frm1701q:txtYear').value + qtr;

        var fileNameEmail = emailFilePath.substring(emailFilePath.lastIndexOf("\\") + 1, emailFilePath.length);
        var versionNumber = fileNameEmail.lastIndexOf("V") > -1 ? fileNameEmail.substring(fileNameEmail.lastIndexOf("V"), fileNameEmail.lastIndexOf(".")) : "";

        //var emailTaxPayer = document.getElementById('frm1702MX:txtPg1Pt1I12Email').value;
        var emailTaxPayer = document.getElementById('txtEmail').value;
        var emailSubject = tpRDOCode + "_" + formType + "_" + tpTIN + "_" + tpYear + versionNumber;

        var emailBody = "Received Email subject to validation of BIR. <br> With attachment '" + fileNameEmail + "' <br> Date and time submitted: " + dateSubmitted +
						" <br><br> TIN: " + tpTIN +
						" <br> Name: " + document.getElementById("frm1701q:txtTaxpayerName").value +
						" <br> Tax Type: Income Tax" +
						" <br> Form Type: " + formType +
						" <br> Return Period: " + tpYear +
						" <br> <br> Penalties may be imposed for any violation to the provisions of the NIRC and issuances thereof." +
						" <br> <br> FOR RETURNS WITH PAYMENT" +
						" <br> Please print the said email together with the Income Tax Return and then Proceed to Pay in the Authorized Agent Bank / Collection Agent under RDO where registered following existing issuances.";

        //alert("BIRSendEmail Initiated");

        // Display loader to show that an email is being sent
        $('#loader').css('background', 'transparent'); disableDropDown("before");
        $('#loader').show('blind');

        try {
            //BIRSendEmail('1701Q@birgovph.org', '1701Qv2008@bir.gov.ph', emailTaxPayer, emailSubject, emailBody, emailFilePath, '1701Qv2008', 'smtp1.birgovph.org', '25', isRegisteredTP);
            var wsData = conService.getConConfig();
            var ftpFolder = enviService.getFtpFolder('1701Qv2018');
            var returnCode = RenameAndSendFile(emailFilePath, emailTaxPayer, ftpFolder, wsData.mode, wsData.srv, wsData.sslport, wsData.port, wsData.usr, wsData.pass); clearFileNameWOemail();
            $('#container').hide();
            if (returnCode == 0) {
                document.getElementById('txtFinalFlag').value = "1";  updateFinalFlagOnSaveFile(fileNameEmail);    alert("Submit Successful. Subject to validation by BIR. \n\n A notification will be sent to your email ("+ emailTaxPayer +"). Please print or save the email as an evidence of efiled return.");
                $('#paymentOption').show();
                $('#paymentOptionCloseBtn').on('click', function () {
                    $('#paymentOption').hide();
                    $('#container').show();
                });
            }
            else {
                document.getElementById('txtFinalFlag').value = "2";  updateFinalFlagOnSaveFile(fileNameEmail);   alert('Your Tax Return was not submitted online due to any of the \n following reasons that may interrupt the submission process: \n - No internet connection \n - Slow internet connection \n - Overly restrictive firewall');
                $('#container').show();
            }
        }
        catch (e) {
            document.getElementById('txtFinalFlag').value = "2";  updateFinalFlagOnSaveFile(fileNameEmail);   alert('Your Tax Return was not submitted online due to any of the \n following reasons that may interrupt the submission process: \n - No internet connection \n - Slow internet connection \n - Overly restrictive firewall');
            $('#container').show();
        }
        finally {
        }
        // Hide loader
        $('#loader').hide('blind');
         $('#loader').css('background', '#FFF'); checkFinalCopyBtn(formType); disableDropDown("after");
        HideContainer('ebirConfirmOnline');
        ShowContainer('container');
    }
    //--------------------------START:  Rollbase REST API using 'create2' and 'setBinaryData' --------------------------
    var sessionId;
    var respMsg;
    var create2Id;

    xmlHttp = new XMLHttpRequest(), loginXML = new XMLHttpRequest(), binReturnsUploadXML = new XMLHttpRequest();
    /*
    var gAdminUser = "";
    var gAdminPass = "";
    
    function getAdminUser(val) {
        gAdminUser = val;
    }
    function getAdminPass(val) {
        gAdminPass = val;
    }
    function validateAdminLogon() {
    
        if (gAdminUser.length > 0 && gAdminPass.length > 0) {
    
            var login = "https://ebirforms.bir.gov.ph:443/rest/api/login?loginName="+gAdminUser+"&password="+gAdminPass;		
            loginXML.open( "GET", login, true);		
            loginXML.send(null); 		
    
        } else {
            alert("Please provide Username and Password.");
            return;
        }	
    }
    
    function gotoAdmin() {
        showModalRollbaseLogin();	
    }
    function showModalRollbaseLogin() {
            document.getElementById('container').style.display = "none";
            $('#modalRollbaseLogin').show('blind');		
    } 
            
    function cancelModalRollbaseLogin() {
            if ( $('#modalRollbaseLogin').css('display') != 'none' ) {
                document.getElementById('container').style.display = 'block';	
                $('#modalRollbaseLogin').hide('blind');
            }
    }*/

    var api, x, gRBSessionId;
    function openLogin() {  document.getElementById('txtFinalFlag').value = '3'
        isSubmit = true;
        isSubmitFinal = true;
        if (gIsReadOnly) {
            isSubmitFinal = false;
        }
        var hasSavedReturn = saveXMLsubmit(true);
        if (hasSavedReturn) {
            var loginURL = geteBIRFormsOnlineLoginURL();
            x = window.open(loginURL, 'Login_Screen', 'resizable=1,scrollbars=1,height=850,width=900');
            api = window.setInterval(getAPI, 500);
        }
    }
    function getAPI() {
		try {
			if (x.closed) {
				if (api) {
					if (isSubmitFinal) {
						window.clearInterval(api);
						api = null;
						saveXMLsubmit(false);
					}
					else {
						window.clearInterval(api);
						api = null;
						saveXMLsubmit(true);
					}
				}
				return;
			}

			if ($("#response", x.document).length > 0)
				$("#responsetext").val($("#response", x.document).val());
			else return;
			var response = String($("#responsetext").val());
			gRBSessionId = response;

			/* sessionId = gRBSessionId.split('sessionId');
			sessionId = String(sessionId[1]);
			sessionId = sessionId.substring(1,sessionId.length-2);			
			
			if (response.length != 0 && sessionId != 'ndefin') {

				//x.close();
				window.clearInterval(api);
				//alert("Session ID : '"+sessionId+"' successfully created!");
				createRecord(); 
			} 
			//else if (response.length != 0 && sessionId == 'ndefin') {
				//alert("Invalid username and password!");
			//} */

			sessionId = gRBSessionId.split('<sessionId>');
			sessionId = String(sessionId[1]);
			sessionId = sessionId.split('</sessionId>');
			sessionId = String(sessionId[0]);
			//alert('sessionId = '+sessionId);

			if (response.length != 0 && (sessionId != 'undefined' || sessionId != '<?xml ver')) {
				createRecord();
				window.clearInterval(api);
			}
		}
		catch (e) {
			return;
		}
    }

    /* Commented for logon IAF 
    function uploadMe() {	
        saveXML(true);
        gotoAdmin();
    }
    function uploadMe() {	
        saveXML(true);
        //dgarfin TODO: username/password should not be hard-coded here.  It should verify first if there's an IAF session.  
        //If it has, then supply it with 'loginName' and 'password'.  
        //Otherwise, popup a new window asking user to login to IAF then if logged in successfully, supply credentials to params
        var login = "https://ebirforms.bir.gov.ph:443/rest/api/login?loginName=dgarfin_tester@bir_dev&password=142857";
        loginXML.open( "GET", login, true);
        loginXML.send(null); 
    }
    
    loginXML.onreadystatechange = function() { 
        if ( loginXML.readyState == 4 && loginXML.status==200 ) { //Request Complete	
            sessionId = String(loginXML.responseText).split('sessionId');
            sessionId = String(sessionId[1]);
            sessionId = sessionId.substring(1,sessionId.length-2);		
            
    
            // Commented for logon IAF
            if ( $('#modalRollbaseLogin').css('display') != 'none' ) {
                document.getElementById('container').style.display = 'block';	
                $('#modalRollbaseLogin').hide('blind');
            }///		
            alert("Session ID : '"+sessionId+"' successfully created!");
            createRecord();
         
        }
        else if ( loginXML.readyState == 3 && loginXML.status!=200 ) {
            //alert('readyState = '+loginXML.readyState+' status = '+loginXML.status);  //2/403;3/403;
            alert('Wrong credentials provided.  Pls try again.');
            return;
        }	
    }*/

    xmlFileForCreate2X = new Date();
    //getURL() is defined in string-util.js
    var rbURL = getURL();
    function createRecord() {

        createURL = rbURL + "/rest/api/create2?sessionId=" + sessionId + "&objName=upload1&tax_due=" + p3BasicTax + "&total_penalties=" + p3TotalPenalties + "&total_amount_payable=" + p3TotalAmountPayable + "&tp_zip=" + p3TPZip + "&tp_addr=" + p3TPAddress + "&tp_telnum=" + p3TPTelNum + "&tp_name=" + p3TPName + "&tp_lob=" + p3TPLineBus + "&tp_rdo_code=" + p3TPRDOCode + "&tp_branch_code=" + p3TPBranchCode + "&tp_tin=" + p3TPTIN + "&surcharge=" + p3Surcharge + "&compromise=" + p3Compromise + "&interest=" + p3Interest + "&is_amended_return=" + p3IsAmended + "&return_period=" + p3ReturnPeriod + "&return_period_end=" + p3ReturnPeriodEnd + "&useIds=false&form_type_text=1701Qv2018-Jul2008&load=" + xmlFileForCreate2X; //FOR create2

        // xmlHttp.open( "GET", encodeURI(createURL), true); //xxx
        // xmlHttp.send(null); 

        xmlHttp.open("POST", createURL, false);
        xmlHttp.send();

        var respXMLMsg = xmlHttp.responseText;

        create2Id = respXMLMsg;
        create2Id = create2Id.split('id=');
        create2Id = String(create2Id[1]).replace(/"/gi, '');
        create2Id = String(parseInt(create2Id)).replace(/ /, '');

        //alert("Form ID : '"+create2Id+"' successfully created!");
        x.document.theForm.submit();
        uploadXMLFile();
    }

    /* xmlHttp.onreadystatechange = function() {
        if ( xmlHttp.readyState == 4 && xmlHttp.status==200 ) { //Request Complete
    
            var respXMLMsg = xmlHttp.responseText;
            //Get ID of response from Create2
            create2Id = respXMLMsg.substring(respXMLMsg.indexOf('data  id=')+10, respXMLMsg.indexOf(' objName=')-1); //should be at least 8-digit ID here		
            //alert("Form ID : '"+create2Id+"' successfully created!");	
    
            if (isNaN(create2Id)) {
                    //alert('Tax return filing is unsuccessful!');
                    x.close();
                    openLogin();
            } else {
                    //alert("Form ID : '"+create2Id+"' successfully created!");     
                    uploadXMLFile();                
            }
    
        }
    } */

    function uploadXMLFile() {
        var binDataURL;

        //Dev Note: frmMainSrc contains the HTML and content of the form
        //frmMainSrc should get the print preview version
        // $('#frmMain').html(); //content of the loop
        printme();

        if (savedReturn != null && savedReturn.length > 0) {
            var intervalCnt = 1000;

            var xmlFileForUpload = savedReturn.replace(/&nbsp;/g, "<span style='padding-left:0.25em'> </span>");
            xmlFileForUpload = xmlFileForUpload.replace(/&amp;/g, "AND");
            xmlFileForUpload = xmlFileForUpload.replace(/&/g, "_AND_");
            xmlFileForUpload = xmlFileForUpload.replace(/\+/g, "_PLUS_");
            var savedReturnLen = xmlFileForUpload.length;

            //Loop Begin - create submit_return_data records, related to Created Upload File - 		
            var numOfSRLoops = Math.ceil(savedReturnLen * 1 / intervalCnt);
            var loopSRCnt = numOfSRLoops + 1;
            var startSRPost = 0;
            var endSRPost = intervalCnt;
            var partSRCnt = 1;

            for (var i = 0; i < numOfSRLoops; i++) {

                binDataURL = rbURL + "/rest/api/create2?sessionId=" + sessionId + "&objName=submit_return_data&useIds=false&index_=" + partSRCnt + "&name=1701Qv2018_part" + partSRCnt + "&R95607586=" + create2Id + "&content=" + xmlFileForUpload.substring(startSRPost, endSRPost);
                var binDataUploadXML = new XMLHttpRequest();
                // binDataUploadXML.open( "GET", encodeURI(binDataURL) , false); 
                // binDataUploadXML.send(null);

                binDataUploadXML.open("POST", encodeURI(binDataURL), false);
                binDataUploadXML.send();

                //xmlFn.writeLine(xmlFileInBase64.substring(startSRPost, endSRPost)+"\n\ncompleted\n\n");			
                //alert('i = '+i+' startSRPost = '+startSRPost+' endSRPost = '+endSRPost);	

                startSRPost = startSRPost + intervalCnt;
                if (i == numOfSRLoops - 1) {
                    endSRPost = savedReturnLen;
                } else {
                    endSRPost = endSRPost + intervalCnt;
                }
                partSRCnt++;
            }
            //alert("A total of "+loopSRCnt+" iterations are uploaded in 'submit_return_data' object for this form!");	
            cancel();
            disableAllElementIDs();
            //Open a new page, displaying the created form
            //alert("Finished Loading REST 'create2' request for FORMS object.");

            d.getElementById('frm1701q:txtCurrentPage').disabled = false;
            d.getElementById('frm1701q:btnPrevPage').disabled = false;
            d.getElementById('frm1701q:btnNextPage').disabled = false;
            
            //getDisplayPageURL() is defined in string-util2014.js
            var redirectURL = x.window.location.href;
            var formURL = getDisplayPageURL(redirectURL, create2Id);
            if (parseInt(create2Id) > 0) window.open(formURL, 'Login_Screen', 'resizable=1,scrollbars=1,height=850,width=900');
        } else {
            alert("Tax Return file does not exists.  Cannot proceed with submission.");
            return;
        }

        //xmlFn.close();		

    }
    //--------------------------END:  Rollbase REST API using 'create2' and 'setBinaryData' --------------------------

</script>
